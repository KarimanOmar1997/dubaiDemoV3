"use strict";(self.webpackChunkRemoteClient=self.webpackChunkRemoteClient||[]).push([[4780],{9704:(t,e,s)=>{s.d(e,{e:()=>d});var i=s(32773),n=s(80959),r=s(77037),h=s(3952),o=s(69763),a=s(2824),l=s(2232),c=s(3687),u=s(59700);async function d(t,e,s){const d=(0,n.Mq)(s),{point:_,distance:f,returnEdge:m,vertexMode:g}=e;if(!m&&"none"===g)return{candidates:[]};let p=(0,i.o8)(e.query);p=await t.schedule((()=>(0,c.n)(p,t.definitionExpression,t.spatialReference)),d),p=await t.reschedule((()=>(0,l.v)(p,{availableFields:t.availableFields,fieldsIndex:t.fieldsIndex,geometryType:t.geometryType,spatialReference:t.spatialReference})),d);const y=!(0,o.e)(_.spatialReference,t.spatialReference);y&&await(0,a.c)(_.spatialReference,t.spatialReference);const b="number"==typeof f?f:f.x,v="number"==typeof f?f:f.y,x={xmin:_.x-b,xmax:_.x+b,ymin:_.y-v,ymax:_.y+v,spatialReference:_.spatialReference},M=y?(0,a.p)(x,t.spatialReference):x;if(!M)return{candidates:[]};const E=(await(0,h.el)((0,r.rS)(_),null,{signal:d}))[0],B=(await(0,h.el)((0,r.rS)(M),null,{signal:d}))[0];if(null==E||null==B)return{candidates:[]};const A=new l.Q(await t.reschedule((()=>t.searchFeatures((0,l.g)(B.toJSON()))),d),p,t);await t.reschedule((()=>t.executeObjectIdsQuery(A)),d),await t.reschedule((()=>t.executeTimeQuery(A)),d),await t.reschedule((()=>t.executeAttributesQuery(A)),d),await t.reschedule((()=>async function(t,e,s){const{query:i}=e,{spatialRel:n}=i;if(!e?.items?.length||!i.geometry||!n)return;const r=await(0,u.g)(n,i.geometry,t.geometryType,t.hasZ,t.hasM),h=await t.runSpatialFilter(e.items,(t=>r(t.geometry)),s);e.items=h}(t,A,d)),d);const z=E.toJSON(),I=y?(0,a.p)(z,t.spatialReference):z,w=y?Math.max(M.xmax-M.xmin,M.ymax-M.ymin)/2:f;return A.createSnappingResponse({...e,point:I,distance:w},p.returnZ,_.spatialReference)}},11618:(t,e,s)=>{s.d(e,{o:()=>n});var i=s(58003);const n={getObjectId:t=>t.objectId,getAttributes:t=>t.attributes,getAttribute:(t,e)=>t.attributes[e],cloneWithGeometry:(t,e)=>new i.O(e,t.attributes,null,t.objectId),getGeometry:t=>t.geometry,getCentroid:(t,e)=>t.ensureCentroid(e)}},11721:(t,e,s)=>{s.d(e,{B:()=>E,P:()=>h});var i=s(32773),n=s(61532),r=s(32159);class h{constructor(t=9,e){this._compareMinX=u,this._compareMinY=d,this._toBBox=t=>t,this._maxEntries=Math.max(4,t||9),this._minEntries=Math.max(2,Math.ceil(.4*this._maxEntries)),e&&("function"==typeof e?this._toBBox=e:this._initFormat(e)),this.clear()}destroy(){this.clear(),b.prune(),v.prune(),x.prune(),M.prune()}all(t){o(this._data,t)}search(t,e){let s=this._data;const i=this._toBBox;if(p(t,s))for(b.clear();s;){for(let n=0,r=s.children.length;n<r;n++){const r=s.children[n],h=s.leaf?i(r):r;p(t,h)&&(s.leaf?e(r):g(t,h)?o(r,e):b.push(r))}s=b.pop()}}collides(t){let e=this._data;const s=this._toBBox;if(!p(t,e))return!1;for(b.clear();e;){for(let i=0,n=e.children.length;i<n;i++){const n=e.children[i],r=e.leaf?s(n):n;if(p(t,r)){if(e.leaf||g(t,r))return!0;b.push(n)}}e=b.pop()}return!1}load(t){if(!t.length)return this;if(t.length<this._minEntries){for(let e=0,s=t.length;e<s;e++)this.insert(t[e]);return this}let e=this._build(t.slice(),0,t.length-1,0);if(this._data.children.length)if(this._data.height===e.height)this._splitRoot(this._data,e);else{if(this._data.height<e.height){const t=this._data;this._data=e,e=t}this._insert(e,this._data.height-e.height-1,!0)}else this._data=e;return this}insert(t){return t&&this._insert(t,this._data.height-1),this}clear(){return this._data=new A([]),this}remove(t){if(!t)return this;let e,s=this._data,n=null,r=0,h=!1;const o=this._toBBox(t);for(x.clear(),M.clear();s||x.length>0;){if(s||(s=x.pop(),n=x.data[x.length-1],r=M.pop()??0,h=!0),s.leaf&&(e=(0,i.d)(s.children,(0,i.t)(t),s.children.length,s.indexHint),-1!==e))return s.children.splice(e,1),x.push(s),this._condense(x),this;h||s.leaf||!g(s,o)?n?(r++,s=n.children[r],h=!1):s=null:(x.push(s),M.push(r),r=0,n=s,s=s.children[0])}return this}toJSON(){return this._data}fromJSON(t){return this._data=t,this}_build(t,e,s,i){const n=s-e+1;let r=this._maxEntries;if(n<=r){const i=new A(t.slice(e,s+1));return a(i,this._toBBox),i}i||(i=Math.ceil(Math.log(n)/Math.log(r)),r=Math.ceil(n/r**(i-1)));const h=new z([]);h.height=i;const o=Math.ceil(n/r),l=o*Math.ceil(Math.sqrt(r));y(t,e,s,l,this._compareMinX);for(let n=e;n<=s;n+=l){const e=Math.min(n+l-1,s);y(t,n,e,o,this._compareMinY);for(let s=n;s<=e;s+=o){const n=Math.min(s+o-1,e);h.children.push(this._build(t,s,n,i-1))}}return a(h,this._toBBox),h}_insert(t,e,s){const i=this._toBBox,n=s?t:i(t);x.clear();const r=function(t,e,s,i){for(;i.push(e),!0!==e.leaf&&i.length-1!==s;){let s,i=1/0,h=1/0;for(let o=0,a=e.children.length;o<a;o++){const a=e.children[o],l=_(a),c=(n=t,r=a,(Math.max(r.maxX,n.maxX)-Math.min(r.minX,n.minX))*(Math.max(r.maxY,n.maxY)-Math.min(r.minY,n.minY))-l);c<h?(h=c,i=l<i?l:i,s=a):c===h&&l<i&&(i=l,s=a)}e=s||e.children[0]}var n,r;return e}(n,this._data,e,x);for(r.children.push(t),c(r,n);e>=0&&x.data[e].children.length>this._maxEntries;)this._split(x,e),e--;!function(t,e,s){for(let i=s;i>=0;i--)c(e.data[i],t)}(n,x,e)}_split(t,e){const s=t.data[e],i=s.children.length,n=this._minEntries;this._chooseSplitAxis(s,n,i);const r=this._chooseSplitIndex(s,n,i);if(!r)return;const h=s.children.splice(r,s.children.length-r),o=s.leaf?new A(h):new z(h);o.height=s.height,a(s,this._toBBox),a(o,this._toBBox),e?t.data[e-1].children.push(o):this._splitRoot(s,o)}_splitRoot(t,e){this._data=new z([t,e]),this._data.height=t.height+1,a(this._data,this._toBBox)}_chooseSplitIndex(t,e,s){let i,n,r;i=n=1/0;for(let h=e;h<=s-e;h++){const e=l(t,0,h,this._toBBox),o=l(t,h,s,this._toBBox),a=m(e,o),c=_(e)+_(o);a<i?(i=a,r=h,n=c<n?c:n):a===i&&c<n&&(n=c,r=h)}return r}_chooseSplitAxis(t,e,s){const i=t.leaf?this._compareMinX:u,n=t.leaf?this._compareMinY:d;this._allDistMargin(t,e,s,i)<this._allDistMargin(t,e,s,n)&&t.children.sort(i)}_allDistMargin(t,e,s,i){t.children.sort(i);const n=this._toBBox,r=l(t,0,e,n),h=l(t,s-e,s,n);let o=f(r)+f(h);for(let i=e;i<s-e;i++){const e=t.children[i];c(r,t.leaf?n(e):e),o+=f(r)}for(let i=s-e-1;i>=e;i--){const e=t.children[i];c(h,t.leaf?n(e):e),o+=f(h)}return o}_condense(t){for(let e=t.length-1;e>=0;e--){const s=t.data[e];if(0===s.children.length)if(e>0){const n=t.data[e-1],r=n.children;r.splice((0,i.d)(r,s,r.length,n.indexHint),1)}else this.clear();else a(s,this._toBBox)}}_initFormat(t){const e=["return a"," - b",";"];this._compareMinX=new Function("a","b",e.join(t[0])),this._compareMinY=new Function("a","b",e.join(t[1])),this._toBBox=new Function("a","return {minX: a"+t[0]+", minY: a"+t[1]+", maxX: a"+t[2]+", maxY: a"+t[3]+"};")}}function o(t,e){let s=t;for(v.clear();s;){if(!0===s.leaf)for(const t of s.children)e((0,i.t)(t));else v.pushArray(s.children);s=v.pop()??null}}function a(t,e){l(t,0,t.children.length,e,t)}function l(t,e,s,i,n){n||(n=new A([])),n.minX=1/0,n.minY=1/0,n.maxX=-1/0,n.maxY=-1/0;for(let r,h=e;h<s;h++)r=t.children[h],c(n,t.leaf?i(r):r);return n}function c(t,e){t.minX=Math.min(t.minX,e.minX),t.minY=Math.min(t.minY,e.minY),t.maxX=Math.max(t.maxX,e.maxX),t.maxY=Math.max(t.maxY,e.maxY)}function u(t,e){return t.minX-e.minX}function d(t,e){return t.minY-e.minY}function _(t){return(t.maxX-t.minX)*(t.maxY-t.minY)}function f(t){return t.maxX-t.minX+(t.maxY-t.minY)}function m(t,e){const s=Math.max(t.minX,e.minX),i=Math.max(t.minY,e.minY),n=Math.min(t.maxX,e.maxX),r=Math.min(t.maxY,e.maxY);return Math.max(0,n-s)*Math.max(0,r-i)}function g(t,e){return t.minX<=e.minX&&t.minY<=e.minY&&e.maxX<=t.maxX&&e.maxY<=t.maxY}function p(t,e){return e.minX<=t.maxX&&e.minY<=t.maxY&&e.maxX>=t.minX&&e.maxY>=t.minY}function y(t,e,s,i,n){const h=[e,s];for(;h.length;){const e=h.pop(),s=h.pop();if(e-s<=i)continue;const o=s+Math.ceil((e-s)/i/2)*i;(0,r.q)(t,o,s,e,n),h.push(s,o,o,e)}}const b=new n.P,v=new n.P,x=new n.P,M=new n.P({deallocator:void 0});class E{constructor(){this.minX=1/0,this.minY=1/0,this.maxX=-1/0,this.maxY=-1/0}}class B extends E{constructor(){super(...arguments),this.height=1,this.indexHint=new i.P}}class A extends B{constructor(t){super(),this.children=t,this.leaf=!0}}class z extends B{constructor(t){super(),this.children=t,this.leaf=!1}}},13141:(t,e,s)=>{s.d(e,{F:()=>f});var i=s(32773),n=s(6407),r=s(81272),h=s(20266),o=s(47239),a=s(48402),l=s(83637),c=s(42614),u=s(59700),d=s(11618);const _=(0,o.c)();class f{constructor(t){this.geometryInfo=t,this._boundsStore=new c.B,this._featuresById=new Map,this._usedMemory=0,this.events=new r.A,this.featureAdapter=d.o}get usedMemory(){return this._usedMemory}get geometryType(){return this.geometryInfo.geometryType}get hasM(){return this.geometryInfo.hasM}get hasZ(){return this.geometryInfo.hasZ}get numFeatures(){return this._featuresById.size}get fullBounds(){return this._boundsStore.fullBounds}get storeStatistics(){let t=0;return this._featuresById.forEach((e=>{null!=e.geometry&&e.geometry.coords&&(t+=e.geometry.coords.length)})),{featureCount:this._featuresById.size,vertexCount:t/(this.hasZ?this.hasM?4:3:this.hasM?3:2)}}getFullExtent(t){if(null==this.fullBounds)return null;const[e,s,i,n]=this.fullBounds;return{xmin:e,ymin:s,xmax:i,ymax:n,spatialReference:(0,u.c)(t)}}add(t){this._add(t),this._emitChanged()}addMany(t){for(const e of t)this._add(e);this._emitChanged()}upsertMany(t){const e=t.map((t=>this._upsert(t)));return this._emitChanged(),e.filter(i.i)}clear(){this._featuresById.clear(),this._boundsStore.clear(),this._emitChanged(),this._usedMemory=0}removeById(t){const e=this._featuresById.get(t);return e?(this._remove(e),this._emitChanged(),e):null}removeManyById(t){this._boundsStore.invalidateIndex();for(const e of t){const t=this._featuresById.get(e);t&&this._remove(t)}this._emitChanged()}forEachBounds(t,e){for(const s of t){const t=this._boundsStore.get(s.objectId);t&&e((0,o.g)(_,t))}}getFeature(t){return this._featuresById.get(t)}has(t){return this._featuresById.has(t)}forEach(t){this._featuresById.forEach((e=>t(e)))}forEachInBounds(t,e){this._boundsStore.forEachInBounds(t,(t=>{e(this._featuresById.get(t))}))}_emitChanged(){this.events.emit("changed",void 0)}_add(t){if(!t)return;const e=t.objectId;if(null==e)return void h.L.getLogger("esri.layers.graphics.data.FeatureStore").error(new n.A("featurestore:invalid-feature","feature id is missing",{feature:t}));const s=this._featuresById.get(e);let i;if(s?(t.displayId=s.displayId,i=this._boundsStore.get(e),this._boundsStore.delete(e),this._usedMemory-=this.estimateFeatureUsedMemory?.(s)??0):null!=this.onFeatureAdd&&this.onFeatureAdd(t),!t.geometry?.coords?.length)return this._boundsStore.set(e,null),void this._featuresById.set(e,t);i=(0,l.g)(null!=i?i:(0,a.c)(),t.geometry,this.geometryInfo.hasZ,this.geometryInfo.hasM),null!=i&&this._boundsStore.set(e,i),this._featuresById.set(e,t),this._usedMemory+=this.estimateFeatureUsedMemory?.(t)??0}_upsert(t){const e=t?.objectId;if(null==e)return h.L.getLogger("esri.layers.graphics.data.FeatureStore").error(new n.A("featurestore:invalid-feature","feature id is missing",{feature:t})),null;const s=this._featuresById.get(e);if(!s)return this._add(t),t;this._usedMemory-=this.estimateFeatureUsedMemory?.(s)??0;const{geometry:i,attributes:r}=t;for(const t in r)s.attributes[t]=r[t];return i&&(s.geometry=i,this._boundsStore.set(e,(0,l.g)((0,a.c)(),i,this.geometryInfo.hasZ,this.geometryInfo.hasM)??null)),this._usedMemory+=this.estimateFeatureUsedMemory?.(s)??0,s}_remove(t){null!=this.onFeatureRemove&&this.onFeatureRemove(t);const e=t.objectId;return this._boundsStore.delete(e),this._featuresById.delete(e),this._usedMemory-=this.estimateFeatureUsedMemory?.(t)??0,t}}},17745:(t,e,s)=>{s.d(e,{A:()=>O});var i,n,r,h=s(32816),o=s(35819),a=s(81272),l=s(13671),c=s(32773),u=s(36555),d=s(45371),_=s(36544),f=s(91047),m=s(29298),g=s(24863),p=s(69421),y=s(44945),b=s(12119);s(85176),s(93181),s(50704),s(36172),s(41390),s(20266),s(90740),s(40499),s(58498),s(6407),s(61532),s(80959),s(19247),s(48064),(r=i||(i={}))[r.ADD=1]="ADD",r[r.REMOVE=2]="REMOVE",r[r.MOVE=4]="MOVE";class v{constructor(t,e,s,i,n){this.target=t,this.added=e,this.removed=s,this.start=i,this.deleteCount=n}}const x=new u.O(class{constructor(){this.target=null,this.cancellable=!1,this.defaultPrevented=!1,this.item=void 0,this.type=void 0}preventDefault(){this.cancellable&&(this.defaultPrevented=!0)}reset(t){this.defaultPrevented=!1,this.item=t}},void 0,(t=>{t.item=null,t.target=null,t.defaultPrevented=!1,t.cancellable=!1}));function M(t){t&&"object"==typeof t&&"destroy"in t&&"function"==typeof t.destroy&&t.destroy()}function E(t){return t?t instanceof R?t.toArray():t.length?Array.prototype.slice.apply(t):[]:[]}function B(t){if(t?.length)return t[0]}function A(t,e,s,i){const n=Math.min(t.length-s,e.length-i);let r=0;for(;r<n&&t[s+r]===e[i+r];)r++;return r}function z(t,e,s,i){e&&e.forEach(((e,n,r)=>{t.push(e),z(t,s.call(i,e,n,r),s,i)}))}const I=new Set,w=new Set,S=new Set,L=new Map;let C=0,R=class extends a.A.EventedAccessor{static{n=this}static{this.ofType=t=>{if(!t)return n;if(L.has(t))return L.get(t);let e=null;if("function"==typeof t)e=t.prototype.declaredClass;else if(t.base)e=t.base.prototype.declaredClass;else for(const s in t.typeMap){const i=t.typeMap[s].prototype.declaredClass;e?e+=` | ${i}`:e=i}let s=class extends n{};return(0,h._)([(0,g.s)({Type:t,ensureType:"function"==typeof t?(0,_.a)(t):(0,_.c)(t)})],s.prototype,"itemType",void 0),s=(0,h._)([(0,p.$)(`esri.core.Collection<${e}>`)],s),L.set(t,s),s}}static isCollection(t){return null!=t&&t instanceof n}constructor(t){super(t),this._chgListeners=[],this._notifications=null,this._updating=!1,this._timer=null,this._observable=new y.S,this.length=0,this._items=[],Object.defineProperty(this,"uid",{value:C++})}normalizeCtorArgs(t){return t?Array.isArray(t)||t instanceof n?{items:t}:t:{}}destroy(){this._removeAllRaw(),this._timer&&this._timer.remove(),this._emitter.destroy(),this._notifications=null}*[Symbol.iterator](){yield*this.items}get items(){return(0,f.t)(this._observable),this._items}set items(t){this._emitBeforeChanges(i.ADD)||(this._splice(0,this.length,E(t)),this._emitAfterChanges(i.ADD))}hasEventListener(t){return!this.destroyed&&("change"===t?this._chgListeners.length>0:this._emitter.hasEventListener(t))}on(t,e){if(this.destroyed)return(0,l.m)();if("change"===t){const t=this._chgListeners,s={removed:!1,callback:e};return t.push(s),this._notifications&&this._notifications.push({listeners:t.slice(),items:this._items.slice(),changes:[]}),(0,l.m)((()=>{s.removed=!0,t.splice(t.indexOf(s),1)}))}return this._emitter.on(t,e)}once(t,e){const s="deref"in e?()=>e.deref():()=>e,i=this.on(t,(t=>{s()?.call(null,t),i.remove()}));return i}add(t,e){if((0,f.t)(this._observable),this._emitBeforeChanges(i.ADD))return this;const s=this.getNextIndex(e??null);return this._splice(s,0,[t]),this._emitAfterChanges(i.ADD),this}addMany(t,e=this._items.length){if((0,f.t)(this._observable),!t?.length)return this;if(this._emitBeforeChanges(i.ADD))return this;const s=this.getNextIndex(e);return this._splice(s,0,E(t)),this._emitAfterChanges(i.ADD),this}at(t){if((0,f.t)(this._observable),(t=Math.trunc(t)||0)<0&&(t+=this.length),!(t<0||t>=this.length))return this._items[t]}removeAll(){if((0,f.t)(this._observable),!this.length||this._emitBeforeChanges(i.REMOVE))return[];const t=this._removeAllRaw();return this._emitAfterChanges(i.REMOVE),t}_removeAllRaw(){return 0===this.length?[]:this._splice(0,this.length)||[]}clone(){return(0,f.t)(this._observable),this._createNewInstance({items:this._items.map(c.o8)})}concat(...t){(0,f.t)(this._observable);const e=t.map(E);return this._createNewInstance({items:this._items.concat(...e)})}drain(t,e){if((0,f.t)(this._observable),!this.length||this._emitBeforeChanges(i.REMOVE))return;const s=this._splice(0,this.length),n=s.length;for(let i=0;i<n;i++)t.call(e,s[i],i,s);this._emitAfterChanges(i.REMOVE)}destroyAll(){this.drain(M)}destroyMany(t){const e=this.removeMany(t);return e.forEach(M),e}every(t,e){return(0,f.t)(this._observable),this._items.every(t,e)}filter(t,e){(0,f.t)(this._observable);const s=2===arguments.length?this._items.filter(t,e):this._items.filter(t);return this._createNewInstance({items:s})}find(t,e){return(0,f.t)(this._observable),this._items.find(t,e)}findIndex(t,e){return(0,f.t)(this._observable),this._items.findIndex(t,e)}flatten(t,e){(0,f.t)(this._observable);const s=[];return z(s,this,t,e),new n(s)}forEach(t,e){return(0,f.t)(this._observable),this._items.forEach(t,e)}getItemAt(t){return(0,f.t)(this._observable),this._items[t]}getNextIndex(t){(0,f.t)(this._observable);const e=this.length;return(t=t??e)<0?t=0:t>e&&(t=e),t}includes(t,e=0){return(0,f.t)(this._observable),this._items.includes(t,e)}indexOf(t,e=0){return(0,f.t)(this._observable),this._items.indexOf(t,e)}join(t=","){return(0,f.t)(this._observable),this._items.join(t)}lastIndexOf(t,e=this.length-1){return(0,f.t)(this._observable),this._items.lastIndexOf(t,e)}map(t,e){(0,f.t)(this._observable);const s=this._items.map(t,e);return new n({items:s})}reorder(t,e=this.length-1){(0,f.t)(this._observable);const s=this.indexOf(t);if(-1!==s){if(e<0?e=0:e>=this.length&&(e=this.length-1),s!==e){if(this._emitBeforeChanges(i.MOVE))return t;this._splice(s,1),this._splice(e,0,[t]),this._emitAfterChanges(i.MOVE)}return t}}pop(){if((0,f.t)(this._observable),!this.length||this._emitBeforeChanges(i.REMOVE))return;const t=B(this._splice(this.length-1,1));return this._emitAfterChanges(i.REMOVE),t}push(...t){return(0,f.t)(this._observable),this._emitBeforeChanges(i.ADD)||(this._splice(this.length,0,t),this._emitAfterChanges(i.ADD)),this.length}reduce(t,e){(0,f.t)(this._observable);const s=this._items;return 2===arguments.length?s.reduce(t,e):s.reduce(t)}reduceRight(t,e){(0,f.t)(this._observable);const s=this._items;return 2===arguments.length?s.reduceRight(t,e):s.reduceRight(t)}remove(t){return(0,f.t)(this._observable),this.removeAt(this.indexOf(t))}removeAt(t){if((0,f.t)(this._observable),t<0||t>=this.length||this._emitBeforeChanges(i.REMOVE))return;const e=B(this._splice(t,1));return this._emitAfterChanges(i.REMOVE),e}removeMany(t){if((0,f.t)(this._observable),!t?.length||this._emitBeforeChanges(i.REMOVE))return[];const e=t instanceof n?t.toArray():t,s=this._items,r=[],h=e.length;for(let t=0;t<h;t++){const i=e[t],n=s.indexOf(i);if(n>-1){const i=1+A(e,s,t+1,n+1),h=this._splice(n,i);h&&h.length>0&&r.push.apply(r,h),t+=i-1}}return this._emitAfterChanges(i.REMOVE),r}reverse(){if((0,f.t)(this._observable),this._emitBeforeChanges(i.MOVE))return this;const t=this._splice(0,this.length);return t&&(t.reverse(),this._splice(0,0,t)),this._emitAfterChanges(i.MOVE),this}shift(){if((0,f.t)(this._observable),!this.length||this._emitBeforeChanges(i.REMOVE))return;const t=B(this._splice(0,1));return this._emitAfterChanges(i.REMOVE),t}slice(t=0,e=this.length){return(0,f.t)(this._observable),this._createNewInstance({items:this._items.slice(t,e)})}some(t,e){return(0,f.t)(this._observable),this._items.some(t,e)}sort(t){if((0,f.t)(this._observable),!this.length||this._emitBeforeChanges(i.MOVE)||!this._requiresSort(t))return this;const e=this._splice(0,this.length);return arguments.length?e.sort(t):e.sort(),this._splice(0,0,e),this._emitAfterChanges(i.MOVE),this}_requiresSort(t=(t,e)=>t===e?0:t<e?-1:1){const e=this.length-1;for(let s=0;s<e;s++)if(t(this.items[s],this.items[s+1])>0)return!0;return!1}splice(t,e,...s){(0,f.t)(this._observable),1===arguments.length&&(e=this.length),e??=0;const n=(e?i.REMOVE:0)|(s.length?i.ADD:0);if(this._emitBeforeChanges(n))return[];const r=this._splice(t,e,s)||[];return this._emitAfterChanges(n),r}toArray(){return(0,f.t)(this._observable),this._items.slice()}toJSON(t){return(0,f.t)(this._observable),this.toArray().map((e=>(0,b.i)(e)?e.toJSON(t):e))}toLocaleString(){return(0,f.t)(this._observable),this._items.toLocaleString()}toString(){return(0,f.t)(this._observable),this._items.toString()}unshift(...t){return(0,f.t)(this._observable),!t.length||this._emitBeforeChanges(i.ADD)||(this._splice(0,0,t),this._emitAfterChanges(i.ADD)),this.length}_createNewInstance(t){return new this.constructor(t)}_splice(t,e,s){const i=this._items,n=this.itemType;let r,h;if(!this._notifications&&this.hasEventListener("change")&&(this._notifications=[{listeners:this._chgListeners.slice(),items:this._items.slice(),changes:[]}],this._timer&&this._timer.remove(),this._updating=!0,this._timer=(0,d._)((()=>this._dispatchChange()))),t<0&&(t+=this.length),e){if(h=i.splice(t,e),this.hasEventListener("before-remove")){const e=x.acquire();e.target=this,e.cancellable=!0;for(let s=0,n=h.length;s<n;s++)r=h[s],e.reset(r),this.emit("before-remove",e),e.defaultPrevented&&(h.splice(s,1),i.splice(t,0,r),t+=1,s-=1,n-=1);x.release(e)}if(this.length=this._items.length,this.hasEventListener("after-remove")){const t=x.acquire();t.target=this,t.cancellable=!1;const e=h.length;for(let s=0;s<e;s++)t.reset(h[s]),this.emit("after-remove",t);x.release(t)}}if(s?.length){if(n){const t=[];for(const e of s){const s=n.ensureType(e);null==s&&null!=e||t.push(s)}s=t}const e=this.hasEventListener("before-add"),r=this.hasEventListener("after-add"),h=t===this.length;if(e||r){const n=x.acquire();n.target=this,n.cancellable=!0;const o=x.acquire();o.target=this,o.cancellable=!1;for(const a of s)e?(n.reset(a),this.emit("before-add",n),n.defaultPrevented||(h?i.push(a):i.splice(t++,0,a),this._set("length",i.length),r&&(o.reset(a),this.emit("after-add",o)))):(h?i.push(a):i.splice(t++,0,a),this._set("length",i.length),o.reset(a),this.emit("after-add",o));x.release(o),x.release(n)}else{if(h)for(const t of s)i.push(t);else i.splice(t,0,...s);this._set("length",i.length)}}if((s?.length||h?.length)&&this._notifyChangeEvent(s,h),this.hasEventListener("after-splice")){const i=new v(this,s,h,t,e);this.emit("after-splice",i)}return h}_emitBeforeChanges(t){let e=!1;if(this.hasEventListener("before-changes")){const s=x.acquire();s.target=this,s.cancellable=!0,s.type=t,this.emit("before-changes",s),e=s.defaultPrevented,x.release(s)}return e}_emitAfterChanges(t){if(this.hasEventListener("after-changes")){const e=x.acquire();e.target=this,e.cancellable=!1,e.type=t,this.emit("after-changes",e),x.release(e)}this._observable.notify()}_notifyChangeEvent(t,e){this.hasEventListener("change")&&this._notifications&&this._notifications[this._notifications.length-1].changes.push({added:t,removed:e})}get updating(){return this._updating}_dispatchChange(){if(this._timer&&(this._timer.remove(),this._timer=null),this._updating=!1,!this._notifications)return;const t=this._notifications;this._notifications=null;for(const e of t){const t=e.changes;I.clear(),w.clear(),S.clear();for(const{added:e,removed:s}of t){if(e)if(0===S.size&&0===w.size)for(const t of e)I.add(t);else for(const t of e)w.has(t)?(S.add(t),w.delete(t)):S.has(t)||I.add(t);if(s)if(0===S.size&&0===I.size)for(const t of s)w.add(t);else for(const t of s)I.has(t)?I.delete(t):(S.delete(t),w.add(t))}const s=o.A.acquire();I.forEach((t=>{s.push(t)}));const i=o.A.acquire();w.forEach((t=>{i.push(t)}));const n=this._items,r=e.items,h=o.A.acquire();if(S.forEach((t=>{r.indexOf(t)!==n.indexOf(t)&&h.push(t)})),e.listeners&&(s.length||i.length||h.length)){const t={target:this,added:s,removed:i,moved:h},n=e.listeners.length;for(let s=0;s<n;s++){const i=e.listeners[s];i.removed||i.callback.call(this,t)}}o.A.release(s),o.A.release(i),o.A.release(h)}I.clear(),w.clear(),S.clear()}};(0,h._)([(0,m.MZ)()],R.prototype,"_updating",void 0),(0,h._)([(0,m.MZ)()],R.prototype,"length",void 0),(0,h._)([(0,m.MZ)()],R.prototype,"items",null),(0,h._)([(0,m.MZ)({readOnly:!0})],R.prototype,"updating",null),R=n=(0,h._)([(0,p.$)("esri.core.Collection")],R);const O=R},22151:(t,e,s)=>{var i,n;s.d(e,{M:()=>r}),(n=i||(i={}))[n.ALL=0]="ALL",n[n.SOME=1]="SOME",Symbol.iterator;class r{get size(){return this._size}constructor(t=10485760){this._maxSize=t,this._db=new Map,this._size=0,this._hit=0,this._miss=0,this._users=new Map,this._sizeLimits=new Map}destroy(){this.clearAll(),this._sizeLimits.clear(),this._users.clear()}register(t){this._users.set(t.id.slice(0,-1),t)}deregister(t){this.clear(t),this._sizeLimits.delete(t),this._users.delete(t.id.slice(0,-1))}get maxSize(){return this._maxSize}set maxSize(t){this._maxSize=Math.max(t,-1),this._checkSize()}getSize(t,e){const s=this._db.get(t.id+e);return s?.size??0}put(t,e,s,n,r){e=t.id+e;const o=this._db.get(e);if(o&&(this._size-=o.size,t.size-=o.size,this._db.delete(e),o.entry!==s&&this._notifyRemove(e,o.entry,o.size,i.ALL)),n>this._maxSize)return void this._notifyRemove(e,s,n,i.ALL);if(void 0===s)return void console.warn("Refusing to cache undefined entry ");if(!n||n<0)return console.warn(`Refusing to cache entry with size ${n} for key ${e}`),void this._notifyRemove(e,s,0,i.ALL);const a=1+Math.max(r,-4)- -3;this._db.set(e,new h(s,n,a)),this._size+=n,t.size+=n,this._checkSize()}updateSize(t,e,s,n){e=t.id+e;const r=this._db.get(e);if(r&&r.entry===s){for(this._size-=r.size,t.size-=r.size;n>this._maxSize;){const t=this._notifyRemove(e,s,n,i.SOME);if(!(null!=t&&t>0))return void this._db.delete(e);n=t}r.size=n,this._size+=n,t.size+=n,this._checkSize()}}pop(t,e){e=t.id+e;const s=this._db.get(e);if(s)return this._size-=s.size,t.size-=s.size,this._db.delete(e),++this._hit,s.entry;++this._miss}get(t,e){e=t.id+e;const s=this._db.get(e);if(void 0!==s)return this._db.delete(e),s.lives=s.lifetime,this._db.set(e,s),++this._hit,s.entry;++this._miss}peek(t,e){const s=this._db.get(t.id+e);return s?++this._hit:++this._miss,s?.entry}get performanceInfo(){const t={Size:Math.round(this._size/1048576)+"/"+Math.round(this._maxSize/1048576)+"MB","Hit rate":Math.round(100*this._getHitRate())+"%",Entries:this._db.size.toString()},e={},s=new Array;this._db.forEach(((t,i)=>{const n=t.lifetime;s[n]=(s[n]||0)+t.size,this._users.forEach((s=>{const{id:n,name:r}=s;if(i.startsWith(n)){const s=e[r]||0;e[r]=s+t.size}}))}));const i={};this._users.forEach((t=>{const s=t.name;if("hitRate"in t&&"number"==typeof t.hitRate&&!isNaN(t.hitRate)&&t.hitRate>0){const n=e[s]||0;e[s]=n,i[s]=Math.round(100*t.hitRate)+"%"}else i[s]="0%"}));const n=Object.keys(e);n.sort(((t,s)=>e[s]-e[t])),n.forEach((s=>t[s]=Math.round(e[s]/2**20)+"MB / "+i[s]));for(let e=s.length-1;e>=0;--e){const i=s[e];i&&(t["Priority "+(e+-3-1)]=Math.round(i/this._size*100)+"%")}return t}resetStats(){this._hit=this._miss=0,this._users.forEach((t=>t.resetHitRate()))}clear(t){const e=t.id;this._db.forEach(((t,s)=>{s.startsWith(e)&&(this._size-=t.size,this._db.delete(s),this._notifyRemove(s,t.entry,t.size,i.ALL))})),t.size=0}clearAll(){this._db.forEach(((t,e)=>this._notifyRemove(e,t.entry,t.size,i.ALL))),this._users.forEach((t=>t.size=0)),this._size=0,this._db.clear()}*values(t){for(const[e,s]of this._db)e.startsWith(t.id)&&(yield s.entry)}_getHitRate(){return this._hit/(this._hit+this._miss)}_notifyRemove(t,e,s,i){const n=this._users.get(t.split(o)[0])?.removeFunc,r=n?.(e,i,s);return"number"==typeof r?r:null}_checkSize(){this._sizeLimits.forEach(((t,e)=>this._checkSizeLimits(t,e))),this._checkSizeLimits(this.maxSize)}setMaxSize(t,e){null==e||e<=0?this._sizeLimits.delete(t):this._sizeLimits.set(t,e)}_checkSizeLimits(t,e){const s=e??this;if(s.size<=t)return;const i=e?.id;let n=!0;for(;n;){n=!1;for(const[r,h]of this._db)if(0===h.lifetime&&(!i||r.startsWith(i))){const i=e??this._users.get(r.split(o)[0]);if(this._purgeItem(r,h,i),s.size<=.9*t)return;n||=this._db.has(r)}}for(const[n,r]of this._db)if(!i||n.startsWith(i)){const i=e??this._users.get(n.split(o)[0]);if(this._purgeItem(n,r,i),s.size<=.9*t)return}}_purgeItem(t,e,s){if(this._db.delete(t),e.lives<=1){this._size-=e.size,s&&(s.size-=e.size);const n=this._notifyRemove(t,e.entry,e.size,i.SOME);null!=n&&n>0&&(this._size+=n,s&&(s.size+=n),e.lives=e.lifetime,e.size=n,this._db.set(t,e))}else--e.lives,this._db.set(t,e)}}class h{constructor(t,e,s){this.entry=t,this.size=e,this.lifetime=s,this.lives=s}}const o=":"},23787:(t,e,s)=>{s.d(e,{L:()=>n});var i=s(22151);class n{constructor(t,e){this.removeFunc=e,this._storage=new i.M,this.id="",this.name="",this.size=0,this._storage.maxSize=t,this._storage.register(this)}destroy(){this._storage.deregister(this),this._storage.destroy()}put(t,e,s=1){this._storage.put(this,t,e,s,1)}pop(t){return this._storage.pop(this,t)}get(t){return this._storage.get(this,t)}clear(){this._storage.clearAll()}get maxSize(){return this._storage.maxSize}set maxSize(t){this._storage.maxSize=t}resetHitRate(){}}},24863:(t,e,s)=>{function i(t){return(e,s)=>{e[s]=t}}s.d(e,{s:()=>i})},42614:(t,e,s)=>{s.d(e,{B:()=>o});var i=s(32773),n=s(11721),r=s(48402);const h={minX:0,minY:0,maxX:0,maxY:0};class o{constructor(){this._indexInvalid=!1,this._boundsToLoad=[],this._boundsById=new Map,this._idByBounds=new Map,this._index=new n.P(9,(0,i.h)("esri-csp-restrictions")?t=>({minX:t[0],minY:t[1],maxX:t[2],maxY:t[3]}):["[0]","[1]","[2]","[3]"]),this._loadIndex=()=>{if(this._indexInvalid){const t=new Array(this._idByBounds.size);let e=0;this._idByBounds.forEach(((s,i)=>{t[e++]=i})),this._indexInvalid=!1,this._index.clear(),this._index.load(t)}else this._boundsToLoad.length&&(this._index.load(Array.from(new Set(this._boundsToLoad.filter((t=>this._idByBounds.has(t)))))),this._boundsToLoad.length=0)}}get fullBounds(){if(!this._boundsById.size)return null;const t=(0,r.e)();for(const e of this._boundsById.values())e&&(t[0]=Math.min(e[0],t[0]),t[1]=Math.min(e[1],t[1]),t[2]=Math.max(e[2],t[2]),t[3]=Math.max(e[3],t[3]));return t}get valid(){return!this._indexInvalid}clear(){this._indexInvalid=!1,this._boundsToLoad.length=0,this._boundsById.clear(),this._idByBounds.clear(),this._index.clear()}delete(t){const e=this._boundsById.get(t);this._boundsById.delete(t),e&&(this._idByBounds.delete(e),this._indexInvalid||this._index.remove(e))}forEachInBounds(t,e){this._loadIndex(),function(t,e,s){!function(t){h.minX=t[0],h.minY=t[1],h.maxX=t[2],h.maxY=t[3]}(e),t.search(h,s)}(this._index,t,(t=>e(this._idByBounds.get(t))))}get(t){return this._boundsById.get(t)}has(t){return this._boundsById.has(t)}invalidateIndex(){this._indexInvalid||(this._indexInvalid=!0,this._boundsToLoad.length=0)}set(t,e){if(!this._indexInvalid){const e=this._boundsById.get(t);e&&(this._index.remove(e),this._idByBounds.delete(e))}this._boundsById.set(t,e),e&&(this._idByBounds.set(e,t),this._indexInvalid||(this._boundsToLoad.push(e),this._boundsToLoad.length>5e4&&this._loadIndex()))}}},52731:(t,e,s)=>{s.d(e,{A:()=>c});var i=s(32816),n=s(41390),r=s(32773),h=(s(20266),s(57732)),o=s(93181),a=s(69421);s(85176),s(50704),s(40499),s(36555),s(58498),s(13671),s(91047),s(29298),s(36544),s(6407),s(90740),s(35819),s(45371),s(61532),s(80959),s(19247),s(36172),s(48064);const l=t=>{let e=class extends t{clone(){const t=(0,o.g)(this);(0,h.b)(t,"unable to clone instance of non-accessor class");const e=t.metadata,s=t.store,i={},a=new Map;for(const t in e){const h=e[t],o=s?.originOf(t),l=h.clonable;if(h.readOnly||!1===l||o!==n.O.USER&&o!==n.O.DEFAULTS&&o!==n.O.WEB_MAP&&o!==n.O.WEB_SCENE)continue;const c=this[t];let u=null;u="function"==typeof l?l(c):"reference"===l?c:(0,r.TU)(c),null!=c&&null==u||(o===n.O.DEFAULTS?a.set(t,u):i[t]=u)}const l=new(0,Object.getPrototypeOf(this).constructor)(i);if(a.size){const t=(0,o.g)(l)?.store;if(t)for(const[e,s]of a)t.set(e,s,n.O.DEFAULTS)}return l}};return e=(0,i._)([(0,a.$)("esri.core.Clonable")],e),e};let c=class extends(l(n.A)){};c=(0,i._)([(0,a.$)("esri.core.Clonable")],c),(c||(c={})).ClonableMixin=l},67321:(t,e,s)=>{s.d(e,{C_:()=>d,OH:()=>m,Vh:()=>g,on:()=>u,pc:()=>p,wB:()=>a,z7:()=>l});var i=s(19247),n=s(13671),r=s(57732),h=s(80959),o=s(35819);function a(t,e,s={}){return c(t,e,s,_)}function l(t,e,s={}){return c(t,e,s,f)}function c(t,e,s={},i){let n=null;const h=s.once?(t,s)=>{i(t)&&((0,r.r)(n),e(t,s))}:(t,s)=>{i(t)&&e(t,s)};if(n=(0,o.w)(t,h,s.sync,s.equals),s.initial){const e=t();h(e,e)}return n}function u(t,e,s,h={}){let o=null,l=null,c=null;function u(){o&&l&&(l.remove(),h.onListenerRemove?.(o),o=null,l=null)}function d(t){h.once&&h.once&&(0,r.r)(c),s(t)}const _=a(t,((t,s)=>{u(),(0,i.i)(t)&&(o=t,l=(0,i.a)(t,e,d),h.onListenerAdd?.(t))}),{sync:h.sync,initial:!0});return c=(0,n.m)((()=>{_.remove(),u()})),c}function d(t,e){return function(t,e,s){if((0,h.G4)(s))return Promise.reject((0,h.NK)());const i=t();if(e?.(i))return Promise.resolve(i);let o=null;function a(){o=(0,r.r)(o)}return new Promise(((i,r)=>{o=(0,n.h)([(0,h.u7)(s,(()=>{a(),r((0,h.NK)())})),c(t,(t=>{a(),i(t)}),{sync:!1,once:!0},e??_)])}))}(t,f,e)}function _(t){return!0}function f(t){return!!t}s(6407),s(32773),s(20266),s(90740),s(36555),s(45371),s(61532),s(85176),s(93181),s(50704),s(91047),s(36172);const m={sync:!0},g={initial:!0},p={sync:!0,initial:!0}},81272:(t,e,s)=>{s.d(e,{A:()=>a});var i=s(32816),n=s(41390),r=s(13671),h=s(69421);s(32773),s(20266),s(90740),s(85176),s(93181),s(50704),s(40499),s(36555),s(58498),s(91047),s(29298),s(36544),s(6407),s(35819),s(45371),s(61532),s(80959),s(19247),s(36172),s(48064);class o{constructor(){this._emitter=new o.EventEmitter(this)}emit(t,e){return this._emitter.emit(t,e)}on(t,e){return this._emitter.on(t,e)}once(t,e){return this._emitter.once(t,e)}hasEventListener(t){return this._emitter.hasEventListener(t)}}!function(t){class e{constructor(t=null){this._target=t,this._listenersMap=null}clear(){this._listenersMap?.clear(),this._listenersMap=null}destroy(){this.clear()}emit(t,e){let s=this._listenersMap?.get(t);if(!s)return!1;const i=this._target||this;let n=!1;for(const t of s.slice()){const s="deref"in t?t.deref():t;s?s?.call(i,e):n=!0}return n&&(s=s.filter((t=>!("deref"in t)||null!=t.deref())),this._listenersMap.set(t,s)),s.length>0}on(t,e){if(Array.isArray(t)){const s=t.map((t=>this.on(t,e)));return(0,r.h)(s)}if(t.includes(","))throw new TypeError("Evented.on() with a comma delimited string of event types is not supported");this._listenersMap??=new Map;const s=this._listenersMap.get(t)||[];return s.push(e),this._listenersMap.set(t,s),(0,r.m)((()=>{const s=this._listenersMap?.get(t),i=s?.indexOf(e)??-1;i>=0&&s.splice(i,1)}))}once(t,e){const s=this.on(t,(t=>{s.remove();const i="deref"in e?e.deref():e;i?.call(null,t)}));return s}hasEventListener(t){const e=this._listenersMap?.get(t);return null!=e&&e.length>0}}t.EventEmitter=e,t.EventedMixin=t=>{let s=class extends t{constructor(){super(...arguments),this._emitter=new e}destroy(){this._emitter.clear()}emit(t,e){return this._emitter.emit(t,e)}on(t,e){return this._emitter.on(t,e)}once(t,e){return this._emitter.once(t,e)}hasEventListener(t){return this._emitter.hasEventListener(t)}};return s=(0,i._)([(0,h.$)("esri.core.Evented")],s),s};let s=class extends n.A{constructor(){super(...arguments),this._emitter=new o.EventEmitter(this)}destroy(){this._emitter.clear()}emit(t,e){return this._emitter.emit(t,e)}on(t,e){return this._emitter.on(t,e)}once(t,e){return this._emitter.once(t,e)}hasEventListener(t){return this._emitter.hasEventListener(t)}};s=(0,i._)([(0,h.$)("esri.core.Evented.EventedAccessor")],s),t.EventedAccessor=s}(o||(o={}));const a=o},87985:(t,e,s)=>{s.d(e,{a:()=>r,c:()=>o,p:()=>n,t:()=>h});const i=/^-?(\d+(\.\d+)?)\s*((px)|(pt))?$/i;function n(t){return t?t/72*96:0}function r(t){return t?72*t/96:0}function h(t){if("string"==typeof t){const e=t.match(i);if(e){const s=Number(e[1]),i=e[3]&&e[3].toLowerCase(),n="-"===t.charAt(0),h="px"===i?r(s):s;return n?-h:h}return console.warn("screenUtils.toPt: input not recognized!"),null}return t}function o(t=0,e=0){return{x:t,y:e}}}}]);