"use strict";(self.webpackChunkRemoteClient=self.webpackChunkRemoteClient||[]).push([[6533],{13317:(e,t,n)=>{n.d(t,{c:()=>l,f:()=>u});var r=n(59192);const i={ar:"ar-u-nu-latn",bs:"sr-Latn-CS",nn:"no-NN"};let a=new WeakMap,o={};function l(e={}){const t={};return null!=e.digitSeparator&&(t.useGrouping=e.digitSeparator),null!=e.places&&(t.minimumFractionDigits=t.maximumFractionDigits=e.places),t}function u(e,t){return Object.is(e,-0)&&(e=0),function(e){const t=e||o;if(!a.has(t)){const n=(0,r.g)(),o=(0,r.a)(n)?.language,l=o&&i[o]||n;a.set(t,new Intl.NumberFormat(l,e))}return a.get(t)}(t).format(e)}(0,r.b)((()=>{a=new WeakMap,o={}})),new Map},96533:(e,t,n)=>{n.r(t),n.d(t,{applyTextFormattingHTML:()=>J,createFieldInfoMap:()=>H,findRelatedLayer:()=>ie,findUtilityNetwork:()=>ae,fixTokens:()=>R,formatAttributes:()=>K,formatEditInfo:()=>Q,formatValueToFieldInfo:()=>O,getAllFieldInfos:()=>P,getFieldInfo:()=>G,getFieldInfoLabel:()=>k,getFixedFieldName:()=>x,getFixedFieldNames:()=>A,getSourceLayer:()=>T,graphicCallback:()=>L,htmlEntities:()=>_,isAssociatedFeatureSupportedLayer:()=>D,isExpressionField:()=>C,isFeatureSupportedLayer:()=>j,isGraphicForRelatableFeatureSupportedLayer:()=>$,isRelatableFeatureSupportedLayer:()=>S,isRelatableLayer:()=>U,isRelatedField:()=>X,preLayerQueryCallback:()=>ne,preRequestCallback:()=>re,querySourceLayer:()=>V,queryUpdatedFeature:()=>B,shouldOpenInNewTab:()=>N,substituteAttributes:()=>E,substituteFieldsInLinksAndAttributes:()=>v});var r=n(32773),i=n(20266),a=n(50214),o=n(13317),l=n(30011),u=n(23916),s=n(31572),f=n(78016);n(90740),n(93804),n(59192),n(13671),n(16345),n(54483),n(6407),n(29512),n(99063),n(64604),n(80959),n(19247),n(1178),n(17745),n(32816),n(35819),n(36555),n(45371),n(61532),n(85176),n(93181),n(50704),n(91047),n(36172),n(81272),n(41390),n(69421),n(40499),n(36544),n(48064),n(58498),n(29298),n(44945),n(93074),n(67321),n(71044),n(47215),n(24330),n(47812),n(18527),n(83463),n(18683),n(346);const c=()=>i.L.getLogger("esri.widgets.Feature.support.featureUtils"),d=/href=(""|'')/gi,p=/(\{([^{\r\n]+)\})/g,y=/'/g,m=/^\s*expression\//i,b=/(\n)/gi,g=/[\u00A0-\u9999<>&]/gim,I=/href\s*=\s*(?:"([^"]+)"|'([^']+)')/gi,h=/^(?:mailto:|tel:)/,F="relationships/",w=(0,a.c)("short-date-short-time");function T(e){if(null!=e)return(e.sourceLayer||e.layer)??void 0}async function L({type:e,value:t,event:n}){try{return"function"==typeof t?t(n):await t}catch(r){return void c().error("error",`An error occurred when calling the "${e}" function`,{error:r,graphic:n.graphic,value:t})}}function N(e=""){if(e)return!h.test(e.trim().toLowerCase())}function C(e){return!!e&&m.test(e)}function k(e,t){const n=function(e,t){if(!t||!C(t)||!e)return;const n=t.replace(m,"").toLowerCase();return e.find((({name:e})=>e.toLowerCase()===n))}(t,e?.fieldName);return n?n.title||null:e?e.label||e.fieldName:null}function x(e,t){const n=Z(t,e);return n?n.name:e}function A(e,t){return e&&e.map((e=>x(e,t)))}function Z(e,t){return e&&"function"==typeof e.getField&&t?e.getField(t)??null:null}function q(e){return`${e}`.trim()}function v({attributes:e,globalAttributes:t,layer:n,text:r,expressionAttributes:i,fieldInfoMap:a}){return r?E({formattedAttributes:t,template:M(r,{...t,...i,...e},n),fieldInfoMap:a}):""}function E({formattedAttributes:e,template:t,fieldInfoMap:n}){return q((r=(0,i.r)((0,i.r)(t,(e=>function(e,t){const n=t.get(e.toLowerCase());return`{${n?.fieldName||e}}`}(e,n))),e),r.replaceAll(d,"")));var r}function R(e,t){return e.replaceAll(p,((e,n,r)=>{const i=Z(t,r);return i?`{${i.name}}`:n}))}function M(e,t,n){const r=R(e,n);return r?r.replaceAll(I,((e,n,r)=>function(e,t,n){const r=(t=q(t))&&"{"!==t[0];return(0,i.r)(e,function(e,t=!1){const n={...e};return Object.keys(n).forEach((e=>function(e,t,n=!1){const r=t[e];if("string"==typeof r){const i="%27",a=(n?encodeURIComponent(r):r).replaceAll(y,i);t[e]=a}}(e,n,t))),n}(n,r||!1))}(e,n||r,t))):r}function j(e){return null!=e&&"object"==typeof e&&"fieldsIndex"in e&&"geometryType"in e&&"getField"in e&&"load"in e&&"loaded"in e&&"objectIdField"in e&&"spatialReference"in e&&"type"in e&&("feature"===e.type||"scene"===e.type||"subtype-group"===e.type||"subtype-sublayer"===e.type||"sublayer"===e.type)&&"when"in e}function U(e){return null!=e&&"object"==typeof e&&"createQuery"in e&&"queryFeatureCount"in e&&"queryObjectIds"in e&&"queryRelatedFeatures"in e&&"queryRelatedFeaturesCount"in e&&"relationships"in e}function S(e){return j(e)&&U(e)}function D(e){return!(!(e&&"object"==typeof e&&"createQuery"in e&&"getField"in e&&"queryFeatureCount"in e&&"queryFeatures"in e&&"queryObjectIds"in e&&"capabilities"in e&&"fields"in e&&"fieldsIndex"in e&&"type"in e)||"feature"!==e.type&&"subtype-group"!==e.type&&"subtype-sublayer"!==e.type&&"sublayer"!==e.type||!("when"in e))&&("subtype-sublayer"===e.type&&"parent"in e&&e.parent&&"object"==typeof e.parent?"globalIdField"in e.parent:"globalIdField"in e)}function $(e){return!!e&&"object"==typeof e&&"sourceLayer"in e&&S(e.sourceLayer)}function O(e,t){const{fieldInfos:n,fieldName:r,preventPlacesFormatting:i,layer:a,timeZone:u}=t,f=G(n,r),c=Z(a,r);if(f&&!(0,l.JL)(r)){const t=c?.type,n=f.format?.dateFormat;if("date"===t||"date-only"===t||"time-only"===t||"timestamp-offset"===t||n)return(0,s.f)(e,{format:n,fieldType:t,timeZoneOptions:{layerTimeZone:a&&"preferredTimeZone"in a?a.preferredTimeZone:null,viewTimeZone:u,datesInUnknownTimezone:!(!a||!("datesInUnknownTimezone"in a)||!a.datesInUnknownTimezone)}})}const d=f?.format;return"string"==typeof e&&(0,l.JL)(r)&&d?function(e,t){return e=e.trim(),/\d{2}-\d{2}/.test(e)?e:e.includes(",")?z(e,",",", ",t):e.includes(";")?z(e,";","; ",t):e.includes(" ")?z(e," "," ",t):(0,o.f)(Number(e),(0,o.c)(t))}(e,d):(e=function(e,t){if("string"==typeof e&&t&&null==t.dateFormat&&(null!=t.places||null!=t.digitSeparator)){const t=Number(e);if(!isNaN(t))return t}return e}(e,d),"string"==typeof e||null==e||null==d?J(e):(0,o.f)(e,i?{...(0,o.c)(d),minimumFractionDigits:0,maximumFractionDigits:20}:(0,o.c)(d)))}function z(e,t,n,r){return e.trim().split(t).map((e=>(0,o.f)(Number(e),(0,o.c)(r)))).join(n)}function G(e,t){if(e?.length&&t)return e.find((e=>e.fieldName?.toLowerCase()===t.toLowerCase()))}function Q(e,t,n,r){const{creatorField:i,creationDateField:o,editorField:l,editDateField:u}=e;if(!t)return;const s=(0,f.g)(r&&"preferredTimeZone"in r?r.preferredTimeZone:null,!(!r||!("datesInUnknownTimezone"in r)||!r.datesInUnknownTimezone),n,w,"date"),c={...w,...s},d=t[u];if("number"==typeof d){const e=t[l];return{type:"edit",date:(0,a.f)(d,c),user:e}}const p=t[o];if("number"==typeof p){const e=t[i];return{type:"create",date:(0,a.f)(p,c),user:e}}return null}function H(e,t){const n=new Map;if(!e)return n;for(const r of e){if(!r.fieldName)continue;const e=x(r.fieldName,t);r.fieldName=e,n.set(e.toLowerCase(),r)}return n}function P(e){const t=[];if(!e)return t;const{fieldInfos:n,content:r}=e;return n&&t.push(...n),r&&Array.isArray(r)?(r.forEach((e=>{if("fields"===e.type){const n=e?.fieldInfos;n&&t.push(...n)}})),t):t}function _(e){return e.replaceAll(g,(e=>`&#${e.charCodeAt(0)};`))}function J(e){return"string"==typeof e?e.replaceAll(b,'<br class="esri-text-new-line" />'):e}function W(e){const{value:t,fieldName:n,fieldInfos:i,fieldInfoMap:a,layer:o,graphic:u,timeZone:f}=e;if(null==t)return"";const c=function({fieldName:e,value:t,graphic:n,layer:i}){if(X(e))return null;if(!i||"function"!=typeof i.getFieldDomain)return null;const a=n&&i.getFieldDomain(e,{feature:n,excludeImpliedDomains:(0,r.h)("esri-widget-legacy-field-domain-calculation")});return a&&"coded-value"===a.type?a.getName(t):null}({fieldName:n,value:t,graphic:u,layer:o});if(c)return c;const d=function({fieldName:e,graphic:t,layer:n}){if(X(e))return null;if(!n||"function"!=typeof n.getFeatureType)return null;const{typeIdField:r}=n;if(!r||e!==r)return null;const i=n.getFeatureType(t);return i?i.name:null}({fieldName:n,graphic:u,layer:o});if(d)return d;if(a.get(n.toLowerCase()))return O(t,{fieldInfos:i||Array.from(a.values()),fieldName:n,layer:o,timeZone:f});const p=o?.fieldsIndex?.get(n);return p&&((0,s.i)(p)||(0,l.OH)(p))?(0,s.f)(t,{fieldType:p.type,timeZoneOptions:{layerTimeZone:o&&"preferredTimeZone"in o?o.preferredTimeZone:null,viewTimeZone:f,datesInUnknownTimezone:!(!o||!("datesInUnknownTimezone"in o)||!o.datesInUnknownTimezone)}}):J(t)}function K({fieldInfos:e,attributes:t,layer:n,graphic:r,fieldInfoMap:i,relatedInfos:a,timeZone:o}){const l={};return a?.forEach((t=>function({attributes:e,relatedInfo:t,fieldInfoMap:n,fieldInfos:r,layer:i,timeZone:a}){e&&t&&(t.relatedFeatures?.forEach((o=>Y({attributes:e,graphic:o,relatedInfo:t,fieldInfoMap:n,fieldInfos:r,layer:i,timeZone:a}))),t.relatedStatsFeatures?.forEach((o=>Y({attributes:e,graphic:o,relatedInfo:t,fieldInfoMap:n,fieldInfos:r,layer:i,timeZone:a}))))}({attributes:l,relatedInfo:t,fieldInfoMap:i,fieldInfos:e,layer:n,timeZone:o}))),t&&Object.keys(t).forEach((a=>{const u=t[a];l[a]=W({fieldName:a,fieldInfos:e,fieldInfoMap:i,layer:n,value:u,graphic:r,timeZone:o})})),l}async function V(e,t){const{layer:n,graphic:r,outFields:i,objectIds:a,returnGeometry:o,spatialReference:l}=e,s=a[0];if("number"!=typeof s&&"string"!=typeof s){const e="Could not query required fields for the specified feature. The feature's ID is invalid.",t={layer:n,graphic:r,objectId:s,requiredFields:i};return c().warn(e,t),null}if(!(0,u.j)(n)?.operations?.supportsQuery){const e="The specified layer cannot be queried. The following fields will not be available.",t={layer:n,graphic:r,requiredFields:i,returnGeometry:o};return c().warn(e,t),null}const f=n.createQuery();return f.objectIds=a,f.outFields=i?.length?i:[n.objectIdField],f.returnGeometry=!!o,f.returnZ=!!o,f.returnM=!!o,f.outSpatialReference=l,(await n.queryFeatures(f,t)).features[0]}async function B({graphic:e,popupTemplate:t,layer:n,spatialReference:r},i){if(!n||!t)return;if("function"==typeof n.load&&await n.load(i),!e.attributes)return;const a=n.objectIdField,o=e.attributes[a];if(null==o)return;const u=[o],s=await t.getRequiredFields(n.fieldsIndex),f=(0,l.Kl)(e,s),c=f?[]:s.includes(a)?s:[...s,a],d=t.returnGeometry||await async function(e){if(!e.expressionInfos?.length)return!1;const t=await(0,l.l)(),{arcadeUtils:{hasGeometryFunctions:n}}=t;return n(e)}(t);if(f&&!d)return;const p=await V({layer:n,graphic:e,outFields:c,objectIds:u,returnGeometry:d,spatialReference:r},i);p&&(p.geometry&&(e.geometry=p.geometry),p.attributes&&(e.attributes={...e.attributes,...p.attributes}))}function X(e=""){return!!e&&e.includes(F)}function Y({attributes:e,graphic:t,relatedInfo:n,fieldInfos:r,fieldInfoMap:i,layer:a,timeZone:o}){e&&t&&n&&Object.keys(t.attributes).forEach((l=>{const u=(s={layerId:n.relation.id.toString(),fieldName:l})?`${F}${s.layerId}/${s.fieldName}`:"";var s;const f=t.attributes[l];e[u]=W({fieldName:u,fieldInfos:r,fieldInfoMap:i,layer:a,value:f,graphic:t,timeZone:o})}))}const ee=e=>{if(!e)return!1;const t=e.toUpperCase();return t.includes("CURRENT_TIMESTAMP")||t.includes("CURRENT_DATE")||t.includes("CURRENT_TIME")},te=({layer:e,method:t,query:n,definitionExpression:r})=>{if(!e.capabilities?.query?.supportsCacheHint||"attachments"===t)return;const i=null!=n.where?n.where:null,a=null!=n.geometry?n.geometry:null;ee(r)||ee(i)||"extent"===a?.type||"tile"===n.resultType||(n.cacheHint=!0)},ne=({query:e,layer:t,method:n})=>{te({layer:t,method:n,query:e,definitionExpression:`${t.definitionExpression} ${t.serviceDefinitionExpression??""}`})},re=({queryPayload:e,layer:t,method:n})=>{te({layer:t,method:n,query:e,definitionExpression:`${t.definitionExpression} ${t.serviceDefinitionExpression??""}`})};function ie(e,t,n){return e&&t&&n?"sublayer"===t.type?le({layers:t.layer?.allSublayers,map:e,relatedLayer:t,relationship:n})||le({layers:t.layer?.subtables,map:e,relatedLayer:t,relationship:n}):le({layers:e.allLayers,map:e,relatedLayer:t,relationship:n})||le({layers:e.allTables,map:e,relatedLayer:t,relationship:n}):null}function ae(e,t){return e&&"utilityNetworks"in e&&t?e.utilityNetworks?.find((e=>e.isUtilityLayer(t))):null}function oe(e,t){return e?.allTables.find((e=>"feature"===e.type&&e.layerId===t.id&&e.url===t.layer?.url))}function le({map:e,relationship:t,relationship:{relatedTableId:n},relatedLayer:r,layers:i}){if(!i)return null;for(const a of i){if("map-image"===a.type){const n=le({layers:a.sublayers,map:e,relatedLayer:r,relationship:t})||le({layers:a.subtables,map:e,relatedLayer:r,relationship:t});if(n)return n;continue}if(!S(a))continue;if("sublayer"===r.type){if(a!==r&&a.id===n)return a.isTable?oe(e,a):a;continue}const i="scene"===r.type&&r.associatedLayer?r.associatedLayer.url:r.url;if(!i)return null;if("sublayer"!==a.type){if(a!==r&&a.url===i&&a.layerId===n)return a}else if(a!==r&&a.layer?.url===i&&a.id===n)return a.isTable?oe(e,a):a}return null}}}]);