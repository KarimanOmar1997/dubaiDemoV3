/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.33/esri/copyright.txt for details.
*/
import{L as s}from"./ILyr3DWasmPerSceneView.js";import{l as t}from"./Lyr3DModule.js";import"./assets.js";import"../config.js";import"../core/lang.js";import"../request.js";import"../kernel.js";import"../core/urlUtils.js";import"../core/Error.js";import"./Logger.js";import"./jsonUtils.js";import"./MapUtils.js";import"../core/promiseUtils.js";import"./handleUtils.js";import"./events.js";import"./maybe.js";import"./persistableUrlUtils.js";let r,e;async function i(t){await o();const r={status:s.Failed,error:"",jobDescJson:"",data:new Uint8Array(0),missingInputUrls:[]};if(t.inputs.length<1)return{result:r,transferList:[]};const i={ptrs:[],sizes:[]};for(const s of t.inputs){const t=e._malloc(s.byteLength);new Uint8Array(e.HEAPU8.buffer,t,s.byteLength).set(new Uint8Array(s)),i.ptrs.push(t),i.sizes.push(s.byteLength)}const n=e.process(t.jobDescJson,t.id,i,t.isMissingResourceCase);r.status=n.status,r.missingInputUrls=n.missingInputUrls.slice();const l=n.status===s.Succeeded&&n.data,a=r.status===s.MissingInputs&&r.missingInputUrls.length>0;r.jobDescJson=n.jobDescJson.slice(),r.error=n.error.slice(),l?r.data=n.data.slice():a&&(r.originalInputs=t.inputs.slice());for(let s=0;s<i.ptrs.length;++s)e._free(i.ptrs[s]);const p=[];if(l)p.push(r.data.buffer);else if(a)for(const s of t.inputs)p.push(s);return{result:r,transferList:p}}function n(){e&&(e.uninitialize_lyr3d_worker_wasm(),e=null)}function o(){return e?Promise.resolve():(r||(r=t().then((s=>{e=s,e.initialize_lyr3d_worker_wasm(),r=null}))),r)}export{n as destroyWasm,o as initialize,i as process};
