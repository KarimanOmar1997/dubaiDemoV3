/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.33/esri/copyright.txt for details.
*/
import t from"../core/Error.js";import{e}from"../core/lang.js";class r{constructor(t){this._bits=[...t]}equals(t){return e(this._bits,t.bits)}get code(){return this._code??=String.fromCharCode(...this._bits),this._code}get bits(){return this._bits}}const a=class{},i=new a;class s extends a{constructor(){super(),this._parameterBits=this._parameterBits?.map((()=>0))??[],this._parameterNames??=[]}get key(){return this._key??=new r(this._parameterBits),this._key}decode(t=this.key){const e=this._parameterBits;this._parameterBits=[...t.bits];const r=this._parameterNames.map((t=>`    ${t}: ${this[t]}`)).join("\n");return this._parameterBits=e,r}}function n(e={}){return(r,a)=>{r.hasOwnProperty("_parameterNames")||Object.defineProperty(r,"_parameterNames",{value:r._parameterNames?.slice()??[],configurable:!0,writable:!0}),r.hasOwnProperty("_parameterBits")||Object.defineProperty(r,"_parameterBits",{value:r._parameterBits?.slice()??[0],configurable:!0,writable:!0}),r._parameterNames.push(a);const i=e.count||2,s=Math.ceil(Math.log2(i)),n=r._parameterBits;let o=0;for(;n[o]+s>16;)o++,o>=n.length&&n.push(0);const p=n[o],h=(1<<s)-1<<p;n[o]+=s,e.count?Object.defineProperty(r,a,{get(){return(this._parameterBits[o]&h)>>p},set(r){if(this[a]!==r){if(this._key=null,this._parameterBits[o]=this._parameterBits[o]&~h|+r<<p&h,"number"!=typeof r)throw new t("internal:invalid-shader-configuration",`Configuration value for ${a} must be a number, got ${typeof r}`);if(null==e.count)throw new t("internal:invalid-shader-configuration",`Configuration value for ${a} must provide a count option`)}}}):Object.defineProperty(r,a,{get(){return!!((this._parameterBits[o]&h)>>p)},set(e){if(this[a]!==e&&(this._key=null,this._parameterBits[o]=this._parameterBits[o]&~h|+e<<p&h,"boolean"!=typeof e))throw new t("internal:invalid-shader-configuration",`Configuration value for ${a} must be boolean, got ${typeof e}`)}})}}export{a as N,s as S,i as n,n as p};
