/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.33/esri/copyright.txt for details.
*/
import{c as n}from"./mathUtils.js";import{d as t,i as r,j as o,f as s,k as c,e as I,n as a,s as e,c as u}from"./vec3.js";import{c as i}from"./vec3f64.js";import{s as f,a as N,p as E}from"./vector.js";import{t as T}from"./mathUtils2.js";function S(n=Q){return[n[0],n[1],n[2],n[3]]}function _(n=Q[0],t=Q[1],r=Q[2],o=Q[3]){return D(n,t,r,o,f.get())}function M(n,t){return D(t[0],t[1],t[2],t[3],n)}function g(n){return n}function D(n,t,r,o,s=S()){return s[0]=n,s[1]=t,s[2]=r,s[3]=o,s}function O(n,t,r){return u(r,n),r[3]=t,r}function m(n,t,r){const o=t[0]*t[0]+t[1]*t[1]+t[2]*t[2],s=Math.abs(o-1)>1e-5&&o>1e-12?1/Math.sqrt(o):1;return r[0]=t[0]*s,r[1]=t[1]*s,r[2]=t[2]*s,r[3]=-(r[0]*n[0]+r[1]*n[1]+r[2]*n[2]),r}function U(n,t,r,o=S()){const s=r[0]-t[0],c=r[1]-t[1],I=r[2]-t[2],a=n[0]-t[0],e=n[1]-t[1],u=n[2]-t[2],i=c*u-I*e,f=I*a-s*u,N=s*e-c*a,E=i*i+f*f+N*N,T=Math.abs(E-1)>1e-5&&E>1e-12?1/Math.sqrt(E):1;return o[0]=i*T,o[1]=f*T,o[2]=N*T,o[3]=-(o[0]*n[0]+o[1]*n[1]+o[2]*n[2]),o}function h(n,r,o,s=0,e=Math.floor(o*(1/3)),u=Math.floor(o*(2/3))){if(o<3)return!1;r(A,s);let i=e,f=!1;for(;i<o-1&&!f;)r(F,i),i++,f=!I(A,F);if(!f)return!1;for(i=Math.max(i,u),f=!1;i<o&&!f;)r(p,i),i++,c(v,A,F),a(v,v),c(R,F,p),a(R,R),f=!I(A,p)&&!I(F,p)&&Math.abs(t(v,R))<l;return f?(U(A,F,p,n),!0):(0!==s||1!==e||2!==u)&&h(n,r,o,0,1,2)}function C(n,t,r=!0){const o=t.length/3;return h(n,((n,r)=>e(n,t[3*r+0],t[3*r+1],t[3*r+2])),r?o-1:o)}const l=.99619469809,A=i(),F=i(),p=i(),v=i(),R=i();function j(n,r,o){return r!==n&&M(n,r),n[3]=-t(n,o),n}function b(n,t){return t[0]=-n[0],t[1]=-n[1],t[2]=-n[2],t[3]=-n[3],t}function d(n,t,r,o){return s(p,t,n),m(r,p,o)}function y(n,t,r,o){return J(K(n,t,c(N.get(),r,t),W,o))}function X(n,t,r){return null!=t&&J(K(n,t.origin,t.direction,Y,r))}function L(n,t,r){return J(K(n,t.origin,t.vector,V.NONE,r))}function P(n,t,r){return J(K(n,t.origin,t.vector,V.CLAMP,r))}function q(n,t){return G(n,t)>=0}function x(n,r){const o=t(n,r.ray.direction),s=-G(n,r.ray.origin);if(s<0&&o>=0)return!1;if(o>-1e-6&&o<1e-6)return s>0;if((s<0||o<0)&&!(s<0&&o<0))return!0;const c=s/o;return o>0?c<r.c1&&(r.c1=c):c>r.c0&&(r.c0=c),r.c0<=r.c1}function k(n,r){const o=t(n,r.ray.direction),s=-G(n,r.ray.origin);if(o>-1e-6&&o<1e-6)return s>0;const c=s/o;return o>0?c<r.c1&&(r.c1=c):c>r.c0&&(r.c0=c),r.c0<=r.c1}function w(n,s,I){const a=o(N.get(),n,-n[3]),e=function(n,r,s){const I=o(N.get(),n,t(n,r));return c(s,r,I),s}(n,c(N.get(),s,a),N.get());return r(I,e,a),I}function z(n,t,r,o){const s=n,I=N.get(),a=N.get();T(s,I,a);const u=c(N.get(),r,t),i=E(I,u),f=E(a,u),S=E(s,u);return e(o,i,f,S)}function B(n,t){return Math.abs(G(n,t))}function G(n,r){return t(n,r)+n[3]}var H;function J(n){return n===H.INTERSECTS_INSIDE_OUT||n===H.INTERSECTS_OUTSIDE_IN}function K(s,c,I,a,e){const u=t(s,I),i=G(s,c);if(0===u)return i>=0?H.INSIDE:H.OUTSIDE;let f=-i/u;return a&V.CLAMP&&(f=n(f,0,1)),!(a&V.INFINITE_MIN)&&f<0||!(a&V.INFINITE_MAX)&&f>1?i>=0?H.INSIDE:H.OUTSIDE:(r(e,c,o(e,I,f)),i>=0?H.INTERSECTS_INSIDE_OUT:H.INTERSECTS_OUTSIDE_IN)}!function(n){n[n.INTERSECTS_INSIDE_OUT=0]="INTERSECTS_INSIDE_OUT",n[n.INTERSECTS_OUTSIDE_IN=1]="INTERSECTS_OUTSIDE_IN",n[n.INSIDE=2]="INSIDE",n[n.OUTSIDE=3]="OUTSIDE"}(H||(H={}));const Q=[0,0,1,0];var V;!function(n){n[n.NONE=0]="NONE",n[n.CLAMP=1]="CLAMP",n[n.INFINITE_MIN=4]="INFINITE_MIN",n[n.INFINITE_MAX=8]="INFINITE_MAX"}(V||(V={}));const W=V.INFINITE_MIN|V.INFINITE_MAX,Y=V.INFINITE_MAX;export{V as I,M as a,d as b,S as c,D as d,L as e,m as f,g,P as h,X as i,q as j,h as k,U as l,z as m,k as n,G as o,w as p,x as q,C as r,j as s,y as t,B as u,b as v,_ as w,K as x,H as y,O as z};
