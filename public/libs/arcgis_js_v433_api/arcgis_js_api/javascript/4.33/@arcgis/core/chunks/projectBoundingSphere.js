/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.33/esri/copyright.txt for details.
*/
import{e}from"./mathUtils.js";import{c as r}from"./vec3f64.js";import{a as t,c as s,P as n,b as a,w as o}from"./projectBuffer.js";import{j as i}from"./unitUtils.js";function c(e,r,c,f){if(null==r||null==f)return!1;const p=t(r,f);if(null==p?.projector)return!1;if(p.projector===s)return c[0]=e[0],c[1]=e[1],c[2]=e[2],c[3]=e[3],!0;const{source:E,dest:R,projector:m}=p;if(R.spatialReferenceId===n.WEB_MERCATOR){const r=a[E.spatialReferenceId][n.WGS84];return null!=r&&(r(e,0,u,0),o(u,0,c,0),c[3]=l(u[1],e[2],e[3],i.radius),!0)}if(E.spatialReferenceId!==n.WGS84&&E.spatialReferenceId!==n.CGCS2000||R.spatialReferenceId!==n.PLATE_CARREE){m(e,0,c,0);const r=E.metersPerUnit??1,t=R.metersPerUnit??1;c[3]=e[3]*r/t}else{const r=a[E.spatialReferenceId][n.SPHERICAL_ECEF],t=a[n.SPHERICAL_ECEF][n.PLATE_CARREE];let s=e[3];null!=r&&null!=t&&(s=l(e[1],e[2],e[3],i.radius)),m(e,0,c,0),c[3]=s}return!0}function l(e,r,t,s){const n=s+r;if(n<s/2||t>n)return Number.MAX_VALUE;const a=Math.abs(f*e)+Math.asin(t/n);return a>=Math.PI/2?Number.MAX_VALUE:t/Math.cos(a)}const u=r(),f=e(1);export{c as p};
