/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.33/esri/copyright.txt for details.
*/
import"../core/lang.js";import"./Logger.js";import{h as t,g as n}from"./mathUtils.js";import{d as r}from"./mat4.js";import{l as s,s as o,w as e,i,j as a,x as c,f as u,t as f,k as m,v as l,n as g,m as h,b as p}from"./vec3.js";import{c as M}from"./vec3f64.js";import{e as d,c as j}from"./vec4.js";import{c as v,f as b}from"./vec4f64.js";import{g as S}from"./common.js";import{A as x}from"./Axis.js";import{f as y,e as A}from"./ray.js";import{a as q,d as P,e as R}from"./vector.js";function w(n,r){const e=s(n),i=t(n[2]/e),a=Math.atan2(n[1]/e,n[0]/e);return o(r,e,i,a),r}const C=_();function _(){return v()}const E=d,O=d;function T(t,n){return j(n,t)}function k(t,n){return b(t[0],t[1],t[2],n)}function L(t){return t}function N(t,n){return t[0]=t[1]=t[2]=0,t[3]=n,t}function Z(t){return t[3]}function z(t){return t}function F(t,n,r,s){return b(t,n,r,s)}function I(t,n,r){if(null==n)return!1;if(!X(t,n,V))return!1;let{t0:s,t1:o}=V;if((s<0||o<s&&o>0)&&(s=o),s<0)return!1;if(r){const{origin:t,direction:o}=n;r[0]=t[0]+o[0]*s,r[1]=t[1]+o[1]*s,r[2]=t[2]+o[2]*s}return!0}function U(t,n,r){const s=y(n,r);if(!X(t,s,V))return[];const{origin:o,direction:e}=s,{t0:i,t1:a}=V,c=n=>{const r=M();return p(r,o,e,n),H(t,r,r)};return Math.abs(i-a)<S()?[c(i)]:[c(i),c(a)]}const V={t0:0,t1:0};function X(t,n,r){const{origin:s,direction:o}=n,e=Y;e[0]=s[0]-t[0],e[1]=s[1]-t[1],e[2]=s[2]-t[2];const i=o[0]*o[0]+o[1]*o[1]+o[2]*o[2];if(0===i)return!1;const a=2*(o[0]*e[0]+o[1]*e[1]+o[2]*e[2]),c=a*a-4*i*(e[0]*e[0]+e[1]*e[1]+e[2]*e[2]-t[3]*t[3]);if(c<0)return!1;const u=Math.sqrt(c);return r.t0=(-a-u)/(2*i),r.t1=(-a+u)/(2*i),!0}const Y=M();function B(t,n){return I(t,n,null)}function D(t,n,o){const e=q.get(),i=P.get();u(e,n.origin,n.direction);const c=Z(t);u(o,e,n.origin),a(o,o,1/s(o)*c);const m=K(t,n.origin),l=R(n.origin,o);return r(i,l+m,e),f(o,o,i),o}function G(t,n,r,s){const o=Z(t),e=o*o,i=n+.5*Math.PI,a=r*r+e-2*Math.cos(i)*r*o,c=Math.sqrt(a),u=a-e;if(u<=0)return.5;const f=Math.sqrt(u),m=Math.acos(f/c)-Math.asin(o/(c/Math.sin(i)));return Math.min(1,(m+.5*s)/s)}function H(t,n,r){const o=m(q.get(),n,t),e=a(q.get(),o,t[3]/s(o));return i(r,e,t)}function J(t,n){const r=m(q.get(),n,t),s=l(r),o=t[3]*t[3];return Math.sqrt(Math.abs(s-o))}function K(t,r){const o=m(q.get(),r,t),e=s(o),i=Z(t),a=i+Math.abs(i-e);return n(i/a)}const Q=M();function W(t,n,r,s){const e=m(Q,n,t);switch(r){case x.X:{const t=w(e,Q)[2];return o(s,-Math.sin(t),Math.cos(t),0)}case x.Y:{const t=w(e,Q),n=t[1],r=t[2],i=Math.sin(n);return o(s,-i*Math.cos(r),-i*Math.sin(r),Math.cos(n))}case x.Z:return g(s,e);default:return}}function $(t,n){const r=m(rt,n,t);return s(r)-t[3]}function tt(t,n){const r=e(t,n),s=Z(t);return r<=s*s}function nt(t,n,r=v()){const s=c(t,n),o=t[3],e=n[3];return s+e<o?(j(r,t),r):s+o<e?(j(r,n),r):(h(r,t,n,(s+e-o)/(2*s)),r[3]=(s+o+e)/2,r)}const rt=M(),st=_(),ot=Object.freeze(Object.defineProperty({__proto__:null,NullSphere:C,altitudeAt:$,angleToSilhouette:K,axisAt:W,cameraFrustumCoverage:G,clear:function(t){t[0]=t[1]=t[2]=t[3]=0},closestPoint:function(t,n,r){return I(t,n,r)?r:(A(n,t,r),H(t,r,r))},closestPointOnSilhouette:D,containsPoint:tt,copy:T,create:_,distanceToSilhouette:J,elevate:function(t,n,r){return t!==r&&(r[0]=t[0],r[1]=t[1],r[2]=t[2]),r[3]=t[3]+n,r},equals:O,exactEquals:E,fromCenterAndRadius:k,fromRadius:N,fromValues:F,getCenter:z,getExtent:function(t,n){return n},getRadius:Z,intersectLine:U,intersectRay:I,intersectRayClosestSilhouette:function(t,n,r){if(I(t,n,r))return r;const o=D(t,n,q.get());return i(r,n.origin,a(q.get(),n.direction,c(n.origin,o)/s(n.direction))),r},intersectsRay:B,projectPoint:H,setAltitudeAt:function(t,n,r,s){const o=$(t,n),e=W(t,n,x.Z,rt),c=a(rt,e,r-o);return i(s,n,c)},setExtent:function(t,n,r){return t!==r&&T(t,r),r},tmpSphere:st,union:nt,wrap:L},Symbol.toStringTag,{value:"Module"}));export{C as N,T as a,Z as b,_ as c,tt as d,U as e,F as f,z as g,k as h,B as i,E as j,N as k,G as l,I as m,D as n,J as o,H as p,ot as s,st as t,nt as u,L as w};
