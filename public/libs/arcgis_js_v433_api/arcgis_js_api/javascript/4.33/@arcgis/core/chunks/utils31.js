/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.33/esri/copyright.txt for details.
*/
import{p as e}from"./screenUtils.js";function n(n){const s=t(o(n)),i=s,a=Math.max(s/2,5),l=Math.round(e(n.maxPathLength)/a)+1,{density:r}=n;return{smoothing:e(n.smoothing),interpolate:!0,velocityScale:"flow-from"===n.flowRepresentation?1:-1,verticesPerLine:l,minSpeedThreshold:.001,segmentLength:a,maxTurnAngle:1,collisions:!0,lineCollisionWidth:i,lineSpacing:10,density:r}}function t(e){return"constant"===e.kind?e.value[0]:e.values[e.values.length-1]}function s(e){const n=e.toRgba();return[n[0]/255,n[1]/255,n[2]/255,n[3]]}function i(e){return{kind:"constant",value:[.1,.1,.1,1]}}function o(n){if(!n.hasVisualVariables("size"))return{kind:"constant",value:[e(n.trailWidth)]};const t=n.getVisualVariablesForType("size")[0],s=[],i=[];let o;if(t.stops){for(const n of t.stops)s.push(n.value),i.push(e(n.size));o=t.stops.length}else s.push(t.minDataValue,t.maxDataValue),i.push(e(t.minSize),e(t.maxSize)),o=2;return{kind:"ramp",stops:s,values:i,count:o}}function a(e){if(!e.hasVisualVariables("color"))return{kind:"constant",value:s(e.color)};const n=e.getVisualVariablesForType("color")[0],t=[],i=[];for(const e of n.stops)t.push(e.value),Array.prototype.push.apply(i,s(e.color));return{kind:"ramp",stops:t,values:i,count:n.stops.length}}function l(e){if(!e.hasVisualVariables("opacity"))return{kind:"constant",value:[1]};const n=e.getVisualVariablesForType("opacity")[0],t=[],s=[];for(const e of n.stops)t.push(e.value),s.push(e.opacity);return{kind:"ramp",stops:t,values:s,count:n.stops.length}}function r(e,n,t,s){switch(n){case"int":e.setUniform1iv(t,s);break;case"float":e.setUniform1fv(t,s);break;case"vec2":e.setUniform2fv(t,s);break;case"vec3":e.setUniform3fv(t,s);break;case"vec4":e.setUniform4fv(t,s)}}function u(e,n,t,s){"constant"===s.kind?r(e,t,`u_${n}`,s.value):(r(e,"float",`u_${n}_stops`,s.stops),r(e,t,`u_${n}_values`,s.values),e.setUniform1i(`u_${n}_count`,s.count))}function c(e,n){let t=!0;return t=t&&e.collisions===n.collisions,t=t&&e.density===n.density,t=t&&e.interpolate===n.interpolate,t=t&&e.lineCollisionWidth===n.lineCollisionWidth,t=t&&e.lineSpacing===n.lineSpacing,t=t&&e.maxTurnAngle===n.maxTurnAngle,t=t&&e.minSpeedThreshold===n.minSpeedThreshold,t=t&&e.segmentLength===n.segmentLength,t=t&&e.smoothing===n.smoothing,t=t&&e.velocityScale===n.velocityScale,t=t&&e.verticesPerLine===n.verticesPerLine,t}function p(e,n){return e===n||null!=e&&null!=n&&e.equals(n)}function f(e,n){if(!c(e.simulationSettings,n.simulationSettings))return!1;if(!p(e.timeExtent,n.timeExtent))return!1;let t=!0;return t=t&&e.loadImagery===n.loadImagery,t=t&&e.createFlowMesh===n.createFlowMesh,t=t&&e.color.kind===n.color.kind,t=t&&e.opacity.kind===n.opacity.kind,t=t&&e.size.kind===n.size.kind,t}export{u as a,f as b,o as c,l as d,a as e,t as f,n as g,i as h,c as s,p as t};
