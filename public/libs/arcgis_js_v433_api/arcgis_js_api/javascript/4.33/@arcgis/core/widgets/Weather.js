/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.33/esri/copyright.txt for details.
*/
import{_ as e}from"../chunks/tslib.es6.js";import s,{g as t}from"../core/Accessor.js";import{L as o}from"../chunks/Logger.js";import{m as r}from"../chunks/memoize.js";import{property as i}from"../core/accessorSupport/decorators/property.js";import"../core/lang.js";import{subclass as n}from"../core/accessorSupport/decorators/subclass.js";import{a}from"../chunks/weather.js";import l from"./Widget.js";import{l as c}from"../chunks/componentsUtils.js";import{g as p}from"../chunks/globalCss.js";import{H as d}from"../chunks/Heading.js";import{c as u}from"../chunks/widgetUtils.js";import{m as h}from"../chunks/messageBundle.js";import{t as m,a as g}from"../chunks/jsxFactory.js";import v,{W as y,a as j}from"./Weather/WeatherViewModel.js";import"../core/Handles.js";import"../chunks/maybe.js";import"../chunks/get.js";import"../chunks/utils.js";import"../chunks/handleUtils.js";import"../chunks/Lifecycle.js";import"../chunks/metadata.js";import"../chunks/ObjectPool.js";import"../chunks/ObservableBase.js";import"../chunks/tracking.js";import"../chunks/watch.js";import"../core/scheduling.js";import"../chunks/nextTick.js";import"../chunks/PooledArray.js";import"../core/promiseUtils.js";import"../core/Error.js";import"../config.js";import"../chunks/events.js";import"../chunks/SetUtils.js";import"../chunks/SimpleTrackingTarget.js";import"../chunks/ensureType.js";import"../chunks/MapUtils.js";import"../chunks/Warning.js";import"../views/3d/environment/CloudyWeather.js";import"../core/JSONSupport.js";import"../chunks/enumeration.js";import"../chunks/jsonMap.js";import"../views/3d/environment/FoggyWeather.js";import"../views/3d/environment/RainyWeather.js";import"../views/3d/environment/SnowyWeather.js";import"../views/3d/environment/SunnyWeather.js";import"../intl.js";import"../chunks/date.js";import"../chunks/locale.js";import"../chunks/constants.js";import"../chunks/datetime.js";import"../chunks/number2.js";import"../chunks/substitute.js";import"../chunks/messages.js";import"../request.js";import"../kernel.js";import"../core/urlUtils.js";import"../chunks/jsonUtils.js";import"../chunks/persistableUrlUtils.js";import"../chunks/assets.js";import"../chunks/domUtils.js";import"../core/Evented.js";import"../core/Promise.js";import"../core/reactiveUtils.js";import"../chunks/uuid.js";import"../core/accessorSupport/decorators/cast.js";import"../chunks/projector.js";import"../chunks/sanitizerUtils.js";import"../chunks/jsxWidgetSupport.js";import"../chunks/mathUtils.js";const k="esri-weather",b={base:k,content:`${k}__content`,hasError:`${k}__content--has-error`,selector:`${k}__selector`,options:`${k}__options`,optionsHidden:`${k}__options--hidden`,error:`${k}__error`,warning:`${k}__warning`},w={base:`${k}__labeled-slider`};let C=class extends l{constructor(e){super(e),this._onChange=e=>{this.onChange(e.currentTarget.value)}}render(){const{label:e}=this;return m("div",{class:w.base},m("calcite-label",{scale:"s"},e,m("calcite-slider",{"aria-label":e,disabled:this.disabled,max:1,min:0,step:.01,value:this.value,onCalciteSliderChange:this._onChange,onCalciteSliderInput:this._onChange})))}loadDependencies(){return c({label:()=>import("../chunks/index2.js"),slider:()=>import("../chunks/index71.js")})}};e([i()],C.prototype,"value",void 0),e([i()],C.prototype,"onChange",void 0),e([i()],C.prototype,"disabled",void 0),C=e([n("esri.widgets.Weather.LabeledSlider")],C);let _=class extends s{constructor(e){super(e),this.header=!0}};e([i({type:Boolean,nonNullable:!0})],_.prototype,"header",void 0),_=e([n("esri.widgets.Weather.VisibleElements")],_);const f=_,S={sunny:"brightness",cloudy:"partly-cloudy",rainy:"rain",snowy:"snow",foggy:"fog"};let M=class extends l{constructor(e){super(e),this.viewModel=new v({isDefaultViewModel:!0}),this.headingLevel=4,this.visibleElements=new f,this._renderWeatherTypeButton=e=>{const s=this.viewModel,t=this.messages[e].label,o=s.state===y.Disabled,r=!o&&s.current.type===e;return m("calcite-button",{appearance:r?"solid":"outline","aria-checked":r?"true":"false",disabled:o,iconStart:S[e],key:`${e}-type-button`,kind:r?"brand":"neutral",label:t,onclick:()=>{r||s.setWeatherByType(e)},scale:"l",title:t})},this._memoizedCallbacks=r((e=>({onCloudCoverChange:s=>{"cloudCover"in e&&(e.cloudCover=s)},onPrecipitationChange:s=>{"precipitation"in e&&(e.precipitation=s)},onFogStrengthChange:s=>{"fogStrength"in e&&(e.fogStrength=s)},onSnowCoverChange:e=>{this.viewModel.setSnowCoverEnabled(e.currentTarget.checked)}}))),t(o.getLogger(this),"Weather","arcgis-weather",{version:"4.33"})}render(){const e=this.viewModel.state===y.Disabled;return m("div",{"aria-label":this.messages.widgetLabelAccessible,class:this.classes(b.base,p.widget,e&&p.widgetDisabled),role:"region"},this._renderContent())}loadDependencies(){return c({button:()=>import("../chunks/index6.js"),checkbox:()=>import("../chunks/index21.js"),icon:()=>import("../chunks/index.js"),label:()=>import("../chunks/index2.js")})}get view(){return this.viewModel?.view}set view(e){this.viewModel&&(this.viewModel.view=e)}get icon(){return"partly-cloudy"}set icon(e){this._overrideIfSome("icon",e)}get label(){return this.messages?.widgetLabel??""}set label(e){this._overrideIfSome("label",e)}get _errorMessage(){const e=this.messages.error;switch(this.viewModel.error){case j.LocalScene:return e.localScene;case j.NoAtmosphere:return e.noAtmosphere;case j.UnsupportedView:return e.unsupported;default:return null}}get _warningMessage(){return this.viewModel.error===j.NotVisible&&null!=this.view&&"3d"===this.view?.type&&this.view.environment.atmosphereEnabled?this.messages.error.notVisible:null}_renderContent(){const{headingLevel:e,messages:s,viewModel:t,visibleElements:o}=this,r=this._warningMessage,i=t.current,n=t.state===y.Error;return m(g,null,o.header?m(d,{level:e},s.widgetLabel):null,n?m("div",{class:b.error,key:"error"},this._errorMessage):null,m("div",{class:u({[b.content]:!0,[b.hasError]:n}),key:"content"},m("div",{"aria-label":s.weatherType,class:b.selector,key:"type-selector",role:"radiogroup"},a.map(this._renderWeatherTypeButton)),Object.values(t.weatherByType).map((e=>m("div",{class:u({[b.options]:!0,[b.optionsHidden]:e.type!==i?.type}),key:"options-container"},this._renderOptions(e)))),null!=r?this._renderWarning(r):null))}_renderOptions(e){const{viewModel:s,messages:t}=this,o=s.state===y.Disabled,r=this._memoizedCallbacks(e);switch(e.type){case"sunny":return m(C,{disabled:o,key:"sunny-cover",label:t.sunny.cloudCover,value:e.cloudCover,onChange:r.onCloudCoverChange});case"cloudy":return m(C,{disabled:o,key:"cloudy-cover",label:t.cloudy.cloudCover,value:e.cloudCover,onChange:r.onCloudCoverChange});case"rainy":return m(g,null,m(C,{disabled:o,key:"rainy-cover",label:t.rainy.cloudCover,value:e.cloudCover,onChange:r.onCloudCoverChange}),m(C,{disabled:o,key:"rainy-precipitation",label:t.rainy.precipitation,value:e.precipitation,onChange:r.onPrecipitationChange}));case"snowy":return m(g,null,m(C,{disabled:o,key:"snowy-cloud-cover",label:t.snowy.cloudCover,value:e.cloudCover,onChange:r.onCloudCoverChange}),m(C,{disabled:o,key:"snowy-precipitation",label:t.snowy.precipitation,value:e.precipitation,onChange:r.onPrecipitationChange}),m("calcite-label",{key:"snow-cover",layout:"inline",scale:"s",title:t.snowy.snowCoverTooltip},m("calcite-checkbox",{checked:"enabled"===e.snowCover,disabled:o,onCalciteCheckboxChange:r.onSnowCoverChange}),t.snowy.snowCover));case"foggy":return m(C,{disabled:o,key:"foggy-cover",label:t.foggy.fogStrength,value:e.fogStrength,onChange:r.onFogStrengthChange})}}_renderWarning(e){return m("div",{class:b.warning,key:"warning"},m("calcite-icon",{icon:"exclamation-mark-triangle",scale:"s"}),e)}};e([i()],M.prototype,"viewModel",void 0),e([i()],M.prototype,"view",null),e([i()],M.prototype,"headingLevel",void 0),e([i({type:f,nonNullable:!0})],M.prototype,"visibleElements",void 0),e([i()],M.prototype,"icon",null),e([i()],M.prototype,"label",null),e([i(),h("esri/widgets/Weather/t9n/Weather")],M.prototype,"messages",void 0),e([i()],M.prototype,"_errorMessage",null),e([i()],M.prototype,"_warningMessage",null),M=e([n("esri.widgets.Weather")],M);const W=M;export{W as default};
