// All material copyright Esri, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.33/esri/copyright.txt for details.
//>>built
define(["exports","./enum","../core/string","../core/sql/UnknownTimeZone","../chunks/datetime"],(function(e,t,n,r,i){"use strict";e.ArcadeDateErrorCodes=void 0,(e.ArcadeDateErrorCodes||(e.ArcadeDateErrorCodes={})).TimeZoneNotRecognized="TimeZoneNotRecognized";const o={[e.ArcadeDateErrorCodes.TimeZoneNotRecognized]:"Timezone identifier has not been recognized."};class s extends Error{constructor(e,t){super(n.replace(o[e],t)),this.declaredRootClass="esri.arcade.arcadedate.dateerror",Error.captureStackTrace&&Error.captureStackTrace(this,s)}}function a(e,t,n){return e<t?e-t:e>n?e-n:0}function d(e,t,n){return e<t?t:e>n?n:e}class c{constructor(e){this._date=e,this.declaredRootClass="esri.arcade.arcadedate"}static fromParts(e=0,t=1,n=1,r=0,o=0,s=0,u=0,h){if(isNaN(e)||isNaN(t)||isNaN(n)||isNaN(r)||isNaN(o)||isNaN(s)||isNaN(u))return null;const l=i.DateTime.local(e,t).daysInMonth;let T=i.DateTime.fromObject({day:d(n,1,l),year:e,month:d(t,1,12),hour:d(r,0,23),minute:d(o,0,59),second:d(s,0,59),millisecond:d(u,0,999)},{zone:m(h)});return T=T.plus({months:a(t,1,12),days:a(n,1,l),hours:a(r,0,23),minutes:a(o,0,59),seconds:a(s,0,59),milliseconds:a(u,0,999)}),new c(T)}static get systemTimeZoneCanonicalName(){return Intl.DateTimeFormat().resolvedOptions().timeZone??"system"}static arcadeDateAndZoneToArcadeDate(e,t){const n=m(t);return e.isUnknownTimeZone||n===r.UnknownTimeZone.instance?c.fromParts(e.year,e.monthJS+1,e.day,e.hour,e.minute,e.second,e.millisecond,n):new c(e._date.setZone(n))}static dateJSToArcadeDate(e){return new c(i.DateTime.fromJSDate(e,{zone:"system"}))}static dateJSAndZoneToArcadeDate(e,t="system"){const n=m(t);return new c(i.DateTime.fromJSDate(e,{zone:n}))}static unknownEpochToArcadeDate(e){return new c(i.DateTime.fromMillis(e,{zone:r.UnknownTimeZone.instance}))}static unknownDateJSToArcadeDate(e){return new c(i.DateTime.fromMillis(e.getTime(),{zone:r.UnknownTimeZone.instance}))}static epochToArcadeDate(e,t="system"){const n=m(t);return new c(i.DateTime.fromMillis(e,{zone:n}))}static dateTimeToArcadeDate(e){return new c(e)}clone(){return new c(this._date)}changeTimeZone(e){const t=m(e);return c.dateTimeToArcadeDate(this._date.setZone(t))}static dateTimeAndZoneToArcadeDate(e,t){const n=m(t);return e.zone===r.UnknownTimeZone.instance||n===r.UnknownTimeZone.instance?c.fromParts(e.year,e.month,e.day,e.hour,e.minute,e.second,e.millisecond,n):new c(e.setZone(n))}static nowToArcadeDate(e){const t=m(e);return new c(i.DateTime.fromJSDate(new Date,{zone:t}))}static nowUTCToArcadeDate(){return new c(i.DateTime.utc())}get isSystem(){return"system"===this.timeZone||this.timeZone===c.systemTimeZoneCanonicalName}equals(e){return this.isSystem&&e.isSystem?this.toNumber()===e.toNumber():this.isUnknownTimeZone===e.isUnknownTimeZone&&this._date.equals(e._date)}get isUnknownTimeZone(){return this._date.zone===r.UnknownTimeZone.instance}get isValid(){return this._date.isValid}get hour(){return this._date.hour}get second(){return this._date.second}get day(){return this._date.day}get dayOfWeekISO(){return this._date.weekday}get dayOfWeekJS(){let e=this._date.weekday;return e>6&&(e=0),e}get millisecond(){return this._date.millisecond}get monthISO(){return this._date.month}get weekISO(){return this._date.weekNumber}get yearISO(){return this._date.weekYear}get monthJS(){return this._date.month-1}get year(){return this._date.year}get minute(){return this._date.minute}get zone(){return this._date.zone}get timeZoneOffset(){return this.isUnknownTimeZone?0:this._date.offset}get timeZone(){if(this.isUnknownTimeZone)return"unknown";if("system"===this._date.zone.type)return"system";const e=this.zone;return"fixed"===e.type?0===e.fixed?"UTC":e.formatOffset(0,"short"):e.name}stringify(){return JSON.stringify(this.toJSDate())}plus(e){return new c(this._date.plus(e))}diff(e,t){return this._date.diff(e._date,t)[t]}toISODate(){return this._date.toISODate()}toISOString(e){return e?this._date.toISO({suppressMilliseconds:!0,includeOffset:!this.isUnknownTimeZone}):this._date.toISO({includeOffset:!this.isUnknownTimeZone})}toISOTime(e,t){return this._date.toISOTime({suppressMilliseconds:e,includeOffset:t&&!this.isUnknownTimeZone})}toFormat(e,t){return this.isUnknownTimeZone&&(e=e.replaceAll("Z","")),this._date.toFormat(e,t)}toJSDate(){return this._date.toJSDate()}toSQLValue(){return this._date.toFormat("yyyy-LL-dd HH:mm:ss")}toSQLWithKeyword(){return`timestamp '${this.toSQLValue()}'`}toDateTime(){return this._date}toNumber(){return this._date.toMillis()}getTime(){return this._date.toMillis()}toUTC(){return new c(this._date.toUTC())}toLocal(){return new c(this._date.toLocal())}toString(){return this.toISOString(!0)}static fromReaderAsTimeStampOffset(e){if(!e)return null;const t=i.DateTime.fromISO(e,{setZone:!0});return new c(t)}}function m(n,o=!0){if(n instanceof i.Zone)return n;switch(t.toStringEnumKey(n)){case"system":return"system";case"utc":return"UTC";case"unknown":return r.UnknownTimeZone.instance}if(/^[+-]?[0-9]{1,2}([:][0-9]{2})?$/.test(n)){const e=i.FixedOffsetZone.parseSpecifier("UTC"+(n.startsWith("+")||n.startsWith("-")?"":"+")+n);if(e)return e}const a=i.IANAZone.create(n);if(!a.isValid){if(o)throw new s(e.ArcadeDateErrorCodes.TimeZoneNotRecognized);return null}return a}e.ArcadeDate=c,e.ArcadeDateError=s,e.arcadeDateErrorMessages=o,e.createDateTimeZone=m,Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})}));