// All material copyright Esri, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.33/esri/copyright.txt for details.
//>>built
define(["exports","../Dictionary","../executionError","../../chunks/languageUtils","../featureset/support/shared"],(function(e,n,t,r,a){"use strict";function o(e,t){return e&&e.domain?"coded-value"===e.domain.type||"codedValue"===e.domain.type?n.convertObjectToArcadeDictionary({type:"codedValue",name:e.domain.name,dataType:a.layerFieldEsriConstants[e.field.type],codedValues:e.domain.codedValues.map((e=>({name:e.name,code:e.code})))},r.defaultTimeZone(t)):n.convertObjectToArcadeDictionary({type:"range",name:e.domain.name,dataType:a.layerFieldEsriConstants[e.field.type],min:e.domain.minValue,max:e.domain.maxValue},r.defaultTimeZone(t)):null}e.registerFunctions=function(e){"async"===e.mode&&(e.functions.domain=function(n,a){return e.standardFunctionAsync(n,a,(async(e,i,c)=>{if(r.pcCheck(c,2,3,n,a),r.isFeature(c[0]))return o(r.featureFullDomain(c[0],r.toString(c[1]),void 0===c[2]?void 0:c[2]),n);if(r.isFeatureSet(c[0]))return await c[0]._ensureLoaded(),o(r.getDomain(r.toString(c[1]),c[0],null,void 0===c[2]?void 0:c[2]),n);throw new t.ArcadeExecutionError(n,t.ExecutionErrorCodes.InvalidParameter,a)}))},e.functions.subtypes=function(a,o){return e.standardFunctionAsync(a,o,(async(e,i,c)=>{if(r.pcCheck(c,1,1,a,o),r.isFeature(c[0])){const e=r.featureSubtypes(c[0]);return e?n.convertObjectToArcadeDictionary(e,r.defaultTimeZone(a)):null}if(r.isFeatureSet(c[0])){await c[0]._ensureLoaded();const e=c[0].subtypeMetaData();return e?n.convertObjectToArcadeDictionary(e,r.defaultTimeZone(a)):null}throw new t.ArcadeExecutionError(a,t.ExecutionErrorCodes.InvalidParameter,o)}))},e.functions.domainname=function(n,a){return e.standardFunctionAsync(n,a,(async(e,o,i)=>{if(r.pcCheck(i,2,4,n,a),r.isFeature(i[0]))return r.featureDomainValueLookup(i[0],r.toString(i[1]),i[2],void 0===i[3]?void 0:i[3]);if(r.isFeatureSet(i[0])){await i[0]._ensureLoaded();const e=r.getDomain(r.toString(i[1]),i[0],null,void 0===i[3]?void 0:i[3]);return r.getDomainValue(e,i[2])}throw new t.ArcadeExecutionError(n,t.ExecutionErrorCodes.InvalidParameter,a)}))},e.signatures.push({name:"domainname",min:2,max:4}),e.functions.domaincode=function(n,a){return e.standardFunctionAsync(n,a,(async(e,o,i)=>{if(r.pcCheck(i,2,4,n,a),r.isFeature(i[0]))return r.featureDomainCodeLookup(i[0],r.toString(i[1]),i[2],void 0===i[3]?void 0:i[3]);if(r.isFeatureSet(i[0])){await i[0]._ensureLoaded();const e=r.getDomain(r.toString(i[1]),i[0],null,void 0===i[3]?void 0:i[3]);return r.getDomainCode(e,i[2])}throw new t.ArcadeExecutionError(n,t.ExecutionErrorCodes.InvalidParameter,a)}))},e.signatures.push({name:"domaincode",min:2,max:4}),e.functions.text=function(n,a){return e.standardFunctionAsync(n,a,(async(e,o,i)=>{if(r.pcCheck(i,1,2,n,a),r.isFeatureSet(i[0])){const o=r.defaultUndefined(i[1],"");if(""===o)return i[0].castToText();if("schema"===o.toLowerCase())return i[0].convertToText("schema",e.abortSignal);if("featureset"===o.toLowerCase())return i[0].convertToText("featureset",e.abortSignal);throw new t.ArcadeExecutionError(n,t.ExecutionErrorCodes.InvalidParameter,a)}return r.toStringExplicit(i[0],i[1])}))},e.functions.gdbversion=function(n,a){return e.standardFunctionAsync(n,a,(async(e,o,i)=>{if(r.pcCheck(i,1,1,n,a),r.isFeature(i[0]))return i[0].gdbVersion();if(r.isFeatureSet(i[0]))return(await i[0].load()).gdbVersion;throw new t.ArcadeExecutionError(n,t.ExecutionErrorCodes.InvalidParameter,a)}))},e.functions.schema=function(a,o){return e.standardFunctionAsync(a,o,(async(e,i,c)=>{if(r.pcCheck(c,1,1,a,o),r.isFeatureSet(c[0]))return await c[0].load(),n.convertObjectToArcadeDictionary(c[0].schema(),r.defaultTimeZone(a));if(r.isFeature(c[0])){const e=r.featureSchema(c[0]);return e?n.convertObjectToArcadeDictionary(e,r.defaultTimeZone(a)):null}throw new t.ArcadeExecutionError(a,t.ExecutionErrorCodes.InvalidParameter,o)}))})},Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})}));