// All material copyright Esri, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.33/esri/copyright.txt for details.
//>>built
define(["exports","../executionError","../../chunks/languageUtils","../../core/accessorSupport/ensureType","../../geometry/Point","../../geometry/support/jsonUtils"],(function(r,n,e,t,a,u){"use strict";function s(r,n=!1){const t={};for(const a of r.keys()){const u=n?a.toLowerCase():a,l=r.attributes[a];t[u]=e.isDictionary(l)?s(l):l}return t}const l=Symbol("NoValue");function o(r){return Array.isArray(r)&&r.length>0?r[0]:e.isImmutableArray(r)&&r.length()>0?r.get(0):l}function i(r){return t.ensureNumber(r,0)??0}function c(r){return"number"==typeof r&&!Number.isNaN(r)}const h=null;function f(r){return t.ensureNumber(r,h)??h}function y(r){return"number"==typeof r&&!Number.isNaN(r)||null===r}function m(r){return!(r.length<2||"number"!=typeof r[0]||Number.isNaN(r[0])||"number"!=typeof r[1]||Number.isNaN(r[1]))}function d(r){return m(r)?r.length>2?r.slice(0,2):r:null}function A(r){return m(r)?c(r[2])?r.length>3?r.slice(0,3):r:[r[0],r[1],i(r[2])]:null}function E(r){return m(r)?r.length>=3&&!y(r[2])?[r[0],r[1],f(r[2])]:r.length>3?r.slice(0,3):r:null}function g(r){return m(r)?c(r[2])&&y(r[3])?r.length>4?r.slice(0,4):r:[r[0],r[1],i(r[2]),f(r[3])]:null}function p(r){return[r.x,r.y]}function b(r){return[r.x,r.y,r.z??0]}function v(r){return[r.x,r.y,r.m??h]}function M(r){return[r.x,r.y,r.z??0,r.m??h]}function Z(r,n){return r?n?g:A:n?E:d}function N(r,n){return r?n?M:b:n?v:p}function x(r,n,t){return Array.isArray(r)?t(r):r instanceof a?n(r):e.isImmutableArray(r)?t(r.toArray()):null}function w(r,t,u){return Array.isArray(r)?u(r):e.isDictionary(r)?r.hasField("c")?function(r,t,a){if(e.isImmutableArray(r)&&(r=r.toArray()),!Array.isArray(r)||2!==r.length)throw new n.ArcadeExecutionError(null,n.ExecutionErrorCodes.InvalidParameter,null);const u=x(r[0],t,a);if(null==u)return null;const s=x(r[1],p,d);return null==s?null:{c:[u,s]}}(r.field("c"),t,u):r.hasField("a")?function(r,t,a){if(e.isImmutableArray(r)&&(r=r.toArray()),!Array.isArray(r)||4!==r.length&&7!==r.length)throw new n.ArcadeExecutionError(null,n.ExecutionErrorCodes.InvalidParameter,null);const u=x(r[0],t,a);if(null==u)return null;const s=x(r[1],p,d);if(null==s)return null;const l=r[2];if(0!==l&&1!==l)throw new n.ArcadeExecutionError(null,n.ExecutionErrorCodes.InvalidParameter,null);const o=r[3];if(0!==o&&1!==o)throw new n.ArcadeExecutionError(null,n.ExecutionErrorCodes.InvalidParameter,null);if(4===r.length)return{a:[u,s,l,o]};const i=r[4];if("number"!=typeof i)throw new n.ArcadeExecutionError(null,n.ExecutionErrorCodes.InvalidParameter,null);if(Number.isNaN(i))return null;const c=r[5];if("number"!=typeof c)throw new n.ArcadeExecutionError(null,n.ExecutionErrorCodes.InvalidParameter,null);if(Number.isNaN(c))return null;const h=r[6];if("number"!=typeof h)throw new n.ArcadeExecutionError(null,n.ExecutionErrorCodes.InvalidParameter,null);return Number.isNaN(h)?null:{a:[u,s,l,o,i,c,h]}}(r.field("a"),t,u):r.hasField("b")?function(r,t,a){if(e.isImmutableArray(r)&&(r=r.toArray()),!Array.isArray(r)||3!==r.length)throw new n.ArcadeExecutionError(null,n.ExecutionErrorCodes.InvalidParameter,null);const u=x(r[0],t,a);if(null==u)return null;const s=x(r[1],p,d);if(null==s)return null;const l=x(r[2],p,d);return null==l?null:{b:[u,s,l]}}(r.field("b"),t,u):null:r instanceof a?t(r):e.isImmutableArray(r)?u(r.toArray()):null}function I(r,n,t,a){const u=[];if(Array.isArray(r))for(const e of r){const r=n(e,t,a);null!=r&&u.push(r)}else if(e.isImmutableArray(r))for(let e=0;e<r.length();e++){const s=n(r.get(e),t,a);null!=s&&u.push(s)}return u}function P(r,n,t){return Array.isArray(r)?r.length>=n:e.isImmutableArray(r)?r.length()>=n:r instanceof a&&r[t]}function C(r,n,e){return void 0===r&&void 0===n?{hasZ:P(e,3,"hasZ"),hasM:P(e,4,"hasM")}:void 0===r?!0===n?{hasZ:P(e,4,"hasZ"),hasM:!0}:{hasZ:P(e,3,"hasZ"),hasM:!1}:void 0===n?!0===r?{hasZ:!0,hasM:P(e,4,"hasM")}:{hasZ:!1,hasM:P(e,3,"hasM")}:{hasZ:!0===r,hasM:!0===n}}function z(r,n,t,u){r=function(r){const n=o(o(r));return n===l||Array.isArray(n)||e.isImmutableArray(n)||n instanceof a?r:[r]}(r);const s=o(o(r));if(s===l)return null;const{hasZ:i,hasM:c}=C(n,t,s),h=N(i,c),f=Z(i,c),y=[];if(Array.isArray(r))for(let n=0;n<r.length;n++)y.push(I(r[n],u,h,f));else if(e.isImmutableArray(r))for(let n=0;n<r.length();n++)y.push(I(r.get(n),u,h,f));return{arrays:y,hasZ:i,hasM:c}}r.constructGeometryFromDictionary=function(r,e,t=null){const a=s(r,!0);if(void 0!==a.hasm&&(a.hasM=a.hasm,delete a.hasm),void 0!==a.hasz&&(a.hasZ=a.hasz,delete a.hasz),void 0!==a.spatialreference&&(a.spatialReference=a.spatialreference,delete a.spatialreference),a.spatialReference||(a.spatialReference=e),void 0!==a.curverings){const r=z(a.curverings,a.hasZ,a.hasM,w);if(null==r)return null;a.curveRings=r.arrays,delete a.curverings,delete a.rings,a.hasZ=r.hasZ,a.hasM=r.hasM}else if(void 0!==a.rings){const r=z(a.rings,a.hasZ,a.hasM,x);if(null==r)return null;a.rings=r.arrays,a.hasZ=r.hasZ,a.hasM=r.hasM}if(void 0!==a.curvepaths){const r=z(a.curvepaths,a.hasZ,a.hasM,w);if(null==r)return null;a.curvePaths=r.arrays,delete a.curvepaths,delete a.paths,a.hasZ=r.hasZ,a.hasM=r.hasM}else if(void 0!==a.paths){const r=z(a.paths,a.hasZ,a.hasM,x);if(null==r)return null;a.paths=r.arrays,a.hasZ=r.hasZ,a.hasM=r.hasM}if(void 0!==a.points){const r=function(r,n,e){const t=o(r);if(t===l)return null;const{hasZ:a,hasM:u}=C(n,e,t);return{array:I(r,x,N(a,u),Z(a,u)),hasZ:a,hasM:u}}(a.points,a.hasZ,a.hasM);if(null==r)return null;a.points=r.array,a.hasZ=r.hasZ,a.hasM=r.hasM}const i=u.fromJSON(a);if(null!=t&&i?.type!==t)throw new n.ArcadeExecutionError(null,n.ExecutionErrorCodes.InvalidParameter,null);return i},Object.defineProperty(r,Symbol.toStringTag,{value:"Module"})}));