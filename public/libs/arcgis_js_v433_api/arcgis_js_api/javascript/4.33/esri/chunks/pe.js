// All material copyright Esri, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.33/esri/copyright.txt for details.
//>>built
define(["require","exports","../assets","../core/has"],(function(e,t,o,_){"use strict";let n;function r(){return!!t._pe}function p(){return!!_("esri-wasm")}function P(){return n||(n=new Promise(((t,o)=>e(["./pe-wasm"],t,o))).then((({default:e})=>e({locateFile:e=>o.getAssetUrl(`esri/geometry/support/${e}`)}))).then((e=>{T(e)})),n)}var s,i,E,a,u,c;function T(e){function o(e,t,o){e[t]=o(e[t])}t._pe=e,t.PeDefs.init(),t.PeGTlistExtended.init(),t.PeNotationMgrs.init(),t.PeNotationUtm.init(),t.PePCSInfo.init(),t.PeDouble=class extends t._pe.PeDouble{constructor(e=NaN){super(e)}destroy(){t._pe.destroy(this)}[Symbol.dispose](){this.destroy()}},t.PeGCSExtent=class extends t._pe.PeGCSExtent{destroy(){t._pe.destroy(this)}[Symbol.dispose](){this.destroy()}};const _=[t._pe.PeAngunit,t._pe.PeDatum,t._pe.PeGeogcs,t._pe.PeGeogtran,t._pe.PeObject,t._pe.PeParameter,t._pe.PePrimem,t._pe.PeProjcs,t._pe.PeSpheroid,t._pe.PeUnit];for(const e of _)o(e.prototype,"getName",(e=>function(){return e.call(this,new Array(t.PeDefs.PE_NAME_MAX))}));for(const e of[t._pe.PeGeogtran,t._pe.PeProjcs])o(e.prototype,"getParameters",(e=>function(){const o=new Array(t.PeDefs.PE_PARM_MAX);let _=e.call(this);for(let e=0;e<o.length;e++){const n=t._pe.getValue(_,"*");o[e]=n?t._pe.wrapPointer(n,t._pe.PeParameter):null,_+=Int32Array.BYTES_PER_ELEMENT}return o}));o(t._pe.PeHorizon.prototype,"getCoord",(e=>function(t=!1){const o=this.getSize();if(!o)return null;const _=[];return d(_,o,e.call(this),t),_})),o(t._pe.PeGTlistExtendedEntry.prototype,"getEntries",(e=>{const o=t._pe._pe_getPeGTlistExtendedGTsSize();return function(){let _=null;const n=e.call(this);if(!t._pe.compare(n,t._pe.NULL)){_=[n];const e=this.getSteps();if(e>1){const r=t._pe.getPointer(n);for(let n=1;n<e;n++)_.push(t._pe.wrapPointer(r+o*n,t._pe.PeGTlistExtendedGTs))}}return _}}));const n=t._pe._pe_getPeHorizonSize(),r=e=>function(){let o=this._cache;if(o||(o=new Map,this._cache=o),o.has(e))return o.get(e);let _=null;const r=e.call(this);if(!t._pe.compare(r,t._pe.NULL)){_=[r];const e=r.getNump();if(e>1){const o=t._pe.getPointer(r);for(let r=1;r<e;r++)_.push(t._pe.wrapPointer(o+n*r,t._pe.PeHorizon))}}return o.set(e,_),_};o(t._pe.PeProjcs.prototype,"horizonGcsGenerate",r),o(t._pe.PeProjcs.prototype,"horizonPcsGenerate",r),t._pe.PeObject.prototype.toString=function(e=t.PeDefs.PE_STR_OPTS_NONE){t._pe.ensureCache.prepare();const o=t._pe.getPointer(this),_=t._pe.ensureInt8(new Array(t.PeDefs.PE_BUFFER_MAX));return t._pe.UTF8ToString(t._pe._pe_object_to_string_ext(o,e,_))},t._pe.PeGeogcs.prototype.destroy=function(){this.Delete(),f(this),this.ptr=0},t._pe.PeGeogcs.prototype[Symbol.dispose]=function(){this.destroy()},t._pe.PeProjcs.prototype.destroy=function(){this.Delete(),f(this),this.ptr=0},t._pe.PeProjcs.prototype[Symbol.dispose]=function(){this.destroy()}}function f(e){if(!e)return;const o=t._pe.getClass(e);if(!o)return;const _=t._pe.getCache(o);if(!_)return;const n=t._pe.getPointer(e);n&&delete _[n]}function g(e,o){const _=[],n=new Array(o);for(let o=0;o<e;o++)_.push(t._pe.ensureInt8(n));return _}function l(e){return ArrayBuffer.isView(e)?e:Array.isArray(e[0])?e.flat():e}function d(e,o,_,n=!1){if(n)for(let n=0;n<2*o;n++)e[n]=t._pe.getValue(_+n*Float64Array.BYTES_PER_ELEMENT,"double");else{const n=0===e.length;for(let r=0;r<o;r++)n&&(e[r]=new Array(2)),e[r][0]=t._pe.getValue(_,"double"),e[r][1]=t._pe.getValue(_+Float64Array.BYTES_PER_ELEMENT,"double"),_+=2*Float64Array.BYTES_PER_ELEMENT}}t._pe=null,t.PeCSTransformations=void 0,function(e){function o(e,o,_){t._pe.ensureCache.prepare();const n=l(_),r=_===n,p=t._pe.ensureFloat64(n),P=t._pe._pe_geog_to_proj(t._pe.getPointer(e),o,p);return P&&d(_,o,p,r),P}function _(e,t,o){return n(e,t,o,0)}function n(e,o,_,n){t._pe.ensureCache.prepare();const r=l(_),p=_===r,P=t._pe.ensureFloat64(r),s=t._pe._pe_proj_to_geog_center(t._pe.getPointer(e),o,P,n);return s&&d(_,o,P,p),s}e.geogToProj=o,e.projGeog=function(e,n,r,p){switch(p){case t.PeDefs.PE_TRANSFORM_P_TO_G:return _(e,n,r);case t.PeDefs.PE_TRANSFORM_G_TO_P:return o(e,n,r)}return 0},e.projToGeog=_,e.projToGeogCenter=n}(t.PeCSTransformations||(t.PeCSTransformations={})),t.PeDefs=void 0,(s=t.PeDefs||(t.PeDefs={})).init=function(){s.PE_BUFFER_MAX=t._pe.PeDefs.prototype.PE_BUFFER_MAX,s.PE_NAME_MAX=t._pe.PeDefs.prototype.PE_NAME_MAX,s.PE_MGRS_MAX=t._pe.PeDefs.prototype.PE_MGRS_MAX,s.PE_USNG_MAX=t._pe.PeDefs.prototype.PE_USNG_MAX,s.PE_DD_MAX=t._pe.PeDefs.prototype.PE_DD_MAX,s.PE_DDM_MAX=t._pe.PeDefs.prototype.PE_DDM_MAX,s.PE_DMS_MAX=t._pe.PeDefs.prototype.PE_DMS_MAX,s.PE_UTM_MAX=t._pe.PeDefs.prototype.PE_UTM_MAX,s.PE_PARM_MAX=t._pe.PeDefs.prototype.PE_PARM_MAX,s.PE_TYPE_NONE=t._pe.PeDefs.prototype.PE_TYPE_NONE,s.PE_TYPE_GEOGCS=t._pe.PeDefs.prototype.PE_TYPE_GEOGCS,s.PE_TYPE_PROJCS=t._pe.PeDefs.prototype.PE_TYPE_PROJCS,s.PE_TYPE_GEOGTRAN=t._pe.PeDefs.prototype.PE_TYPE_GEOGTRAN,s.PE_TYPE_COORDSYS=t._pe.PeDefs.prototype.PE_TYPE_COORDSYS,s.PE_TYPE_UNIT=t._pe.PeDefs.prototype.PE_TYPE_UNIT,s.PE_TYPE_LINUNIT=t._pe.PeDefs.prototype.PE_TYPE_LINUNIT,s.PE_STR_OPTS_NONE=t._pe.PeDefs.prototype.PE_STR_OPTS_NONE,s.PE_STR_AUTH_NONE=t._pe.PeDefs.prototype.PE_STR_AUTH_NONE,s.PE_STR_AUTH_TOP=t._pe.PeDefs.prototype.PE_STR_AUTH_TOP,s.PE_STR_NAME_CANON=t._pe.PeDefs.prototype.PE_STR_NAME_CANON,s.PE_STR_FMT_WKT=t._pe.PeDefs.prototype.PE_STR_FMT_WKT,s.PE_STR_FMT_WKT2=t._pe.PeDefs.prototype.PE_STR_FMT_WKT2,s.PE_PARM_X0=t._pe.PeDefs.prototype.PE_PARM_X0,s.PE_PARM_ND=t._pe.PeDefs.prototype.PE_PARM_ND,s.PE_TRANSFORM_1_TO_2=t._pe.PeDefs.prototype.PE_TRANSFORM_1_TO_2,s.PE_TRANSFORM_2_TO_1=t._pe.PeDefs.prototype.PE_TRANSFORM_2_TO_1,s.PE_TRANSFORM_P_TO_G=t._pe.PeDefs.prototype.PE_TRANSFORM_P_TO_G,s.PE_TRANSFORM_G_TO_P=t._pe.PeDefs.prototype.PE_TRANSFORM_G_TO_P,s.PE_HORIZON_RECT=t._pe.PeDefs.prototype.PE_HORIZON_RECT,s.PE_HORIZON_POLY=t._pe.PeDefs.prototype.PE_HORIZON_POLY,s.PE_HORIZON_LINE=t._pe.PeDefs.prototype.PE_HORIZON_LINE,s.PE_HORIZON_DELTA=t._pe.PeDefs.prototype.PE_HORIZON_DELTA},t.PeDouble=null,t.PeFactory=void 0,function(e){const o={},_={},n=e=>{const o=e.getType();switch(o){case t.PeDefs.PE_TYPE_GEOGCS:e=t._pe.castObject(e,t._pe.PeGeogcs);break;case t.PeDefs.PE_TYPE_PROJCS:e=t._pe.castObject(e,t._pe.PeProjcs);break;case t.PeDefs.PE_TYPE_GEOGTRAN:e=t._pe.castObject(e,t._pe.PeGeogtran);break;default:o&t.PeDefs.PE_TYPE_UNIT&&(e=t._pe.castObject(e,t._pe.PeUnit))}return e};function r(e,_){let r=null,p=o[e];if(p||(p={},o[e]=p),p.hasOwnProperty(String(_))&&(r=p[_],t._pe.compare(r,t._pe.NULL)&&(r=null)),!r){const o=t._pe.PeFactory.prototype.factoryByType(e,_);t._pe.compare(o,t._pe.NULL)||(r=n(o),p[_]=r)}return r}e.initialize=function(){t._pe.PeFactory.prototype.initialize(null)},e.coordsys=function(e){return r(t.PeDefs.PE_TYPE_COORDSYS,e)},e.factoryByType=r,e.fromString=function(e,o){let r=null,p=_[e];if(p||(p={},_[e]=p),p.hasOwnProperty(o)&&(r=p[o],t._pe.compare(r,t._pe.NULL)&&(r=null)),!r){const _=t._pe.PeFactory.prototype.fromString(e,o);t._pe.compare(_,t._pe.NULL)||(r=n(_),p[o]=r)}return r},e.geogcs=function(e){return r(t.PeDefs.PE_TYPE_GEOGCS,e)},e.geogtran=function(e){return r(t.PeDefs.PE_TYPE_GEOGTRAN,e)},e.getCode=function(e){return t._pe.PeFactory.prototype.getCode(e)},e.projcs=function(e){return r(t.PeDefs.PE_TYPE_PROJCS,e)},e.unit=function(e){return r(t.PeDefs.PE_TYPE_UNIT,e)}}(t.PeFactory||(t.PeFactory={})),t.PeGCSExtent=null,t.PeGTlistExtended=void 0,function(e){let o;e.init=function(){e.PE_GTLIST_OPTS_COMMON=t._pe.PeGTlistExtended.prototype.PE_GTLIST_OPTS_COMMON,o=t._pe._pe_getPeGTlistExtendedEntrySize()},e.getGTlist=function(e,_,n,r,p,P){let s=null;const i=new t._pe.PeInteger(P);try{const E=t._pe.PeGTlistExtended.prototype.getGTlist(e,_,n,r,p,i);if((P=i.val)&&(s=[E],P>1)){const e=t._pe.getPointer(E);for(let _=1;_<P;_++)s.push(t._pe.wrapPointer(e+o*_,t._pe.PeGTlistExtendedEntry))}}finally{t._pe.destroy(i)}return s}}(t.PeGTlistExtended||(t.PeGTlistExtended={})),t.PeGTlistExtendedEntry=void 0,(t.PeGTlistExtendedEntry||(t.PeGTlistExtendedEntry={})).destroy=function(e){if(e?.length){for(const t of e)f(t),t.getEntries().forEach((e=>{f(e);const t=e.getGeogtran();f(t),t.getParameters().forEach(f),[t.getGeogcs1(),t.getGeogcs2()].forEach((e=>{f(e);const t=e.getDatum();f(t),f(t.getSpheroid()),f(e.getPrimem()),f(e.getUnit())}))}));t._pe.PeGTlistExtendedEntry.prototype.Delete(e[0])}},t.PeGTTransformations=void 0,(t.PeGTTransformations||(t.PeGTTransformations={})).geogToGeog=function(e,o,_,n,r){t._pe.ensureCache.prepare();const p=l(_),P=_===p,s=t._pe.ensureFloat64(p);let i=0;n&&(i=t._pe.ensureFloat64(n));const E=t._pe._pe_geog_to_geog(t._pe.getPointer(e),o,s,i,r);return E&&d(_,o,s,P),E},t.PeLineType=void 0,(i=t.PeLineType||(t.PeLineType={})).geodesicCoordinate=function(e,o,_,n,r,p,P,s){t._pe.PeLineType.prototype.geodesic_coordinate(e,o,_,n,r,p,P,s)},i.geodeticCoordinate=function(e,o,_,n,r,p,P,s,i){t._pe.PeLineType.prototype.geodetic_coordinate(e,o,_,n,r,p,P,s,i)},i.geodeticDistance=function(e,o,_,n,r,p,P,s,i,E){t._pe.PeLineType.prototype.geodetic_distance(e,o,_,n,r,p,P,s,i,E)},i.greatEllipticDistance=function(e,o,_,n,r,p,P,s,i){t._pe.PeLineType.prototype.great_elliptic_distance(e,o,_,n,r,p,P,s,i)},t.PeMath=void 0,(E=t.PeMath||(t.PeMath={})).phiToEta=function(e,o){return t._pe.PeMath.prototype.phi_to_eta(e,o)},E.etaToPhi=function(e,o){return t._pe.PeMath.prototype.eta_to_phi(e,o)},E.phiToPhig=function(e,o){return t._pe.PeMath.prototype.phi_to_phig(e,o)},E.q=function(e,o,_){return t._pe.PeMath.prototype.q(e,o,_)},E.q90=function(e,o){return t._pe.PeMath.prototype.q90(e,o)},t.PeNotationDms=void 0,function(e){const o=(e,o,_,n,r,p)=>{let P,s;switch(t._pe.ensureCache.prepare(),e){case"dd":P=t._pe._pe_geog_to_dd,s=t.PeDefs.PE_DD_MAX;break;case"ddm":P=t._pe._pe_geog_to_ddm,s=t.PeDefs.PE_DDM_MAX;break;case"dms":P=t._pe._pe_geog_to_dms,s=t.PeDefs.PE_DMS_MAX}let i=0;o&&(i=t._pe.getPointer(o));const E=l(n),a=t._pe.ensureFloat64(E),u=g(_,s),c=P(i,_,a,r,t._pe.ensureInt32(u));if(c)for(let e=0;e<_;e++)p[e]=t._pe.UTF8ToString(u[e]);return c},_=(e,o,_,n,r)=>{let p;switch(t._pe.ensureCache.prepare(),e){case"dd":p=t._pe._pe_dd_to_geog;break;case"ddm":p=t._pe._pe_ddm_to_geog;break;case"dms":p=t._pe._pe_dms_to_geog}let P=0;o&&(P=t._pe.getPointer(o));const s=n.map((e=>t._pe.ensureString(e))),i=t._pe.ensureInt32(s),E=t._pe.ensureFloat64(new Array(2*_)),a=p(P,_,i,E);return a&&d(r,_,E),a};e.geogToDms=function(e,t,_,n,r){return o("dms",e,t,_,n,r)},e.dmsToGeog=function(e,t,o,n){return _("dms",e,t,o,n)},e.geogToDdm=function(e,t,_,n,r){return o("ddm",e,t,_,n,r)},e.ddmToGeog=function(e,t,o,n){return _("ddm",e,t,o,n)},e.geogToDd=function(e,t,_,n,r){return o("dd",e,t,_,n,r)},e.ddToGeog=function(e,t,o,n){return _("dd",e,t,o,n)}}(t.PeNotationDms||(t.PeNotationDms={})),t.PeNotationMgrs=void 0,(a=t.PeNotationMgrs||(t.PeNotationMgrs={})).init=function(){a.PE_MGRS_STYLE_NEW=t._pe.PeNotationMgrs.prototype.PE_MGRS_STYLE_NEW,a.PE_MGRS_STYLE_OLD=t._pe.PeNotationMgrs.prototype.PE_MGRS_STYLE_OLD,a.PE_MGRS_STYLE_AUTO=t._pe.PeNotationMgrs.prototype.PE_MGRS_STYLE_AUTO,a.PE_MGRS_180_ZONE_1_PLUS=t._pe.PeNotationMgrs.prototype.PE_MGRS_180_ZONE_1_PLUS,a.PE_MGRS_ADD_SPACES=t._pe.PeNotationMgrs.prototype.PE_MGRS_ADD_SPACES},a.geogToMgrsExtended=function(e,o,_,n,r,p,P){t._pe.ensureCache.prepare();let s=0;e&&(s=t._pe.getPointer(e));const i=l(_),E=t._pe.ensureFloat64(i),a=g(o,t.PeDefs.PE_MGRS_MAX),u=t._pe.ensureInt32(a),c=t._pe._pe_geog_to_mgrs_extended(s,o,E,n,r,p,u);if(c)for(let e=0;e<o;e++)P[e]=t._pe.UTF8ToString(a[e]);return c},a.mgrsToGeogExtended=function(e,o,_,n,r){t._pe.ensureCache.prepare();let p=0;e&&(p=t._pe.getPointer(e));const P=_.map((e=>t._pe.ensureString(e))),s=t._pe.ensureInt32(P),i=t._pe.ensureFloat64(new Array(2*o)),E=t._pe._pe_mgrs_to_geog_extended(p,o,s,n,i);return E&&d(r,o,i),E},t.PeNotationUsng=void 0,(u=t.PeNotationUsng||(t.PeNotationUsng={})).geogToUsng=function(e,o,_,n,r,p,P){t._pe.ensureCache.prepare();let s=0;e&&(s=t._pe.getPointer(e));const i=l(_),E=t._pe.ensureFloat64(i),a=g(o,t.PeDefs.PE_MGRS_MAX),u=t._pe.ensureInt32(a),c=t._pe._pe_geog_to_usng(s,o,E,n,r,p,u);if(c)for(let e=0;e<o;e++)P[e]=t._pe.UTF8ToString(a[e]);return c},u.usngToGeog=function(e,o,_,n){t._pe.ensureCache.prepare();let r=0;e&&(r=t._pe.getPointer(e));const p=_.map((e=>t._pe.ensureString(e))),P=t._pe.ensureInt32(p),s=t._pe.ensureFloat64(new Array(2*o)),i=t._pe._pe_usng_to_geog(r,o,P,s);return i&&d(n,o,s),i},t.PeNotationUtm=void 0,(c=t.PeNotationUtm||(t.PeNotationUtm={})).init=function(){c.PE_UTM_OPTS_NONE=t._pe.PeNotationUtm.prototype.PE_UTM_OPTS_NONE,c.PE_UTM_OPTS_ADD_SPACES=t._pe.PeNotationUtm.prototype.PE_UTM_OPTS_ADD_SPACES,c.PE_UTM_OPTS_NS=t._pe.PeNotationUtm.prototype.PE_UTM_OPTS_NS},c.geogToUtm=function(e,o,_,n,r){t._pe.ensureCache.prepare();let p=0;e&&(p=t._pe.getPointer(e));const P=l(_),s=t._pe.ensureFloat64(P),i=g(o,t.PeDefs.PE_UTM_MAX),E=t._pe.ensureInt32(i),a=t._pe._pe_geog_to_utm(p,o,s,n,E);if(a)for(let e=0;e<o;e++)r[e]=t._pe.UTF8ToString(i[e]);return a},c.utmToGeog=function(e,o,_,n,r){t._pe.ensureCache.prepare();let p=0;e&&(p=t._pe.getPointer(e));const P=_.map((e=>t._pe.ensureString(e))),s=t._pe.ensureInt32(P),i=t._pe.ensureFloat64(new Array(2*o)),E=t._pe._pe_utm_to_geog(p,o,s,n,i);return E&&d(r,o,i),E},t.PePCSInfo=void 0,function(e){const o=new Map;e.init=function(){e.PE_PCSINFO_OPTION_NONE=t._pe.PePCSInfo.prototype.PE_PCSINFO_OPTION_NONE,e.PE_PCSINFO_OPTION_DOMAIN=t._pe.PePCSInfo.prototype.PE_PCSINFO_OPTION_DOMAIN,e.PE_POLE_OUTSIDE_BOUNDARY=t._pe.PePCSInfo.prototype.PE_POLE_OUTSIDE_BOUNDARY,e.PE_POLE_POINT=t._pe.PePCSInfo.prototype.PE_POLE_POINT},e.generate=function(_,n=e.PE_PCSINFO_OPTION_DOMAIN){let r=null,p=null;return o.has(_)&&(p=o.get(_),p[n]&&(r=p[n])),r||(r=t._pe.PePCSInfo.prototype.generate(_,n),p||(p=[],o.set(_,p)),p[n]=r),r}}(t.PePCSInfo||(t.PePCSInfo={})),t.PeVersion=void 0,(t.PeVersion||(t.PeVersion={})).versionString=function(){return t._pe.PeVersion.prototype.version_string()};const S=Object.freeze(Object.defineProperty({__proto__:null,get PeCSTransformations(){return t.PeCSTransformations},get PeDefs(){return t.PeDefs},get PeDouble(){return t.PeDouble},get PeFactory(){return t.PeFactory},get PeGCSExtent(){return t.PeGCSExtent},get PeGTTransformations(){return t.PeGTTransformations},get PeGTlistExtended(){return t.PeGTlistExtended},get PeGTlistExtendedEntry(){return t.PeGTlistExtendedEntry},get PeLineType(){return t.PeLineType},get PeMath(){return t.PeMath},get PeNotationDms(){return t.PeNotationDms},get PeNotationMgrs(){return t.PeNotationMgrs},get PeNotationUsng(){return t.PeNotationUsng},get PeNotationUtm(){return t.PeNotationUtm},get PePCSInfo(){return t.PePCSInfo},get PeVersion(){return t.PeVersion},_init:T,get _pe(){return t._pe},isLoaded:r,isSupported:p,load:P},Symbol.toStringTag,{value:"Module"}));t._init=T,t.isLoaded=r,t.isSupported=p,t.load=P,t.pe=S}));