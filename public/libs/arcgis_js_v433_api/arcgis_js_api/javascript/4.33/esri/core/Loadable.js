// All material copyright Esri, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.33/esri/copyright.txt for details.
//>>built
define(["exports","../chunks/tslib.es6","./Error","./maybe","./Promise","./promiseUtils","./Warning","./accessorSupport/decorators/property","./accessorSupport/decorators/subclass"],(function(t,o,e,r,s,l,a,d,n){"use strict";const i="loaded",c=t=>{let s=class extends t{constructor(...t){super(...t),this._loadController=null,this.loadError=null,this.loadStatus="not-loaded",this._set("loadWarnings",[]),this.addResolvingPromise(new Promise((t=>{const o=this.load.bind(this);this.load=r=>{const s=new Promise(((t,o)=>{const s=l.onAbortOrThrow(r,o);this.destroyed&&o(new e("load:instance-destroyed",`Instance of '${this.declaredClass||this.constructor.name}' is already destroyed`,{instance:this})),this.when(t,o).finally((()=>{s&&s.remove()}))}));if("not-loaded"===this.loadStatus){this._set("loadStatus","loading");const t=this._loadController=new AbortController;o({signal:t.signal})}return t(),s}}))),this.when((()=>{this._set("loadStatus",i),this._loadController=null}),(t=>{this._set("loadStatus","failed"),this._set("loadError",t),this._loadController=null}))}destroy(){this._loadController&&(this._loadController=r.abortMaybe(this._loadController),this._promiseProps.abort()),this._set("loadError",null),this._set("loadWarnings",[])}get loaded(){return this.loadStatus===i}get loadWarnings(){return this._get("loadWarnings")}load(){return null}cancelLoad(){return this.isFulfilled()||(this._set("loadError",new e("load:cancelled","Cancelled")),this._loadController?.abort(),this._promiseProps.abort()),this}};return o.__decorate([d.property({readOnly:!0})],s.prototype,"loaded",null),o.__decorate([d.property({readOnly:!0})],s.prototype,"loadError",void 0),o.__decorate([d.property({clonable:!1})],s.prototype,"loadStatus",void 0),o.__decorate([d.property({type:[a],readOnly:!0})],s.prototype,"loadWarnings",null),s=o.__decorate([n.subclass("esri.core.Loadable")],s),s};var u;return t.default=class extends(c(s)){},t.default=o.__decorate([n.subclass("esri.core.Loadable")],t.default),(u=t.default||(t.default={})).LoadableMixin=c,u.isLoadable=function(t){return!(!t||!t.load)},t.default}));