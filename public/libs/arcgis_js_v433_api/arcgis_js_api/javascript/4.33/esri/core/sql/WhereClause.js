// All material copyright Esri, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.33/esri/copyright.txt for details.
//>>built
require({cache:{"esri/core/sql/AggregateFunctions":function(){define(["exports","./DateOnly","./errorSupport","./SqlTimestampOffset","./TimeOnly","../../chunks/datetime"],(function(e,t,r,n,a,o){"use strict";const i={min:{minParams:1,maxParams:1,evaluate:e=>u(e[0],"min")},max:{minParams:1,maxParams:1,evaluate:e=>u(e[0],"max")},avg:{minParams:1,maxParams:1,evaluate:e=>l(e[0])},sum:{minParams:1,maxParams:1,evaluate:e=>function(e){if(null===e)return null;let t=0;for(let n=0;n<e.length;n++){const a=e[n];if(null!==a){if(!s(a))throw new r.SqlError(r.SqlErrorCodes.InvalidValueForAggregateFunction);t+=a}}return t}(e[0])},stddev:{minParams:1,maxParams:1,evaluate:e=>function(e){if(null===e)return null;const t=c(e);return null===t?null:Math.sqrt(t)}(e[0])},count:{minParams:1,maxParams:1,evaluate:e=>null==e[0]?null:e[0].length},var:{minParams:1,maxParams:1,evaluate:e=>c(e[0])}};function l(e){if(null===e)return null;let t=0,n=0;for(let a=0;a<e.length;a++){const o=e[a];if(null!==o){if(!s(o))throw new r.SqlError(r.SqlErrorCodes.InvalidValueForAggregateFunction);n++,t+=o}}return 0===n?null:t/e.length}function s(e){return"number"==typeof e}function u(e,r){if(null===e)return null;let i=null,l=null;for(const s of e){let e=s;e=t.DateOnly.isDateOnly(s)||a.TimeOnly.isTimeOnly(s)?s.toNumber():o.DateTime.isDateTime(s)?s.toMillis():n.SqlTimeStampOffset.isTimestampOffset(s)?s.toMilliseconds():s,(null===i||"max"===r&&null!==l&&null!==e&&l<=e||"min"===r&&null!==l&&null!==e&&l>=e)&&(i=s,l=e)}return i}function c(e){if(null===e)return null;if(0===(e=e.filter((e=>null!==e))).length)return null;const t=l(e);if(null===t)return null;let n=0;for(const a of e){if(!s(a))throw new r.SqlError(r.SqlErrorCodes.InvalidValueForAggregateFunction);n+=(t-a)**2}return n/(e.length-1)}e.aggregateFunction=function(e,t){const n=i[e.toLowerCase()];if(null==n)throw new r.SqlError(r.SqlErrorCodes.FunctionNotRecognized);if(t.length<n.minParams||t.length>n.maxParams)throw new r.SqlError(r.SqlErrorCodes.InvalidParameterCount,{name:e.toUpperCase()});return n.evaluate(t)},e.isAggregate=function(e,t){const r=i[e.toLowerCase()];return null!=r&&t>=r.minParams&&t<=r.maxParams},Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})}))},"esri/core/sql/errorSupport":function(){define(["exports","../string"],(function(e,t){"use strict";var r;e.SqlErrorCodes=void 0,(r=e.SqlErrorCodes||(e.SqlErrorCodes={})).InvalidFunctionParameters="InvalidFunctionParameters",r.InvalidValueForAggregateFunction="InvalidValueForAggregateFunction",r.UnsupportedSqlFunction="UnsupportedSqlFunction",r.UnsupportedOperator="UnsupportedOperator",r.UnsupportedSyntax="UnsupportedSyntax",r.UnsupportedIsRhs="UnsupportedIsRhs",r.UnsupportedIsLhs="UnsupportedIsLhs",r.InvalidDataType="InvalidDataType",r.CannotCastValue="CannotCastValue",r.FunctionNotRecognized="FunctionNotRecognized",r.InvalidTime="InvalidTime",r.InvalidParameterCount="InvalidParameterCount",r.InvalidTimeStamp="InvalidTimeStamp",r.InvalidDate="InvalidDate",r.InvalidOperator="InvalidOperator",r.IllegalInterval="IllegalInterval",r.YearMonthIntervals="YearMonthIntervals",r.PrimarySecondaryQualifiers="PrimarySecondaryQualifiers",r.MissingStatisticParameters="MissingStatisticParameters";const n={[e.SqlErrorCodes.InvalidValueForAggregateFunction]:"Invalid value used in aggregate function",[e.SqlErrorCodes.MissingStatisticParameters]:"Statistic does not have 1 or 0 Parameters",[e.SqlErrorCodes.InvalidFunctionParameters]:"Invalid parameters for call to {function}",[e.SqlErrorCodes.UnsupportedIsLhs]:"Unsupported left hand expression in is statement",[e.SqlErrorCodes.UnsupportedIsRhs]:"Unsupported right hand expression in is statement",[e.SqlErrorCodes.UnsupportedOperator]:"Unsupported operator - {operator}",[e.SqlErrorCodes.UnsupportedSyntax]:"Unsupported syntax - {node}",[e.SqlErrorCodes.UnsupportedSqlFunction]:"Sql function not found = {function}",[e.SqlErrorCodes.InvalidDataType]:"Invalid sql data type",[e.SqlErrorCodes.InvalidDate]:"Invalid date encountered",[e.SqlErrorCodes.InvalidOperator]:"Invalid operator encountered",[e.SqlErrorCodes.InvalidTime]:"Invalid time encountered",[e.SqlErrorCodes.IllegalInterval]:"Illegal interval",[e.SqlErrorCodes.FunctionNotRecognized]:"Function not recognized",[e.SqlErrorCodes.InvalidTimeStamp]:"Invalid timestamp encountered",[e.SqlErrorCodes.InvalidParameterCount]:"Invalid parameter count for call to {name}",[e.SqlErrorCodes.PrimarySecondaryQualifiers]:"Primary and Secondary SqlInterval qualifiers not supported",[e.SqlErrorCodes.YearMonthIntervals]:"Year-Month Intervals not supported",[e.SqlErrorCodes.CannotCastValue]:"Cannot cast value to the required data type"};class a extends Error{constructor(e,r){super(t.replace(n[e],r)),this.declaredRootClass="esri.arcade.featureset.support.sqlerror",Error.captureStackTrace&&Error.captureStackTrace(this,a)}}e.SqlError=a,e.sqlErrorMessages=n,Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})}))},"esri/core/sql/SqlTimestampOffset":function(){define(["exports","../../chunks/datetime"],(function(e,t){"use strict";function r(e){return Number.isNaN(e)||0===e?e:Math.trunc(e)}const n="esri.core.sql.SqlTimeStampOffset";class a{constructor(e){this._timeStampOffset=e,this.declaredRootClass=n,this._date=null}static isTimestampOffset(e){return"object"==typeof e&&null!=e&&"declaredRootClass"in e&&e.declaredRootClass===n}toDateTime(){return this._date??=t.DateTime.fromISO(this._timeStampOffset,{setZone:!0}),this._date}get isValid(){return this.toDateTime().isValid}get timezoneOffsetHour(){return r(this.toDateTime().offset/60)}get timezoneOffsetMinutes(){return r(this.toDateTime().offset%60)}toMilliseconds(){return this.toDateTime().toMillis()}get hour(){return this.toDateTime().hour}get minute(){return this.toDateTime().minute}get second(){return this.toDateTime().second}get day(){return this.toDateTime().day}get month(){return this.toDateTime().month}get year(){return this.toDateTime().year}startOfDay(){return a.fromDateTime(this.toDateTime().startOf("day"))}static fromJSDate(e){return new a(t.DateTime.fromJSDate(e).toISO({includeOffset:!0}))}static fromDateTime(e){return new a(e.toISO({includeOffset:!0}))}static fromParts(e,t,r=0,n=0,o=0,i=0,l=0,s=!1,u=0,c=0){const d=`${e.toString().padStart(4,"0")}-${t.toString().padStart(2,"0")}-${r.toString().padStart(2,"0")}`;let m="";i<10&&(m="0");let f=`${n.toString().padStart(2,"0")}:${o.toString().padStart(2,"0")}:${m+i.toString()}`;0!==l&&(f+="."+l.toString().padStart(3,"0"));const p=`${s?"-":"+"}${u.toString().padStart(2,"0")}:${c.toString().padStart(2,"0")}`;return new a(d+"T"+f+p)}toStorageFormat(){return this._timeStampOffset}toString(){return this._timeStampOffset}toSQLValue(){let e=this.toDateTime().toSQL({includeOffset:!0,includeOffsetSpace:!0});return e&&(e=e.replace(".000","")),e}toSQLWithKeyword(){return`timestamp '${this.toSQLValue()}'`}addMilliseconds(e){const t=this.toDateTime().plus(e);return a.fromDateTime(t)}}e.SqlTimeStampOffset=a,Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})}))},"esri/core/sql/sqlArithmeticUtils":function(){define(["exports","./errorSupport","./sqlDateParsingUtils","./SqlInterval","./StandardizedFunctions","../../support/guards"],(function(e,t,r,n,a,o){"use strict";function i(e,r,n){switch(n){case"+":return e+r;case"-":return e-r;case"*":return e*r;case"/":return e/r}throw new t.SqlError(t.SqlErrorCodes.InvalidOperator)}function l(e,r,n){switch(n){case"+":return r.plus({milliseconds:e.valueInMilliseconds()});case"-":return e.valueInMilliseconds()-r.toMillis()}throw new t.SqlError(t.SqlErrorCodes.InvalidOperator)}function s(e,r,n){if("+"===n)return r.plus("milliseconds",e.valueInMilliseconds());throw new t.SqlError(t.SqlErrorCodes.InvalidOperator)}function u(e,r,n){if("+"===n)return r.plus("milliseconds",e.valueInMilliseconds());throw new t.SqlError(t.SqlErrorCodes.InvalidOperator)}function c(e,r,n){switch(n){case"+":return e.plus("milliseconds",r.valueInMilliseconds());case"-":return e.plus("milliseconds",-1*r.valueInMilliseconds())}throw new t.SqlError(t.SqlErrorCodes.InvalidOperator)}function d(e,r,n){if("+"===n)return r.addMilliseconds(e.valueInMilliseconds());throw new t.SqlError(t.SqlErrorCodes.InvalidOperator)}function m(e,r,a){switch(a){case"+":return n.SqlInterval.createFromMilliseconds(e.valueInMilliseconds()+r.valueInMilliseconds());case"-":return n.SqlInterval.createFromMilliseconds(e.valueInMilliseconds()-r.valueInMilliseconds());case"*":return n.SqlInterval.createFromMilliseconds(e.valueInMilliseconds()*r.valueInMilliseconds());case"/":return n.SqlInterval.createFromMilliseconds(e.valueInMilliseconds()/r.valueInMilliseconds())}throw new t.SqlError(t.SqlErrorCodes.InvalidOperator)}function f(e,r,a){switch(a){case"+":return n.SqlInterval.createFromMilliseconds(e.valueInMilliseconds()+r);case"-":return n.SqlInterval.createFromMilliseconds(e.valueInMilliseconds()-r);case"*":return n.SqlInterval.createFromMilliseconds(e.valueInMilliseconds()*r);case"/":return n.SqlInterval.createFromMilliseconds(e.valueInMilliseconds()/r)}throw new t.SqlError(t.SqlErrorCodes.InvalidOperator)}function p(e,r,a){switch(a){case"+":return n.SqlInterval.createFromMilliseconds(e+r.valueInMilliseconds());case"-":return n.SqlInterval.createFromMilliseconds(e-r.valueInMilliseconds());case"*":return n.SqlInterval.createFromMilliseconds(e*r.valueInMilliseconds());case"/":return n.SqlInterval.createFromMilliseconds(e/r.valueInMilliseconds())}throw new t.SqlError(t.SqlErrorCodes.InvalidOperator)}function h(e,r,n){switch(n){case"+":return e.plus("milliseconds",r.valueInMilliseconds());case"-":return e.plus("milliseconds",-1*r.valueInMilliseconds())}throw new t.SqlError(t.SqlErrorCodes.InvalidOperator)}function S(e,r,n){switch(n){case"+":return e.plus({milliseconds:r.valueInMilliseconds()});case"-":return e.minus({milliseconds:r.valueInMilliseconds()})}throw new t.SqlError(t.SqlErrorCodes.InvalidOperator)}function v(e,r,n){switch(n){case"+":return e.addMilliseconds(r.valueInMilliseconds());case"-":return e.addMilliseconds(-1*r.valueInMilliseconds())}throw new t.SqlError(t.SqlErrorCodes.InvalidOperator)}function E(e,r,n){const a=1e3*r*24*60*60;switch(n){case"+":return e.plus({milliseconds:a});case"-":return e.minus({milliseconds:a})}throw new t.SqlError(t.SqlErrorCodes.InvalidOperator)}function w(e,r,n){const a=1e3*r*24*60*60;switch(n){case"+":return e.plus("milliseconds",a);case"-":return e.plus("milliseconds",-1*a)}throw new t.SqlError(t.SqlErrorCodes.InvalidOperator)}function T(e,r,n){const a=1e3*r*24*60*60;switch(n){case"+":return e.plus("milliseconds",a);case"-":return e.plus("milliseconds",-1*a)}throw new t.SqlError(t.SqlErrorCodes.InvalidOperator)}function q(e,r,n){throw new t.SqlError(t.SqlErrorCodes.InvalidOperator)}function y(e,r,n){const a=1e3*r*24*60*60;switch(n){case"+":return e.addMilliseconds(a);case"-":return e.addMilliseconds(-1*a)}throw new t.SqlError(t.SqlErrorCodes.InvalidOperator)}function I(e,r,n){throw new t.SqlError(t.SqlErrorCodes.InvalidOperator)}function g(e,r,n){throw new t.SqlError(t.SqlErrorCodes.InvalidOperator)}function O(e,r,n){throw new t.SqlError(t.SqlErrorCodes.InvalidOperator)}function C(e,r,n){const a=parseFloat(r);if(isNaN(a))throw new t.SqlError(t.SqlErrorCodes.InvalidOperator);return i(e,a,n)}function D(e,r,n){const a=parseFloat(e);if(isNaN(a))throw new t.SqlError(t.SqlErrorCodes.InvalidOperator);return i(a,r,n)}function N(e,r,n){if("+"===n)return e+r;throw new t.SqlError(t.SqlErrorCodes.InvalidOperator)}function x(e,r,n){throw new t.SqlError(t.SqlErrorCodes.InvalidOperator)}function b(e,r,n){throw new t.SqlError(t.SqlErrorCodes.InvalidOperator)}function A(e,r,n){if("-"===n)return e.toDateTimeLuxon(r.zone).diff(r).as("days");throw new t.SqlError(t.SqlErrorCodes.InvalidOperator)}function M(e,r,n){if("-"===n)return e.toDateTimeLuxon(r.toDateTime().zone).diff(r.toDateTime()).as("days");throw new t.SqlError(t.SqlErrorCodes.InvalidOperator)}function _(e,r,n){if("-"===n)return e.toDateTimeLuxon("UTC").diff(r.toDateTimeLuxon("UTC")).as("days");throw new t.SqlError(t.SqlErrorCodes.InvalidOperator)}function F(e,r,n){throw new t.SqlError(t.SqlErrorCodes.InvalidOperator)}function P(e,r,n){throw new t.SqlError(t.SqlErrorCodes.InvalidOperator)}function L(e,r,n){if("-"===n)return e.toDateTime().diff(r.toDateTimeLuxon(e.toDateTime().zone)).as("days");throw new t.SqlError(t.SqlErrorCodes.InvalidOperator)}function R(e,r,n){if("-"===n)return e.toDateTime().diff(r).as("days");throw new t.SqlError(t.SqlErrorCodes.InvalidOperator)}function U(e,r,n){if("-"===n)return e.toDateTime().diff(r.toDateTime()).as("days");throw new t.SqlError(t.SqlErrorCodes.InvalidOperator)}function $(e,r,n){throw new t.SqlError(t.SqlErrorCodes.InvalidOperator)}function k(e,r,n){throw new t.SqlError(t.SqlErrorCodes.InvalidOperator)}function V(e,r,n){throw new t.SqlError(t.SqlErrorCodes.InvalidOperator)}function z(e,r,n){throw new t.SqlError(t.SqlErrorCodes.InvalidOperator)}function Z(e,r,n){if("-"===n)return e.diff(r).as("days");throw new t.SqlError(t.SqlErrorCodes.InvalidOperator)}function H(e,r,n){if("-"===n)return e.diff(r.toDateTimeLuxon(e.zone)).as("days");throw new t.SqlError(t.SqlErrorCodes.InvalidOperator)}function j(e,r,n){if("-"===n)return e.diff(r.toDateTime()).as("days");throw new t.SqlError(t.SqlErrorCodes.InvalidOperator)}function W(e,r,n){throw new t.SqlError(t.SqlErrorCodes.InvalidOperator)}function Y(e,r,n){throw new t.SqlError(t.SqlErrorCodes.InvalidOperator)}function G(e,r,n){throw new t.SqlError(t.SqlErrorCodes.InvalidOperator)}function J(e,r,n){throw new t.SqlError(t.SqlErrorCodes.InvalidOperator)}function Q(e,r,n){throw new t.SqlError(t.SqlErrorCodes.InvalidOperator)}function B(e,r,n){throw new t.SqlError(t.SqlErrorCodes.InvalidOperator)}function K(e,r,n){throw new t.SqlError(t.SqlErrorCodes.InvalidOperator)}function X(e,r,n){throw new t.SqlError(t.SqlErrorCodes.InvalidOperator)}function ee(e,r,n){throw new t.SqlError(t.SqlErrorCodes.InvalidOperator)}e.calculateDateOnlyAndDateOnly=_,e.calculateDateOnlyAndDateTime=A,e.calculateDateOnlyAndNumber=w,e.calculateDateOnlyAndSqlInterval=h,e.calculateDateOnlyAndString=Y,e.calculateDateOnlyAndTimeOnly=F,e.calculateDateOnlyAndTimestamp=M,e.calculateDateTimeAndDateOnly=H,e.calculateDateTimeAndDateTime=Z,e.calculateDateTimeAndNumber=E,e.calculateDateTimeAndSqlInterval=S,e.calculateDateTimeAndString=J,e.calculateDateTimeAndTimeOnly=W,e.calculateDateTimeAndTimestamp=j,e.calculateNumberAndDateOnly=O,e.calculateNumberAndDateTime=q,e.calculateNumberAndNumber=i,e.calculateNumberAndSqlInterval=p,e.calculateNumberAndString=C,e.calculateNumberAndTimeOnly=g,e.calculateNumberAndTimestamp=I,e.calculateSqlIntervalAndDateOnly=u,e.calculateSqlIntervalAndDateTime=l,e.calculateSqlIntervalAndNumber=f,e.calculateSqlIntervalAndSqlInterval=m,e.calculateSqlIntervalAndString=x,e.calculateSqlIntervalAndTimeOnly=s,e.calculateSqlIntervalAndTimestamp=d,e.calculateStringAndDateOnly=K,e.calculateStringAndDateTime=X,e.calculateStringAndNumber=D,e.calculateStringAndSqlInterval=b,e.calculateStringAndString=N,e.calculateStringAndTimeOnly=B,e.calculateStringAndTimestamp=ee,e.calculateTimeOnlyAndDateOnly=k,e.calculateTimeOnlyAndDateTime=$,e.calculateTimeOnlyAndNumber=T,e.calculateTimeOnlyAndSqlInterval=c,e.calculateTimeOnlyAndString=G,e.calculateTimeOnlyAndTimeOnly=z,e.calculateTimeOnlyAndTimestamp=V,e.calculateTimestampAndDateOnly=L,e.calculateTimestampAndDateTime=R,e.calculateTimestampAndNumber=y,e.calculateTimestampAndSqlInterval=v,e.calculateTimestampAndString=Q,e.calculateTimestampAndTimeOnly=P,e.calculateTimestampAndTimestamp=U,e.sqlCalculateFunction=function(e,n,te,re){if("||"===e)return a.evaluateFunction("concat",[n,te],re);if(null===n||null===te)return null;if(o.isNumber(n)){if(o.isNumber(te))return i(n,te,e);if(r.isSqlInterval(te))return p(n,te,e);if(r.isTimeOnly(te))return g();if(r.isDateOnly(te))return O();if(r.isTimestampOffset(te))return I();if(r.isDateTime(te))return q();if(o.isString(te))return C(n,te,e);throw new t.SqlError(t.SqlErrorCodes.InvalidOperator)}if(r.isDateOnly(n)){if(o.isNumber(te))return w(n,te,e);if(r.isSqlInterval(te))return h(n,te,e);if(r.isTimeOnly(te))return F();if(r.isDateOnly(te))return _(n,te,e);if(r.isTimestampOffset(te))return M(n,te,e);if(r.isDateTime(te))return A(n,te,e);if(o.isString(te))return Y();throw new t.SqlError(t.SqlErrorCodes.InvalidOperator)}if(r.isTimeOnly(n)){if(o.isNumber(te))return T(n,te,e);if(r.isSqlInterval(te))return c(n,te,e);if(r.isTimeOnly(te))return z();if(r.isDateOnly(te))return k();if(r.isTimestampOffset(te))return V();if(r.isDateTime(te))return $();if(o.isString(te))return G();throw new t.SqlError(t.SqlErrorCodes.InvalidOperator)}if(r.isSqlInterval(n)){if(o.isNumber(te))return f(n,te,e);if(r.isSqlInterval(te))return m(n,te,e);if(r.isTimeOnly(te))return s(n,te,e);if(r.isDateOnly(te))return u(n,te,e);if(r.isTimestampOffset(te))return d(n,te,e);if(r.isDateTime(te))return l(n,te,e);if(o.isString(te))return x();throw new t.SqlError(t.SqlErrorCodes.InvalidOperator)}if(r.isDateTime(n)){if(o.isNumber(te))return E(n,te,e);if(r.isSqlInterval(te))return S(n,te,e);if(r.isTimeOnly(te))return W();if(r.isDateOnly(te))return H(n,te,e);if(r.isTimestampOffset(te))return j(n,te,e);if(r.isDateTime(te))return Z(n,te,e);if(o.isString(te))return J();throw new t.SqlError(t.SqlErrorCodes.InvalidOperator)}if(r.isTimestampOffset(n)){if(o.isNumber(te))return y(n,te,e);if(r.isSqlInterval(te))return v(n,te,e);if(r.isTimeOnly(te))return P();if(r.isDateOnly(te))return L(n,te,e);if(r.isTimestampOffset(te))return U(n,te,e);if(r.isDateTime(te))return R(n,te,e);if(o.isString(te))return Q();throw new t.SqlError(t.SqlErrorCodes.InvalidOperator)}if(o.isString(n)){if(o.isNumber(te))return D(n,te,e);if(r.isSqlInterval(te))return b();if(r.isTimeOnly(te))return B();if(r.isDateOnly(te))return K();if(r.isTimestampOffset(te))return ee();if(r.isDateTime(te))return X();if(o.isString(te))return N(n,te,e);throw new t.SqlError(t.SqlErrorCodes.InvalidOperator)}throw new t.SqlError(t.SqlErrorCodes.InvalidOperator)},Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})}))},"esri/core/sql/sqlDateParsingUtils":function(){define(["exports","./DateOnly","./errorSupport","./SqlInterval","./SqlTimestampOffset","./TimeOnly","./UnknownTimeZone","../../chunks/datetime"],(function(e,t,r,n,a,o,i,l){"use strict";const s=/^(\d{1,2}):(\d{1,2}):(\d{1,2})$/,u=/^(\d{1,2}):(\d{1,2})$/,c=/^(\d{1,2}):(\d{1,2}):(\d{1,2}).([0-9]+)$/,d=/^(\d{4})-(\d{1,2})-(\d{1,2})$/,m=/^(\d{4})-(\d{1,2})-(\d{1,2}) (\d{1,2}):(\d{1,2}):(\d{1,2})(\.[0-9]+)?$/,f=/^(\d{4})-(\d{1,2})-(\d{1,2}) (\d{1,2}):(\d{1,2}):(\d{1,2})(\.[0-9]+)?[ ]{0,1}(\+|-)(\d{1,2}):(\d{1,2})$/,p=/^(\d{4})-(\d{1,2})-(\d{1,2}) (\d{1,2}):(\d{1,2})?[ ]{0,1}(\+|-)(\d{1,2}):(\d{1,2})$/,h=/^(\d{4})-(\d{1,2})-(\d{1,2}) (\d{1,2}):(\d{1,2})$/;function S(e,t,n=!1){let o=m.exec(e);if(null!==o){const[,e,n,a,s,u,c,d]=o,m=l.DateTime.fromObject({year:parseInt(e,10),month:parseInt(n,10),day:parseInt(a,10),hour:parseInt(s,10),minute:parseInt(u,10),second:parseInt(c,10),millisecond:d?parseInt(d.replace(".",""),10):0},{zone:i.substituteUnknownTimezone(t)});if(!1===m.isValid)throw new r.SqlError(r.SqlErrorCodes.InvalidTimeStamp);return m}if(o=f.exec(e),null!==o){const[,e,t,n,i,l,s,u,c,d,m]=o,f=a.SqlTimeStampOffset.fromParts(parseInt(e,10),parseInt(t,10),parseInt(n,10),parseInt(i,10),parseInt(l,10),parseInt(s,10),u?parseInt(u.replace(".",""),10):0,"-"===c,parseInt(d,10),parseInt(m,10));if(!1===f.isValid)throw new r.SqlError(r.SqlErrorCodes.InvalidTimeStamp);return f}if(o=p.exec(e),null!==o){const[,e,t,n,i,l,s,u,c]=o,d=a.SqlTimeStampOffset.fromParts(parseInt(e,10),parseInt(t,10),parseInt(n,10),parseInt(i,10),parseInt(l,10),0,0,"-"===s,parseInt(u,10),parseInt(c,10));if(!1===d.isValid)throw new r.SqlError(r.SqlErrorCodes.InvalidTimeStamp);return d}if(o=h.exec(e),null!==o){const[,e,n,a,s,u]=o,c=l.DateTime.fromObject({year:parseInt(e,10),month:parseInt(n,10),day:parseInt(a,10),hour:parseInt(s,10),minute:parseInt(u,10),second:0},{zone:i.substituteUnknownTimezone(t)});if(!1===c.isValid)throw new r.SqlError(r.SqlErrorCodes.InvalidTimeStamp);return c}if(o=d.exec(e),null!==o){const[,e,n,a]=o,s=l.DateTime.fromObject({year:parseInt(e,10),month:parseInt(n,10),day:parseInt(a,10),hour:0,minute:0,second:0},{zone:i.substituteUnknownTimezone(t)});if(!1===s.isValid)throw new r.SqlError(r.SqlErrorCodes.InvalidTimeStamp);return s}throw new r.SqlError(r.SqlErrorCodes.InvalidTimeStamp)}e.convertToExecutingTimeZone=function(e,t){if(t instanceof l.Zone)return t===i.UnknownTimeZone.instance?l.DateTime.fromMillis(e.getTime(),{zone:i.UnknownTimeZone.instance}):l.DateTime.fromJSDate(e,{zone:t});switch(t){case"system":case"local":case null:return l.DateTime.fromJSDate(e);default:return"unknown"===t?.toLowerCase()?l.DateTime.fromMillis(e.getTime(),{zone:i.UnknownTimeZone.instance}):l.DateTime.fromJSDate(e,{zone:t})}},e.isDateOnly=function(e){return t.DateOnly.isDateOnly(e)},e.isDateTime=function(e){return l.DateTime.isDateTime(e)},e.isSqlInterval=function(e){return n.SqlInterval.isInterval(e)},e.isTimeOnly=function(e){return o.TimeOnly.isTimeOnly(e)},e.isTimestampOffset=function(e){return a.SqlTimeStampOffset.isTimestampOffset(e)},e.parseDate=function(e,n){const a=d.exec(e);if(null===a)try{return S(e,n)}catch{throw new r.SqlError(r.SqlErrorCodes.InvalidDate)}const[,o,i,l]=a,s=t.DateOnly.fromParts(parseInt(o,10),parseInt(i,10),parseInt(l,10));if(null===s)throw new r.SqlError(r.SqlErrorCodes.InvalidDate);return s},e.parseTime=function(e){let t=s.exec(e);if(null!==t){const[,e,n,a]=t,i=o.TimeOnly.fromParts(parseInt(e,10),parseInt(n,10),parseInt(a,10),0);if(null!==i)return i;throw new r.SqlError(r.SqlErrorCodes.InvalidTime)}if(t=u.exec(e),null!==t){const[,e,n]=t,a=o.TimeOnly.fromParts(parseInt(e,10),parseInt(n,10),0,0);if(null!==a)return a;throw new r.SqlError(r.SqlErrorCodes.InvalidTime)}if(t=c.exec(e),null!==t){const[,e,n,a,i]=t,l=o.TimeOnly.fromParts(parseInt(e,10),parseInt(n,10),parseInt(a,10),parseInt(i,10));if(null!==l)return l;throw new r.SqlError(r.SqlErrorCodes.InvalidTime)}throw new r.SqlError(r.SqlErrorCodes.InvalidTime)},e.parseTimestamp=S,Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})}))},"esri/core/sql/SqlInterval":function(){define(["exports","./errorSupport"],(function(e,t){"use strict";function r(e){if(null!==e.precision||null!==e.secondary)throw new t.SqlError(t.SqlErrorCodes.PrimarySecondaryQualifiers)}function n(e,t){if(t.includes(".")){const r=t.split(".");e.second=parseFloat(r[0]),e.millis=parseInt(r[1],10)}else e.second=parseFloat(t)}const a="esri.core.sql.SqlInterval";class o{constructor(){this.declaredRootClass=a,this.op="+",this.day=0,this.second=0,this.hour=0,this.month=0,this.year=0,this.minute=0,this.millis=0}static isInterval(e){return"object"==typeof e&&null!=e&&"declaredRootClass"in e&&e.declaredRootClass===a}static createFromMilliseconds(e){const t=new o;return t.second=e/1e3,t}static createFromValueAndQualifier(e,a,i){let l=null;const s=new o;if(s.op="-"===i?"-":"+","interval-period"===a.type){r(a);const o=new RegExp("^[0-9]{1,}$");if("year"===a.period||"month"===a.period)throw new t.SqlError(t.SqlErrorCodes.YearMonthIntervals);if("second"===a.period){if(!/^[0-9]{1,}([.]{1}[0-9]{1,}){0,1}$/.test(e))throw new t.SqlError(t.SqlErrorCodes.IllegalInterval);n(s,e)}else{if(!o.test(e))throw new t.SqlError(t.SqlErrorCodes.IllegalInterval);s[a.period]=parseFloat(e)}}else{if(r(a.start),r(a.end),"year"===a.start.period||"month"===a.start.period||"year"===a.end.period||"month"===a.end.period)throw new t.SqlError(t.SqlErrorCodes.YearMonthIntervals);switch(a.start.period){case"day":switch(a.end.period){case"hour":if(l=new RegExp("^[0-9]{1,} [0-9]{1,}$"),!l.test(e))throw new t.SqlError(t.SqlErrorCodes.IllegalInterval);s[a.start.period]=parseFloat(e.split(" ")[0]),s[a.end.period]=parseFloat(e.split(" ")[1]);break;case"minute":if(l=new RegExp("^[0-9]{1,} [0-9]{1,2}:[0-9]{1,}$"),!l.test(e))throw new t.SqlError(t.SqlErrorCodes.IllegalInterval);{s[a.start.period]=parseFloat(e.split(" ")[0]);const t=e.split(" ")[1].split(":");s.hour=parseFloat(t[0]),s.minute=parseFloat(t[1])}break;case"second":if(l=new RegExp("^[0-9]{1,} [0-9]{1,2}:[0-9]{1,2}:[0-9]{1,}([.]{1}[0-9]{1,}){0,1}$"),!l.test(e))throw new t.SqlError(t.SqlErrorCodes.IllegalInterval);{s[a.start.period]=parseFloat(e.split(" ")[0]);const t=e.split(" ")[1].split(":");s.hour=parseFloat(t[0]),s.minute=parseFloat(t[1]),n(s,t[2])}break;default:throw new t.SqlError(t.SqlErrorCodes.IllegalInterval)}break;case"hour":switch(a.end.period){case"minute":if(l=new RegExp("^[0-9]{1,}:[0-9]{1,}$"),!l.test(e))throw new t.SqlError(t.SqlErrorCodes.IllegalInterval);s.hour=parseFloat(e.split(":")[0]),s.minute=parseFloat(e.split(":")[1]);break;case"second":if(l=new RegExp("^[0-9]{1,}:[0-9]{1,2}:[0-9]{1,}([.]{1}[0-9]{1,}){0,1}$"),!l.test(e))throw new t.SqlError(t.SqlErrorCodes.IllegalInterval);{const t=e.split(":");s.hour=parseFloat(t[0]),s.minute=parseFloat(t[1]),n(s,t[2])}break;default:throw new t.SqlError(t.SqlErrorCodes.IllegalInterval)}break;case"minute":if("second"!==a.end.period)throw new t.SqlError(t.SqlErrorCodes.IllegalInterval);if(l=new RegExp("^[0-9]{1,}:[0-9]{1,}([.]{1}[0-9]{1,}){0,1}$"),!l.test(e))throw new t.SqlError(t.SqlErrorCodes.IllegalInterval);{const t=e.split(":");s.minute=parseFloat(t[0]),n(s,t[1])}break;default:throw new t.SqlError(t.SqlErrorCodes.IllegalInterval)}}return s}valueInMilliseconds(){return("-"===this.op?-1:1)*(this.millis+1e3*this.second+60*this.minute*1e3+60*this.hour*60*1e3+24*this.day*60*60*1e3+this.month*(365/12)*24*60*60*1e3+365*this.year*24*60*60*1e3)}}e.SqlInterval=o,Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})}))},"esri/core/sql/StandardizedFunctions":function(){define(["exports","../mathUtils","../string","./DateOnly","./errorSupport","./sqlCompareUtils","./sqlDateParsingUtils","./TimeOnly","../../support/guards","../../chunks/datetime"],(function(e,t,r,n,a,o,i,l,s,u){"use strict";function c(e){return!(s.isDate(e)||i.isDateOnly(e)||i.isDateTime(e)||i.isTimeOnly(e)||i.isTimestampOffset(e))}function d(e){return i.isDateOnly(e)||i.isTimeOnly(e)?e.toString():i.isTimestampOffset(e)?e.toSQLValue():i.isDateTime(e)?0===e.millisecond?e.toFormat("yyyy-LL-dd HH:mm:ss"):e.toSQL({includeOffset:!1}):s.isDate(e)?d(u.DateTime.fromJSDate(e)):e.toString()}const m={extract:{minParams:2,maxParams:2,evaluate:([e,t])=>{if(null==t)return null;if(s.isDate(t))switch(e.toUpperCase()){case"SECOND":return t.getSeconds();case"MINUTE":return t.getMinutes();case"HOUR":return t.getHours();case"DAY":return t.getDate();case"MONTH":return t.getMonth()+1;case"YEAR":return t.getFullYear();case"TIMEZONE_HOUR":case"TIMEZONE_MINUTE":return 0;case"DOW":return u.DateTime.fromJSDate(t,{zone:"system"}).weekday;case"DOY":return u.DateTime.fromJSDate(t,{zone:"system"}).ordinal;case"WEEK":return u.DateTime.fromJSDate(t,{zone:"system"}).weekNumber}else if(i.isDateTime(t))switch(e.toUpperCase()){case"SECOND":return t.second;case"MINUTE":return t.minute;case"HOUR":return t.hour;case"DAY":return t.day;case"MONTH":return t.month;case"YEAR":return t.year;case"TIMEZONE_HOUR":case"TIMEZONE_MINUTE":throw new a.SqlError(a.SqlErrorCodes.InvalidFunctionParameters,{function:"EXTRACT"});case"DOW":return t.weekday;case"DOY":return t.ordinal;case"WEEK":return t.weekNumber}else if(i.isDateOnly(t))switch(e.toUpperCase()){case"DAY":return t.day;case"MONTH":return t.month;case"YEAR":return t.year;case"TIMEZONE_HOUR":case"TIMEZONE_MINUTE":throw new a.SqlError(a.SqlErrorCodes.InvalidFunctionParameters,{function:"EXTRACT"});case"DOW":return t.toDateTime("unknown").weekday;case"DOY":return t.toDateTime("unknown").ordinal;case"WEEK":return t.toDateTime("unknown").weekNumber}else if(i.isTimeOnly(t))switch(e.toUpperCase()){case"SECOND":return t.second;case"MINUTE":return t.minute;case"HOUR":return t.hour}else if(i.isTimestampOffset(t))switch(e.toUpperCase()){case"SECOND":return t.second;case"MINUTE":return t.minute;case"HOUR":return t.hour;case"DAY":return t.day;case"MONTH":return t.month;case"YEAR":return t.year;case"TIMEZONE_HOUR":return t.timezoneOffsetHour;case"TIMEZONE_MINUTE":return t.timezoneOffsetMinutes;case"DOW":return t.toDateTime().weekday;case"DOY":return t.toDateTime().ordinal;case"WEEK":return t.toDateTime().weekNumber}throw new a.SqlError(a.SqlErrorCodes.InvalidFunctionParameters,{function:"EXTRACT"})}},substring:{minParams:2,maxParams:3,evaluate:e=>{if(2===e.length){const[t,r]=e;return null==t||null==r?null:t.toString().substring(r-1)}if(3===e.length){const[t,r,n]=e;return null==t||null==r||null==n?null:n<=0?"":t.toString().substring(r-1,r+n-1)}}},position:{minParams:2,maxParams:2,evaluate:([e,t])=>null==e||null==t?null:t.indexOf(e)+1},trim:{minParams:2,maxParams:3,evaluate:e=>{const t=3===e.length,n=t?e[1]:" ",o=t?e[2]:e[1];if(null==n||null==o)return null;const i=`(${r.escapeRegExpString(n)})`;switch(e[0]){case"BOTH":return o.replaceAll(new RegExp(`^${i}*|${i}*$`,"g"),"");case"LEADING":return o.replaceAll(new RegExp(`^${i}*`,"g"),"");case"TRAILING":return o.replaceAll(new RegExp(`${i}*$`,"g"),"")}throw new a.SqlError(a.SqlErrorCodes.InvalidFunctionParameters,{function:"TRIM"})}},abs:{minParams:1,maxParams:1,evaluate:e=>null==e[0]?null:Math.abs(e[0])},ceiling:{minParams:1,maxParams:1,evaluate:e=>null==e[0]?null:Math.ceil(e[0])},floor:{minParams:1,maxParams:1,evaluate:e=>null==e[0]?null:Math.floor(e[0])},log:{minParams:1,maxParams:1,evaluate:e=>null==e[0]?null:Math.log(e[0])},log10:{minParams:1,maxParams:1,evaluate:e=>null==e[0]?null:Math.log(e[0])*Math.LOG10E},sin:{minParams:1,maxParams:1,evaluate:e=>null==e[0]?null:Math.sin(e[0])},cos:{minParams:1,maxParams:1,evaluate:e=>null==e[0]?null:Math.cos(e[0])},tan:{minParams:1,maxParams:1,evaluate:e=>null==e[0]?null:Math.tan(e[0])},asin:{minParams:1,maxParams:1,evaluate:e=>null==e[0]?null:Math.asin(e[0])},acos:{minParams:1,maxParams:1,evaluate:e=>null==e[0]?null:Math.acos(e[0])},atan:{minParams:1,maxParams:1,evaluate:e=>null==e[0]?null:Math.atan(e[0])},sign:{minParams:1,maxParams:1,evaluate:e=>null==e[0]?null:e[0]>0?1:e[0]<0?-1:0},power:{minParams:2,maxParams:2,evaluate:e=>null==e[0]||null==e[1]?null:e[0]**e[1]},mod:{minParams:2,maxParams:2,evaluate:e=>null==e[0]||null==e[1]?null:e[0]%e[1]},round:{minParams:1,maxParams:2,evaluate:e=>{const t=e[0],r=2===e.length?10**e[1]:1;return null==t?null:Math.round(t*r)/r}},truncate:{minParams:1,maxParams:2,evaluate:e=>null==e[0]?null:1===e.length||0===e[1]?Math.trunc(e[0]):t.decimalAdjust("trunc",e[0],-Number(e[1]))},char_length:{minParams:1,maxParams:1,evaluate:e=>s.isString(e[0])?e[0].length:0},concat:{minParams:1,maxParams:1/0,evaluate:e=>{let t="";for(let r=0;r<e.length;r++){if(null==e[r])return null;t+=e[r].toString()}return t}},lower:{minParams:1,maxParams:1,evaluate:e=>null==e[0]?null:e[0].toString().toLowerCase()},upper:{minParams:1,maxParams:1,evaluate:e=>null==e[0]?null:e[0].toString().toUpperCase()},coalesce:{minParams:1,maxParams:1/0,evaluate:e=>{for(const t of e)if(null!==t)return t;return null}},cosh:{minParams:1,maxParams:1,evaluate:e=>null==e[0]?null:Math.cosh(e[0])},sinh:{minParams:1,maxParams:1,evaluate:e=>null==e[0]?null:Math.sinh(e[0])},tanh:{minParams:1,maxParams:1,evaluate:e=>null==e[0]?null:Math.tanh(e[0])},nullif:{minParams:2,maxParams:2,evaluate:e=>o.sqlCompare(e[0],e[1],"=")?null:e[0]},cast:{minParams:2,maxParams:2,evaluate:(e,t)=>{const r=e[0],o=e[1];if(null===r)return null;switch(o.type){case"integer":{if(!c(r))throw new a.SqlError(a.SqlErrorCodes.CannotCastValue);const e=parseInt(r,10);if(isNaN(e))throw new a.SqlError(a.SqlErrorCodes.CannotCastValue);return e}case"smallint":{if(!c(r))throw new a.SqlError(a.SqlErrorCodes.CannotCastValue);const e=parseInt(r,10);if(isNaN(e))throw new a.SqlError(a.SqlErrorCodes.CannotCastValue);if(e>32767||e<-32767)throw new a.SqlError(a.SqlErrorCodes.CannotCastValue);return e}case"float":case"real":{if(!c(r))throw new a.SqlError(a.SqlErrorCodes.CannotCastValue);const e=parseFloat(r);if(isNaN(e))throw new a.SqlError(a.SqlErrorCodes.CannotCastValue);return e}case"time":return function(e){if(s.isDate(e))return l.TimeOnly.fromDateJS(e);if(i.isDateTime(e))return l.TimeOnly.fromDateTime(e);if(i.isDateOnly(e))throw new a.SqlError(a.SqlErrorCodes.CannotCastValue);if(i.isTimeOnly(e))return e;if(i.isTimestampOffset(e))return l.TimeOnly.fromSqlTimeStampOffset(e);if(s.isString(e))return i.parseTime(e);throw new a.SqlError(a.SqlErrorCodes.CannotCastValue)}(r);case"date":return function(e){if(s.isDate(e))return n.DateOnly.fromDateJS(e);if(i.isDateTime(e))return n.DateOnly.fromParts(e.year,e.month,e.day);if(i.isDateOnly(e))return e;if(i.isTimeOnly(e))throw new a.SqlError(a.SqlErrorCodes.CannotCastValue);if(i.isTimestampOffset(e)&&null===n.DateOnly.fromParts(e.year,e.month,e.day))throw new a.SqlError(a.SqlErrorCodes.CannotCastValue);if(s.isString(e)){const t=n.DateOnly.fromReader(e);if(null!==t&&t.isValid)return t}throw new a.SqlError(a.SqlErrorCodes.CannotCastValue)}(r);case"timestamp":return function(e,t,r){if(s.isDate(e))return i.convertToExecutingTimeZone(e,t);if(i.isDateTime(e))return e;if(i.isDateOnly(e))return e.toDateTimeLuxon("unknown");if(i.isTimeOnly(e))throw new a.SqlError(a.SqlErrorCodes.CannotCastValue);if(i.isTimestampOffset(e))return e;if(s.isString(e))return i.parseTimestamp(e,"unknown",r);throw new a.SqlError(a.SqlErrorCodes.CannotCastValue)}(r,t,!0===o.withtimezone);case"varchar":{const e=d(r);if(e.length>o.size)throw new a.SqlError(a.SqlErrorCodes.CannotCastValue);return e}default:throw new a.SqlError(a.SqlErrorCodes.InvalidDataType)}}}};e.evaluateFunction=function(e,t,r){const n=m[e.toLowerCase()];if(null==n)throw new a.SqlError(a.SqlErrorCodes.FunctionNotRecognized);if(t.length<n.minParams||t.length>n.maxParams)throw new a.SqlError(a.SqlErrorCodes.InvalidParameterCount,{name:e.toUpperCase()});return n.evaluate(t,r)},e.isStandardized=function(e,t){const r=m[e.toLowerCase()];return null!=r&&t>=r.minParams&&t<=r.maxParams},Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})}))},"esri/core/sql/sqlCompareUtils":function(){define(["exports","./errorSupport","./sqlDateParsingUtils","./SqlTimestampOffset","./UnknownTimeZone","../../support/guards","../../chunks/datetime"],(function(e,t,r,n,a,o,i){"use strict";function l(e){return!!r.isDateTime(e)||!!r.isTimestampOffset(e)}function s(e){return!!(r.isDateTime(e)||r.isDateOnly(e)||r.isTimestampOffset(e)||r.isTimeOnly(e))}function u(e){if(r.isDateTime(e))return e.toMillis();if(r.isDateOnly(e))return e.toNumber();if(r.isTimestampOffset(e))return e.toMilliseconds();throw new t.SqlError(t.SqlErrorCodes.InvalidDataType)}function c(e,t,r){switch(r){case"<>":return e!==t;case"=":return e===t;case">":return e>t;case"<":return e<t;case">=":return e>=t;case"<=":return e<=t}}function d(e,t,r){n.SqlTimeStampOffset.isTimestampOffset(e)&&(e=e.toDateTime()),n.SqlTimeStampOffset.isTimestampOffset(t)&&(t=t.toDateTime());const a=m(e),o=m(t);switch(r){case"<>":return a!==o;case"=":return a===o;case">":return a>o;case"<":return a<o;case">=":return a>=o;case"<=":return a<=o}}function m(e){return 321408e5*e.year+26784e5*e.month+864e5*e.day+36e5*e.hour+6e4*e.minute+1e3*e.second+e.millisecond}e.dateValueInMilliseconds=u,e.isDateOrTimeValue=s,e.isDateTimeComparableValue=l,e.sqlCompare=function(e,m,f){if(null==e||null==m)return null;if(o.isNumber(e)){if(o.isNumber(m))return c(e,m,f);if(o.isString(m))return function(e,t,r){const n=parseFloat(t);if(!isNaN(n))return c(e,n,r);const a=e.toString();switch(r){case"<>":return a!==t;case"=":return a===t;case">":return a>t;case"<":return a<t;case">=":return a>=t;case"<=":return a<=t}}(e,m,f);if(s(m))throw new t.SqlError(t.SqlErrorCodes.InvalidOperator);if(r.isDateOnly(m))throw new t.SqlError(t.SqlErrorCodes.InvalidOperator)}else if(o.isString(e)){if(o.isNumber(m))return function(e,t,r){const n=parseFloat(e);if(!isNaN(n))return c(n,t,r);const a=t.toString();switch(r){case"<>":return e!==a;case"=":return e===a;case">":return e>a;case"<":return e<a;case">=":return e>=a;case"<=":return e<=a}}(e,m,f);if(o.isString(m))return function(e,t,r){switch(r){case"<>":return e!==t;case"=":return e===t;case">":return e>t;case"<":return e<t;case">=":return e>=t;case"<=":return e<=t}}(e,m,f);if(r.isDateTime(m))throw new t.SqlError(t.SqlErrorCodes.InvalidOperator);if(r.isDateOnly(m))throw new t.SqlError(t.SqlErrorCodes.InvalidOperator);if(r.isTimeOnly(m))throw new t.SqlError(t.SqlErrorCodes.InvalidOperator);if(r.isTimestampOffset(m))throw new t.SqlError(t.SqlErrorCodes.InvalidOperator)}else if(r.isDateTime(e)){if(l(m)){if(a.isUnknownTimeZone(e.zone)){if(i.DateTime.isDateTime(m)&&!a.isUnknownTimeZone(m.zone))return d(e,m,f);if(n.SqlTimeStampOffset.isTimestampOffset(m))return d(e,m,f)}else if(i.DateTime.isDateTime(m)&&a.isUnknownTimeZone(m.zone)){if(!a.isUnknownTimeZone(e.zone))return d(e,m,f);if(n.SqlTimeStampOffset.isTimestampOffset(e))return d(e,m,f)}return c(u(e),u(m),f)}if(o.isString(m))throw new t.SqlError(t.SqlErrorCodes.InvalidOperator);if(r.isDateOnly(m))return function(e,t,r){const n=t.toDateTimeLuxon(e.zone);return c((e=e.startOf("day")).toMillis(),n.toMillis(),r)}(e,m,f);if(r.isTimeOnly(m))throw new t.SqlError(t.SqlErrorCodes.InvalidOperator);if(o.isNumber(m))throw new t.SqlError(t.SqlErrorCodes.InvalidOperator)}else if(r.isDateOnly(e)){if(r.isTimestampOffset(m))return function(e,t,r){const n=e.toDateTimeLuxon(t.toDateTime().zone);return t=t.startOfDay(),c(n.toMillis(),t.toMilliseconds(),r)}(e,m,f);if(r.isDateTime(m))return function(e,t,r){const n=e.toDateTimeLuxon(t.zone);return t=t.startOf("day"),c(n.toMillis(),t.toMillis(),r)}(e,m,f);if(o.isString(m))throw new t.SqlError(t.SqlErrorCodes.InvalidOperator);if(r.isDateOnly(m))return c(e.toNumber(),m.toNumber(),f);if(r.isTimeOnly(m))throw new t.SqlError(t.SqlErrorCodes.InvalidOperator);if(o.isNumber(m))throw new t.SqlError(t.SqlErrorCodes.InvalidOperator)}else if(r.isTimeOnly(e)){if(r.isTimeOnly(m))return c(e.toNumber(),m.toNumber(),f);if(o.isString(m))throw new t.SqlError(t.SqlErrorCodes.InvalidOperator);if(o.isNumber(m))throw new t.SqlError(t.SqlErrorCodes.InvalidOperator);if(r.isDateOnly(m))throw new t.SqlError(t.SqlErrorCodes.InvalidOperator);if(l(m))throw new t.SqlError(t.SqlErrorCodes.InvalidOperator)}else if(r.isTimestampOffset(e)){if(l(m))return i.DateTime.isDateTime(m)&&a.isUnknownTimeZone(m.zone)?d(e,m,f):c(u(e),u(m),f);if(o.isString(m))throw new t.SqlError(t.SqlErrorCodes.InvalidOperator);if(r.isDateOnly(m))return function(e,t,r){const n=t.toDateTimeLuxon(e.toDateTime().zone);return c((e=e.startOfDay()).toMilliseconds(),n.toMillis(),r)}(e,m,f);if(r.isTimeOnly(m))throw new t.SqlError(t.SqlErrorCodes.InvalidOperator);if(o.isNumber(m))throw new t.SqlError(t.SqlErrorCodes.InvalidOperator)}switch(f){case"<>":return e!==m;case"=":return e===m;case">":return e>m;case"<":return e<m;case">=":return e>=m;case"<=":return e<=m}},Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})}))},"esri/core/sql/WhereGrammar":function(){define(["exports"],(function(e){"use strict";class t extends SyntaxError{constructor(e,t,r,n){super(e),this.expected=t,this.found=r,this.location=n,this.name="SyntaxError"}format(e){let t="Error: "+this.message;if(this.location){let r=null;const n=e.find((e=>e.source===this.location.source));n&&(r=n.text.split(/\r\n|\n|\r/g));const a=this.location.start,o=this.location.source&&"function"==typeof this.location.source.offset?this.location.source.offset(a):a,i=this.location.source+":"+o.line+":"+o.column;if(r){const e=this.location.end,n="".padEnd(o.line.toString().length," "),l=r[a.line-1],s=(a.line===e.line?e.column:l.length+1)-a.column||1;t+="\n --\x3e "+i+"\n"+n+" |\n"+o.line+" | "+l+"\n"+n+" | "+"".padEnd(a.column-1," ")+"".padEnd(s,"^")}else t+="\n at "+i}return t}static buildMessage(e,t){function r(e){return e.codePointAt(0).toString(16).toUpperCase()}const n=Object.prototype.hasOwnProperty.call(RegExp.prototype,"unicode")?new RegExp("[\\p{C}\\p{Mn}\\p{Mc}]","gu"):null;function a(e){return n?e.replace(n,(e=>"\\u{"+r(e)+"}")):e}function o(e){return a(e.replace(/\\/g,"\\\\").replace(/"/g,'\\"').replace(/\0/g,"\\0").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/[\x00-\x0F]/g,(e=>"\\x0"+r(e))).replace(/[\x10-\x1F\x7F-\x9F]/g,(e=>"\\x"+r(e))))}function i(e){return a(e.replace(/\\/g,"\\\\").replace(/\]/g,"\\]").replace(/\^/g,"\\^").replace(/-/g,"\\-").replace(/\0/g,"\\0").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/[\x00-\x0F]/g,(e=>"\\x0"+r(e))).replace(/[\x10-\x1F\x7F-\x9F]/g,(e=>"\\x"+r(e))))}const l={literal:e=>'"'+o(e.text)+'"',class(e){const t=e.parts.map((e=>Array.isArray(e)?i(e[0])+"-"+i(e[1]):i(e)));return"["+(e.inverted?"^":"")+t.join("")+"]"+(e.unicode?"u":"")},any:()=>"any character",end:()=>"end of input",other:e=>e.description};function s(e){return l[e.type](e)}return"Expected "+function(e){const t=e.map(s);if(t.sort(),t.length>0){let e=1;for(let r=1;r<t.length;r++)t[r-1]!==t[r]&&(t[e]=t[r],e++);t.length=e}switch(t.length){case 1:return t[0];case 2:return t[0]+" or "+t[1];default:return t.slice(0,-1).join(", ")+", or "+t[t.length-1]}}(e)+" but "+function(e){return e?'"'+o(e)+'"':"end of input"}(t)+" found."}}e.WhereGrammar=class{static parse(e){return function(e,r){const n={},a=(r=void 0!==r?r:{}).grammarSource,o={start:Tr};let i=Tr;const l="!",s="=",u=">=",c=">",d="<=",m="<>",f="!=",p="||",h="@",S="'",v="N'",E="''",w=".",T="null",q="true",y="false",I="in",g="is",O="like",C="escape",D="not",N="and",x="or",b="between",A="from",M="for",_="substring",F="extract",P="trim",L="position",R="timestamp",U="date",$="time",k="leading",V="trailing",z="both",Z="cast",H="as",j="integer",W="int",Y="smallint",G="float",J="real",Q="varchar",B="to",K="interval",X="year",ee="timezone_hour",te="timezone_minute",re="month",ne="day",ae="hour",oe="minute",ie="second",le="dow",se="doy",ue="week",ce="case",de="end",me="when",fe="then",pe="else",he=",",Se="(",ve=")",Ee="`",we=/^[<-=]/,Te=/^[+\-]/,qe=/^[*\/]/,ye=/^[A-Za-z_\x80-\uFFFF]/,Ie=/^[A-Za-z0-9_]/,ge=/^[A-Za-z0-9_.\x80-\uFFFF]/,Oe=/^["]/,Ce=/^[^']/,De=/^[0-9]/,Ne=/^[eE]/,xe=/^[ \t\n\r]/,be=/^[^`]/,Ae=hr("!",!1),Me=hr("=",!1),_e=hr(">=",!1),Fe=hr(">",!1),Pe=hr("<=",!1),Le=hr("<>",!1),Re=Sr([["<","="]],!1,!1,!1),Ue=hr("!=",!1),$e=Sr(["+","-"],!1,!1,!1),ke=hr("||",!1),Ve=Sr(["*","/"],!1,!1,!1),ze=Sr([["A","Z"],["a","z"],"_",["","￿"]],!1,!1,!1),Ze=Sr([["A","Z"],["a","z"],["0","9"],"_"],!1,!1,!1),He=Sr([["A","Z"],["a","z"],["0","9"],"_",".",["","￿"]],!1,!1,!1),je=Sr(['"'],!1,!1,!1),We=hr("@",!1),Ye=hr("'",!1),Ge=hr("N'",!1),Je=hr("''",!1),Qe=Sr(["'"],!0,!1,!1),Be=hr(".",!1),Ke=Sr([["0","9"]],!1,!1,!1),Xe=Sr(["e","E"],!1,!1,!1),et=hr("NULL",!0),tt=hr("TRUE",!0),rt=hr("FALSE",!0),nt=hr("IN",!0),at=hr("IS",!0),ot=hr("LIKE",!0),it=hr("ESCAPE",!0),lt=hr("NOT",!0),st=hr("AND",!0),ut=hr("OR",!0),ct=hr("BETWEEN",!0),dt=hr("FROM",!0),mt=hr("FOR",!0),ft=hr("SUBSTRING",!0),pt=hr("EXTRACT",!0),ht=hr("TRIM",!0),St=hr("POSITION",!0),vt=hr("TIMESTAMP",!0),Et=hr("DATE",!0),wt=hr("TIME",!0),Tt=hr("LEADING",!0),qt=hr("TRAILING",!0),yt=hr("BOTH",!0),It=hr("CAST",!0),gt=hr("AS",!0),Ot=hr("INTEGER",!0),Ct=hr("INT",!0),Dt=hr("SMALLINT",!0),Nt=hr("FLOAT",!0),xt=hr("REAL",!0),bt=hr("VARCHAR",!0),At=hr("TO",!0),Mt=hr("INTERVAL",!0),_t=hr("YEAR",!0),Ft=hr("TIMEZONE_HOUR",!0),Pt=hr("TIMEZONE_MINUTE",!0),Lt=hr("MONTH",!0),Rt=hr("DAY",!0),Ut=hr("HOUR",!0),$t=hr("MINUTE",!0),kt=hr("SECOND",!0),Vt=hr("DOW",!0),zt=hr("DOY",!0),Zt=hr("WEEK",!0),Ht=hr("CASE",!0),jt=hr("END",!0),Wt=hr("WHEN",!0),Yt=hr("THEN",!0),Gt=hr("ELSE",!0),Jt=hr(",",!1),Qt=hr("(",!1),Bt=hr(")",!1),Kt=Sr([" ","\t","\n","\r"],!1,!1,!1),Xt=hr("`",!1),er=Sr(["`"],!0,!1,!1);function tr(e,t,r){return{op:t,expr:r,location:fr()}}function rr(e,t,r){return{op:t,expr:r,location:fr()}}function nr(e,t){return{op:e,expr:t,location:fr()}}function ar(e,t,r){return{op:t,expr:r,location:fr()}}function or(e,t,r){return{op:t,expr:r,location:fr()}}let ir=0|r.peg$currPos,lr=ir;const sr=[{line:1,column:1}];let ur,cr=ir,dr=r.peg$maxFailExpected||[],mr=0|r.peg$silentFails;if(r.startRule){if(!(r.startRule in o))throw new Error("Can't start parsing from rule \""+r.startRule+'".');i=o[r.startRule]}function fr(){return Er(lr,ir)}function pr(e,r){throw function(e,r){return new t(e,null,null,r)}(e,r=void 0!==r?r:Er(lr,ir))}function hr(e,t){return{type:"literal",text:e,ignoreCase:t}}function Sr(e,t,r,n){return{type:"class",parts:e,inverted:t,ignoreCase:r,unicode:n}}function vr(t){let r,n=sr[t];if(n)return n;if(t>=sr.length)r=sr.length-1;else for(r=t;!sr[--r];);for(n=sr[r],n={line:n.line,column:n.column};r<t;)10===e.charCodeAt(r)?(n.line++,n.column=1):n.column++,r++;return sr[t]=n,n}function Er(e,t,r){const n=vr(e),o=vr(t);return{source:a,start:{offset:e,line:n.line,column:n.column},end:{offset:t,line:o.line,column:o.column}}}function wr(e){ir<cr||(ir>cr&&(cr=ir,dr=[]),dr.push(e))}function Tr(){let e,t;return e=ir,bn(),t=yr(),t!==n?(bn(),lr=e,e=t):(ir=e,e=n),e}function qr(){let e,t,r,a,o,i,l,s;if(e=ir,t=Nn(),t!==n){for(bn(),r=[],a=yr();a!==n;)r.push(a),a=ir,o=ir,i=bn(),l=Dn(),l!==n?(s=bn(),i=[i,l,s],o=i):(ir=o,o=n),o!==n?(o=yr(),o===n?(ir=a,a=n):a=o):a=o;a=bn(),o=xn(),o!==n?(lr=e,u=r,e={type:"expression-list",location:fr(),value:u}):(ir=e,e=n)}else ir=e,e=n;var u;return e}function yr(){let e,t,r,a,o,i;if(e=ir,t=Ir(),t!==n){for(r=[],a=ir,bn(),o=un(),o!==n?(bn(),i=Ir(),i!==n?(lr=a,a=tr(0,o,i)):(ir=a,a=n)):(ir=a,a=n);a!==n;)r.push(a),a=ir,bn(),o=un(),o!==n?(bn(),i=Ir(),i!==n?(lr=a,a=tr(0,o,i)):(ir=a,a=n)):(ir=a,a=n);lr=e,e=Fn(t,r)}else ir=e,e=n;return e}function Ir(){let e,t,r,a,o,i;if(e=ir,t=gr(),t!==n){for(r=[],a=ir,bn(),o=sn(),o!==n?(bn(),i=gr(),i!==n?(lr=a,a=rr(0,o,i)):(ir=a,a=n)):(ir=a,a=n);a!==n;)r.push(a),a=ir,bn(),o=sn(),o!==n?(bn(),i=gr(),i!==n?(lr=a,a=rr(0,o,i)):(ir=a,a=n)):(ir=a,a=n);lr=e,e=Fn(t,r)}else ir=e,e=n;return e}function gr(){let t,r,a,o,i;return t=ir,r=ln(),r===n&&(r=ir,33===e.charCodeAt(ir)?(a=l,ir++):(a=n,0===mr&&wr(Ae)),a!==n?(o=ir,mr++,61===e.charCodeAt(ir)?(i=s,ir++):(i=n,0===mr&&wr(Me)),mr--,i===n?o=void 0:(ir=o,o=n),o!==n?(a=[a,o],r=a):(ir=r,r=n)):(ir=r,r=n)),r!==n?(a=bn(),o=gr(),o!==n?(lr=t,t=function(e,t,r){return{type:"unary-expression",location:r,operator:"NOT",expr:t}}(0,o,fr())):(ir=t,t=n)):(ir=t,t=n),t===n&&(t=function(){let t,r,a,o;var i,l;return t=ir,r=Nr(),r!==n?(a=ir,bn(),o=function(){let t;return t=function(){let e,t,r,a,o;if(e=ir,t=[],r=ir,bn(),a=Or(),a!==n?(bn(),o=Nr(),o!==n?(lr=r,r=nr(a,o)):(ir=r,r=n)):(ir=r,r=n),r!==n)for(;r!==n;)t.push(r),r=ir,bn(),a=Or(),a!==n?(bn(),o=Nr(),o!==n?(lr=r,r=nr(a,o)):(ir=r,r=n)):(ir=r,r=n);else t=n;return t!==n&&(lr=e,t={type:"arithmetic",tail:t}),e=t,e}(),t===n&&(t=function(){let e,t,r;return e=ir,t=Dr(),t!==n?(bn(),r=qr(),r!==n?(lr=e,e={op:t,right:r}):(ir=e,e=n)):(ir=e,e=n),e===n&&(e=ir,t=Dr(),t!==n?(bn(),r=$r(),r!==n?(lr=e,e={op:t,right:r}):(ir=e,e=n)):(ir=e,e=n)),e}(),t===n&&(t=function(){let e,t,r,a,o,i,l,s;var u,c;return e=ir,t=ln(),t!==n?(bn(),r=cn(),r!==n?(a=bn(),o=ir,i=Nr(),i!==n?(bn(),l=sn(),l!==n?(bn(),s=Nr(),s!==n?(lr=o,u=i,c=s,o=_n(fr(),u,c)):(ir=o,o=n)):(ir=o,o=n)):(ir=o,o=n),o!==n?(lr=e,e={op:"NOT"+r,right:o}):(ir=e,e=n)):(ir=e,e=n)):(ir=e,e=n),e===n&&(e=ir,t=cn(),t!==n?(bn(),r=ir,a=Nr(),a!==n?(o=bn(),i=sn(),i!==n?(bn(),l=Nr(),l!==n?(lr=r,r=function(e,t,r){return _n(fr(),t,r)}(0,a,l)):(ir=r,r=n)):(ir=r,r=n)):(ir=r,r=n),r!==n?(lr=e,e={op:t,right:r}):(ir=e,e=n)):(ir=e,e=n)),e}(),t===n&&(t=function(){let e,t,r,a;return e=ir,t=an(),t!==n?(bn(),r=ln(),r!==n?(bn(),a=Nr(),a!==n?(lr=e,e={op:t+"NOT",right:a}):(ir=e,e=n)):(ir=e,e=n)):(ir=e,e=n),e===n&&(e=ir,t=an(),t!==n?(bn(),r=Nr(),r!==n?(lr=e,e={op:t,right:r}):(ir=e,e=n)):(ir=e,e=n)),e}(),t===n&&(t=function(){let t,r,a,o,i;return t=ir,r=Cr(),r!==n?(bn(),a=Yr(),a!==n?(bn(),o=function(){let t,r,a,o;return t=ir,r=e.substr(ir,6),r.toLowerCase()===C?ir+=6:(r=n,0===mr&&wr(it)),r!==n?(a=ir,mr++,o=Pr(),mr--,o===n?a=void 0:(ir=a,a=n),a!==n?(lr=t,t="ESCAPE"):(ir=t,t=n)):(ir=t,t=n),t}(),o!==n?(bn(),i=Gr(),i!==n?(lr=t,t={op:r,right:a,escape:i.value}):(ir=t,t=n)):(ir=t,t=n)):(ir=t,t=n)):(ir=t,t=n),t===n&&(t=ir,r=Cr(),r!==n?(bn(),a=Yr(),a!==n?(lr=t,t={op:r,right:a,escape:""}):(ir=t,t=n)):(ir=t,t=n)),t}())))),t}(),o!==n?a=o:(ir=a,a=n),a===n&&(a=null),lr=t,i=r,t=""==(l=a)||null==l||null==l?i:"arithmetic"==l.type?Fn(i,l.tail):Mn(l.op,i,l.right,l.escape,fr())):(ir=t,t=n),t}()),t}function Or(){let t;return e.substr(ir,2)===u?(t=u,ir+=2):(t=n,0===mr&&wr(_e)),t===n&&(62===e.charCodeAt(ir)?(t=c,ir++):(t=n,0===mr&&wr(Fe)),t===n&&(e.substr(ir,2)===d?(t=d,ir+=2):(t=n,0===mr&&wr(Pe)),t===n&&(e.substr(ir,2)===m?(t=m,ir+=2):(t=n,0===mr&&wr(Le)),t===n&&(t=e.charAt(ir),we.test(t)?ir++:(t=n,0===mr&&wr(Re)),t===n&&(e.substr(ir,2)===f?(t=f,ir+=2):(t=n,0===mr&&wr(Ue))))))),t}function Cr(){let e,t,r,a,o;var i;return e=ir,t=ir,r=ln(),r!==n?(a=bn(),o=on(),o!==n?(r=[r,a,o],t=r):(ir=t,t=n)):(ir=t,t=n),t!==n&&(lr=e,t=(i=t)[0]+" "+i[2]),e=t,e===n&&(e=on()),e}function Dr(){let e,t,r,a,o;var i;return e=ir,t=ir,r=ln(),r!==n?(a=bn(),o=nn(),o!==n?(r=[r,a,o],t=r):(ir=t,t=n)):(ir=t,t=n),t!==n&&(lr=e,t=(i=t)[0]+" "+i[2]),e=t,e===n&&(e=nn()),e}function Nr(){let e,t,r,a,o,i;if(e=ir,t=br(),t!==n){for(r=[],a=ir,bn(),o=xr(),o!==n?(bn(),i=br(),i!==n?(lr=a,a=ar(0,o,i)):(ir=a,a=n)):(ir=a,a=n);a!==n;)r.push(a),a=ir,bn(),o=xr(),o!==n?(bn(),i=br(),i!==n?(lr=a,a=ar(0,o,i)):(ir=a,a=n)):(ir=a,a=n);lr=e,e=Fn(t,r)}else ir=e,e=n;return e}function xr(){let t;return t=e.charAt(ir),Te.test(t)?ir++:(t=n,0===mr&&wr($e)),t===n&&(e.substr(ir,2)===p?(t=p,ir+=2):(t=n,0===mr&&wr(ke))),t}function br(){let e,t,r,a,o,i;if(e=ir,t=Mr(),t!==n){for(r=[],a=ir,bn(),o=Ar(),o!==n?(bn(),i=Mr(),i!==n?(lr=a,a=or(0,o,i)):(ir=a,a=n)):(ir=a,a=n);a!==n;)r.push(a),a=ir,bn(),o=Ar(),o!==n?(bn(),i=Mr(),i!==n?(lr=a,a=or(0,o,i)):(ir=a,a=n)):(ir=a,a=n);lr=e,e=Fn(t,r)}else ir=e,e=n;return e}function Ar(){let t;return t=e.charAt(ir),qe.test(t)?ir++:(t=n,0===mr&&wr(Ve)),t}function Mr(){let t,r,a,o;var i;return t=function(){let t;return t=Gr(),t===n&&(t=function(){let e,t,r,a;var o;return e=ir,t=function(){let e,t,r,a;return e=ir,t=Kr(),t!==n?(r=Xr(),r!==n?(a=en(),a!==n?(lr=e,e=parseFloat(t+r+a)):(ir=e,e=n)):(ir=e,e=n)):(ir=e,e=n),e===n&&(e=ir,t=Kr(),t!==n?(r=Xr(),r!==n?(lr=e,e=parseFloat(t+r)):(ir=e,e=n)):(ir=e,e=n),e===n&&(e=ir,t=Kr(),t!==n?(r=en(),r!==n?(lr=e,e=parseFloat(t+r)):(ir=e,e=n)):(ir=e,e=n),e===n&&(e=ir,t=Kr(),t!==n&&(lr=e,t=parseFloat(t)),e=t))),e}(),t!==n?(r=ir,mr++,a=Fr(),mr--,a===n?r=void 0:(ir=r,r=n),r!==n?(lr=e,o=t,e={type:"number",location:fr(),value:o}):(ir=e,e=n)):(ir=e,e=n),e}(),t===n&&(t=function(){let t,r;return t=ir,r=function(){let t,r,a,o;return t=ir,r=e.substr(ir,4),r.toLowerCase()===q?ir+=4:(r=n,0===mr&&wr(tt)),r!==n?(a=ir,mr++,o=Pr(),mr--,o===n?a=void 0:(ir=a,a=n),a!==n?(r=[r,a],t=r):(ir=t,t=n)):(ir=t,t=n),t}(),r!==n&&(lr=t,r={type:"boolean",location:fr(),value:!0}),t=r,t===n&&(t=ir,r=function(){let t,r,a,o;return t=ir,r=e.substr(ir,5),r.toLowerCase()===y?ir+=5:(r=n,0===mr&&wr(rt)),r!==n?(a=ir,mr++,o=Pr(),mr--,o===n?a=void 0:(ir=a,a=n),a!==n?(r=[r,a],t=r):(ir=t,t=n)):(ir=t,t=n),t}(),r!==n&&(lr=t,r={type:"boolean",location:fr(),value:!1}),t=r),t}(),t===n&&(t=function(){let t,r;return t=ir,r=function(){let t,r,a,o;return t=ir,r=e.substr(ir,4),r.toLowerCase()===T?ir+=4:(r=n,0===mr&&wr(et)),r!==n?(a=ir,mr++,o=Pr(),mr--,o===n?a=void 0:(ir=a,a=n),a!==n?(r=[r,a],t=r):(ir=t,t=n)):(ir=t,t=n),t}(),r!==n&&(lr=t,r={type:"null",location:fr(),value:null}),t=r,t}(),t===n&&(t=function(){let e,t,r;var a,o;return e=ir,t=pn(),t!==n?(bn(),r=Yr(),r!==n?(lr=e,"string"===(a=r).type&&(o=a.value,!0!==/^(\d{4})-(\d{1,2})-(\d{1,2})$|^(\d{4})-(\d{1,2})-(\d{1,2}) (\d{1,2}):(\d{1,2}):(\d{1,2})(\.[0-9]+)?$|^(\d{4})-(\d{1,2})-(\d{1,2}) (\d{1,2}):(\d{1,2}):(\d{1,2})(\.[0-9]+)?[ ]{0,1}(\+|\-)(\d{1,2}):(\d{1,2})$|^(\d{4})-(\d{1,2})-(\d{1,2}) (\d{1,2}):(\d{1,2})?[ ]{0,1}(\+|\-)(\d{1,2}):(\d{1,2})$|^(\d{4})-(\d{1,2})-(\d{1,2}) (\d{1,2}):(\d{1,2})$/.test(o)&&pr("Date literal is invalid")),e={type:"date",location:fr(),value:a.value}):(ir=e,e=n)):(ir=e,e=n),e}(),t===n&&(t=function(){let e,t,r;var a,o;return e=ir,t=fn(),t!==n?(bn(),r=Yr(),r!==n?(lr=e,"string"===(a=r).type&&(o=a.value,!0!==/^(\d{4})-(\d{1,2})-(\d{1,2})$|^(\d{4})-(\d{1,2})-(\d{1,2}) (\d{1,2}):(\d{1,2}):(\d{1,2})(\.[0-9]+)?$|^(\d{4})-(\d{1,2})-(\d{1,2}) (\d{1,2}):(\d{1,2}):(\d{1,2})(\.[0-9]+)?[ ]{0,1}(\+|\-)(\d{1,2}):(\d{1,2})$|^(\d{4})-(\d{1,2})-(\d{1,2}) (\d{1,2}):(\d{1,2})?[ ]{0,1}(\+|\-)(\d{1,2}):(\d{1,2})$|^(\d{4})-(\d{1,2})-(\d{1,2}) (\d{1,2}):(\d{1,2})$/.test(o)&&pr("Timestamp literal is invalid")),e={type:"timestamp",location:fr(),value:a.value}):(ir=e,e=n)):(ir=e,e=n),e}(),t===n&&(t=function(){let t,r,a,o,i;var l,s,u;return t=ir,r=Sn(),r!==n?(bn(),a=e.charAt(ir),Te.test(a)?ir++:(a=n,0===mr&&wr($e)),a!==n?(bn(),o=Yr(),o!==n?(bn(),i=Zr(),i!==n?(lr=t,l=a,s=o,u=i,t={type:"interval",location:fr(),value:s,qualifier:u,op:l}):(ir=t,t=n)):(ir=t,t=n)):(ir=t,t=n)):(ir=t,t=n),t===n&&(t=ir,r=Sn(),r!==n?(bn(),a=Yr(),a!==n?(bn(),o=Zr(),o!==n?(lr=t,t=function(e,t){return{type:"interval",location:fr(),value:e,qualifier:t,op:""}}(a,o)):(ir=t,t=n)):(ir=t,t=n)):(ir=t,t=n)),t}(),t===n&&(t=function(){let e,t,r;var a,o;return e=ir,t=hn(),t!==n?(bn(),r=Yr(),r!==n?(lr=e,"string"===(a=r).type&&(o=a.value,!0!==/^(\d{1,2}):(\d{1,2}):(\d{1,2})$|^(\d{1,2}):(\d{1,2})$|^(\d{1,2}):(\d{1,2}):(\d{1,2}).([0-9]+)$/.test(o)&&pr("Time literal is invalid")),e={type:"time",location:fr(),value:a.value}):(ir=e,e=n)):(ir=e,e=n),e}()))))))),t}(),t===n&&(t=function(){let e,t,r,a,o,i,l,s;var u,c,d;return e=ir,t=mn(),t!==n?(bn(),r=ir,a=Nn(),a!==n?(bn(),o=zr(),o!==n?(bn(),i=dn(),i!==n?(bn(),l=yr(),l!==n?(bn(),s=xn(),s!==n?(lr=r,c=o,d=l,r=_n(fr(),c,d)):(ir=r,r=n)):(ir=r,r=n)):(ir=r,r=n)):(ir=r,r=n)):(ir=r,r=n),r===n&&(r=ir,a=Nn(),a!==n?(bn(),o=zr(),o!==n?(bn(),i=Dn(),i!==n?(bn(),l=yr(),l!==n?(bn(),s=xn(),s!==n?(lr=r,r=function(e,t){return _n(fr(),e,t)}(o,l)):(ir=r,r=n)):(ir=r,r=n)):(ir=r,r=n)):(ir=r,r=n)):(ir=r,r=n)),r!==n?(lr=e,u=r,e={type:"function",location:fr(),name:"extract",args:u}):(ir=e,e=n)):(ir=e,e=n),e}(),t===n&&(t=function(){let t,r,a,o,i,l,s,u,c,d,m;var f,p,h,S;return t=ir,r=function(){let t,r,a,o;return t=ir,r=e.substr(ir,9),r.toLowerCase()===_?ir+=9:(r=n,0===mr&&wr(ft)),r!==n?(a=ir,mr++,o=Pr(),mr--,o===n?a=void 0:(ir=a,a=n),a!==n?(lr=t,t="SUBSTRING"):(ir=t,t=n)):(ir=t,t=n),t}(),r!==n?(bn(),a=ir,o=Nn(),o!==n?(bn(),i=yr(),i!==n?(bn(),l=dn(),l!==n?(bn(),s=yr(),s!==n?(bn(),u=ir,c=function(){let t,r,a,o;return t=ir,r=e.substr(ir,3),r.toLowerCase()===M?ir+=3:(r=n,0===mr&&wr(mt)),r!==n?(a=ir,mr++,o=Pr(),mr--,o===n?a=void 0:(ir=a,a=n),a!==n?(lr=t,t="FOR"):(ir=t,t=n)):(ir=t,t=n),t}(),c!==n?(d=bn(),m=yr(),m!==n?(bn(),u=m):(ir=u,u=n)):(ir=u,u=n),u===n&&(u=null),c=xn(),c!==n?(lr=a,p=i,h=s,S=u,a=_n(fr(),p,h,...S?[S]:[])):(ir=a,a=n)):(ir=a,a=n)):(ir=a,a=n)):(ir=a,a=n)):(ir=a,a=n),a===n&&(a=ir,o=Nn(),o!==n?(bn(),i=yr(),i!==n?(bn(),l=Dn(),l!==n?(bn(),s=yr(),s!==n?(bn(),u=Dn(),u!==n?(c=bn(),d=yr(),d!==n?(m=xn(),m!==n?(lr=a,a=function(e,t,r){return _n(fr(),e,t,r)}(i,s,d)):(ir=a,a=n)):(ir=a,a=n)):(ir=a,a=n)):(ir=a,a=n)):(ir=a,a=n)):(ir=a,a=n)):(ir=a,a=n)),a!==n?(lr=t,f=a,t={type:"function",location:fr(),name:"substring",args:f}):(ir=t,t=n)):(ir=t,t=n),t}(),t===n&&(t=function(){let t,r,a,o,i,l,s,u,c;var d,m,f,p;return t=ir,r=function(){let t,r,a,o;return t=ir,r=e.substr(ir,4),r.toLowerCase()===P?ir+=4:(r=n,0===mr&&wr(ht)),r!==n?(a=ir,mr++,o=Pr(),mr--,o===n?a=void 0:(ir=a,a=n),a!==n?(lr=t,t="TRIM"):(ir=t,t=n)):(ir=t,t=n),t}(),r!==n?(bn(),a=ir,o=Nn(),o!==n?(bn(),i=Vr(),bn(),l=yr(),l!==n?(bn(),s=dn(),s!==n?(bn(),u=yr(),u!==n?(bn(),c=xn(),c!==n?(lr=a,m=i,f=l,p=u,a=_n(fr(),m,f,p)):(ir=a,a=n)):(ir=a,a=n)):(ir=a,a=n)):(ir=a,a=n)):(ir=a,a=n),a===n&&(a=ir,o=Nn(),o!==n?(bn(),i=Vr(),bn(),l=yr(),l!==n?(bn(),s=xn(),s!==n?(lr=a,a=function(e,t){return _n(fr(),e,t)}(i,l)):(ir=a,a=n)):(ir=a,a=n)):(ir=a,a=n)),a!==n?(lr=t,d=a,t={type:"function",location:fr(),name:"trim",args:d}):(ir=t,t=n)):(ir=t,t=n),t}(),t===n&&(t=function(){let t,r,a,o,i,l,s,u;var c,d,m;return t=ir,r=function(){let t,r,a,o;return t=ir,r=e.substr(ir,8),r.toLowerCase()===L?ir+=8:(r=n,0===mr&&wr(St)),r!==n?(a=ir,mr++,o=Pr(),mr--,o===n?a=void 0:(ir=a,a=n),a!==n?(lr=t,t="POSITION"):(ir=t,t=n)):(ir=t,t=n),t}(),r!==n?(bn(),a=ir,o=Nn(),o!==n?(bn(),i=yr(),i!==n?(bn(),l=nn(),l!==n?(bn(),s=yr(),s!==n?(bn(),u=xn(),u!==n?(lr=a,d=i,m=s,a=_n(fr(),d,m)):(ir=a,a=n)):(ir=a,a=n)):(ir=a,a=n)):(ir=a,a=n)):(ir=a,a=n),a===n&&(a=ir,o=Nn(),o!==n?(bn(),i=yr(),i!==n?(bn(),l=Dn(),l!==n?(bn(),s=yr(),s!==n?(bn(),u=xn(),u!==n?(lr=a,a=function(e,t){return _n(fr(),e,t)}(i,s)):(ir=a,a=n)):(ir=a,a=n)):(ir=a,a=n)):(ir=a,a=n)):(ir=a,a=n)),a!==n?(lr=t,c=a,t={type:"function",location:fr(),name:"position",args:c}):(ir=t,t=n)):(ir=t,t=n),t}(),t===n&&(t=function(){let t,r,a,o,i,l,s,u;var c,d,m;return t=ir,r=function(){let t,r,a,o;return t=ir,r=e.substr(ir,4),r.toLowerCase()===Z?ir+=4:(r=n,0===mr&&wr(It)),r!==n?(a=ir,mr++,o=Pr(),mr--,o===n?a=void 0:(ir=a,a=n),a!==n?(lr=t,t="CAST"):(ir=t,t=n)):(ir=t,t=n),t}(),r!==n?(bn(),a=ir,o=Nn(),o!==n?(bn(),i=yr(),i!==n?(bn(),l=function(){let t,r,a,o;return t=ir,r=e.substr(ir,2),r.toLowerCase()===H?ir+=2:(r=n,0===mr&&wr(gt)),r!==n?(a=ir,mr++,o=Pr(),mr--,o===n?a=void 0:(ir=a,a=n),a!==n?(lr=t,t="AS"):(ir=t,t=n)):(ir=t,t=n),t}(),l!==n?(bn(),s=kr(),s!==n?(bn(),u=xn(),u!==n?(lr=a,d=i,m=s,a=_n(fr(),d,m)):(ir=a,a=n)):(ir=a,a=n)):(ir=a,a=n)):(ir=a,a=n)):(ir=a,a=n),a===n&&(a=ir,o=Nn(),o!==n?(bn(),i=yr(),i!==n?(bn(),l=Dn(),l!==n?(bn(),s=kr(),s!==n?(bn(),u=xn(),u!==n?(lr=a,a=function(e,t){return _n(fr(),e,t)}(i,s)):(ir=a,a=n)):(ir=a,a=n)):(ir=a,a=n)):(ir=a,a=n)):(ir=a,a=n)),a!==n?(lr=t,c=a,t={type:"function",location:fr(),name:"cast",args:c}):(ir=t,t=n)):(ir=t,t=n),t}(),t===n&&(t=function(){let t,r,a,o;var i,l;return t=ir,r=ir,mr++,a=mn(),mr--,a===n?r=void 0:(ir=r,r=n),r!==n?(a=function(){let t,r,a,o;if(t=ir,r=_r(),r!==n&&(lr=t),t=r,t===n)if(t=ir,96===e.charCodeAt(ir)?(r=Ee,ir++):(r=n,0===mr&&wr(Xt)),r!==n){if(a=[],o=e.charAt(ir),be.test(o)?ir++:(o=n,0===mr&&wr(er)),o!==n)for(;o!==n;)a.push(o),o=e.charAt(ir),be.test(o)?ir++:(o=n,0===mr&&wr(er));else a=n;a!==n?(96===e.charCodeAt(ir)?(o=Ee,ir++):(o=n,0===mr&&wr(Xt)),o!==n?(lr=t,t=a.join("")):(ir=t,t=n)):(ir=t,t=n)}else ir=t,t=n;return t}(),a!==n?(bn(),o=qr(),o!==n?(lr=t,i=a,l=o,t={type:"function",location:fr(),name:i,args:l}):(ir=t,t=n)):(ir=t,t=n)):(ir=t,t=n),t}(),t===n&&(t=function(){let e;return e=function(){let e,t,r,a,o,i,l;if(e=ir,t=In(),t!==n)if(bn(),r=yr(),r!==n){for(bn(),a=[],o=ir,i=Qr(),i!==n?(l=bn(),o=i):(ir=o,o=n);o!==n;)a.push(o),o=ir,i=Qr(),i!==n?(l=bn(),o=i):(ir=o,o=n);o=gn(),o!==n?(lr=e,s=r,u=a,e={type:"case-expression",location:fr(),format:"simple",operand:s,clauses:u,else:null,elseLocation:null}):(ir=e,e=n)}else ir=e,e=n;else ir=e,e=n;var s,u;if(e===n)if(e=ir,t=In(),t!==n)if(bn(),r=yr(),r!==n){for(bn(),a=[],o=ir,i=Qr(),i!==n?(l=bn(),o=i):(ir=o,o=n);o!==n;)a.push(o),o=ir,i=Qr(),i!==n?(l=bn(),o=i):(ir=o,o=n);o=Br(),o!==n?(i=bn(),l=gn(),l!==n?(lr=e,e=function(e,t,r){return{type:"case-expression",location:fr(),format:"simple",operand:e,clauses:t,else:r.value,elseLocation:r.location}}(r,a,o)):(ir=e,e=n)):(ir=e,e=n)}else ir=e,e=n;else ir=e,e=n;return e}(),e===n&&(e=function(){let e,t,r,a,o,i;if(e=ir,t=In(),t!==n){for(bn(),r=[],a=ir,o=Jr(),o!==n?(i=bn(),a=o):(ir=a,a=n);a!==n;)r.push(a),a=ir,o=Jr(),o!==n?(i=bn(),a=o):(ir=a,a=n);a=gn(),a!==n?(lr=e,l=r,e={type:"case-expression",location:fr(),format:"searched",clauses:l,else:null,elseLocation:null}):(ir=e,e=n)}else ir=e,e=n;var l;if(e===n)if(e=ir,t=In(),t!==n){for(bn(),r=[],a=ir,o=Jr(),o!==n?(i=bn(),a=o):(ir=a,a=n);a!==n;)r.push(a),a=ir,o=Jr(),o!==n?(i=bn(),a=o):(ir=a,a=n);a=Br(),a!==n?(o=bn(),i=gn(),i!==n?(lr=e,e=function(e,t){return{type:"case-expression",location:fr(),format:"searched",clauses:e,else:t.value,elseLocation:t.location}}(r,a)):(ir=e,e=n)):(ir=e,e=n)}else ir=e,e=n;return e}()),e}(),t===n&&(t=function(){let e,t;var r,a;return e=ir,t=function(){let e,t;return e=ir,t=function(){let e,t,r,a;if(e=ir,t=Fr(),t!==n){for(r=[],a=Lr();a!==n;)r.push(a),a=Lr();lr=e,e=t+r.join("")}else ir=e,e=n;return e}(),t!==n&&(lr=e),e=t,e}(),t!==n&&(lr=e,t=/^CURRENT_DATE$/i.test(r=t)?{type:"current-time",location:fr(),mode:"date"}:/^CURRENT_TIMESTAMP$/i.test(r)?{type:"current-time",location:fr(),mode:"timestamp"}:/^CURRENT_TIME$/i.test(r)?{type:"current-time",location:fr(),mode:"time"}:/^CURRENT_USER$/i.test(r)?{type:"current-user",location:fr()}:{type:"column-reference",location:fr(),table:"",column:r}),e=t,e===n&&(e=ir,t=function(){let e,t,r,a;return e=ir,t=Ur(),t!==n?(r=function(){let e,t,r;for(e=ir,t=[],r=Rr();r!==n;)t.push(r),r=Rr();return lr=e,t=t.join(""),e=t,e}(),a=Ur(),a!==n?(lr=e,e=r):(ir=e,e=n)):(ir=e,e=n),e}(),t!==n&&(lr=e,a=t,t={type:"column-reference",location:fr(),table:"",column:a,delimited:!0}),e=t),e}(),t===n&&(t=$r(),t===n&&(t=ir,r=Nn(),r!==n?(bn(),a=yr(),a!==n?(bn(),o=xn(),o!==n?(lr=t,(i=a).paren=!0,t=i):(ir=t,t=n)):(ir=t,t=n)):(ir=t,t=n))))))))))),t}function _r(){let e,t,r,a;if(e=ir,t=Fr(),t!==n){for(r=[],a=Pr();a!==n;)r.push(a),a=Pr();lr=e,e=t+r.join("")}else ir=e,e=n;return e}function Fr(){let t;return t=e.charAt(ir),ye.test(t)?ir++:(t=n,0===mr&&wr(ze)),t}function Pr(){let t;return t=e.charAt(ir),Ie.test(t)?ir++:(t=n,0===mr&&wr(Ze)),t}function Lr(){let t;return t=e.charAt(ir),ge.test(t)?ir++:(t=n,0===mr&&wr(He)),t}function Rr(){let t;return t=function(){let t;return t=e.charAt(ir),ge.test(t)?ir++:(t=n,0===mr&&wr(He)),t}(),t===n&&(t=function(){let e,t,r;return e=ir,t=Ur(),t!==n?(r=Ur(),r!==n?(lr=e,e='"'):(ir=e,e=n)):(ir=e,e=n),e}()),t}function Ur(){let t;return t=e.charAt(ir),Oe.test(t)?ir++:(t=n,0===mr&&wr(je)),t}function $r(){let t,r,a,o;var i;return t=ir,r=ir,64===e.charCodeAt(ir)?(a=h,ir++):(a=n,0===mr&&wr(We)),a!==n?(o=_r(),o!==n?(a=[a,o],r=a):(ir=r,r=n)):(ir=r,r=n),r!==n&&(lr=t,i=r,r={type:"parameter",location:fr(),value:i[1]}),t=r,t}function kr(){let t,r,a,o,i;var l;return t=ir,r=function(){let t,r,a,o;return t=ir,r=e.substr(ir,7),r.toLowerCase()===j?ir+=7:(r=n,0===mr&&wr(Ot)),r!==n?(a=ir,mr++,o=Pr(),mr--,o===n?a=void 0:(ir=a,a=n),a!==n?(lr=t,t="INTEGER"):(ir=t,t=n)):(ir=t,t=n),t}(),r===n&&(r=function(){let t,r,a,o;return t=ir,r=e.substr(ir,3),r.toLowerCase()===W?ir+=3:(r=n,0===mr&&wr(Ct)),r!==n?(a=ir,mr++,o=Pr(),mr--,o===n?a=void 0:(ir=a,a=n),a!==n?(lr=t,t="INT"):(ir=t,t=n)):(ir=t,t=n),t}()),r!==n&&(lr=t,r={type:"data-type",location:fr(),value:{type:"integer"}}),t=r,t===n&&(t=ir,r=function(){let t,r,a,o;return t=ir,r=e.substr(ir,8),r.toLowerCase()===Y?ir+=8:(r=n,0===mr&&wr(Dt)),r!==n?(a=ir,mr++,o=Pr(),mr--,o===n?a=void 0:(ir=a,a=n),a!==n?(lr=t,t="SMALLINT"):(ir=t,t=n)):(ir=t,t=n),t}(),r!==n&&(lr=t,r={type:"data-type",location:fr(),value:{type:"smallint"}}),t=r,t===n&&(t=ir,r=function(){let t,r,a,o;return t=ir,r=e.substr(ir,5),r.toLowerCase()===G?ir+=5:(r=n,0===mr&&wr(Nt)),r!==n?(a=ir,mr++,o=Pr(),mr--,o===n?a=void 0:(ir=a,a=n),a!==n?(lr=t,t="FLOAT"):(ir=t,t=n)):(ir=t,t=n),t}(),r!==n&&(lr=t,r={type:"data-type",location:fr(),value:{type:"float"}}),t=r,t===n&&(t=ir,r=function(){let t,r,a,o;return t=ir,r=e.substr(ir,4),r.toLowerCase()===J?ir+=4:(r=n,0===mr&&wr(xt)),r!==n?(a=ir,mr++,o=Pr(),mr--,o===n?a=void 0:(ir=a,a=n),a!==n?(lr=t,t="REAL"):(ir=t,t=n)):(ir=t,t=n),t}(),r!==n&&(lr=t,r={type:"data-type",location:fr(),value:{type:"real"}}),t=r,t===n&&(t=ir,r=pn(),r!==n&&(lr=t,r={type:"data-type",location:fr(),value:{type:"date"}}),t=r,t===n&&(t=ir,r=fn(),r!==n&&(lr=t,r={type:"data-type",location:fr(),value:{type:"timestamp"}}),t=r,t===n&&(t=ir,r=hn(),r!==n&&(lr=t,r={type:"data-type",location:fr(),value:{type:"time"}}),t=r,t===n&&(t=ir,r=function(){let t,r,a,o;return t=ir,r=e.substr(ir,7),r.toLowerCase()===Q?ir+=7:(r=n,0===mr&&wr(bt)),r!==n?(a=ir,mr++,o=Pr(),mr--,o===n?a=void 0:(ir=a,a=n),a!==n?(lr=t,t="VARCHAR"):(ir=t,t=n)):(ir=t,t=n),t}(),r!==n?(bn(),a=Nn(),a!==n?(bn(),o=tn(),o!==n?(bn(),i=xn(),i!==n?(lr=t,l=o,t={type:"data-type",location:fr(),value:{type:"varchar",size:parseInt(l)}}):(ir=t,t=n)):(ir=t,t=n)):(ir=t,t=n)):(ir=t,t=n)))))))),t}function Vr(){let t,r;var a;return t=ir,r=function(){let t,r,a,o;return t=ir,r=e.substr(ir,7),r.toLowerCase()===k?ir+=7:(r=n,0===mr&&wr(Tt)),r!==n?(a=ir,mr++,o=Pr(),mr--,o===n?a=void 0:(ir=a,a=n),a!==n?(lr=t,t="LEADING"):(ir=t,t=n)):(ir=t,t=n),t}(),r===n&&(r=function(){let t,r,a,o;return t=ir,r=e.substr(ir,8),r.toLowerCase()===V?ir+=8:(r=n,0===mr&&wr(qt)),r!==n?(a=ir,mr++,o=Pr(),mr--,o===n?a=void 0:(ir=a,a=n),a!==n?(lr=t,t="TRAILING"):(ir=t,t=n)):(ir=t,t=n),t}(),r===n&&(r=function(){let t,r,a,o;return t=ir,r=e.substr(ir,4),r.toLowerCase()===z?ir+=4:(r=n,0===mr&&wr(yt)),r!==n?(a=ir,mr++,o=Pr(),mr--,o===n?a=void 0:(ir=a,a=n),a!==n?(lr=t,t="BOTH"):(ir=t,t=n)):(ir=t,t=n),t}())),r===n&&(r=null),lr=t,a=r,r={type:"string",location:fr(),value:a??"BOTH"},t=r,t}function zr(){let t,r;var a;return t=ir,r=vn(),r===n&&(r=En(),r===n&&(r=wn(),r===n&&(r=Tn(),r===n&&(r=qn(),r===n&&(r=yn(),r===n&&(r=function(){let t,r,a,o;return t=ir,r=e.substr(ir,13),r.toLowerCase()===ee?ir+=13:(r=n,0===mr&&wr(Ft)),r!==n?(a=ir,mr++,o=Pr(),mr--,o===n?a=void 0:(ir=a,a=n),a!==n?(lr=t,t="TIMEZONE_HOUR"):(ir=t,t=n)):(ir=t,t=n),t}(),r===n&&(r=function(){let t,r,a,o;return t=ir,r=e.substr(ir,15),r.toLowerCase()===te?ir+=15:(r=n,0===mr&&wr(Pt)),r!==n?(a=ir,mr++,o=Pr(),mr--,o===n?a=void 0:(ir=a,a=n),a!==n?(lr=t,t="TIMEZONE_MINUTE"):(ir=t,t=n)):(ir=t,t=n),t}(),r===n&&(r=function(){let t,r,a,o;return t=ir,r=e.substr(ir,3),r.toLowerCase()===le?ir+=3:(r=n,0===mr&&wr(Vt)),r!==n?(a=ir,mr++,o=Pr(),mr--,o===n?a=void 0:(ir=a,a=n),a!==n?(lr=t,t="DOW"):(ir=t,t=n)):(ir=t,t=n),t}(),r===n&&(r=function(){let t,r,a,o;return t=ir,r=e.substr(ir,3),r.toLowerCase()===se?ir+=3:(r=n,0===mr&&wr(zt)),r!==n?(a=ir,mr++,o=Pr(),mr--,o===n?a=void 0:(ir=a,a=n),a!==n?(lr=t,t="DOY"):(ir=t,t=n)):(ir=t,t=n),t}(),r===n&&(r=function(){let t,r,a,o;return t=ir,r=e.substr(ir,4),r.toLowerCase()===ue?ir+=4:(r=n,0===mr&&wr(Zt)),r!==n?(a=ir,mr++,o=Pr(),mr--,o===n?a=void 0:(ir=a,a=n),a!==n?(lr=t,t="WEEK"):(ir=t,t=n)):(ir=t,t=n),t}())))))))))),r!==n&&(lr=t,a=r,r={type:"string",location:fr(),value:a}),t=r,t}function Zr(){let t,r,a,o;var i,l;return t=ir,r=function(){let e,t,r,a,o;var i,l;return e=ir,t=Hr(),t!==n?(bn(),r=Nn(),r!==n?(bn(),a=Wr(),a!==n?(bn(),o=xn(),o!==n?(lr=e,i=t,l=a,e={type:"interval-period",location:fr(),period:i.value,precision:l,secondary:null}):(ir=e,e=n)):(ir=e,e=n)):(ir=e,e=n)):(ir=e,e=n),e===n&&(e=ir,t=Hr(),t!==n&&(lr=e,t=function(e){return{type:"interval-period",location:fr(),period:e.value,precision:null,secondary:null}}(t)),e=t),e}(),r!==n?(bn(),a=function(){let t,r,a,o;return t=ir,r=e.substr(ir,2),r.toLowerCase()===B?ir+=2:(r=n,0===mr&&wr(At)),r!==n?(a=ir,mr++,o=Pr(),mr--,o===n?a=void 0:(ir=a,a=n),a!==n?(lr=t,t="TO"):(ir=t,t=n)):(ir=t,t=n),t}(),a!==n?(bn(),o=function(){let e,t,r,a,o,i,l;var s,u,c;return e=ir,t=Hr(),t!==n&&(lr=e,s=t,t={type:"interval-period",location:fr(),period:s.value,precision:null,secondary:null}),e=t,e===n&&(e=ir,t=yn(),t!==n?(bn(),r=Nn(),r!==n?(bn(),a=Wr(),a!==n?(bn(),o=Dn(),o!==n?(bn(),i=jr(),i!==n?(bn(),l=xn(),l!==n?(lr=e,u=a,c=i,e={type:"interval-period",location:fr(),period:"second",precision:u,secondary:c}):(ir=e,e=n)):(ir=e,e=n)):(ir=e,e=n)):(ir=e,e=n)):(ir=e,e=n)):(ir=e,e=n),e===n&&(e=ir,t=yn(),t!==n?(bn(),r=Nn(),r!==n?(bn(),a=Wr(),a!==n?(bn(),o=xn(),o!==n?(lr=e,e=function(e){return{type:"interval-period",location:fr(),period:"second",precision:e,secondary:null}}(a)):(ir=e,e=n)):(ir=e,e=n)):(ir=e,e=n)):(ir=e,e=n),e===n&&(e=ir,t=yn(),t!==n&&(lr=e,t={type:"interval-period",location:fr(),period:"second",precision:null,secondary:null}),e=t))),e}(),o!==n?(lr=t,i=r,l=o,t={type:"interval-qualifier",location:fr(),start:i,end:l}):(ir=t,t=n)):(ir=t,t=n)):(ir=t,t=n),t===n&&(t=function(){let e,t,r,a,o,i,l;var s,u;return e=ir,t=Hr(),t!==n?(bn(),r=Nn(),r!==n?(bn(),a=jr(),a!==n?(bn(),o=xn(),o!==n?(lr=e,s=t,u=a,e={type:"interval-period",location:fr(),period:s.value,precision:u,secondary:null}):(ir=e,e=n)):(ir=e,e=n)):(ir=e,e=n)):(ir=e,e=n),e===n&&(e=ir,t=Hr(),t!==n&&(lr=e,t=function(e){return{type:"interval-period",location:fr(),period:e.value,precision:null,secondary:null}}(t)),e=t,e===n&&(e=ir,t=yn(),t!==n?(bn(),r=Nn(),r!==n?(bn(),a=Wr(),a!==n?(bn(),o=Dn(),o!==n?(bn(),i=jr(),i!==n?(bn(),l=xn(),l!==n?(lr=e,e=function(e,t){return{type:"interval-period",location:fr(),period:"second",precision:e,secondary:t}}(a,i)):(ir=e,e=n)):(ir=e,e=n)):(ir=e,e=n)):(ir=e,e=n)):(ir=e,e=n)):(ir=e,e=n),e===n&&(e=ir,t=yn(),t!==n?(bn(),r=Nn(),r!==n?(bn(),a=jr(),a!==n?(bn(),o=xn(),o!==n?(lr=e,e=function(e){return{type:"interval-period",location:fr(),period:"second",precision:e,secondary:null}}(a)):(ir=e,e=n)):(ir=e,e=n)):(ir=e,e=n)):(ir=e,e=n),e===n&&(e=ir,t=yn(),t!==n&&(lr=e,t={type:"interval-period",location:fr(),period:"second",precision:null,secondary:null}),e=t)))),e}()),t}function Hr(){let e,t;return e=ir,t=wn(),t!==n&&(lr=e,t={type:"string",location:fr(),value:"day"}),e=t,e===n&&(e=ir,t=Tn(),t!==n&&(lr=e,t={type:"string",location:fr(),value:"hour"}),e=t,e===n&&(e=ir,t=qn(),t!==n&&(lr=e,t={type:"string",location:fr(),value:"minute"}),e=t,e===n&&(e=ir,t=En(),t!==n&&(lr=e,t={type:"string",location:fr(),value:"month"}),e=t,e===n&&(e=ir,t=vn(),t!==n&&(lr=e,t={type:"string",location:fr(),value:"year"}),e=t)))),e}function jr(){let e,t;return e=ir,t=tn(),t!==n&&(lr=e,t=parseFloat(t)),e=t,e}function Wr(){let e,t;return e=ir,t=tn(),t!==n&&(lr=e,t=parseFloat(t)),e=t,e}function Yr(){let e;return e=Gr(),e===n&&(e=$r()),e}function Gr(){let t,r,a,o,i;if(t=ir,39===e.charCodeAt(ir)?(r=S,ir++):(r=n,0===mr&&wr(Ye)),r===n&&(e.substr(ir,2)===v?(r=v,ir+=2):(r=n,0===mr&&wr(Ge))),r!==n){for(a=[],o=ir,e.substr(ir,2)===E?(i=E,ir+=2):(i=n,0===mr&&wr(Je)),i!==n&&(lr=o,i="'"),o=i,o===n&&(o=e.charAt(ir),Ce.test(o)?ir++:(o=n,0===mr&&wr(Qe)));o!==n;)a.push(o),o=ir,e.substr(ir,2)===E?(i=E,ir+=2):(i=n,0===mr&&wr(Je)),i!==n&&(lr=o,i="'"),o=i,o===n&&(o=e.charAt(ir),Ce.test(o)?ir++:(o=n,0===mr&&wr(Qe)));39===e.charCodeAt(ir)?(o=S,ir++):(o=n,0===mr&&wr(Ye)),o!==n?(lr=t,l=a,t={type:"string",location:fr(),value:l.join("")}):(ir=t,t=n)}else ir=t,t=n;var l;return t}function Jr(){let e,t,r,a,o;var i,l;return e=ir,t=On(),t!==n?(bn(),r=yr(),r!==n?(bn(),a=Cn(),a!==n?(bn(),o=yr(),o!==n?(lr=e,i=r,l=o,e={type:"when-clause",location:fr(),operand:i,value:l}):(ir=e,e=n)):(ir=e,e=n)):(ir=e,e=n)):(ir=e,e=n),e}function Qr(){let e,t,r,a,o;var i,l;return e=ir,t=On(),t!==n?(bn(),r=yr(),r!==n?(bn(),a=Cn(),a!==n?(bn(),o=yr(),o!==n?(lr=e,i=r,l=o,e={type:"when-clause",location:fr(),operand:i,value:l}):(ir=e,e=n)):(ir=e,e=n)):(ir=e,e=n)):(ir=e,e=n),e}function Br(){let t,r,a;var o;return t=ir,r=function(){let t,r,a,o;return t=ir,r=e.substr(ir,4),r.toLowerCase()===pe?ir+=4:(r=n,0===mr&&wr(Gt)),r!==n?(a=ir,mr++,o=Pr(),mr--,o===n?a=void 0:(ir=a,a=n),a!==n?(lr=t,t="ELSE"):(ir=t,t=n)):(ir=t,t=n),t}(),r!==n?(bn(),a=yr(),a!==n?(lr=t,o=a,t={type:"else-clause",location:fr(),value:o}):(ir=t,t=n)):(ir=t,t=n),t}function Kr(){let t,r,a;var o;return t=tn(),t===n&&(t=ir,r=e.charAt(ir),Te.test(r)?ir++:(r=n,0===mr&&wr($e)),r!==n?(a=tn(),a!==n?(lr=t,o=a,t=r[0]+o):(ir=t,t=n)):(ir=t,t=n)),t}function Xr(){let t,r,a;var o;return t=ir,46===e.charCodeAt(ir)?(r=w,ir++):(r=n,0===mr&&wr(Be)),r!==n?(a=tn(),a===n&&(a=null),lr=t,t="."+(null!=(o=a)?o:"")):(ir=t,t=n),t}function en(){let t,r,a;return t=ir,r=function(){let t,r,a;var o;return t=ir,r=e.charAt(ir),Ne.test(r)?ir++:(r=n,0===mr&&wr(Xe)),r!==n?(a=e.charAt(ir),Te.test(a)?ir++:(a=n,0===mr&&wr($e)),a===n&&(a=null),lr=t,t="e"+(null===(o=a)?"":o)):(ir=t,t=n),t}(),r!==n?(a=tn(),a!==n?(lr=t,t=r+a):(ir=t,t=n)):(ir=t,t=n),t}function tn(){let e,t,r;if(e=ir,t=[],r=rn(),r!==n)for(;r!==n;)t.push(r),r=rn();else t=n;return t!==n&&(lr=e,t=t.join("")),e=t,e}function rn(){let t;return t=e.charAt(ir),De.test(t)?ir++:(t=n,0===mr&&wr(Ke)),t}function nn(){let t,r,a,o;return t=ir,r=e.substr(ir,2),r.toLowerCase()===I?ir+=2:(r=n,0===mr&&wr(nt)),r!==n?(a=ir,mr++,o=Pr(),mr--,o===n?a=void 0:(ir=a,a=n),a!==n?(lr=t,t="IN"):(ir=t,t=n)):(ir=t,t=n),t}function an(){let t,r,a,o;return t=ir,r=e.substr(ir,2),r.toLowerCase()===g?ir+=2:(r=n,0===mr&&wr(at)),r!==n?(a=ir,mr++,o=Pr(),mr--,o===n?a=void 0:(ir=a,a=n),a!==n?(lr=t,t="IS"):(ir=t,t=n)):(ir=t,t=n),t}function on(){let t,r,a,o;return t=ir,r=e.substr(ir,4),r.toLowerCase()===O?ir+=4:(r=n,0===mr&&wr(ot)),r!==n?(a=ir,mr++,o=Pr(),mr--,o===n?a=void 0:(ir=a,a=n),a!==n?(lr=t,t="LIKE"):(ir=t,t=n)):(ir=t,t=n),t}function ln(){let t,r,a,o;return t=ir,r=e.substr(ir,3),r.toLowerCase()===D?ir+=3:(r=n,0===mr&&wr(lt)),r!==n?(a=ir,mr++,o=Pr(),mr--,o===n?a=void 0:(ir=a,a=n),a!==n?(lr=t,t="NOT"):(ir=t,t=n)):(ir=t,t=n),t}function sn(){let t,r,a,o;return t=ir,r=e.substr(ir,3),r.toLowerCase()===N?ir+=3:(r=n,0===mr&&wr(st)),r!==n?(a=ir,mr++,o=Pr(),mr--,o===n?a=void 0:(ir=a,a=n),a!==n?(lr=t,t="AND"):(ir=t,t=n)):(ir=t,t=n),t}function un(){let t,r,a,o;return t=ir,r=e.substr(ir,2),r.toLowerCase()===x?ir+=2:(r=n,0===mr&&wr(ut)),r!==n?(a=ir,mr++,o=Pr(),mr--,o===n?a=void 0:(ir=a,a=n),a!==n?(lr=t,t="OR"):(ir=t,t=n)):(ir=t,t=n),t}function cn(){let t,r,a,o;return t=ir,r=e.substr(ir,7),r.toLowerCase()===b?ir+=7:(r=n,0===mr&&wr(ct)),r!==n?(a=ir,mr++,o=Pr(),mr--,o===n?a=void 0:(ir=a,a=n),a!==n?(lr=t,t="BETWEEN"):(ir=t,t=n)):(ir=t,t=n),t}function dn(){let t,r,a,o;return t=ir,r=e.substr(ir,4),r.toLowerCase()===A?ir+=4:(r=n,0===mr&&wr(dt)),r!==n?(a=ir,mr++,o=Pr(),mr--,o===n?a=void 0:(ir=a,a=n),a!==n?(lr=t,t="FROM"):(ir=t,t=n)):(ir=t,t=n),t}function mn(){let t,r,a,o;return t=ir,r=e.substr(ir,7),r.toLowerCase()===F?ir+=7:(r=n,0===mr&&wr(pt)),r!==n?(a=ir,mr++,o=Pr(),mr--,o===n?a=void 0:(ir=a,a=n),a!==n?(lr=t,t="EXTRACT"):(ir=t,t=n)):(ir=t,t=n),t}function fn(){let t,r,a,o;return t=ir,r=e.substr(ir,9),r.toLowerCase()===R?ir+=9:(r=n,0===mr&&wr(vt)),r!==n?(a=ir,mr++,o=Pr(),mr--,o===n?a=void 0:(ir=a,a=n),a!==n?(lr=t,t="TIMESTAMP"):(ir=t,t=n)):(ir=t,t=n),t}function pn(){let t,r,a,o;return t=ir,r=e.substr(ir,4),r.toLowerCase()===U?ir+=4:(r=n,0===mr&&wr(Et)),r!==n?(a=ir,mr++,o=Pr(),mr--,o===n?a=void 0:(ir=a,a=n),a!==n?(lr=t,t="DATE"):(ir=t,t=n)):(ir=t,t=n),t}function hn(){let t,r,a,o;return t=ir,r=e.substr(ir,4),r.toLowerCase()===$?ir+=4:(r=n,0===mr&&wr(wt)),r!==n?(a=ir,mr++,o=Pr(),mr--,o===n?a=void 0:(ir=a,a=n),a!==n?(lr=t,t="TIME"):(ir=t,t=n)):(ir=t,t=n),t}function Sn(){let t,r,a,o;return t=ir,r=e.substr(ir,8),r.toLowerCase()===K?ir+=8:(r=n,0===mr&&wr(Mt)),r!==n?(a=ir,mr++,o=Pr(),mr--,o===n?a=void 0:(ir=a,a=n),a!==n?(lr=t,t="INTERVAL"):(ir=t,t=n)):(ir=t,t=n),t}function vn(){let t,r,a,o;return t=ir,r=e.substr(ir,4),r.toLowerCase()===X?ir+=4:(r=n,0===mr&&wr(_t)),r!==n?(a=ir,mr++,o=Pr(),mr--,o===n?a=void 0:(ir=a,a=n),a!==n?(lr=t,t="YEAR"):(ir=t,t=n)):(ir=t,t=n),t}function En(){let t,r,a,o;return t=ir,r=e.substr(ir,5),r.toLowerCase()===re?ir+=5:(r=n,0===mr&&wr(Lt)),r!==n?(a=ir,mr++,o=Pr(),mr--,o===n?a=void 0:(ir=a,a=n),a!==n?(lr=t,t="MONTH"):(ir=t,t=n)):(ir=t,t=n),t}function wn(){let t,r,a,o;return t=ir,r=e.substr(ir,3),r.toLowerCase()===ne?ir+=3:(r=n,0===mr&&wr(Rt)),r!==n?(a=ir,mr++,o=Pr(),mr--,o===n?a=void 0:(ir=a,a=n),a!==n?(lr=t,t="DAY"):(ir=t,t=n)):(ir=t,t=n),t}function Tn(){let t,r,a,o;return t=ir,r=e.substr(ir,4),r.toLowerCase()===ae?ir+=4:(r=n,0===mr&&wr(Ut)),r!==n?(a=ir,mr++,o=Pr(),mr--,o===n?a=void 0:(ir=a,a=n),a!==n?(lr=t,t="HOUR"):(ir=t,t=n)):(ir=t,t=n),t}function qn(){let t,r,a,o;return t=ir,r=e.substr(ir,6),r.toLowerCase()===oe?ir+=6:(r=n,0===mr&&wr($t)),r!==n?(a=ir,mr++,o=Pr(),mr--,o===n?a=void 0:(ir=a,a=n),a!==n?(lr=t,t="MINUTE"):(ir=t,t=n)):(ir=t,t=n),t}function yn(){let t,r,a,o;return t=ir,r=e.substr(ir,6),r.toLowerCase()===ie?ir+=6:(r=n,0===mr&&wr(kt)),r!==n?(a=ir,mr++,o=Pr(),mr--,o===n?a=void 0:(ir=a,a=n),a!==n?(lr=t,t="SECOND"):(ir=t,t=n)):(ir=t,t=n),t}function In(){let t,r,a,o;return t=ir,r=e.substr(ir,4),r.toLowerCase()===ce?ir+=4:(r=n,0===mr&&wr(Ht)),r!==n?(a=ir,mr++,o=Pr(),mr--,o===n?a=void 0:(ir=a,a=n),a!==n?(lr=t,t="CASE"):(ir=t,t=n)):(ir=t,t=n),t}function gn(){let t,r,a,o;return t=ir,r=e.substr(ir,3),r.toLowerCase()===de?ir+=3:(r=n,0===mr&&wr(jt)),r!==n?(a=ir,mr++,o=Pr(),mr--,o===n?a=void 0:(ir=a,a=n),a!==n?(lr=t,t="END"):(ir=t,t=n)):(ir=t,t=n),t}function On(){let t,r,a,o;return t=ir,r=e.substr(ir,4),r.toLowerCase()===me?ir+=4:(r=n,0===mr&&wr(Wt)),r!==n?(a=ir,mr++,o=Pr(),mr--,o===n?a=void 0:(ir=a,a=n),a!==n?(lr=t,t="WHEN"):(ir=t,t=n)):(ir=t,t=n),t}function Cn(){let t,r,a,o;return t=ir,r=e.substr(ir,4),r.toLowerCase()===fe?ir+=4:(r=n,0===mr&&wr(Yt)),r!==n?(a=ir,mr++,o=Pr(),mr--,o===n?a=void 0:(ir=a,a=n),a!==n?(lr=t,t="THEN"):(ir=t,t=n)):(ir=t,t=n),t}function Dn(){let t;return 44===e.charCodeAt(ir)?(t=he,ir++):(t=n,0===mr&&wr(Jt)),t}function Nn(){let t;return 40===e.charCodeAt(ir)?(t=Se,ir++):(t=n,0===mr&&wr(Qt)),t}function xn(){let t;return 41===e.charCodeAt(ir)?(t=ve,ir++):(t=n,0===mr&&wr(Bt)),t}function bn(){let e,t;for(e=[],t=An();t!==n;)e.push(t),t=An();return e}function An(){let t;return t=e.charAt(ir),xe.test(t)?ir++:(t=n,0===mr&&wr(Kt)),t}function Mn(e,t,r,n,a){const o={type:"binary-expression",location:a,operator:e,left:t,right:r};return void 0!==n&&(o.escape=n),o}function _n(e,...t){return{type:"expression-list",location:e,value:t}}function Fn(e,t){let r=e;for(const{op:e,expr:n,location:{end:a}}of t)r=Mn(e,r,n,void 0,{...r.location,end:a});return r}ur=i();const Pn=ur!==n&&ir===e.length;function Ln(){throw ur!==n&&ir<e.length&&wr({type:"end"}),function(e,r,n){return new t(t.buildMessage(e,r),e,r,n)}(dr,cr<e.length?function(t=ir){const r=e.codePointAt(t);return void 0===r?"":String.fromCodePoint(r)}(cr):null,cr<e.length?Er(cr,cr+1):Er(cr,cr))}return r.peg$library?{peg$result:ur,peg$currPos:ir,peg$FAILED:n,peg$maxFailExpected:dr,peg$maxFailPos:cr,peg$success:Pn,peg$throw:Pn?void 0:Ln}:Pn?ur:void Ln()}(e)}},e.visitAll=function e(t,r){if(null!=t)switch(r(t),t.type){case"when-clause":e(t.operand,r),e(t.value,r);break;case"case-expression":for(const n of t.clauses)e(n,r);"simple"===t.format&&e(t.operand,r),null!==t.else&&e(t.else,r);break;case"expression-list":for(const n of t.value)e(n,r);break;case"unary-expression":e(t.expr,r);break;case"binary-expression":e(t.left,r),e(t.right,r);break;case"function":e(t.args,r);break;case"interval":e(t.value,r),e(t.qualifier,r);break;case"interval-qualifier":e(t.start,r),e(t.end,r)}},Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})}))},"*noref":1}}),define(["../has","./AggregateFunctions","./DateOnly","./errorSupport","./sqlArithmeticUtils","./sqlCompareUtils","./sqlDateParsingUtils","./SqlInterval","./SqlTimestampOffset","./StandardizedFunctions","./TimeOnly","./WhereGrammar","../../support/guards","../../chunks/datetime"],(function(e,t,r,n,a,o,i,l,s,u,c,d,m,f){"use strict";const p=new Set(["current_timestamp","current_date","current_time"]);class h{constructor(e){this.staticData=e}makeBool(e){return D(e)}featureValue(e,t,r,n){return $(e,t,r,n)}equalsNull(e){return null===e}applyLike(e,t,r){return U(e,t,r)}ensureArray(e){return N(e)}applyIn(e,t){return M(e,t)}currentTimestamp(e){return _(e)}currentDate(e){return F(e)}currentTime(e){return P(e)}makeSqlInterval(e,t,r){return l.SqlInterval.createFromValueAndQualifier(e,t,r)}convertInterval(e){return l.SqlInterval.isInterval(e)?e.valueInMilliseconds():e}compare(e,t,r){return o.sqlCompare(t,r,e)}calculate(e,t,r,n){return a.sqlCalculateFunction(e,t,r,n)}evaluateTime(e){return i.parseTime(e)}evaluateTimestamp(e,t,r){return i.parseTimestamp(e,t,r)}evaluateDate(e,t){return i.parseDate(e,t)}evaluateFunction(e,t,r){return u.evaluateFunction(e,t,r)}lookup(e,t){const r=t[e];return void 0===r?null:r}between(e,t){return null==e||null==t[0]||null==t[1]?null:o.sqlCompare(e,t[0],">=")&&o.sqlCompare(e,t[1],"<=")}notbetween(e,t){return null==e||null==t[0]||null==t[1]?null:o.sqlCompare(e,t[0],"<")||o.sqlCompare(e,t[1],">")}ternaryNot(e){return x(e)}ternaryAnd(e,t){return b(e,t)}ternaryOr(e,t){return A(e,t)}}function S(e,...t){return`this.${e}(${t.join(", ")})`}function v(e){return void 0===e?"void 0":JSON.stringify(e)}function E({type:e,period:t,precision:r,secondary:n}){return JSON.stringify({type:e,period:t,precision:r,secondary:n})}const w="feature",T="lookups",q="attributeAdapter",y="fieldsIndex",I="timeZone",g="currentUser";class O{constructor(e){this._parseTree=e,this._staticData=Object.create(null),this._nextStaticDataId=0,this._tempVars=new Set,this._nextTempVarId=0}compile(){const e=this._compileNode(this._parseTree),t=`\n      ${this._tempVars.size>0?`var ${Array.from(this._tempVars).join(", ")};`:""}\n      return this.convertInterval(${e});\n    `;return new Function(w,T,q,y,I,g,t).bind(new h(this._staticData))}_storeStaticData(e){const t="static$"+this._nextStaticDataId++;return this._staticData[t]=e,t}_compileRefStaticData(e){return`this.staticData[${v(e)}]`}_generateTempVar(){const e="temp$"+this._nextTempVarId++;return this._tempVars.add(e),e}_compileSimpleCase(e){const t=this._compileNode(e.operand),r=this._generateTempVar(),n=[];for(const t of e.clauses){const e=S("compare",v("="),r,this._compileNode(t.operand)),a=this._compileNode(t.value);n.push(`${e} ? (${a}) :`)}return null!=e.else?n.push(this._compileNode(e.else)):n.push(v(null)),`(${r} = ${t}, ${n.join(" ")})`}_compileSearchedCase(e){const t=[];for(const r of e.clauses){const e=S("makeBool",this._compileNode(r.operand)),n=this._compileNode(r.value);t.push(`${e} ? (${n}) :`)}return null!=e.else?t.push(this._compileNode(e.else)):t.push(v(null)),t.join(" ")}_compileInExpr(e,t){const r=new Set,n=[];for(const e of t.value)"number"===e.type||"string"===e.type?r.add(e.value):n.push(e);const a=this._compileNode(e),o=S("ensureArray",this._compileNode({type:"expression-list",location:t.location,value:n}));if(r.size>0){const e=this._compileRefStaticData(this._storeStaticData(r)),t=this._generateTempVar();return n.length>0?`(${t} = ${a}, ${e}.has(${t}) || ${S("applyIn",t,o)})`:`(${t} = ${a}, ${t} == null ? null : ${e}.has(${t}))`}return S("applyIn",a,o)}_compileNode(e){switch(e.type){case"interval":return S("makeSqlInterval",this._compileNode(e.value),"interval-qualifier"===e.qualifier.type?function({type:e,start:t,end:r}){return`{type: ${v(e)}, start: ${E(t)}, end: ${E(r)}}`}(e.qualifier):E(e.qualifier),v(e.op));case"case-expression":return"simple"===e.format?this._compileSimpleCase(e):this._compileSearchedCase(e);case"parameter":return S("lookup",v(e.value.toLowerCase()),T);case"expression-list":return`[${e.value.map((e=>this._compileNode(e))).join(", ")}]`;case"unary-expression":return S("ternaryNot",this._compileNode(e.expr));case"binary-expression":switch(e.operator){case"AND":return S("ternaryAnd",this._compileNode(e.left),this._compileNode(e.right));case"OR":return S("ternaryOr",this._compileNode(e.left),this._compileNode(e.right));case"IS":if("null"!==e.right.type)throw new n.SqlError(n.SqlErrorCodes.UnsupportedIsRhs);return S("equalsNull",this._compileNode(e.left));case"ISNOT":if("null"!==e.right.type)throw new n.SqlError(n.SqlErrorCodes.UnsupportedIsRhs);return`!${S("equalsNull",this._compileNode(e.left))}`;case"IN":return this._compileInExpr(e.left,e.right);case"NOT IN":return S("ternaryNot",this._compileInExpr(e.left,e.right));case"BETWEEN":return S("between",this._compileNode(e.left),this._compileNode(e.right));case"NOTBETWEEN":return S("notbetween",this._compileNode(e.left),this._compileNode(e.right));case"LIKE":return S("applyLike",this._compileNode(e.left),this._compileNode(e.right),v(e.escape));case"NOT LIKE":return S("ternaryNot",S("applyLike",this._compileNode(e.left),this._compileNode(e.right),v(e.escape)));case"<>":case"<":case">":case">=":case"<=":case"=":return S("compare",v(e.operator),this._compileNode(e.left),this._compileNode(e.right));case"*":case"-":case"+":case"/":case"||":return S("calculate",v(e.operator),this._compileNode(e.left),this._compileNode(e.right),I);default:throw new n.SqlError(n.SqlErrorCodes.UnsupportedOperator,{operator:e.operator})}case"null":case"boolean":case"string":case"number":return v(e.value);case"time":try{return this._compileRefStaticData(this._storeStaticData(i.parseTime(e.value)))}catch{return S("evaluateTime",v(e.value))}case"date":try{return this._compileRefStaticData(this._storeStaticData(i.parseDate(e.value,"unknown")))}catch{return S("evaluateDate",v(e.value),v("unknown"))}case"timestamp":try{return this._compileRefStaticData(this._storeStaticData(i.parseTimestamp(e.value,"unknown")))}catch{return S("evaluateTimestamp",v(e.value),v("unknown"))}case"current-time":return"date"===e.mode?S("currentDate",I):"time"===e.mode?S("currentTime",I):S("currentTimestamp",I);case"current-user":return g;case"column-reference":return S("featureValue",w,v(e.column),y,q);case"data-type":return function({type:e,size:t,withtimezone:r}){return JSON.stringify({type:e,size:t,withtimezone:r})}(e.value);case"function":return S("evaluateFunction",v(e.name),this._compileNode(e.args),I)}throw new n.SqlError(n.SqlErrorCodes.UnsupportedSyntax,{node:e.type})}}class C{static create(e,t={}){return new C(e,t.fieldsIndex,t.timeZone??void 0,t.currentUser)}constructor(e,t,r="UTC",n=null){this.fieldsIndex=t,this.timeZone=r,this.currentUser=n,this.parameters={},this._compiledExecutor=null,this._hasDateFunctions=void 0,this.parseTree=d.WhereGrammar.parse(e);const{isStandardized:a,isAggregate:o,currentUserRequired:i,referencedFieldNames:l}=this._extractExpressionInfo(t);this._referencedFieldNames=l,this.isStandardized=a,this.isAggregate=o,this.currentUserRequired=i}static convertValueToStorageFormat(e,t=null){if(null===t)return m.isDate(e)?e.getTime():i.isDateTime(e)?e.toMillis():i.isTimestampOffset(e)?e.toStorageFormat():i.isTimeOnly(e)?e.toStorageString():i.isDateOnly(e)?e.toStorageFormat():e;switch(t){case"date":return m.isDate(e)?e.getTime():i.isDateTime(e)?e.toMillis():i.isTimestampOffset(e)?e.toMilliseconds():i.isDateOnly(e)?e.toNumber():e;case"date-only":return m.isDate(e)?r.DateOnly.fromDateJS(e).toString():i.isTimestampOffset(e)?r.DateOnly.fromSqlTimeStampOffset(e).toString():i.isDateTime(e)?r.DateOnly.fromDateTime(e).toString():e;case"time-only":return m.isDate(e)?c.TimeOnly.fromDateJS(e).toStorageString():i.isDateTime(e)?c.TimeOnly.fromDateTime(e).toStorageString():i.isTimestampOffset(e)?c.TimeOnly.fromSqlTimeStampOffset(e).toStorageString():i.isTimeOnly(e)?e.toStorageString():e;case"timestamp-offset":if(m.isDate(e))return s.SqlTimeStampOffset.fromJSDate(e).toStorageFormat();if(i.isDateTime(e))return s.SqlTimeStampOffset.fromDateTime(e).toStorageFormat();if(i.isTimestampOffset(e))return e.toStorageFormat()}return e}get fieldNames(){return this._referencedFieldNames}testSet(e,t=k,r=this.currentUser){return!!this._evaluateNode(this.parseTree,null,t,e,r)}calculateValue(e,t=k,r=this.currentUser){const n=this._evaluateNode(this.parseTree,e,t,null,r);return l.SqlInterval.isInterval(n)?n.valueInMilliseconds()/864e5:n}tryGetCompiledExecutor(){if(null!=this._compiledExecutor)return this._compiledExecutor;if(e("esri-csp-restrictions"))return null;const t=new O(this.parseTree);return this._compiledExecutor=t.compile(),this._compiledExecutor}calculateValueCompiled(e,t=k,r=this.currentUser){const n=this.tryGetCompiledExecutor();return null==n?this.calculateValue(e,t):n(e,this.parameters,t,this.fieldsIndex,this.timeZone,r??null)}testFeature(e,t=k,r=this.currentUser){return!!this._evaluateNode(this.parseTree,e,t,null,r)}testFeatureCompiled(e,t=k,r=this.currentUser){const n=this.tryGetCompiledExecutor();return null==n?this.testFeature(e,t):!!n(e,this.parameters,t,this.fieldsIndex,this.timeZone,r??null)}get hasDateFunctions(){return null!=this._hasDateFunctions||(this._hasDateFunctions=!1,d.visitAll(this.parseTree,(e=>{"current-time"===e.type?this._hasDateFunctions=!0:"function"===e.type&&(this._hasDateFunctions=this._hasDateFunctions||p.has(e.name.toLowerCase()))}))),this._hasDateFunctions}getFunctions(){const e=new Set;return d.visitAll(this.parseTree,(t=>{"function"===t.type&&e.add(t.name.toLowerCase())})),Array.from(e)}getExpressions(){const e=new Map;return d.visitAll(this.parseTree,(t=>{if("function"===t.type){const r=t.name.toLowerCase(),n=t.args.value[0];if("column-reference"===n.type){const t=n.column,a=`${r}-${t}`;e.has(a)||e.set(a,{aggregateType:r,field:t})}}})),[...e.values()]}getVariables(){const e=new Set;return d.visitAll(this.parseTree,(t=>{"parameter"===t.type&&e.add(t.value.toLowerCase())})),Array.from(e)}_extractExpressionInfo(e){const r=[],n=new Set;let a=!0,o=!1,i=!1;return d.visitAll(this.parseTree,(l=>{switch(l.type){case"column-reference":{const t=e?.get(l.column);let a,o;t?a=o=t.name??"":(o=l.column,a=o.toLowerCase()),n.has(a)||(n.add(a),r.push(o)),l.column=o;break}case"current-user":i=!0;break;case"function":{const{name:e,args:r}=l,n=r.value.length;a&&(a=u.isStandardized(e,n)),!1===o&&(o=t.isAggregate(e,n));break}}})),{referencedFieldNames:Array.from(r),isStandardized:a,isAggregate:o,currentUserRequired:i}}_evaluateNode(e,r,s,c,d){let p;switch(e.type){case"interval":{const t=this._evaluateNode(e.value,r,s,c,d);return l.SqlInterval.createFromValueAndQualifier(t,e.qualifier,e.op)}case"case-expression":if("simple"===e.format){const t=this._evaluateNode(e.operand,r,s,c,d);for(let n=0;n<e.clauses.length;n++)if(o.sqlCompare(t,this._evaluateNode(e.clauses[n].operand,r,s,c,d),"="))return this._evaluateNode(e.clauses[n].value,r,s,c,d);if(null!==e.else)return this._evaluateNode(e.else,r,s,c,d)}else{for(let t=0;t<e.clauses.length;t++)if(D(this._evaluateNode(e.clauses[t].operand,r,s,c,d)))return this._evaluateNode(e.clauses[t].value,r,s,c,d);if(null!==e.else)return this._evaluateNode(e.else,r,s,c,d)}return null;case"parameter":return p=this.parameters[e.value.toLowerCase()],m.isDate(p)?f.DateTime.fromJSDate(p):null!=p&&"object"==typeof p&&"toDateTime"in p?p.toDateTime():p;case"expression-list":{const t=[];for(const n of e.value)t.push(this._evaluateNode(n,r,s,c,d));return t}case"unary-expression":return x(this._evaluateNode(e.expr,r,s,c,d));case"binary-expression":switch(e.operator){case"AND":return b(this._evaluateNode(e.left,r,s,c,d),this._evaluateNode(e.right,r,s,c,d));case"OR":return A(this._evaluateNode(e.left,r,s,c,d),this._evaluateNode(e.right,r,s,c,d));case"IS":if("null"!==e.right.type)throw new n.SqlError(n.SqlErrorCodes.UnsupportedIsRhs);return null===this._evaluateNode(e.left,r,s,c,d);case"ISNOT":if("null"!==e.right.type)throw new n.SqlError(n.SqlErrorCodes.UnsupportedIsRhs);return null!==this._evaluateNode(e.left,r,s,c,d);case"IN":{const t=N(this._evaluateNode(e.right,r,s,c,d));return M(this._evaluateNode(e.left,r,s,c,d),t)}case"NOT IN":{const t=N(this._evaluateNode(e.right,r,s,c,d));return x(M(this._evaluateNode(e.left,r,s,c,d),t))}case"BETWEEN":{const t=this._evaluateNode(e.left,r,s,c,d),n=this._evaluateNode(e.right,r,s,c,d);return null==t||null==n[0]||null==n[1]?null:o.sqlCompare(t,n[0],">=")&&o.sqlCompare(t,n[1],"<=")}case"NOTBETWEEN":{const t=this._evaluateNode(e.left,r,s,c,d),n=this._evaluateNode(e.right,r,s,c,d);return null==t||null==n[0]||null==n[1]?null:o.sqlCompare(t,n[0],"<")||o.sqlCompare(t,n[1],">")}case"LIKE":return U(this._evaluateNode(e.left,r,s,c,d),this._evaluateNode(e.right,r,s,c,d),e.escape);case"NOT LIKE":return x(U(this._evaluateNode(e.left,r,s,c,d),this._evaluateNode(e.right,r,s,c,d),e.escape));case"<>":case"<":case">":case">=":case"<=":case"=":return o.sqlCompare(this._evaluateNode(e.left,r,s,c,d),this._evaluateNode(e.right,r,s,c,d),e.operator);case"-":case"+":case"*":case"/":case"||":return a.sqlCalculateFunction(e.operator,this._evaluateNode(e.left,r,s,c,d),this._evaluateNode(e.right,r,s,c,d),this.timeZone)}case"null":case"boolean":case"string":case"number":return e.value;case"date":return e.parsedValue??=i.parseDate(e.value,"unknown"),e.parsedValue;case"timestamp":return e.parsedValue??=i.parseTimestamp(e.value,"unknown"),e.parsedValue;case"time":return i.parseTime(e.value);case"current-time":return"date"===e.mode?F(this.timeZone):"time"===e.mode?P(this.timeZone):_(this.timeZone);case"current-user":return d??null;case"column-reference":return $(r,e.column,this.fieldsIndex,s);case"data-type":return e.value;case"function":{if(this.isAggregate&&t.isAggregate(e.name,e.args.value.length)){const r=[];for(const t of e.args?.value||[]){const e=[];for(const r of c||[])e.push(this._evaluateNode(t,r,s,null,d));r.push(e)}return t.aggregateFunction(e.name,r)}const n=this._evaluateNode(e.args,r,s,c,d);return u.evaluateFunction(e.name,n,this.timeZone)}}throw new n.SqlError(n.SqlErrorCodes.UnsupportedSyntax,{node:e.type})}}function D(e){return!0===e}function N(e){return Array.isArray(e)?e:[e]}function x(e){return null!==e?!0!==e:null}function b(e,t){return null!=e&&null!=t?!0===e&&!0===t:!1!==e&&!1!==t&&null}function A(e,t){return null!=e&&null!=t?!0===e||!0===t:!0===e||!0===t||null}function M(e,t){if(null==e)return null;let r=!1;for(const n of t)if(null==n)r=null;else{if(e===n){r=!0;break}if(o.isDateOrTimeValue(e)&&o.isDateOrTimeValue(n)&&(r=o.sqlCompare(e,n,"="),r))break}return r}function _(e){return i.convertToExecutingTimeZone(new Date,e)}function F(e){return r.DateOnly.fromNow(e)}function P(e){const t=i.convertToExecutingTimeZone(new Date,e);return c.TimeOnly.fromDateTime(t)}const L="-[]/{}()*+?.\\^$|";var R;function U(e,t,r){if(null==e)return null;const n=function(e,t){const r=t;let n="",a=R.Normal;for(let t=0;t<e.length;t++){const o=e.charAt(t);switch(a){case R.Normal:o===r?a=R.Escaped:L.includes(o)?n+="\\"+o:n+="%"===o?".*":"_"===o?".":o;break;case R.Escaped:L.includes(o)?n+="\\"+o:n+=o,a=R.Normal}}return new RegExp("^"+n+"$","m")}(t,r);return n.test(e)}function $(e,t,n,a){if("getAttributeSQL"in a)return a.getAttributeSQL(e,t);const o=a.getAttribute(e,t);if(null==o)return o;const l=n?.get(t);switch(l?.type){case"esriFieldTypeDate":case"date":return i.convertToExecutingTimeZone(new Date(o),n?.getLuxonTimeZone(l.name)??f.FixedOffsetZone.utcInstance);case"esriFieldTypeDateOnly":case"date-only":return r.DateOnly.fromReader(o);case"esriFieldTypeTimeOnly":case"time-only":return c.TimeOnly.fromReader(o);case"esriFieldTypeTimestampOffset":case"timestamp-offset":return new s.SqlTimeStampOffset(o)}return o}!function(e){e[e.Normal=0]="Normal",e[e.Escaped=1]="Escaped"}(R||(R={}));const k={getAttribute(e,t){var r;return((r=e)&&"object"==typeof r.attributes?e.attributes:e)[t]}};return C}));