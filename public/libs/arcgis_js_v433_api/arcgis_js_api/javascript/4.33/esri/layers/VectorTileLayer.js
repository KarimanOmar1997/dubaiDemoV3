// All material copyright Esri, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.33/esri/copyright.txt for details.
//>>built
require({cache:{"esri/layers/mixins/ArcGISCachedService":function(){define(["exports","../../chunks/tslib.es6","../../core/accessorSupport/decorators/property","../../core/has","../../core/Logger","../../core/RandomLCG","../../core/accessorSupport/decorators/reader","../../core/accessorSupport/decorators/subclass","../../geometry/SpatialReference","../support/TileInfo","../support/TileInfoTilemapCache","../support/TilemapCache"],(function(e,t,r,i,n,o,s,a,l,c,u,h){"use strict";e.ArcGISCachedService=e=>{let i=class extends e{constructor(){super(...arguments),this.copyright=null,this.minScale=0,this.maxScale=0,this.spatialReference=null,this.tileInfo=null,this.tilemapCache=null}destroy(){this.tilemapCache?.destroy?.()}readMinScale(e,t){return null!=t.minLOD&&null!=t.maxLOD?e:0}readMaxScale(e,t){return null!=t.minLOD&&null!=t.maxLOD?e:0}get supportsBlankTile(){return this.version>=10.2}readTilemapCache(e,t,r){const i=t.capabilities?.includes("Tilemap");let{minLOD:n,maxLOD:o,minScale:s,maxScale:a}=t;if(null==n&&null==o&&(0!==s||0!==a)){const e=e=>Math.round(1e4*e)/1e4;s=e(s||t.tileInfo.lods[0].scale),a=e(a||t.tileInfo.lods[t.tileInfo.lods.length-1].scale);for(const r of t.tileInfo.lods){const t=e(r.scale);n=t>=s?r.level:n,o=t>=a?r.level:o}}if(i)return new h.TilemapCache({layer:this,minLOD:n,maxLOD:o});if(t.tileInfo){const e=new c;return e.read(t.tileInfo,r),new u(e,n,o)}return null}};return t.__decorate([r.property({json:{read:{source:"copyrightText"}}})],i.prototype,"copyright",void 0),t.__decorate([r.property()],i.prototype,"minScale",void 0),t.__decorate([s.reader("service","minScale")],i.prototype,"readMinScale",null),t.__decorate([r.property()],i.prototype,"maxScale",void 0),t.__decorate([s.reader("service","maxScale")],i.prototype,"readMaxScale",null),t.__decorate([r.property({type:l})],i.prototype,"spatialReference",void 0),t.__decorate([r.property({readOnly:!0})],i.prototype,"supportsBlankTile",null),t.__decorate([r.property({type:c})],i.prototype,"tileInfo",void 0),t.__decorate([r.property()],i.prototype,"tilemapCache",void 0),t.__decorate([s.reader("service","tilemapCache",["capabilities","tileInfo"])],i.prototype,"readTilemapCache",null),t.__decorate([r.property()],i.prototype,"version",void 0),i=t.__decorate([a.subclass("esri.layers.mixins.ArcGISCachedService")],i),i},Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})}))},"esri/layers/support/TileInfo":function(){define(["exports","../../chunks/tslib.es6","../../core/jsonMap","../../core/JSONSupport","../../core/unitUtils","../../core/accessorSupport/decorators/property","../../core/accessorSupport/ensureType","../../core/has","../../core/RandomLCG","../../core/accessorSupport/decorators/reader","../../core/accessorSupport/decorators/subclass","../../core/accessorSupport/decorators/writer","../../geometry/Point","../../geometry/SpatialReference","../../geometry/support/aaBoundingRect","../../geometry/support/spatialReferenceUtils","../../geometry/support/webMercatorUtils","./LOD","./TileKey"],(function(e,t,r,i,n,o,s,a,l,c,u,h,p,y,_,d,f,m,T){"use strict";var g;const E=new r.JSONMap({PNG:"png",PNG8:"png8",PNG24:"png24",PNG32:"png32",JPEG:"jpg",JPG:"jpg",DIB:"dib",TIFF:"tiff",EMF:"emf",PS:"ps",PDF:"pdf",GIF:"gif",SVG:"svg",SVGZ:"svgz",Mixed:"mixed",MIXED:"mixed",LERC:"lerc",LERC2D:"lerc2d",RAW:"raw",pbf:"pbf"});var S,A;return e.default=class extends i{static{g=this}static create(e={}){const{resolutionFactor:t=1,scales:r,size:i=256,spatialReference:o=y.WebMercator,numLODs:s=24}=e;if(!d.isValid(o)){const e=[];if(r)for(let t=0;t<r.length;t++){const i=r[t];e.push(new m({level:t,scale:i,resolution:i}))}else{let t=5e-4;for(let r=s-1;r>=0;r--)e.unshift(new m({level:r,scale:t,resolution:t})),t*=2}return new g({dpi:96,lods:e,origin:new p(0,0,o),size:[i,i],spatialReference:o})}const a=d.getInfo(o),l=e.origin?new p({x:e.origin.x,y:e.origin.y,spatialReference:o}):new p(a?{x:a.origin[0],y:a.origin[1],spatialReference:o}:{x:0,y:0,spatialReference:o}),c=1/(39.37*n.getMetersPerUnitForSR(o)*96),u=[];if(r)for(let e=0;e<r.length;e++){const t=r[e],i=t*c;u.push(new m({level:e,scale:t,resolution:i}))}else{let e=d.isGeographic(o)?512/i*591657527.5917094:256/i*591657527.591555;const r=Math.ceil(s/t);u.push(new m({level:0,scale:e,resolution:e*c}));for(let i=1;i<r;i++){const r=e/2**t,n=r*c;u.push(new m({level:i,scale:r,resolution:n})),e=r}}return new g({dpi:96,lods:u,origin:l,size:[i,i],spatialReference:o})}constructor(e){super(e),this.dpi=96,this.format=null,this.origin=null,this.size=null,this.spatialReference=null}get isWrappable(){const{spatialReference:e,origin:t}=this;if(e&&t){const r=d.getInfo(e);return e.isWrappable&&!!r&&Math.abs(r.origin[0]-t.x)<=r.dx}return!1}readOrigin(e,t){return p.fromJSON({spatialReference:t.spatialReference,...e})}set lods(e){let t=0,r=0;const i=[],n=this._levelToLOD={};e&&(t=-1/0,r=1/0,e.forEach((e=>{i.push(e.scale),t=e.scale>t?e.scale:t,r=e.scale<r?e.scale:r,n[e.level]=e}))),this._set("scales",i),this._set("lods",e),this._initializeUpsampleLevels()}readSize(e,t){return[t.cols,t.rows]}writeSize(e,t){t.cols=e[0],t.rows=e[1]}zoomToScale(e){const t=this.scales;if(e<=0)return t[0];if(e>=t.length-1)return t[t.length-1];const r=Math.floor(e),i=r+1;return t[r]/(t[r]/t[i])**(e-r)}scaleToZoom(e){const t=this.scales,r=t.length-1;let i=0;for(;i<r;i++){const r=t[i],n=t[i+1];if(r<=e)return i;if(n===e)return i+1;if(r>e&&n<e)return i+Math.log(r/e)/Math.log(r/n)}return i}tileAt(e,t,r,i){const n=this.lodAt(e);if(!n)return null;let o,s;if("number"==typeof t)o=t,s=r;else if(d.equals(t.spatialReference,this.spatialReference))o=t.x,s=t.y,i=r;else{const e=f.project(t,this.spatialReference);if(null==e)return null;o=e.x,s=e.y,i=r}const a=n.resolution*this.size[0],l=n.resolution*this.size[1];return i||(i=new T.TileKey(null,0,0,0,_.create())),i.level=e,i.row=Math.floor((this.origin.y-s)/l+.001),i.col=Math.floor((o-this.origin.x)/a+.001),this.updateTileInfo(i),i}updateTileInfo(e,t=g.ExtrapolateOptions.NONE){let r=this.lodAt(e.level);if(!r&&t===g.ExtrapolateOptions.POWER_OF_TWO){const t=this.lods[this.lods.length-1];t.level<e.level&&(r=t)}if(!r)return;const i=e.level-r.level,n=r.resolution*this.size[0]/2**i,o=r.resolution*this.size[1]/2**i;e.id=`${e.level}/${e.row}/${e.col}`,e.extent||(e.extent=_.create()),e.extent[0]=this.origin.x+e.col*n,e.extent[1]=this.origin.y-(e.row+1)*o,e.extent[2]=e.extent[0]+n,e.extent[3]=e.extent[1]+o}upsampleTile(e){const t=this._upsampleLevels[e.level];return!(!t||-1===t.parentLevel||(e.level=t.parentLevel,e.row=Math.floor(e.row/t.factor+.001),e.col=Math.floor(e.col/t.factor+.001),this.updateTileInfo(e),0))}getTileBounds(e,t){const r=this.lodAt(t.level);if(null==r)return null;const{resolution:i}=r,n=i*this.size[0],o=i*this.size[1];return e[0]=this.origin.x+t.col*n,e[1]=this.origin.y-(t.row+1)*o,e[2]=e[0]+n,e[3]=e[1]+o,e}lodAt(e){return this._levelToLOD?.[e]??null}clone(){return g.fromJSON(this.write({}))}getCompatibleForVTL(e){if(this.size[0]!==this.size[1]||256===this.size[0]&&512===e)return null;const t=(512===this.size[0]&&256===e?-1:0)+(this.spatialReference.isGeographic?1:0);if(this.size[0]===e&&0===t)return this;const r=[],i=this.lods.length-t;for(let e=0;e<i;e++){const i=e+t,{scale:n,resolution:o}=i>=0?this.lods[i]:{scale:2*this.lods[0].scale,resolution:2*this.lods[0].resolution};r.push(new m({level:e,scale:n,resolution:o}))}return new g({size:[e,e],dpi:this.dpi,format:this.format,compressionQuality:this.compressionQuality,origin:this.origin,spatialReference:this.spatialReference,lods:r})}_initializeUpsampleLevels(){const e=this.lods;this._upsampleLevels=[];let t=null;for(let r=0;r<e.length;r++){const i=e[r];this._upsampleLevels[i.level]={parentLevel:t?t.level:-1,factor:t?t.resolution/i.resolution:0},t=i}}},t.__decorate([o.property({type:Number,json:{write:!0}})],e.default.prototype,"compressionQuality",void 0),t.__decorate([o.property({type:Number,json:{write:!0}})],e.default.prototype,"dpi",void 0),t.__decorate([o.property({type:String,json:{read:E.read,write:E.write,origins:{"web-scene":{read:!1,write:!1}}}})],e.default.prototype,"format",void 0),t.__decorate([o.property({readOnly:!0})],e.default.prototype,"isWrappable",null),t.__decorate([o.property({type:p,json:{write:!0}})],e.default.prototype,"origin",void 0),t.__decorate([c.reader("origin")],e.default.prototype,"readOrigin",null),t.__decorate([o.property({type:[m],value:null,json:{write:!0}})],e.default.prototype,"lods",null),t.__decorate([o.property({readOnly:!0})],e.default.prototype,"scales",void 0),t.__decorate([o.property({cast:e=>Array.isArray(e)?e:"number"==typeof e?[e,e]:[256,256]})],e.default.prototype,"size",void 0),t.__decorate([c.reader("size",["rows","cols"])],e.default.prototype,"readSize",null),t.__decorate([h.writer("size",{cols:{type:s.Integer},rows:{type:s.Integer}})],e.default.prototype,"writeSize",null),t.__decorate([o.property({type:y,json:{write:!0}})],e.default.prototype,"spatialReference",void 0),e.default=g=t.__decorate([u.subclass("esri.layers.support.TileInfo")],e.default),(A=(S=e.default||(e.default={})).ExtrapolateOptions||(S.ExtrapolateOptions={}))[A.NONE=0]="NONE",A[A.POWER_OF_TWO=1]="POWER_OF_TWO",e.default}))},"esri/layers/support/LOD":function(){define(["exports","../../chunks/tslib.es6","../../core/JSONSupport","../../core/accessorSupport/decorators/property","../../core/accessorSupport/ensureType","../../core/has","../../core/RandomLCG","../../core/accessorSupport/decorators/subclass"],(function(e,t,r,i,n,o,s,a){"use strict";var l;return e.default=class extends r{static{l=this}constructor(e){super(e),this.cols=null,this.level=0,this.levelValue=null,this.origin=null,this.resolution=0,this.rows=null,this.scale=0}clone(){return new l({cols:this.cols,level:this.level,levelValue:this.levelValue,resolution:this.resolution,rows:this.rows,scale:this.scale})}},t.__decorate([i.property({json:{write:!0,origins:{"web-document":{read:!1,write:!1},"portal-item":{read:!1,write:!1}}}})],e.default.prototype,"cols",void 0),t.__decorate([i.property({type:n.Integer,json:{write:!0}})],e.default.prototype,"level",void 0),t.__decorate([i.property({type:String,json:{write:!0}})],e.default.prototype,"levelValue",void 0),t.__decorate([i.property({json:{write:!0,origins:{"web-document":{read:!1,write:!1},"portal-item":{read:!1,write:!1}}}})],e.default.prototype,"origin",void 0),t.__decorate([i.property({type:Number,json:{write:!0}})],e.default.prototype,"resolution",void 0),t.__decorate([i.property({json:{write:!0,origins:{"web-document":{read:!1,write:!1},"portal-item":{read:!1,write:!1}}}})],e.default.prototype,"rows",void 0),t.__decorate([i.property({type:Number,json:{write:!0}})],e.default.prototype,"scale",void 0),e.default=l=t.__decorate([a.subclass("esri.layers.support.LOD")],e.default),e.default}))},"esri/layers/support/TileKey":function(){define(["exports"],(function(e){"use strict";e.TileKey=class{constructor(e,t,r,i,n=void 0){this.id=e,this.level=t,this.row=r,this.col=i,this.extent=n}},Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})}))},"esri/layers/support/TileInfoTilemapCache":function(){define(["../../core/Error","../../core/promiseUtils"],(function(e,t){"use strict";return class{constructor(e,t=0,r=e.lods[e.lods.length-1].level){this.tileInfo=e,this.minLOD=t,this.maxLOD=r,e.lodAt(t)||(this.minLOD=e.lods[0].level),e.lodAt(r)||(this.maxLOD=e.lods[e.lods.length-1].level)}get effectiveMinLOD(){return this.minLOD??this.tileInfo.lods[0].level}get effectiveMaxLOD(){return this.maxLOD??this.tileInfo.lods[this.tileInfo.lods.length-1].level}getAvailability(e,t,r){const i=this.tileInfo?.lodAt(e);return!i||e<this.minLOD||e>this.maxLOD?"unavailable":i.cols&&i.rows?r>=i.cols[0]&&r<=i.cols[1]&&t>=i.rows[0]&&t<=i.rows[1]?"unknown":"unavailable":"unknown"}async fetchAvailability(r,i,n,o){await t.waitTick(o);const s=this.getAvailability(r,i,n);if("unavailable"===s)throw new e("tile-map:tile-unavailable","Tile is not available",{level:r,row:i,col:n});return s}async fetchAvailabilityUpsample(e,r,i,n,o){await t.waitTick(o),n.level=e,n.row=r,n.col=i;const s=this.tileInfo;return s.updateTileInfo(n),this.fetchAvailability(e,r,i,o).catch((e=>{if(t.isAbortError(e))throw e;if(s.upsampleTile(n))return this.fetchAvailabilityUpsample(n.level,n.row,n.col,n,o);throw e}))}}}))},"esri/layers/support/TilemapCache":function(){define(["exports","../../chunks/tslib.es6","../../request","../../core/Accessor","../../core/ByteSizeUnit","../../core/Error","../../core/handleUtils","../../core/has","../../core/LRUCache","../../core/PooledArray","../../core/promiseUtils","../../core/reactiveUtils","../../core/scheduling","../../core/urlUtils","../../core/accessorSupport/decorators/property","../../core/Logger","../../core/RandomLCG","../../core/accessorSupport/decorators/subclass","./TileKey","./Tilemap"],(function(e,t,r,i,n,o,s,a,l,c,u,h,p,y,_,d,f,m,T,g){"use strict";var E;function S(e,t,r){return new o("tile-map:tile-unavailable","Tile is not available",{level:e,row:t,col:r})}e.TilemapCache=class extends i{static{E=this}constructor(e){super(e),this._pendingTilemapRequests={},this.request=r,this.size=32,this._prefetchingEnabled=!0}initialize(){this._tilemapCache=new l.LRUCache(2*n.ByteSizeUnit.MEGABYTES),this.addHandles(h.watch((()=>{const{layer:e}=this;return[e?.parsedUrl,e?.tileServers,e?.apiKey,e?.customParameters]}),(()=>this._initializeTilemapDefinition()),h.initial))}get effectiveMinLOD(){return this.minLOD??this.layer.tileInfo.lods[0].level}get effectiveMaxLOD(){return this.maxLOD??this.layer.tileInfo.lods[this.layer.tileInfo.lods.length-1].level}getAvailability(e,t,r){if(!this.layer.tileInfo.lodAt(e)||e<this.effectiveMinLOD||e>this.effectiveMaxLOD)return"unavailable";const i=this._tilemapFromCache(e,t,r,this._tmpTilemapDefinition);return i?i.getAvailability(t,r):"unknown"}fetchAvailability(e,t,r,i){return!this.layer.tileInfo.lodAt(e)||e<this.effectiveMinLOD||e>this.effectiveMaxLOD?Promise.reject(S(e,t,r)):this._fetchTilemap(e,t,r,i).catch((e=>e)).then((i=>{if(i instanceof g.Tilemap){const n=i.getAvailability(t,r);if("unavailable"===n)throw S(e,t,r);return n}if(u.isAbortError(i))throw i;return"unknown"}))}fetchAvailabilityUpsample(e,t,r,i,n){i.level=e,i.row=t,i.col=r;const o=this.layer.tileInfo;o.updateTileInfo(i);const s=this.fetchAvailability(e,t,r,n).catch((e=>{if(u.isAbortError(e))throw e;if(o.upsampleTile(i))return this.fetchAvailabilityUpsample(i.level,i.row,i.col,i,n);throw e}));return this._fetchAvailabilityUpsamplePrefetch(i.id,e,t,r,n,s),s}async _fetchAvailabilityUpsamplePrefetch(e,t,r,i,n,o){if(!this._prefetchingEnabled||null==e)return;const a=`prefetch-${e}`;if(this.hasHandles(a))return;const l=new AbortController;o.then((()=>l.abort()),(()=>l.abort()));let c=!1;const h=s.makeHandle((()=>{c||(c=!0,l.abort())}));if(this.addHandles(h,a),await p.waitTicks(10,l.signal).catch((()=>{})),c||(c=!0,this.removeHandles(a)),u.isAborted(l))return;const y=new T.TileKey(e,t,r,i),_={...n,signal:l.signal},d=this.layer.tileInfo;for(let e=0;E._prefetches.length<E._maxPrefetch&&d.upsampleTile(y);++e){const e=this.fetchAvailability(y.level,y.row,y.col,_);E._prefetches.push(e);const t=()=>{E._prefetches.removeUnordered(e)};e.then(t,t)}}static{this._maxPrefetch=4}static{this._prefetches=new c({initialSize:E._maxPrefetch})}_fetchTilemap(e,t,r,i){if(!this.layer.tileInfo.lodAt(e)||e<this.effectiveMinLOD||e>this.effectiveMaxLOD)return Promise.reject(new o("tilemap-cache:level-unavailable",`Level ${e} is unavailable in the service`));const n=this._tmpTilemapDefinition,s=this._tilemapFromCache(e,t,r,n);if(s)return Promise.resolve(s);const a=i?.signal;return i={...i,signal:null},new Promise(((e,t)=>{u.onAbort(a,(()=>t(u.createAbortError())));const r=g.tilemapDefinitionId(n);let o=this._pendingTilemapRequests[r];if(!o){o=g.Tilemap.fromDefinition(n,i).then((e=>(this._tilemapCache.put(r,e,e.byteSize),e)));const e=()=>{delete this._pendingTilemapRequests[r]};this._pendingTilemapRequests[r]=o,o.then(e,e)}o.then(e,t)}))}_initializeTilemapDefinition(){if(!this.layer.parsedUrl)return;const{parsedUrl:e,apiKey:t,customParameters:r}=this.layer;this._tilemapCache.clear(),this._tmpTilemapDefinition={service:{url:e.path,query:y.objectToQuery({...e.query,...r,token:t??e.query?.token}),tileServers:this.layer.tileServers,request:this.request},width:this.size,height:this.size,level:0,row:0,col:0}}_tilemapFromCache(e,t,r,i){i.level=e,i.row=t-t%this.size,i.col=r-r%this.size;const n=g.tilemapDefinitionId(i);return this._tilemapCache.get(n)}get test(){}},t.__decorate([_.property({constructOnly:!0})],e.TilemapCache.prototype,"layer",void 0),t.__decorate([_.property({constructOnly:!0})],e.TilemapCache.prototype,"minLOD",void 0),t.__decorate([_.property({constructOnly:!0})],e.TilemapCache.prototype,"maxLOD",void 0),t.__decorate([_.property({constructOnly:!0})],e.TilemapCache.prototype,"request",void 0),t.__decorate([_.property({constructOnly:!0})],e.TilemapCache.prototype,"size",void 0),e.TilemapCache=E=t.__decorate([m.subclass("esri.layers.support.TilemapCache")],e.TilemapCache),Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})}))},"esri/core/ByteSizeUnit":function(){define(["exports"],(function(e){"use strict";var t;e.ByteSizeUnit=void 0,(t=e.ByteSizeUnit||(e.ByteSizeUnit={}))[t.KILOBYTES=1024]="KILOBYTES",t[t.MEGABYTES=1048576]="MEGABYTES",t[t.GIGABYTES=1073741824]="GIGABYTES",Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})}))},"esri/layers/support/Tilemap":function(){define(["exports","../../request","../../core/Error","../../core/lang","../../core/memoryEstimations","../../geometry/support/UintArray"],(function(e,t,r,i,n,o){"use strict";class s{constructor(e){!function(e){if(!e?.location)throw new r("tilemap:missing-location","Location missing from tilemap response");if(!1===e.valid)throw new r("tilemap:invalid","Tilemap response was marked as invalid");if(!e.data)throw new r("tilemap:missing-data","Data missing from tilemap response");if(!Array.isArray(e.data))throw new r("tilemap:data-mismatch","Data must be an array of numbers");if(e.data.length!==e.location.width*e.location.height)throw new r("tilemap:data-mismatch","Number of data items does not match width/height of tilemap")}(e);const{location:t,data:s}=e;this.location=Object.freeze(i.clone(t));const a=this.location.width,l=this.location.height;let c=!0,u=!0;const h=Math.ceil(a*l/32),p=o.newUintArray(h);let y=0;for(let e=0;e<s.length;e++){const t=e%32;s[e]?(u=!1,p[y]|=1<<t):c=!1,31===t&&++y}u?(this._availability="unavailable",this.byteSize=40):c?(this._availability="available",this.byteSize=40):(this._availability=p,this.byteSize=40+n.estimateNumberArrayMemory(p))}getAvailability(e,t){if("unavailable"===this._availability||"available"===this._availability)return this._availability;const r=(e-this.location.top)*this.location.width+(t-this.location.left),i=r%32,n=r>>5,o=this._availability;return n<0||n>o.length?"unknown":o[n]&1<<i?"available":"unavailable"}static fromDefinition(e,i){const n=e.service.request||t,{row:o,col:a,width:l,height:c}=e,u={query:{f:"json"}};return i=i?{...u,...i}:u,n(function(e){let t;if(e.service.tileServers?.length){const r=e.service.tileServers;t=`${r&&r.length?r[e.row%r.length]:e.service.url}/tilemap/${e.level}/${e.row}/${e.col}/${e.width}/${e.height}`}else t=`${e.service.url}/tilemap/${e.level}/${e.row}/${e.col}/${e.width}/${e.height}`;const r=e.service.query;return r&&(t=`${t}?${r}`),t}(e),i).then((e=>e.data)).catch((e=>{if(422===e?.details?.httpStatus)return{location:{top:o,left:a,width:l,height:c},valid:!0,data:new Array(l*c).fill(0)};throw e})).then((e=>{if(e.location&&(e.location.top!==o||e.location.left!==a||e.location.width!==l||e.location.height!==c))throw new r("tilemap:location-mismatch","Tilemap response for different location than requested",{response:e,definition:{top:o,left:a,width:l,height:c}});return s.fromJSON(e)}))}static fromJSON(e){return Object.freeze(new s(e))}}e.Tilemap=s,e.tilemapDefinitionId=function(e){return`${e.level}/${e.row}/${e.col}/${e.width}/${e.height}`},Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})}))},"esri/geometry/support/UintArray":function(){define(["exports","../../core/typedArrayUtil"],(function(e,t){"use strict";e.newUintArray=function(e,r=!1){return e<=t.nativeArrayMaxSize?r?new Array(e).fill(0):new Array(e):new Uint32Array(e)},e.uintSubArray=function(e,t,r){return Array.isArray(e)?e.slice(t,t+r):e.subarray(t,t+r)},Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})}))},"esri/layers/support/imageUtils":function(){define(["exports"],(function(e){"use strict";let t=null;e.checkWebPSupport=function(e){if(t)return t;const r={lossy:"UklGRiIAAABXRUJQVlA4IBYAAAAwAQCdASoBAAEADsD+JaQAA3AAAAAA",lossless:"UklGRhoAAABXRUJQVlA4TA0AAAAvAAAAEAcQERGIiP4HAA==",alpha:"UklGRkoAAABXRUJQVlA4WAoAAAAQAAAAAAAAAAAAQUxQSAwAAAARBxAR/Q9ERP8DAABWUDggGAAAABQBAJ0BKgEAAQAAAP4AAA3AAP7mtQAAAA==",animation:"UklGRlIAAABXRUJQVlA4WAoAAAASAAAAAAAAAAAAQU5JTQYAAAD/////AABBTk1GJgAAAAAAAAAAAAAAAAAAAGQAAABWUDhMDQAAAC8AAAAQBxAREYiI/gcA"};return t=new Promise((t=>{const i=new Image;i.onload=()=>{i.onload=i.onerror=null,t(i.width>0&&i.height>0)},i.onerror=()=>{i.onload=i.onerror=null,t(!1)},i.src="data:image/webp;base64,"+r[e]})),t},Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})}))},"esri/layers/support/SpriteSource":function(){define(["../../request","../../core/Error","../../core/Logger","../../core/typedArrayUtil","../../core/urlUtils"],(function(e,t,r,i,n){"use strict";function o(e){const t=document.createElement("canvas"),r=t.getContext("2d");t.width=e.width,t.height=e.height,r.drawImage(e,0,0,e.width,e.height);const i=r.getImageData(0,0,e.width,e.height);return{width:e.width,height:e.height,data:new Uint8Array(i.data)}}return class{constructor(e,t){this._spriteSource=e,this._maxTextureSize=t,this.devicePixelRatio=1,this._spriteImageFormat="png",this._isRetina=!1,this._spritesData={},this.image=null,this.width=null,this.height=null,this.loadStatus="not-loaded","url"===e.type&&e.spriteFormat&&(this._spriteImageFormat=e.spriteFormat),e.pixelRatio&&(this.devicePixelRatio=e.pixelRatio),this.baseURL=e.spriteUrl}get spriteNames(){const e=[];for(const t in this._spritesData)e.push(t);return e.sort(),e}getSpriteInfo(e){return this._spritesData?this._spritesData[e]:null}async load(e){if(this.baseURL){this.loadStatus="loading";try{await this._loadSprites(e),this.loadStatus="loaded"}catch{this.loadStatus="failed"}}else this.loadStatus="failed"}async _loadSprites(e){this._isRetina=this.devicePixelRatio>1.15;const{width:i,height:n,data:o,json:s}=await this._getSpriteData(this._spriteSource,e),a=Object.keys(s);if(!a||0===a.length||!o)return this._spritesData=this.image=null,void(this.width=this.height=0);this._spritesData=s,this.width=i,this.height=n;const l=Math.max(this._maxTextureSize,4096);if(i>l||n>l){const e=`Sprite resource for style ${this.baseURL} is bigger than the maximum allowed of ${l} pixels}`;throw r.getLogger("esri.layers.support.SpriteSource").error(e),new t("SpriteSource",e)}let c;for(let e=0;e<o.length;e+=4)c=o[e+3]/255,o[e]=o[e]*c,o[e+1]=o[e+1]*c,o[e+2]=o[e+2]*c;this.image=o}async _getSpriteData(r,s){if("image"===r.type){let e,n;if(this.devicePixelRatio<1.15){if(!r.spriteSource1x)throw new t("SpriteSource","no image data provided for low resolution sprites!");e=r.spriteSource1x.image,n=r.spriteSource1x.json}else{if(!r.spriteSource2x)throw new t("SpriteSource","no image data provided for high resolution sprites!");e=r.spriteSource2x.image,n=r.spriteSource2x.json}return"width"in e&&"height"in e&&"data"in e&&(i.isArrayBuffer(e.data)||i.isUint8ClampedArray(e.data))?{width:e.width,height:e.height,data:new Uint8Array(e.data),json:n}:{...o(e),json:n}}const a=n.urlToObject(this.baseURL),l=a.query?"?"+n.objectToQuery(a.query):"",c=this._isRetina?"@2x":"",u=`${a.path}${c}.${this._spriteImageFormat}${l}`,h=`${a.path}${c}.json${l}`,[p,y]=await Promise.all([e(h,s),e(u,{responseType:"image",...s})]);return{...o(y.data),json:p.data}}}}))},"esri/layers/support/vectorTileLayerLoader":function(){define(["exports","../../request","../../core/lang","../../core/promiseUtils","../../core/urlUtils","../../geometry/support/spatialReferenceUtils","../../geometry/support/webMercatorUtils","../../views/2d/engine/vectorTiles/style/VectorTileSource"],(function(e,t,r,i,n,o,s,a){"use strict";function l(...e){let t;for(const r of e)if(null!=r)if(n.isProtocolRelative(r)){if(t){const e=t.split("://")[0];t=e+":"+r.trim()}}else t=n.isAbsolute(r)?r:n.join(t,r);return t?n.removeTrailingSlash(t):void 0}async function c(e,r,o,s,a){let u,y,_;if(i.throwIfAborted(a),"string"==typeof o){const e=n.normalize(o);_=await t(e,{...a,responseType:"json",query:{f:"json",...a?.query}}),_.ssl&&(u&&(u=u.replace(/^http:/i,"https:")),y&&(y=y.replace(/^http:/i,"https:"))),u=e,y=e}else null!=o&&(_={data:o},u=o.jsonUrl||null,y=s);const d=_?.data;if(h(d))return e.styleUrl=u||null,async function(e,t,r,i){const o=r?n.removeFile(r):n.getAppBaseUrl();e.styleBase=o,e.style=t,t["sprite-format"]&&"webp"===t["sprite-format"].toLowerCase()&&(e.spriteFormat="webp");const s=[];if(t.sources&&t.sources.esri){const r=t.sources.esri;r.url?await c(e,"esri",l(o,r.url),void 0,i):s.push(c(e,"esri",r,o,i))}for(const r of Object.keys(t.sources))"esri"!==r&&"vector"===t.sources[r].type&&(t.sources[r].url?s.push(c(e,r,l(o,t.sources[r].url),void 0,i)):t.sources[r].tiles&&s.push(c(e,r,t.sources[r],o,i)));await Promise.all(s)}(e,d,y,a);if(!h(d))return e.sourceUrl?p(e,d,y,!1,r,a):(e.sourceUrl=u||null,p(e,d,y,!0,r,a));throw new Error("You must specify the URL or the JSON for a service or for a style.")}function u(e){return"object"==typeof e&&!!e&&"tilejson"in e&&null!=e.tilejson}function h(e){return!!e&&"sources"in e&&!!e.sources}async function p(e,t,i,h,p,y){const _=i?n.removeTrailingSlash(i)+"/":n.getAppBaseUrl(),d=function(e){const t=512;if(function(e){return e.hasOwnProperty("tileInfo")}(e)){const r=e?.tileInfo;return null!=r&&(null==r.rows&&(r.rows=t),null==r.cols&&(r.cols=t)),e}const i={xmin:-20037507.067161843,ymin:-20037507.067161843,xmax:20037507.067161843,ymax:20037507.067161843,spatialReference:{wkid:102100,latestWkid:3857}};let n=null;if(u(e)){const{bounds:t}=e;if(t){const e=s.geographicToWebMercator({x:t[0],y:t[1],spatialReference:r.clone(o.wgs84)}),i=s.geographicToWebMercator({x:t[2],y:t[3],spatialReference:r.clone(o.wgs84)});n={xmin:e.x,ymin:e.y,xmax:i.x,ymax:i.y,spatialReference:r.clone(o.webMercator)}}}null===n&&(n=i);let a=78271.51696400007,l=295828763.7957775;const c=[],h=e.hasOwnProperty("maxzoom")&&null!=e.maxzoom?+e.maxzoom:22;for(let e=0;e<=h;e++)c.push({level:e,scale:l,resolution:a}),a/=2,l/=2;return{capabilities:"TilesOnly",initialExtent:n,fullExtent:i,minScale:0,maxScale:0,tiles:e.tiles,tileInfo:{rows:t,cols:t,dpi:96,format:"pbf",origin:{x:-20037508.342787,y:20037508.342787},lods:c,spatialReference:r.clone(o.webMercator)}}}(t),f=new a(p,n.addQueryParameters(_,y?.query??{}),d);if(!h&&e.primarySourceName in e.sourceNameToSource){const t=e.sourceNameToSource[e.primarySourceName];if(!t.isCompatibleWith(f))return;null!=f.fullExtent&&(null!=t.fullExtent?t.fullExtent.union(f.fullExtent):t.fullExtent=f.fullExtent.clone()),t.tileInfo&&f.tileInfo&&t.tileInfo.lods.length<f.tileInfo.lods.length&&(t.tileInfo=f.tileInfo)}if(h&&(e.sourceBase=_,e.source=t,e.validatedSource=d,e.primarySourceName=p),e.sourceNameToSource[p]=f,!u(e)&&"defaultStyles"in t&&!e.style){if(null==t.defaultStyles)throw new Error;return"string"==typeof t.defaultStyles?c(e,"",l(_,t.defaultStyles,"root.json"),void 0,y):c(e,"",t.defaultStyles,l(_,"root.json"),y)}}e.loadMetadata=async function(e,t){const r={source:null,sourceBase:null,sourceUrl:null,validatedSource:null,style:null,styleBase:null,styleUrl:null,sourceNameToSource:{},primarySourceName:"",spriteFormat:"png"},[i,n]="string"==typeof e?[e,null]:[null,e.jsonUrl];return await c(r,"esri",e,n,t),{layerDefinition:r.validatedSource,url:i,serviceUrl:r.sourceUrl,style:r.style,styleUrl:r.styleUrl,spriteUrl:r.style.sprite&&l(r.styleBase,r.style.sprite),spriteFormat:r.spriteFormat,glyphsUrl:r.style.glyphs&&l(r.styleBase,r.style.glyphs),sourceNameToSource:r.sourceNameToSource,primarySourceName:r.primarySourceName}},Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})}))},"esri/views/2d/engine/vectorTiles/style/VectorTileSource":function(){define(["../../../../../core/lang","../../../../../core/urlUtils","../../../../../geometry/Extent","../../../../../layers/support/TileInfo","../../../../../layers/support/TilemapCache","../TilemapIndex","../TilemapRequest","./VectorTilesRequestManager"],(function(e,t,r,i,n,o,s,a){"use strict";return class{constructor(a,l,c){this.tilemap=null,this.tileInfo=null,this.capabilities=null,this.fullExtent=null,this.initialExtent=null,this.name=a,this.sourceUrl=l;const u=t.urlToObject(this.sourceUrl),h=e.clone(c),p=h.tiles;if(u)for(let e=0;e<p.length;e++){const r=t.urlToObject(p[e]);r&&(t.isAbsolute(r.path)||(r.path=t.join(u.path,r.path)),p[e]=t.addQueryParameters(r.path,{...u.query,...r.query}))}this.tileServers=p;const y=c.capabilities&&c.capabilities.split(",").map((e=>e.toLowerCase().trim())),_=!0===c?.exportTilesAllowed,d=!0===y?.includes("tilemap"),f=_&&c.hasOwnProperty("maxExportTilesCount")?c.maxExportTilesCount:0;this.capabilities={operations:{supportsExportTiles:_,supportsTileMap:d},exportTiles:_?{maxExportTilesCount:+f}:null},this.tileInfo=i.fromJSON(h.tileInfo);const m=c.tileMap?t.addQueryParameters(t.join(u.path,c.tileMap),u.query??{}):null;d?(this.type="vector-tile",this.tilemap=new s(new n.TilemapCache({layer:{parsedUrl:u,tileInfo:this.tileInfo},minLOD:h.minLOD??this.tileInfo.lods[0].level,maxLOD:h.maxLOD??this.tileInfo.lods[this.tileInfo.lods.length-1].level}),m)):m&&(this.tilemap=new o(m)),this.fullExtent=r.fromJSON(c.fullExtent),this.initialExtent=r.fromJSON(c.initialExtent)}destroy(){this.tilemap?.destroy()}async getRefKey(e,t){return this.tilemap?this.tilemap.dataKey(e,t):e}requestTile(e,t,r,i){const n=this.tileServers[t%this.tileServers.length];return a.request(n,e,t,r,i)}isCompatibleWith(e){const t=this.tileInfo,r=e.tileInfo;if(!t.spatialReference.equals(r.spatialReference))return!1;if(!t.origin.equals(r.origin))return!1;if(Math.round(t.dpi)!==Math.round(r.dpi))return!1;const i=t.lods,n=r.lods,o=Math.min(i.length,n.length);for(let e=0;e<o;e++){const t=i[e],r=n[e];if(t.level!==r.level||Math.round(t.scale)!==Math.round(r.scale))return!1}return!0}}}))},"esri/views/2d/engine/vectorTiles/TilemapIndex":function(){define(["../../../../request","../../../../core/promiseUtils","../../tiling/TileKey"],(function(e,t,r){"use strict";return class{constructor(e){this.url=e}destroy(){this._tileIndexPromise=null}async fetchTileIndex(){return this._tileIndexPromise||(this._tileIndexPromise=e(this.url).then((e=>e.data.index))),this._tileIndexPromise}async dataKey(e,r){const i=await this.fetchTileIndex();return t.throwIfAborted(r),this._getIndexedDataKey(i,e)}_getIndexedDataKey(e,t){const i=[t];if(t.level<0||t.row<0||t.col<0||t.row>>t.level>0||t.col>>t.level>0)return null;let n=t;for(;0!==n.level;)n=new r(n.level-1,n.row>>1,n.col>>1,n.world),i.push(n);let o,s,a=e,l=i.pop();if(1===a)return l;for(;i.length;)if(o=i.pop(),s=(1&o.col)+((1&o.row)<<1),a){if(0===a[s]){l=null;break}if(1===a[s]){l=o;break}l=o,a=a[s]}return l}}}))},"esri/views/2d/tiling/TileKey":function(){define(["../../../core/ObjectPool"],(function(e){"use strict";class t{static{this.pool=new e(t,null,null,25,50)}static getId(e,t,r,i){return"object"==typeof e?`${e.level}/${e.row}/${e.col}/${e.world}`:`${e}/${t}/${r}/${i}`}constructor(e,t,r,i){this.set(e,t,r,i)}get key(){return this}get id(){return this.toString()}get normalizedId(){return`${this.level}/${this.row}/${this.col}`}set id(e){this.set(e)}get hash(){const e=4095&this.row,t=4095&this.col,r=63&this.level;return(3&this.world)<<30|t<<22|e<<8|r}acquire(e,t,r,i){this.set(e,t,r,i)}contains(e){const t=e.level-this.level;return t>=0&&this.row===e.row>>t&&this.col===e.col>>t&&this.world===e.world}containsChild(e){const t=e.level-this.level;return t>0&&this.row===e.row>>t&&this.col===e.col>>t&&this.world===e.world}equals(e){return this.level===e.level&&this.row===e.row&&this.col===e.col&&this.world===e.world}clone(){return new t(this)}release(){this.level=0,this.row=0,this.col=0,this.world=0}set(e,t,r,i){if(null==e)this.level=0,this.row=0,this.col=0,this.world=0;else if("object"==typeof e)this.level=e.level||0,this.row=e.row||0,this.col=e.col||0,this.world=e.world||0;else if("string"==typeof e){const[t,r,i,n]=e.split("/");this.level=parseFloat(t),this.row=parseFloat(r),this.col=parseFloat(i),this.world=parseFloat(n)}else this.level=+e,this.row=+t,this.col=+r,this.world=+i||0;return this}toString(){return`${this.level}/${this.row}/${this.col}/${this.world}`}getParentKey(){return this.level<=0?null:new t(this.level-1,this.row>>1,this.col>>1,this.world)}getNormalizedNeighbor(e,t,r){const i=this.clone();return i.col+=e,i.row+=t,r.normalizeKey(i),i}getChildKeys(){const e=this.level+1,r=this.row<<1,i=this.col<<1,n=this.world;return[new t(e,r,i,n),new t(e,r,i+1,n),new t(e,r+1,i,n),new t(e,r+1,i+1,n)]}compareRowMajor(e){return this.row<e.row?-1:this.row>e.row?1:this.col<e.col?-1:this.col>e.col?1:0}}return t}))},"esri/views/2d/engine/vectorTiles/TilemapRequest":function(){define(["../../../../request","../../../../core/maybe","../../../../core/promiseUtils","../../tiling/TileKey"],(function(e,t,r,i){"use strict";return class{constructor(e,t){this._tilemap=e,this._tileIndexUrl=t}destroy(){this._tilemap=t.destroyMaybe(this._tilemap),this._tileIndexPromise=null}async fetchTileIndex(t){return this._tileIndexPromise||(this._tileIndexPromise=e(this._tileIndexUrl,{query:{...t?.query}}).then((e=>e.data.index))),this._tileIndexPromise}dataKey(e,t){const{level:n,row:o,col:s}=e,a=new i(e);return this._tilemap.fetchAvailabilityUpsample(n,o,s,a,t).then((()=>(a.world=e.world,a))).catch((e=>{if(r.isAbortError(e))throw e;return null}))}}}))},"esri/views/2d/engine/vectorTiles/style/VectorTilesRequestManager":function(){define(["exports","../../../../../request","../../../../../core/lang","../../../../../core/MapUtils","../../../../../core/promiseUtils","../../../../../core/urlUtils"],(function(e,t,r,i,n,o){"use strict";class s{constructor(e){this._tileUrl=e,this._promise=null,this._abortController=null,this._abortOptions=[]}getData(e){(null==this._promise||n.isAborted(this._abortController?.signal))&&(this._promise=this._makeRequest(this._tileUrl));const t=this._abortOptions;return t.push(e),n.onAbort(e,(()=>{t.every((e=>n.isAborted(e)))&&this._abortController.abort()})),this._promise.then((e=>r.clone(e)))}async _makeRequest(e){this._abortController=new AbortController;const{data:r}=await t(e,{responseType:"array-buffer",signal:this._abortController.signal});return r}}const a=new Map;e.request=function(e,t,r,n,l){const c=o.urlToObject(e),u=c.query;if(u)for(const[e,i]of Object.entries(u))switch(i){case"{x}":u[e]=n.toString();break;case"{y}":u[e]=r.toString();break;case"{z}":u[e]=t.toString()}const h=c.path;return function(e,t){return i.getOrCreateMapValue(a,e,(()=>new s(e))).getData(t).finally((()=>a.delete(e)))}(o.addQueryParameters(h.replaceAll(/\{z\}/gi,t.toString()).replaceAll(/\{y\}/gi,r.toString()).replaceAll(/\{x\}/gi,n.toString()),{...c.query}),l)},Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})}))},"esri/portal/support/jsonContext":function(){define(["exports","../../core/urlUtils","../Portal"],(function(e,t,r){"use strict";function i(e,i){return{origin:i,url:t.urlToObject(e.itemUrl),portal:e.portal||r.getDefault(),portalItem:e}}e.createForItemRead=function(e,t){return{...i(e,t),readResourcePaths:[]}},e.createForItemWrite=function(e,r,n){const o=t.urlToObject(e.itemUrl);return{...i(e,r),messages:[],writtenProperties:[],blockedRelativeUrls:[],verifyItemRelativeUrls:o?{rootPath:o.path,writtenUrls:[]}:null,resources:n?{toAdd:[],toUpdate:[],toKeep:[],pendingOperations:[]}:null}},Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})}))},"esri/views/2d/engine/vectorTiles/tileInfoUtils":function(){define(["exports","../../../../geometry/Point","../../../../layers/support/LOD","../../../../layers/support/TileInfo"],(function(e,t,r,i){"use strict";const n=1e-6;e.areSchemasOverlapping=function(e,t){if(e===t)return!0;if(null==e&&null!=t)return!1;if(null!=e&&null==t)return!1;if(null==e||null==t)return!1;if(!e.spatialReference.equals(t.spatialReference)||e.dpi!==t.dpi)return!1;const r=e.origin,i=t.origin;if(Math.abs(r.x-i.x)>=n||Math.abs(r.y-i.y)>=n)return!1;let o,s;e.lods[0].scale>t.lods[0].scale?(o=e,s=t):(s=e,o=t);for(let e=o.lods[0].scale;e>=s.lods[s.lods.length-1].scale-n;e/=2)if(Math.abs(e-s.lods[0].scale)<n)return!0;return!1},e.unionTileInfos=function(e,n){if(e===n)return e;if(null==e&&null!=n)return n;if(null!=e&&null==n)return e;if(null==e||null==n)return null;const o=e.size[0],s=e.format,a=e.dpi,l=new t({x:e.origin.x,y:e.origin.y}),c=e.spatialReference,u=e.lods[0].scale>n.lods[0].scale?e.lods[0]:n.lods[0],h=e.lods[e.lods.length-1].scale<=n.lods[n.lods.length-1].scale?e.lods[e.lods.length-1]:n.lods[n.lods.length-1],p=u.scale,y=u.resolution,_=h.scale,d=[];let f=p,m=y,T=0;for(;f>=_;)d.push(new r({level:T,resolution:m,scale:f})),T++,f/=2,m/=2;return new i({size:[o,o],dpi:a,format:s||"pbf",origin:l,lods:d,spatialReference:c})},Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})}))},"esri/views/2d/engine/vectorTiles/style/StyleRepository":function(){define(["../../../../../core/lang","./StyleDefinition","./StyleLayer"],(function(e,t,r){"use strict";class i{constructor(r,i=!0){if(this.backgroundBucketIds=[],this._uidToLayer=new Map,this._layerByName={},this._runningId=0,this._style=i?e.clone(r):r,this._style.layers||(this._style.layers=[]),this.version=parseFloat(this._style.version),this.layers=this._style.layers.map(((e,t,r)=>this._create(e,t,r))).filter((e=>!!e)),this.layers)for(let e=0;e<this.layers.length;e++){const r=this.layers[e];this._layerByName[r.id]=r,this._uidToLayer.set(r.uid,r),r.type===t.StyleLayerType.BACKGROUND&&this.backgroundBucketIds.push(r.id)}this._identifyRefLayers()}getLayerStyleProperties(e,r){const i=this.getStyleLayerByUID(e),n=i?.getLayoutValue("symbol-placement",r)!==t.SymbolPlacement.POINT;let o=i?.getLayoutValue("icon-rotation-alignment",r);o===t.RotationAlignment.AUTO&&(o=n?t.RotationAlignment.MAP:t.RotationAlignment.VIEWPORT);let s=i?.getLayoutValue("text-rotation-alignment",r);s===t.RotationAlignment.AUTO&&(s=n?t.RotationAlignment.MAP:t.RotationAlignment.VIEWPORT);const a=i?.getPaintValue("icon-translate",r),l=i?.getPaintValue("icon-translate-anchor",r),c=i?.getPaintValue("text-translate",r),u=i?.getPaintValue("text-translate-anchor",r);return{geometryType:null,iconAllowOverlap:i?.getLayoutValue("icon-allow-overlap",r),iconIgnorePlacement:i?.getLayoutValue("icon-ignore-placement",r),textAllowOverlap:i?.getLayoutValue("text-allow-overlap",r),textIgnorePlacement:i?.getLayoutValue("text-ignore-placement",r),iconRotationAlignment:o,textRotationAlignment:s,iconTranslateAnchor:l,iconTranslate:a,textTranslateAnchor:u,textTranslate:c}}isPainterDataDriven(e){const t=this._layerByName[e];return!!t&&t.isPainterDataDriven()}getStyleLayerId(e){return e>=this.layers.length?null:this.layers[e].id}getStyleLayerByUID(e){return this._uidToLayer.get(e)??null}getStyleLayerIndex(e){const t=this._layerByName[e];return t?this.layers.indexOf(t):-1}setStyleLayer(e,t){if(!e?.id)return;const r=this._style;null!=t&&t>=this.layers.length&&(t=this.layers.length-1);let n,o=!0;const s=this._layerByName[e.id];if(s){const a=this.layers.indexOf(s);t||(t=a),t===a?(o=!1,n=i._recreateLayer(e,s),this.layers[t]=n,r.layers[t]=e):(this.layers.splice(a,1),r.layers.splice(a,1),n=this._create(e,t,this.layers),this.layers.splice(t,0,n),r.layers.splice(t,0,e))}else n=this._create(e,t,this.layers),!t||t>=this.layers.length?(this.layers.push(n),r.layers.push(e)):(this.layers.splice(t,0,n),r.layers.splice(t,0,e));this._layerByName[e.id]=n,this._uidToLayer.set(n.uid,n),o&&this._recomputeZValues(),this._identifyRefLayers()}getStyleLayer(e){const t=this._layerByName[e];return t?{type:t.typeName,id:t.id,source:t.source,"source-layer":t.sourceLayer,minzoom:t.minzoom,maxzoom:t.maxzoom,filter:t.filter,layout:t.layout,paint:t.paint}:null}deleteStyleLayer(e){const t=this._layerByName[e];if(t){delete this._layerByName[e],this._uidToLayer.delete(t.uid);const r=this.layers.indexOf(t);this.layers.splice(r,1),this._style.layers.splice(r,1),this._recomputeZValues(),this._identifyRefLayers()}}getLayerById(e){return this._layerByName[e]}getLayoutProperties(e){const t=this._layerByName[e];return t?t.layout:null}getPaintProperties(e){const t=this._layerByName[e];return t?t.paint:null}setPaintProperties(e,t){const r=this._layerByName[e];if(!r)return;const n={type:r.typeName,id:r.id,source:r.source,"source-layer":r.sourceLayer,minzoom:r.minzoom,maxzoom:r.maxzoom,filter:r.filter,layout:r.layout,paint:t},o=i._recreateLayer(n,r),s=this.layers.indexOf(r);this.layers[s]=o,this._style.layers[s].paint=t,this._layerByName[r.id]=o,this._uidToLayer.set(r.uid,o)}setLayoutProperties(e,t){const r=this._layerByName[e];if(!r)return;const n={type:r.typeName,id:r.id,source:r.source,"source-layer":r.sourceLayer,minzoom:r.minzoom,maxzoom:r.maxzoom,filter:r.filter,layout:t,paint:r.paint},o=i._recreateLayer(n,r),s=this.layers.indexOf(r);this.layers[s]=o,this._style.layers[s].layout=t,this._layerByName[r.id]=o,this._uidToLayer.set(r.uid,o)}setStyleLayerVisibility(e,t){const r=this._layerByName[e];if(!r)return;const n=r.layout||{};n.visibility=t;const o={type:r.typeName,id:r.id,source:r.source,"source-layer":r.sourceLayer,minzoom:r.minzoom,maxzoom:r.maxzoom,filter:r.filter,layout:n,paint:r.paint},s=i._recreateLayer(o,r),a=this.layers.indexOf(r);this.layers[a]=s,this._style.layers[a].layout=n,this._layerByName[r.id]=s,this._uidToLayer.set(r.uid,s)}getStyleLayerVisibility(e){const t=this._layerByName[e];if(!t)return"none";const r=t.layout;return r?.visibility??"visible"}_recomputeZValues(){const e=this.layers,t=1/(e.length+1);for(let r=0;r<e.length;r++)e[r].z=1-(1+r)*t}_identifyRefLayers(){const e=[],r=[];let i=0;for(const n of this.layers){const o=n.layout;if(n.type===t.StyleLayerType.FILL){const t=n;let r=n.source+"|"+n.sourceLayer;r+="|"+(o?.visibility??""),r+="|"+n.minzoom,r+="|"+n.maxzoom,r+="|"+JSON.stringify(n.filter),(t.hasDataDrivenFill||t.hasDataDrivenOutline)&&(r+="|"+i),e.push({key:r,layer:n})}else if(n.type===t.StyleLayerType.LINE){const e=n,t=n.paint,s=null!=t&&(null!=t["line-pattern"]||null!=t["line-dasharray"]);let a=n.source+"|"+n.sourceLayer;a+="|"+(o?.visibility??""),a+="|"+n.minzoom,a+="|"+n.maxzoom,a+="|"+JSON.stringify(n.filter),a+="|"+(void 0!==o?o["line-cap"]:""),a+="|"+(void 0!==o?o["line-join"]:""),(e.hasDataDrivenLine||s)&&(a+="|"+i),r.push({key:a,layer:n})}++i}this._assignRefLayers(e),this._assignRefLayers(r)}_assignRefLayers(e){let r,i;e.sort(((e,t)=>e.key<t.key?-1:e.key>t.key?1:0));const n=e.length;for(let o=0;o<n;o++){const s=e[o];if(s.key===r)s.layer.refLayerId=i;else if(r=s.key,i=s.layer.id,s.layer.type===t.StyleLayerType.FILL){if(!s.layer.getPaintProperty("fill-outline-color"))for(let t=o+1;t<n;t++){const n=e[t];if(n.key!==r)break;if(n.layer.getPaintProperty("fill-outline-color")){e[o]=n,e[t]=s,i=n.layer.id;break}}}else if(s.layer.type===t.StyleLayerType.LINE){let t=s.layer;for(let a=o+1;a<n;a++){const n=e[a];if(n.key!==r)break;const l=n.layer;(t.canUseThinTessellation&&!l.canUseThinTessellation||!t.canUseThinTessellation&&(l.getPaintProperty("line-pattern")||l.getPaintProperty("line-dasharray")))&&(t=l,e[o]=n,e[a]=s,i=n.layer.id)}}}}_create(e,i,n){const o=1-(1+i)*(1/(n.length+1)),s=this._runningId++;switch(e.type){case"background":return new r.BackgroundStyleLayer(t.StyleLayerType.BACKGROUND,e,o,s);case"fill":return new r.FillStyleLayer(t.StyleLayerType.FILL,e,o,s);case"line":return new r.LineStyleLayer(t.StyleLayerType.LINE,e,o,s);case"symbol":return new r.SymbolStyleLayer(t.StyleLayerType.SYMBOL,e,o,s);case"raster":return console.warn(`Unsupported vector tile raster layer ${e.id}`),null;case"circle":return new r.CircleStyleLayer(t.StyleLayerType.CIRCLE,e,o,s)}return null}static _recreateLayer(e,i){switch(e.type){case"background":return new r.BackgroundStyleLayer(t.StyleLayerType.BACKGROUND,e,i.z,i.uid);case"fill":return new r.FillStyleLayer(t.StyleLayerType.FILL,e,i.z,i.uid);case"line":return new r.LineStyleLayer(t.StyleLayerType.LINE,e,i.z,i.uid);case"symbol":return new r.SymbolStyleLayer(t.StyleLayerType.SYMBOL,e,i.z,i.uid);case"raster":return console.warn(`Unsupported vector tile raster layer ${e.id}`),null;case"circle":return new r.CircleStyleLayer(t.StyleLayerType.CIRCLE,e,i.z,i.uid)}return null}}return i}))},"esri/views/2d/engine/vectorTiles/style/StyleDefinition":function(){define(["exports","../../../../../symbols/cim/enums"],(function(e,t){"use strict";var r,i,n,o,s,a,l,c,u;e.StyleLayerType=void 0,(r=e.StyleLayerType||(e.StyleLayerType={}))[r.BACKGROUND=0]="BACKGROUND",r[r.FILL=1]="FILL",r[r.LINE=2]="LINE",r[r.SYMBOL=3]="SYMBOL",r[r.CIRCLE=4]="CIRCLE",e.Visibility=void 0,(i=e.Visibility||(e.Visibility={}))[i.VISIBLE=0]="VISIBLE",i[i.NONE=1]="NONE",e.SymbolPlacement=void 0,(n=e.SymbolPlacement||(e.SymbolPlacement={}))[n.POINT=0]="POINT",n[n.LINE=1]="LINE",n[n.LINE_CENTER=2]="LINE_CENTER",e.RotationAlignment=void 0,(o=e.RotationAlignment||(e.RotationAlignment={}))[o.MAP=0]="MAP",o[o.VIEWPORT=1]="VIEWPORT",o[o.AUTO=2]="AUTO",e.TextJustification=void 0,(s=e.TextJustification||(e.TextJustification={}))[s.AUTO=0]="AUTO",s[s.LEFT=1]="LEFT",s[s.CENTER=2]="CENTER",s[s.RIGHT=3]="RIGHT",e.SymbolAnchor=void 0,(a=e.SymbolAnchor||(e.SymbolAnchor={}))[a.CENTER=0]="CENTER",a[a.LEFT=1]="LEFT",a[a.RIGHT=2]="RIGHT",a[a.TOP=3]="TOP",a[a.BOTTOM=4]="BOTTOM",a[a.TOP_LEFT=5]="TOP_LEFT",a[a.TOP_RIGHT=6]="TOP_RIGHT",a[a.BOTTOM_LEFT=7]="BOTTOM_LEFT",a[a.BOTTOM_RIGHT=8]="BOTTOM_RIGHT",e.TextTransform=void 0,(l=e.TextTransform||(e.TextTransform={}))[l.NONE=0]="NONE",l[l.UPPERCASE=1]="UPPERCASE",l[l.LOWERCASE=2]="LOWERCASE",e.TranslateAnchor=void 0,(c=e.TranslateAnchor||(e.TranslateAnchor={}))[c.MAP=0]="MAP",c[c.VIEWPORT=1]="VIEWPORT",e.TextWritingMode=void 0,(u=e.TextWritingMode||(e.TextWritingMode={}))[u.HORIZONTAL=0]="HORIZONTAL",u[u.VERTICAL=1]="VERTICAL";class h{static{this.backgroundLayoutDefinition={visibility:{type:"enum",values:["visible","none"],default:e.Visibility.VISIBLE}}}static{this.fillLayoutDefinition={visibility:{type:"enum",values:["visible","none"],default:e.Visibility.VISIBLE}}}static{this.lineLayoutDefinition={visibility:{type:"enum",values:["visible","none"],default:e.Visibility.VISIBLE},"line-cap":{type:"enum",values:["butt","round","square"],default:t.CapType.BUTT},"line-join":{type:"enum",values:["bevel","round","miter"],default:t.JoinType.MITER},"line-miter-limit":{type:"number",default:2},"line-round-limit":{type:"number",default:1.05}}}static{this.symbolLayoutDefinition={visibility:{type:"enum",values:["visible","none"],default:e.Visibility.VISIBLE},"symbol-avoid-edges":{type:"boolean",default:!1},"symbol-placement":{type:"enum",values:["point","line","line-center"],default:e.SymbolPlacement.POINT},"symbol-sort-key":{type:"number",default:-1},"symbol-spacing":{type:"number",minimum:1,default:250},"icon-allow-overlap":{type:"boolean",default:!1},"icon-anchor":{type:"enum",values:["center","left","right","top","bottom","top-left","top-right","bottom-left","bottom-right"],default:e.SymbolAnchor.CENTER},"icon-ignore-placement":{type:"boolean",default:!1},"icon-image":{type:"string"},"icon-keep-upright":{type:"boolean",default:!1},"icon-offset":{type:"array",value:"number",length:2,default:[0,0]},"icon-optional":{type:"boolean",default:!1},"icon-padding":{type:"number",minimum:0,default:2},"icon-rotate":{type:"number",default:0},"icon-rotation-alignment":{type:"enum",values:["map","viewport","auto"],default:e.RotationAlignment.AUTO},"icon-size":{type:"number",minimum:0,default:1},"text-allow-overlap":{type:"boolean",default:!1},"text-anchor":{type:"enum",values:["center","left","right","top","bottom","top-left","top-right","bottom-left","bottom-right"],default:e.SymbolAnchor.CENTER},"text-field":{type:"string"},"text-font":{type:"array",value:"string",default:["Open Sans Regular","Arial Unicode MS Regular"]},"text-ignore-placement":{type:"boolean",default:!1},"text-justify":{type:"enum",values:["auto","left","center","right"],default:e.TextJustification.CENTER},"text-keep-upright":{type:"boolean",default:!0},"text-letter-spacing":{type:"number",default:0},"text-line-height":{type:"number",default:1.2},"text-max-angle":{type:"number",minimum:0,default:45},"text-max-width":{type:"number",minimum:0,default:10},"text-offset":{type:"array",value:"number",length:2,default:[0,0]},"text-optional":{type:"boolean",default:!1},"text-padding":{type:"number",minimum:0,default:2},"text-rotate":{type:"number",default:0},"text-rotation-alignment":{type:"enum",values:["map","viewport","auto"],default:e.RotationAlignment.AUTO},"text-size":{type:"number",minimum:0,default:16},"text-transform":{type:"enum",values:["none","uppercase","lowercase"],default:e.TextTransform.NONE},"text-writing-mode":{type:"array",value:"enum",values:["horizontal","vertical"],default:[e.TextWritingMode.HORIZONTAL]}}}static{this.circleLayoutDefinition={visibility:{type:"enum",values:["visible","none"],default:e.Visibility.VISIBLE}}}static{this.backgroundPaintDefinition={"background-color":{type:"color",default:[0,0,0,1]},"background-opacity":{type:"number",minimum:0,maximum:1,default:1},"background-pattern":{type:"string"}}}static{this.fillPaintDefinition={"fill-antialias":{type:"boolean",default:!0},"fill-color":{type:"color",default:[0,0,0,1]},"fill-opacity":{type:"number",minimum:0,maximum:1,default:1},"fill-outline-color":{type:"color",default:[0,0,0,0]},"fill-pattern":{type:"string"},"fill-translate":{type:"array",value:"number",length:2,default:[0,0]},"fill-translate-anchor":{type:"enum",values:["map","viewport"],default:e.TranslateAnchor.MAP}}}static{this.linePaintDefinition={"line-blur":{type:"number",minimum:0,default:0},"line-color":{type:"color",default:[0,0,0,1]},"line-dasharray":{type:"array",value:"number",default:[]},"line-gap-width":{type:"number",minimum:0,default:0},"line-offset":{type:"number",default:0},"line-opacity":{type:"number",minimum:0,maximum:1,default:1},"line-pattern":{type:"string"},"line-translate":{type:"array",value:"number",length:2,default:[0,0]},"line-translate-anchor":{type:"enum",values:["map","viewport"],default:e.TranslateAnchor.MAP},"line-width":{type:"number",minimum:0,default:1}}}static{this.symbolPaintDefinition={"icon-color":{type:"color",default:[0,0,0,1]},"icon-halo-blur":{type:"number",minimum:0,default:0},"icon-halo-color":{type:"color",default:[0,0,0,0]},"icon-halo-width":{type:"number",minimum:0,default:0},"icon-opacity":{type:"number",minimum:0,maximum:1,default:1},"icon-translate":{type:"array",value:"number",length:2,default:[0,0]},"icon-translate-anchor":{type:"enum",values:["map","viewport"],default:e.TranslateAnchor.MAP},"text-color":{type:"color",default:[0,0,0,1]},"text-halo-blur":{type:"number",minimum:0,default:0},"text-halo-color":{type:"color",default:[0,0,0,0]},"text-halo-width":{type:"number",minimum:0,default:0},"text-opacity":{type:"number",minimum:0,maximum:1,default:1},"text-translate":{type:"array",value:"number",length:2,default:[0,0]},"text-translate-anchor":{type:"enum",values:["map","viewport"],default:e.TranslateAnchor.MAP}}}static{this.rasterPaintDefinition={"raster-opacity":{type:"number",minimum:0,maximum:1,default:1},"raster-hue-rotate":{type:"number",default:0},"raster-brightness-min":{type:"number",minimum:0,maximum:1,default:0},"raster-brightness-max":{type:"number",minimum:0,maximum:1,default:1},"raster-saturation":{type:"number",minimum:-1,maximum:1,default:0},"raster-contrast":{type:"number",minimum:-1,maximum:1,default:0},"raster-fade-duration":{type:"number",minimum:0,default:300}}}static{this.circlePaintDefinition={"circle-blur":{type:"number",minimum:0,default:0},"circle-color":{type:"color",default:[0,0,0,1]},"circle-opacity":{type:"number",minimum:0,maximum:1,default:1},"circle-radius":{type:"number",minimum:0,default:5},"circle-stroke-color":{type:"color",default:[0,0,0,1]},"circle-stroke-opacity":{type:"number",minimum:0,maximum:1,default:1},"circle-stroke-width":{type:"number",minimum:0,default:0},"circle-translate":{type:"array",value:"number",length:2,default:[0,0]},"circle-translate-anchor":{type:"enum",values:["map","viewport"],default:e.TranslateAnchor.MAP}}}}e.StyleDefinition=h,Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})}))},"esri/views/2d/engine/vectorTiles/style/StyleLayer":function(){define(["exports","../../../../../geometry/support/aaBoundingRect","../constants","../enums","../GeometryUtils","../shaders/VTLBackgroundMaterial","../shaders/VTLCircleMaterial","../shaders/VTLFillMaterial","../shaders/VTLLineMaterial","../shaders/VTLSymbolMaterial","./Filter","./StyleDefinition","./StyleProperty","../../webgl/definitions"],(function(e,t,r,i,n,o,s,a,l,c,u,h,p,y){"use strict";var _;e.CapType=void 0,(_=e.CapType||(e.CapType={}))[_.BUTT=0]="BUTT",_[_.ROUND=1]="ROUND",_[_.SQUARE=2]="SQUARE",_[_.UNKNOWN=4]="UNKNOWN";class d{constructor(e,t,r,i){switch(this.type=e,this.typeName=t.type,this.id=t.id,this.source=t.source,this.sourceLayer=t["source-layer"],this.minzoom=t.minzoom,this.maxzoom=t.maxzoom,this.filter=t.filter,this.layout=t.layout,this.paint=t.paint,this.z=r,this.uid=i,e){case h.StyleLayerType.BACKGROUND:this._layoutDefinition=h.StyleDefinition.backgroundLayoutDefinition,this._paintDefinition=h.StyleDefinition.backgroundPaintDefinition;break;case h.StyleLayerType.FILL:this._layoutDefinition=h.StyleDefinition.fillLayoutDefinition,this._paintDefinition=h.StyleDefinition.fillPaintDefinition;break;case h.StyleLayerType.LINE:this._layoutDefinition=h.StyleDefinition.lineLayoutDefinition,this._paintDefinition=h.StyleDefinition.linePaintDefinition;break;case h.StyleLayerType.SYMBOL:this._layoutDefinition=h.StyleDefinition.symbolLayoutDefinition,this._paintDefinition=h.StyleDefinition.symbolPaintDefinition;break;case h.StyleLayerType.CIRCLE:this._layoutDefinition=h.StyleDefinition.circleLayoutDefinition,this._paintDefinition=h.StyleDefinition.circlePaintDefinition}this._layoutProperties=this._parseLayout(this.layout),this._paintProperties=this._parsePaint(this.paint)}getFeatureFilter(){return void 0!==this._featureFilter?this._featureFilter:this._featureFilter=u.createFilter(this.filter)}getLayoutProperty(e){return this._layoutProperties[e]}getPaintProperty(e){return this._paintProperties[e]}getLayoutValue(e,t,r){let i;const n=this._layoutProperties[e];return n&&(i=n.getValue(t,r)),void 0===i&&(i=this._layoutDefinition[e].default),i}getPaintValue(e,t,r){let i;const n=this._paintProperties[e];return n&&(i=n.getValue(t,r)),void 0===i&&(i=this._paintDefinition[e].default),i}isPainterDataDriven(){const e=this._paintProperties;if(e)for(const t in e)if(e[t].isDataDriven)return!0;return!1}isIntersectingFeature(e,t,r,i,n,o,s){return!1}getFeatureInflatedBounds(e,t,r,i){return null}_parseLayout(e){const t={};for(const r in e){const i=this._layoutDefinition[r];i&&(t[r]=new p(i,e[r]))}return t}_parsePaint(e){const t={};for(const r in e){const i=this._paintDefinition[r];i&&(t[r]=new p(i,e[r]))}return t}computeAttributesKey(e,t,r,i){let n=0,o=0;for(const e of t){let t=3;if(!e||e!==i){const i=r[e],{isLayout:n,isOptional:o}=i,s=n?this.getLayoutProperty(e):this.getPaintProperty(e);t=s?.interpolator?2:s?.isDataDriven?1:o&&!s?3:0}o|=t<<n,n+=2}return o<<3|e}}function f(e){const r=e?.getGeometry();if(null==r)return null;let i=1/0,n=1/0,o=-1/0,s=-1/0;for(const e of r)if(e)for(const t of e)i=Math.min(i,t.x),n=Math.min(n,t.y),o=Math.max(o,t.x),s=Math.max(s,t.y);return t.fromValues(i,n,o,s)}e.BackgroundStyleLayer=class extends d{constructor(e,t,r,n){super(e,t,r,n),this.backgroundMaterial=new o.VTLBackgroundMaterial(this.computeAttributesKey(i.ShaderProgramType.BACKGROUND,o.VTLBackgroundMaterial.ATTRIBUTES,o.VTLBackgroundMaterial.ATTRIBUTES_INFO))}},e.CircleStyleLayer=class extends d{constructor(e,t,r,n){super(e,t,r,n),this.circleMaterial=new s.VTLCircleMaterial(this.computeAttributesKey(i.ShaderProgramType.CIRCLE,s.VTLCircleMaterial.ATTRIBUTES,s.VTLCircleMaterial.ATTRIBUTES_INFO))}getFeatureInflatedBounds(e,t,i,n){const o=f(e);if(!o)return null;const s=this.getPaintValue("circle-translate",t,e),a=Math.max(s[0],s[1]);o[0]-=a,o[2]-=a,o[1]+=a,o[3]+=a;const l=n*(r.tilePixelRatio*(this.getPaintValue("circle-radius",t,e)+this.getPaintValue("circle-stroke-width",t,e))/2);return o[0]-=l,o[1]-=l,o[2]+=l,o[3]+=l,o}isIntersectingFeature(e,t,i,o,s,a,l){const c=o.getGeometry();if(!c)return!1;const u=r.tilePixelRatio/l.normalizationRatio;e=e/l.normalizationRatio+l.normalizationOffsetX,t=t/l.normalizationRatio+l.normalizationOffsetY,i*=u;const h=n.translateAnchor(this.getPaintValue("circle-translate",s,o),this.getPaintValue("circle-translate-anchor",s,o),a,u),p=u*(this.getPaintValue("circle-radius",s,o)+this.getPaintValue("circle-stroke-width",s,o));let y,_;for(const r of c)if(r)for(const n of r)if(y=n.x+h.x,_=n.y+h.y,Math.sqrt((e-y)*(e-y)+(t-_)*(t-_))-i<=p)return!0;return!1}},e.FillStyleLayer=class extends d{constructor(e,t,r,n){super(e,t,r,n);const o=this.getPaintProperty("fill-color"),s=this.getPaintProperty("fill-opacity"),l=this.getPaintProperty("fill-pattern");this.hasDataDrivenColor=o?.isDataDriven,this.hasDataDrivenOpacity=s?.isDataDriven,this.hasDataDrivenFill=this.hasDataDrivenColor||this.hasDataDrivenOpacity||l?.isDataDriven;const c=this.getPaintProperty("fill-outline-color");this.outlineUsesFillColor=!c,this.hasDataDrivenOutlineColor=c?.isDataDriven,this.hasDataDrivenOutline=c?c.isDataDriven:!!o&&o.isDataDriven,this.hasDataDrivenOutline=(c?this.hasDataDrivenOutlineColor:this.hasDataDrivenColor)||this.hasDataDrivenOpacity,this.fillMaterial=new a.VTLFillMaterial(this.computeAttributesKey(i.ShaderProgramType.FILL,a.VTLFillMaterial.ATTRIBUTES,a.VTLFillMaterial.ATTRIBUTES_INFO)),this.outlineMaterial=new a.VTLOutlineMaterial(this.computeAttributesKey(i.ShaderProgramType.OUTLINE,this.outlineUsesFillColor?a.VTLOutlineMaterial.ATTRIBUTES_FILL:a.VTLOutlineMaterial.ATTRIBUTES_OUTLINE,this.outlineUsesFillColor?a.VTLOutlineMaterial.ATTRIBUTES_INFO_FILL:a.VTLOutlineMaterial.ATTRIBUTES_INFO_OUTLINE),this.outlineUsesFillColor)}getFeatureInflatedBounds(e,t,r,i){const n=f(e);if(!n)return null;const o=this.getPaintValue("fill-translate",t,e),s=i*Math.max(o[0],o[1]);return n[0]-=s,n[2]-=s,n[1]+=s,n[3]+=s,n}isIntersectingFeature(e,t,i,o,s,a,l){const c=o.getGeometry();if(!c)return!1;const u=r.tilePixelRatio/l.normalizationRatio;e=e/l.normalizationRatio+l.normalizationOffsetX,t=t/l.normalizationRatio+l.normalizationOffsetY;const h=n.translateAnchor(this.getPaintValue("fill-translate",s,o),this.getPaintValue("fill-translate-anchor",s,o),a,r.tilePixelRatio);return e-=u*h.x,t-=u*h.y,!!n.pointInPolygon(e,t,c)||n.distanceFromToPolylineWithinThreshold(e,t,c,u*i)}},e.IconLayout=class{constructor(e,t,r){let i;this.allowOverlap=e.getLayoutValue("icon-allow-overlap",t),this.ignorePlacement=e.getLayoutValue("icon-ignore-placement",t),this.keepUpright=e.getLayoutValue("icon-keep-upright",t),this.optional=e.getLayoutValue("icon-optional",t),this.rotationAlignment=e.getLayoutValue("icon-rotation-alignment",t),this.rotationAlignment===h.RotationAlignment.AUTO&&(this.rotationAlignment=r?h.RotationAlignment.MAP:h.RotationAlignment.VIEWPORT),i=e.getLayoutProperty("icon-anchor"),i?.isDataDriven?this._anchorProp=i:this.anchor=e.getLayoutValue("icon-anchor",t),i=e.getLayoutProperty("icon-offset"),i?.isDataDriven?this._offsetProp=i:this.offset=e.getLayoutValue("icon-offset",t),i=e.getLayoutProperty("icon-padding"),i?.isDataDriven?this._paddingProp=i:this.padding=e.getLayoutValue("icon-padding",t),i=e.getLayoutProperty("icon-rotate"),i?.isDataDriven?this._rotateProp=i:this.rotate=e.getLayoutValue("icon-rotate",t),i=e.getLayoutProperty("icon-size"),i?.isDataDriven?this._sizeProp=i:this.size=e.getLayoutValue("icon-size",t)}update(e,t){this._anchorProp&&(this.anchor=this._anchorProp.getValue(e,t)),this._offsetProp&&(this.offset=this._offsetProp.getValue(e,t)),this._paddingProp&&(this.padding=this._paddingProp.getValue(e,t)),this._rotateProp&&(this.rotate=this._rotateProp.getValue(e,t)),this._sizeProp&&(this.size=this._sizeProp.getValue(e,t))}},e.IndexItem=class{constructor(e,t,r,i,n,o){this.layer=e,this.feature=t,this.bounds=r,this.normalizationRatio=i,this.normalizationOffsetX=n,this.normalizationOffsetY=o}},e.LineStyleLayer=class extends d{constructor(e,t,r,n){super(e,t,r,n);const o=this.getPaintProperty("line-pattern");if(this.lineMaterial=new l.VTLLineMaterial(this.computeAttributesKey(i.ShaderProgramType.LINE,l.VTLLineMaterial.ATTRIBUTES,l.VTLLineMaterial.ATTRIBUTES_INFO,o?"line-dasharray":"")),this.hasDataDrivenLine=this.getPaintProperty("line-blur")?.isDataDriven||this.getPaintProperty("line-color")?.isDataDriven||this.getPaintProperty("line-gap-width")?.isDataDriven||this.getPaintProperty("line-offset")?.isDataDriven||this.getPaintProperty("line-opacity")?.isDataDriven||this.getPaintProperty("line-pattern")?.isDataDriven||this.getPaintProperty("line-dasharray")?.isDataDriven||this.getLayoutProperty("line-cap")?.isDataDriven||this.getPaintProperty("line-width")?.isDataDriven,this.canUseThinTessellation=!1,!this.hasDataDrivenLine){const e=this.getPaintProperty("line-width");if(!e||"number"==typeof e&&.5*e<y.thinLineHalfWidthThreshold){const e=this.getPaintProperty("line-offset");(!e||"number"==typeof e&&0===e)&&(this.canUseThinTessellation=!0)}}}getDashKey(t,r){let i;switch(r){case e.CapType.BUTT:i="Butt";break;case e.CapType.ROUND:i="Round";break;case e.CapType.SQUARE:i="Square";break;default:i="Butt"}return`dasharray-[${t.toString()}]-${i}`}getFeatureInflatedBounds(e,t,r,i){const n=f(e);if(!n)return null;const o=this.getPaintValue("line-translate",t,e),s=i*Math.max(o[0],o[1]);n[0]-=s,n[2]-=s,n[1]+=s,n[3]+=s;const a=i*Math.abs(this.getPaintValue("line-offset",t,e)||0),l=i*(this.getPaintValue("line-width",t,e)/2);return n[0]-=a+l,n[1]-=a+l,n[2]+=a+l,n[3]+=a+l,n}isIntersectingFeature(e,t,i,o,s,a,l){let c=o.getGeometry();if(!c)return!1;const u=r.tilePixelRatio/l.normalizationRatio;e=e/l.normalizationRatio+l.normalizationOffsetX,t=t/l.normalizationRatio+l.normalizationOffsetY;const h=n.translateAnchor(this.getPaintValue("line-translate",s,o),this.getPaintValue("line-translate-anchor",s,o),a,r.tilePixelRatio);e-=u*h.x,t-=u*h.y;const p=u*this.getPaintValue("line-offset",s,o)||0;0!==p&&(c=n.offsetLine(c,-p));const y=this.getPaintValue("line-width",s,o)/2;return n.distanceFromToPolylineWithinThreshold(e,t,c,u*(i+y))}},e.StyleLayer=d,e.SymbolStyleLayer=class extends d{constructor(e,t,r,n){super(e,t,r,n),this.iconMaterial=new c.VTLIconMaterial(this.computeAttributesKey(i.ShaderProgramType.ICON,c.VTLIconMaterial.ATTRIBUTES,c.VTLIconMaterial.ATTRIBUTES_INFO)),this.textMaterial=new c.VTLTextMaterial(this.computeAttributesKey(i.ShaderProgramType.TEXT,c.VTLTextMaterial.ATTRIBUTES,c.VTLTextMaterial.ATTRIBUTES_INFO)),this.hasDataDrivenIcon=this.getPaintProperty("icon-color")?.isDataDriven||this.getPaintProperty("icon-halo-blur")?.isDataDriven||this.getPaintProperty("icon-halo-color")?.isDataDriven||this.getPaintProperty("icon-halo-width")?.isDataDriven||this.getPaintProperty("icon-opacity")?.isDataDriven||this.getLayoutProperty("icon-size")?.isDataDriven,this.hasDataDrivenText=this.getPaintProperty("text-color")?.isDataDriven||this.getPaintProperty("text-halo-blur")?.isDataDriven||this.getPaintProperty("text-halo-color")?.isDataDriven||this.getPaintProperty("text-halo-width")?.isDataDriven||this.getPaintProperty("text-opacity")?.isDataDriven||this.getLayoutProperty("text-size")?.isDataDriven}},e.TextLayout=class{constructor(e,t,r){let i;this.allowOverlap=e.getLayoutValue("text-allow-overlap",t),this.ignorePlacement=e.getLayoutValue("text-ignore-placement",t),this.keepUpright=e.getLayoutValue("text-keep-upright",t),this.optional=e.getLayoutValue("text-optional",t),this.rotationAlignment=e.getLayoutValue("text-rotation-alignment",t),this.rotationAlignment===h.RotationAlignment.AUTO&&(this.rotationAlignment=r?h.RotationAlignment.MAP:h.RotationAlignment.VIEWPORT),i=e.getLayoutProperty("text-anchor"),i?.isDataDriven?this._anchorProp=i:this.anchor=e.getLayoutValue("text-anchor",t),i=e.getLayoutProperty("text-justify"),i?.isDataDriven?this._justifyProp=i:this.justify=e.getLayoutValue("text-justify",t),i=e.getLayoutProperty("text-letter-spacing"),i?.isDataDriven?this._letterSpacingProp=i:this.letterSpacing=e.getLayoutValue("text-letter-spacing",t),i=e.getLayoutProperty("text-line-height"),i?.isDataDriven?this._lineHeightProp=i:this.lineHeight=e.getLayoutValue("text-line-height",t),i=e.getLayoutProperty("text-max-angle"),i?.isDataDriven?this._maxAngleProp=i:this.maxAngle=e.getLayoutValue("text-max-angle",t),i=e.getLayoutProperty("text-max-width"),i?.isDataDriven?this._maxWidthProp=i:this.maxWidth=e.getLayoutValue("text-max-width",t),i=e.getLayoutProperty("text-offset"),i?.isDataDriven?this._offsetProp=i:this.offset=e.getLayoutValue("text-offset",t),i=e.getLayoutProperty("text-padding"),i?.isDataDriven?this._paddingProp=i:this.padding=e.getLayoutValue("text-padding",t),i=e.getLayoutProperty("text-rotate"),i?.isDataDriven?this._rotateProp=i:this.rotate=e.getLayoutValue("text-rotate",t),i=e.getLayoutProperty("text-size"),i?.isDataDriven?this._sizeProp=i:this.size=e.getLayoutValue("text-size",t),i=e.getLayoutProperty("text-writing-mode"),i?.isDataDriven?this._writingModeProp=i:this.writingMode=e.getLayoutValue("text-writing-mode",t)}update(e,t){this._anchorProp&&(this.anchor=this._anchorProp.getValue(e,t)),this._justifyProp&&(this.justify=this._justifyProp.getValue(e,t)),this._letterSpacingProp&&(this.letterSpacing=this._letterSpacingProp.getValue(e,t)),this._lineHeightProp&&(this.lineHeight=this._lineHeightProp.getValue(e,t)),this._maxAngleProp&&(this.maxAngle=this._maxAngleProp.getValue(e,t)),this._maxWidthProp&&(this.maxWidth=this._maxWidthProp.getValue(e,t)),this._offsetProp&&(this.offset=this._offsetProp.getValue(e,t)),this._paddingProp&&(this.padding=this._paddingProp.getValue(e,t)),this._rotateProp&&(this.rotate=this._rotateProp.getValue(e,t)),this._sizeProp&&(this.size=this._sizeProp.getValue(e,t)),this._writingModeProp&&(this.writingMode=this._writingModeProp.getValue(e,t))}},Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})}))},"esri/views/2d/engine/vectorTiles/constants":function(){define(["exports"],(function(e){"use strict";e.tileCoordSize=4096,e.tileCoordinateScale=.125,e.tilePixelRatio=8,e.tilePixelSize=512,Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})}))},"esri/views/2d/engine/vectorTiles/enums":function(){define(["exports"],(function(e){"use strict";var t,r,i;e.BucketType=void 0,(t=e.BucketType||(e.BucketType={}))[t.FILL=1]="FILL",t[t.LINE=2]="LINE",t[t.SYMBOL=3]="SYMBOL",t[t.CIRCLE=4]="CIRCLE",e.ShaderProgramType=void 0,(r=e.ShaderProgramType||(e.ShaderProgramType={}))[r.BACKGROUND=0]="BACKGROUND",r[r.FILL=1]="FILL",r[r.OUTLINE=2]="OUTLINE",r[r.LINE=3]="LINE",r[r.ICON=4]="ICON",r[r.CIRCLE=5]="CIRCLE",r[r.TEXT=6]="TEXT",r[r.TILEINFO=7]="TILEINFO",e.StyleUpdateType=void 0,(i=e.StyleUpdateType||(e.StyleUpdateType={}))[i.PAINTER_CHANGED=0]="PAINTER_CHANGED",i[i.LAYOUT_CHANGED=1]="LAYOUT_CHANGED",i[i.LAYER_CHANGED=2]="LAYER_CHANGED",i[i.LAYER_REMOVED=3]="LAYER_REMOVED",i[i.SPRITES_CHANGED=4]="SPRITES_CHANGED",Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})}))},"esri/views/2d/engine/vectorTiles/GeometryUtils":function(){define(["exports","../../../../geometry/support/coordsUtils","../../../../geometry/support/TileClipper"],(function(e,t,r){"use strict";const i=Number.POSITIVE_INFINITY,n=Math.PI,o=2*n,s=128/n,a=256/360,l=n/180,c=1/Math.LN2;function u(e,t){return(e%=t)>=0?e:e+t}e.between=function(e,t,r){return e>=t&&e<=r||e>=r&&e<=t},e.c2pi=o,e.cDegTo256=a,e.cDegToRad=l,e.cInfinity=i,e.cPi=n,e.cRadTo256=s,e.degToByte=function(e){return u(e*a,256)},e.distanceFromToPolylineWithinThreshold=function(e,r,i,n){let o,s,a,l;const c=n*n;for(const n of i){const i=n.length;if(!(i<2)){o=n[0].x,s=n[0].y;for(let u=1;u<i;++u){if(a=n[u].x,l=n[u].y,t.distanceToSegmentSquared(e,r,o,s,a,l)<c)return!0;o=a,s=l}}}return!1},e.getTileMargins=function(e){return 8+Math.max(16*(e-14),0)},e.interpolate=function(e,t,r){return e*(1-r)+t*r},e.isCircleOverlapingRect=function(e,t,r,i,n,o,s){const a=Math.max(i,Math.min(t,o))-t,l=Math.max(n,Math.min(r,s))-r;return a*a+l*l<=e*e},e.log2=function(e){return Math.log(e)*c},e.offsetLine=function(e,t){if(0===t||Number.isNaN(t))return e;const i=[],n=new r.Point(0,0),o=new r.Point(0,0),s=new r.Point(0,0);for(let a=0;a<e.length;a++){const l=e[a],c=[];for(let e=0;e<l.length;e++){const i=l[e-1],a=l[e],u=l[e+1];0===e?n.setCoords(0,0):n.assignSub(a,i).normalize().rightPerpendicular(),e===l.length-1?o.setCoords(0,0):o.assignSub(u,a).normalize().rightPerpendicular(),s.assignAdd(n,o).normalize();const h=s.x*o.x+s.y*o.y;0!==h&&s.scale(1/h),c.push(r.Point.add(a,s.scale(t)))}i.push(c)}return i},e.pointInPolygon=function(e,t,r){let i,n,o,s=0;for(const a of r){i=a.length;for(let r=1;r<i;++r)n=a[r-1],o=a[r],n.y>t!=o.y>t&&((o.x-n.x)*(t-n.y)-(o.y-n.y)*(e-n.x)>0?s++:s--)}return 0!==s},e.positiveMod=u,e.radToByte=function(e){return u(e*s,256)},e.sqr=function(e){return e*e},e.translateAnchor=function(e,t,i,n){const o=new r.Point(e[0],e[1]);if(o.scale(n),"viewport"===t){const e=-i*(Math.PI/180),t=Math.cos(e),r=Math.sin(e);o.rotate(t,r)}return o},Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})}))},"esri/geometry/support/TileClipper":function(){define(["exports"],(function(e){"use strict";var t,r;e.GeometryType=void 0,(t=e.GeometryType||(e.GeometryType={}))[t.Unknown=0]="Unknown",t[t.Point=1]="Point",t[t.LineString=2]="LineString",t[t.Polygon=3]="Polygon";class i{constructor(e,t){this.x=e,this.y=t}static fromArray(e){return new i(e[0],e[1])}clone(){return new i(this.x,this.y)}equals(e,t){return e===this.x&&t===this.y}isEqual(e){return e.x===this.x&&e.y===this.y}setCoords(e,t){return this.x=e,this.y=t,this}normalize(){const e=this.x,t=this.y,r=Math.sqrt(e*e+t*t);return this.x/=r,this.y/=r,this}rightPerpendicular(){const e=this.x;return this.x=this.y,this.y=-e,this}leftPerpendicular(){const e=this.x;return this.x=-this.y,this.y=e,this}move(e,t){return this.x+=e,this.y+=t,this}assign(e){return this.x=e.x,this.y=e.y,this}assignAdd(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this}assignSub(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this}rotate(e,t){const r=this.x,i=this.y;return this.x=r*e-i*t,this.y=r*t+i*e,this}rotateReverse(e,t){const r=this.x,i=this.y;return this.x=r*e+i*t,this.y=-r*t+i*e,this}scale(e){return this.x*=e,this.y*=e,this}length(){const e=this.x,t=this.y;return Math.sqrt(e*e+t*t)}sub(e){return this.x-=e.x,this.y-=e.y,this}add(e){return this.x+=e.x,this.y+=e.y,this}static distance(e,t){const r=t.x-e.x,i=t.y-e.y;return Math.sqrt(r*r+i*i)}static add(e,t){return new i(e.x+t.x,e.y+t.y)}static sub(e,t){return new i(e.x-t.x,e.y-t.y)}}class n{constructor(e,t,r){this.ratio=e,this.x=t,this.y=r}}!function(e){e[e.sideLeft=0]="sideLeft",e[e.sideRight=1]="sideRight",e[e.sideTop=2]="sideTop",e[e.sideBottom=3]="sideBottom"}(r||(r={}));class o{static simplify(e,t,i){if(!i)return;const n=-t,s=e+t,a=-t,l=e+t,c=[],u=[],h=i.length;for(let e=0;e<h;++e){const t=i[e];if(!t||t.length<2)continue;let o,h=t[0];const p=t.length;for(let i=1;i<p;++i)o=t[i],h.x===o.x&&(h.x<=n&&(h.y>o.y?(c.push(e),c.push(i),c.push(r.sideLeft),c.push(-1)):(u.push(e),u.push(i),u.push(r.sideLeft),u.push(-1))),h.x>=s&&(h.y<o.y?(c.push(e),c.push(i),c.push(r.sideRight),c.push(-1)):(u.push(e),u.push(i),u.push(r.sideRight),u.push(-1)))),h.y===o.y&&(h.y<=a&&(h.x<o.x?(c.push(e),c.push(i),c.push(r.sideTop),c.push(-1)):(u.push(e),u.push(i),u.push(r.sideTop),u.push(-1))),h.y>=l&&(h.x>o.x?(c.push(e),c.push(i),c.push(r.sideBottom),c.push(-1)):(u.push(e),u.push(i),u.push(r.sideBottom),u.push(-1)))),h=o}if(0===c.length||0===u.length)return;o.fillParent(i,u,c),o.fillParent(i,c,u);const p=[];o.calcDeltas(p,u,c),o.calcDeltas(p,c,u),o.addDeltas(p,i)}static fillParent(e,t,i){const n=i.length,o=t.length;for(let a=0;a<o;a+=4){const o=t[a],l=t[a+1],c=t[a+2],u=e[o][l-1],h=e[o][l];let p=8092,y=-1;for(let t=0;t<n;t+=4){if(i[t+2]!==c)continue;const n=i[t],o=i[t+1],a=e[n][o-1],l=e[n][o];switch(c){case r.sideLeft:case r.sideRight:if(s(u.y,a.y,l.y)&&s(h.y,a.y,l.y)){const e=Math.abs(l.y-a.y);e<p&&(p=e,y=t)}break;case r.sideTop:case r.sideBottom:if(s(u.x,a.x,l.x)&&s(h.x,a.x,l.x)){const e=Math.abs(l.x-a.x);e<p&&(p=e,y=t)}}}t[a+3]=y}}static calcDeltas(e,t,r){const i=t.length;for(let n=0;n<i;n+=4){const i=[],s=o.calcDelta(n,t,r,i);e.push(t[n]),e.push(t[n+1]),e.push(t[n+2]),e.push(s)}}static calcDelta(e,t,r,i){const n=t[e+3];if(-1===n)return 0;const s=i.length;return s>1&&i[s-2]===n?0:(i.push(n),o.calcDelta(n,r,t,i)+1)}static addDeltas(e,t){const i=e.length;let n=0;for(let t=0;t<i;t+=4){const r=e[t+3];r>n&&(n=r)}for(let o=0;o<i;o+=4){const i=t[e[o]],s=e[o+1],a=n-e[o+3];switch(e[o+2]){case r.sideLeft:i[s-1].x-=a,i[s].x-=a,1===s&&(i[i.length-1].x-=a),s===i.length-1&&(i[0].x-=a);break;case r.sideRight:i[s-1].x+=a,i[s].x+=a,1===s&&(i[i.length-1].x+=a),s===i.length-1&&(i[0].x+=a);break;case r.sideTop:i[s-1].y-=a,i[s].y-=a,1===s&&(i[i.length-1].y-=a),s===i.length-1&&(i[0].y-=a);break;case r.sideBottom:i[s-1].y+=a,i[s].y+=a,1===s&&(i[i.length-1].y+=a),s===i.length-1&&(i[0].y+=a)}}}}const s=(e,t,r)=>e>=t&&e<=r||e>=r&&e<=t;e.Point=i,e.SimpleBuilder=class{setExtent(e){this._ratio=4096===e?1:4096/e}get validateTessellation(){return this._ratio<1}reset(e){this._lines=[],this._line=null}moveTo(e,t){this._line&&this._lines.push(this._line),this._line=[];const r=this._ratio;this._line.push(new i(e*r,t*r))}lineTo(e,t){const r=this._ratio;this._line.push(new i(e*r,t*r))}close(){const e=this._line;e&&!e[0].isEqual(e[e.length-1])&&e.push(e[0])}result(){return this._line&&this._lines.push(this._line),0===this._lines.length?null:this._lines}},e.TileClipper=class{constructor(e,t,r,i=8,n=8){this._lines=[],this._starts=[],this.validateTessellation=!0,this._pixelRatio=i,this._pixelMargin=n,this._tileSize=512*i,this._dz=e,this._yPos=t,this._xPos=r}setPixelMargin(e){e!==this._pixelMargin&&(this._pixelMargin=e,this.setExtent(this._extent))}setExtent(e){this._extent=e,this._finalRatio=this._tileSize/e*(1<<this._dz);let t=this._pixelRatio*this._pixelMargin;t/=this._finalRatio;const r=e>>this._dz;t>r&&(t=r),this._margin=t,this._xmin=r*this._xPos-t,this._ymin=r*this._yPos-t,this._xmax=this._xmin+r+2*t,this._ymax=this._ymin+r+2*t}reset(e){this._type=e,this._lines=[],this._starts=[],this._line=null,this._start=0}moveTo(e,t){this._pushLine(),this._prevIsIn=this._isIn(e,t),this._moveTo(e,t,this._prevIsIn),this._prevPt=new i(e,t),this._firstPt=new i(e,t),this._dist=0}lineTo(e,t){const r=this._isIn(e,t),o=new i(e,t),s=i.distance(this._prevPt,o);let a,l,c,u,h,p,y,_;if(r)this._prevIsIn?this._lineTo(e,t,!0):(a=this._prevPt,l=o,c=this._intersect(l,a),this._start=this._dist+s*(1-this._r),this._lineTo(c.x,c.y,!0),this._lineTo(l.x,l.y,!0));else if(this._prevIsIn)l=this._prevPt,a=o,c=this._intersect(l,a),this._lineTo(c.x,c.y,!0),this._lineTo(a.x,a.y,!1);else{const e=this._prevPt,t=o;if(e.x<=this._xmin&&t.x<=this._xmin||e.x>=this._xmax&&t.x>=this._xmax||e.y<=this._ymin&&t.y<=this._ymin||e.y>=this._ymax&&t.y>=this._ymax)this._lineTo(t.x,t.y,!1);else{const r=[];if((e.x<this._xmin&&t.x>this._xmin||e.x>this._xmin&&t.x<this._xmin)&&(u=(this._xmin-e.x)/(t.x-e.x),_=e.y+u*(t.y-e.y),_<=this._ymin?p=!1:_>=this._ymax?p=!0:r.push(new n(u,this._xmin,_))),(e.x<this._xmax&&t.x>this._xmax||e.x>this._xmax&&t.x<this._xmax)&&(u=(this._xmax-e.x)/(t.x-e.x),_=e.y+u*(t.y-e.y),_<=this._ymin?p=!1:_>=this._ymax?p=!0:r.push(new n(u,this._xmax,_))),(e.y<this._ymin&&t.y>this._ymin||e.y>this._ymin&&t.y<this._ymin)&&(u=(this._ymin-e.y)/(t.y-e.y),y=e.x+u*(t.x-e.x),y<=this._xmin?h=!1:y>=this._xmax?h=!0:r.push(new n(u,y,this._ymin))),(e.y<this._ymax&&t.y>this._ymax||e.y>this._ymax&&t.y<this._ymax)&&(u=(this._ymax-e.y)/(t.y-e.y),y=e.x+u*(t.x-e.x),y<=this._xmin?h=!1:y>=this._xmax?h=!0:r.push(new n(u,y,this._ymax))),0===r.length)h?p?this._lineTo(this._xmax,this._ymax,!0):this._lineTo(this._xmax,this._ymin,!0):p?this._lineTo(this._xmin,this._ymax,!0):this._lineTo(this._xmin,this._ymin,!0);else if(r.length>1&&r[0].ratio>r[1].ratio)this._start=this._dist+s*r[1].ratio,this._lineTo(r[1].x,r[1].y,!0),this._lineTo(r[0].x,r[0].y,!0);else{this._start=this._dist+s*r[0].ratio;for(let e=0;e<r.length;e++)this._lineTo(r[e].x,r[e].y,!0)}this._lineTo(t.x,t.y,!1)}}this._dist+=s,this._prevIsIn=r,this._prevPt=o}close(){if(this._line.length>2){const e=this._firstPt,t=this._prevPt;e.x===t.x&&e.y===t.y||this.lineTo(e.x,e.y);const r=this._line;let i=r.length;for(;i>=4&&(r[0].x===r[1].x&&r[0].x===r[i-2].x||r[0].y===r[1].y&&r[0].y===r[i-2].y);)r.pop(),r[0].x=r[i-2].x,r[0].y=r[i-2].y,--i}}result(t=!0){return this._pushLine(),0===this._lines.length?null:(this._type===e.GeometryType.Polygon&&t&&o.simplify(this._tileSize,this._margin*this._finalRatio,this._lines),this._lines)}resultWithStarts(){if(this._type!==e.GeometryType.LineString)throw new Error("Only valid for lines");this._pushLine();const t=this._lines,r=t.length;if(0===r)return null;const i=[];for(let e=0;e<r;e++)i.push({line:t[e],start:this._starts[e]||0});return i}_isIn(e,t){return e>=this._xmin&&e<=this._xmax&&t>=this._ymin&&t<=this._ymax}_intersect(e,t){let r,n,o;if(t.x>=this._xmin&&t.x<=this._xmax)n=t.y<=this._ymin?this._ymin:this._ymax,o=(n-e.y)/(t.y-e.y),r=e.x+o*(t.x-e.x);else if(t.y>=this._ymin&&t.y<=this._ymax)r=t.x<=this._xmin?this._xmin:this._xmax,o=(r-e.x)/(t.x-e.x),n=e.y+o*(t.y-e.y);else{n=t.y<=this._ymin?this._ymin:this._ymax,r=t.x<=this._xmin?this._xmin:this._xmax;const i=(r-e.x)/(t.x-e.x),s=(n-e.y)/(t.y-e.y);i<s?(o=i,n=e.y+i*(t.y-e.y)):(o=s,r=e.x+s*(t.x-e.x))}return this._r=o,new i(r,n)}_pushLine(){this._line&&(this._type===e.GeometryType.Point?this._line.length>0&&(this._lines.push(this._line),this._starts.push(this._start)):this._type===e.GeometryType.LineString?this._line.length>1&&(this._lines.push(this._line),this._starts.push(this._start)):this._type===e.GeometryType.Polygon&&this._line.length>3&&(this._lines.push(this._line),this._starts.push(this._start))),this._line=[],this._start=0}_moveTo(t,r,n){this._type!==e.GeometryType.Polygon?n&&(t=Math.round((t-(this._xmin+this._margin))*this._finalRatio),r=Math.round((r-(this._ymin+this._margin))*this._finalRatio),this._line.push(new i(t,r))):(n||(t<this._xmin&&(t=this._xmin),t>this._xmax&&(t=this._xmax),r<this._ymin&&(r=this._ymin),r>this._ymax&&(r=this._ymax)),t=Math.round((t-(this._xmin+this._margin))*this._finalRatio),r=Math.round((r-(this._ymin+this._margin))*this._finalRatio),this._line.push(new i(t,r)),this._isH=!1,this._isV=!1)}_lineTo(t,r,n){let o,s;if(this._type!==e.GeometryType.Polygon)if(n){if(t=Math.round((t-(this._xmin+this._margin))*this._finalRatio),r=Math.round((r-(this._ymin+this._margin))*this._finalRatio),this._line.length>0&&(o=this._line[this._line.length-1],o.equals(t,r)))return;this._line.push(new i(t,r))}else this._line&&this._line.length>0&&this._pushLine();else if(n||(t<this._xmin&&(t=this._xmin),t>this._xmax&&(t=this._xmax),r<this._ymin&&(r=this._ymin),r>this._ymax&&(r=this._ymax)),t=Math.round((t-(this._xmin+this._margin))*this._finalRatio),r=Math.round((r-(this._ymin+this._margin))*this._finalRatio),this._line&&this._line.length>0){o=this._line[this._line.length-1];const e=o.x===t,n=o.y===r;if(e&&n)return;this._isH&&e||this._isV&&n?(o.x=t,o.y=r,s=this._line[this._line.length-2],s.x===t&&s.y===r?(this._line.pop(),this._line.length<=1?(this._isH=!1,this._isV=!1):(s=this._line[this._line.length-2],this._isH=s.x===t,this._isV=s.y===r)):(this._isH=s.x===t,this._isV=s.y===r)):(this._line.push(new i(t,r)),this._isH=e,this._isV=n)}else this._line.push(new i(t,r))}},Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})}))},"esri/views/2d/engine/vectorTiles/shaders/VTLBackgroundMaterial":function(){define(["exports","./VTLMaterial","../../../../webgl/enums","../../../../webgl/VertexElementDescriptor"],(function(e,t,r,i){"use strict";class n extends t.VTLMaterial{static{this.ATTRIBUTES=[]}static{this.GEOMETRY_LAYOUT=[new i.VertexElementDescriptor("a_pos",2,r.DataType.BYTE,0,2)]}static{this.ATTRIBUTES_INFO={}}constructor(e){super(e)}geometryInfo(){return n.GEOMETRY_LAYOUT}opacityInfo(){return null}attributes(){return n.ATTRIBUTES}attributesInfo(){return n.ATTRIBUTES_INFO}}e.VTLBackgroundMaterial=n,Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})}))},"esri/views/2d/engine/vectorTiles/shaders/VTLMaterial":function(){define(["exports","../MemoryBuffer","./enums","../../../../webgl/enums","../../../../webgl/VertexElementDescriptor"],(function(e,t,r,i,n){"use strict";class o{constructor(e){this._locations=new Map,this._key=e}get key(){return this._key}get type(){return 7&this._key}defines(){return[]}getStride(){return this._layout||this._buildAttributesInfo(),this._stride}getAttributeLocations(){return 0===this._locations.size&&this._buildAttributesInfo(),this._locations}getLayoutInfo(){return this._layout||this._buildAttributesInfo(),this._layout}getEncodingInfos(){return this._propertyEncodingInfo||this._buildAttributesInfo(),this._propertyEncodingInfo}getUniforms(){return this._uniforms||this._buildAttributesInfo(),this._uniforms}getShaderHeader(){return this._shaderHeader||this._buildAttributesInfo(),this._shaderHeader}getShaderMain(){return this._shaderMain||this._buildAttributesInfo(),this._shaderMain}setDataUniforms(e,t,r,i,n){const o=this.getUniforms();for(const s of o){const{name:o,type:a,getValue:l}=s,c=l(r,t,i,n);if(null!==c)switch(a){case"float":e.setUniform1f(o,c);break;case"vec2":e.setUniform2fv(o,c);break;case"vec4":e.setUniform4fv(o,c)}}}encodeAttributes(e,t,i,n){const o=this.attributesInfo(),s=this.getEncodingInfos(),a=[];let l=0,c=0;for(const u of Object.keys(s)){const h=s[u],{type:p,precisionFactor:y,isLayout:_}=o[u],d=_?i.getLayoutProperty(u):i.getPaintProperty(u),f=d.interpolator?.getInterpolationRange(t);let m=0;for(const i of h){const{offset:o,bufferElementsToAdd:s}=i;if(s>0){for(let e=0;e<s;e++)a.push(0);l+=c,c=i.bufferElementsToAdd}const u=n??d.getValue(f?f[m]:t,e);switch(p){case r.EncodingType.R8_SIGNED:case r.EncodingType.R8_UNSIGNED:a[l]|=this._encodeByte(u*(y||1),8*o);break;case r.EncodingType.R16_SIGNED:case r.EncodingType.R16_UNSIGNED:a[l]|=this._encodeShort(u*(y||1),8*o);break;case r.EncodingType.R8G8_SIGNED:case r.EncodingType.R8G8_UNSIGNED:a[l]|=this._encodeByte(u*(y||1),8*o),a[l]|=this._encodeByte(u*(y||1),8*o+8);break;case r.EncodingType.R16G16_SIGNED:case r.EncodingType.R16G16_UNSIGNED:a[l]|=this._encodeShort(u*(y||1),8*o),a[l]|=this._encodeShort(u*(y||1),8*o+16);break;case r.EncodingType.R8G8B8A8_SIGNED:case r.EncodingType.R8G8B8A8_UNSIGNED:a[l]|=this._encodeByte(u*(y||1),8*o),a[l]|=this._encodeByte(u*(y||1),8*o+8),a[l]|=this._encodeByte(u*(y||1),8*o+16),a[l]|=this._encodeByte(u*(y||1),8*o+24);break;case r.EncodingType.R8G8B8A8_COLOR:a[l]=this._encodeColor(u);break;case r.EncodingType.R16G16B16A16_DASHARRAY:case r.EncodingType.R16G16B16A16_PATTERN:this._encodePattern(l,a,u);break;default:throw new Error("Unsupported encoding type")}m++}}return a}getAtributeState(e){let t=0;const r=3+2*e;return t|=this._bit(r),t|=this._bit(r+1)<<1,t}static{this._encodingInfo={[r.EncodingType.R8_SIGNED]:{dataType:i.DataType.BYTE,bytesPerElement:1,count:1,normalized:!1},[r.EncodingType.R8_UNSIGNED]:{dataType:i.DataType.UNSIGNED_BYTE,bytesPerElement:1,count:1,normalized:!1},[r.EncodingType.R16_SIGNED]:{dataType:i.DataType.SHORT,bytesPerElement:2,count:1,normalized:!1},[r.EncodingType.R16_UNSIGNED]:{dataType:i.DataType.UNSIGNED_SHORT,bytesPerElement:2,count:1,normalized:!1},[r.EncodingType.R8G8_SIGNED]:{dataType:i.DataType.BYTE,bytesPerElement:1,count:2,normalized:!1},[r.EncodingType.R8G8_UNSIGNED]:{dataType:i.DataType.UNSIGNED_BYTE,bytesPerElement:1,count:2,normalized:!1},[r.EncodingType.R16G16_SIGNED]:{dataType:i.DataType.SHORT,bytesPerElement:2,count:2,normalized:!1},[r.EncodingType.R16G16_UNSIGNED]:{dataType:i.DataType.UNSIGNED_SHORT,bytesPerElement:2,count:2,normalized:!1},[r.EncodingType.R8G8B8A8_SIGNED]:{dataType:i.DataType.BYTE,bytesPerElement:1,count:4,normalized:!1},[r.EncodingType.R8G8B8A8_UNSIGNED]:{dataType:i.DataType.UNSIGNED_BYTE,bytesPerElement:1,count:4,normalized:!1},[r.EncodingType.R8G8B8A8_COLOR]:{dataType:i.DataType.UNSIGNED_BYTE,bytesPerElement:1,count:4,normalized:!0},[r.EncodingType.R16G16B16A16_DASHARRAY]:{dataType:i.DataType.UNSIGNED_SHORT,bytesPerElement:2,count:4,normalized:!1},[r.EncodingType.R16G16B16A16_PATTERN]:{dataType:i.DataType.UNSIGNED_SHORT,bytesPerElement:2,count:4,normalized:!1}}}_buildAttributesInfo(){const e=[],t={},n={};let s=-1;const a=this.attributesInfo(),l=this.attributes();let c=-1;for(const i of l){c++;const l=this.getAtributeState(c);if(l===r.AttributeStatus.UNIFORM||l===r.AttributeStatus.UNUSED)continue;const u=a[i],h=[];t[i]=h;const p=u.type;for(let t=0;t<l;t++){const{dataType:t,bytesPerElement:r,count:i,normalized:a}=o._encodingInfo[p],l=r*i,c=`${t}-${!0===a}`;let u=n[c],y=0;if(!u||u.count+i>4)s++,u={dataIndex:s,count:0,offset:0},4!==i&&(n[c]=u),e.push({location:-1,name:"a_data_"+s,count:i,type:t,normalized:a}),y=Math.ceil(Math.max(l/4,1));else{const t=e[u.dataIndex];t.count+=i,y=Math.ceil(Math.max(t.count*r/4,1))-Math.ceil(Math.max(u.offset/4,1))}h.push({dataIndex:u.dataIndex,offset:u.offset,bufferElementsToAdd:y}),u.offset+=l,u.count+=i}}for(const t of e)switch(t.type){case i.DataType.BYTE:case i.DataType.UNSIGNED_BYTE:t.count=4;break;case i.DataType.SHORT:case i.DataType.UNSIGNED_SHORT:t.count+=t.count%2}this._buildVertexBufferLayout(e);let u=0;const h=this._layout.get("geometry");for(const e of h)this._locations.set(e.name,u++);const p=this._layout.get("opacity");if(p)for(const e of p)this._locations.set(e.name,u++);this._buildShaderInfo(e,t),this._propertyEncodingInfo=t}_buildVertexBufferLayout(e){const t=new Map,r=this.geometryInfo();let i=r[0].stride;if(0===e.length)t.set("geometry",r);else{const o=[];let a=i;for(const t of e)i+=s(t.type)*t.count;for(const e of r)o.push(new n.VertexElementDescriptor(e.name,e.count,e.type,e.offset,i,e.normalized));for(const t of e)o.push(new n.VertexElementDescriptor(t.name,t.count,t.type,a,i,t.normalized)),a+=s(t.type)*t.count;t.set("geometry",o)}const o=this.opacityInfo();o&&t.set("opacity",o),this._layout=t,this._stride=i}_buildShaderInfo(e,t){let i="\n",n="\n";const s=[];for(const t of e)i+=`attribute ${this._getType(t.count)} ${t.name};\n`;const l=this.attributes(),c=this.attributesInfo();let u=-1;for(const e of l){u++;const{name:l,type:h,precisionFactor:p,isLayout:y}=c[e],_=p&&1!==p?" * "+1/p:"",{bytesPerElement:d,count:f}=o._encodingInfo[h],m=e=>`a_data_${e.dataIndex}${a(f,e.offset,d)}`;switch(this.getAtributeState(u)){case r.AttributeStatus.UNIFORM:{const t=this._getType(f),o=`u_${l}`;s.push({name:o,type:t,getValue:(t,i,n,o)=>{const s=y?t.getLayoutValue(e,i):t.getPaintValue(e,i);if(h===r.EncodingType.R16G16B16A16_DASHARRAY){const e=t.getDashKey(s,t.getLayoutValue("line-cap",i)),r=o.getMosaicItemPosition(e,!1);if(null==r)return null;const{tl:n,br:a}=r;return[n[0],a[1],a[0],n[1]]}if(h===r.EncodingType.R16G16B16A16_PATTERN){const t=o.getMosaicItemPosition(s,!e.includes("line-"));if(null==t)return null;const{tl:r,br:i}=t;return[r[0],i[1],i[0],r[1]]}if(h===r.EncodingType.R8G8B8A8_COLOR){const e=s[3];return[e*s[0],e*s[1],e*s[2],e]}return s}}),i+=`uniform ${t} ${o};\n`,n+=`${t} ${l} = ${o};\n`}break;case r.AttributeStatus.DATA_DRIVEN:{const r=m(t[e][0]);n+=`${this._getType(f)} ${l} = ${r}${_};\n`}break;case r.AttributeStatus.INTERPOLATED_DATA_DRIVEN:{const r=`u_t_${l}`;s.push({name:r,type:"float",getValue:(t,r,i,n)=>(y?t.getLayoutProperty(e):t.getPaintProperty(e)).interpolator.interpolationUniformValue(i,r)}),i+=`uniform float ${r};\n`;const o=m(t[e][0]),a=m(t[e][1]);n+=`${this._getType(f)} ${l} = mix(${o}${_}, ${a}${_}, ${r});\n`}}}this._shaderHeader=i,this._shaderMain=n,this._uniforms=s}_bit(e){return(this._key&1<<e)>>e}_getType(e){switch(e){case 1:return"float";case 2:return"vec2";case 3:return"vec3";case 4:return"vec4"}throw new Error("Invalid count")}_encodeColor(e){const r=255*e[3];return t.i8888to32(e[0]*r,e[1]*r,e[2]*r,r)}_encodePattern(e,t,r){if(!r?.rect)return;const i=r.rect,n=r.width,o=r.height;t[e]=this._encodeShort(i.x+2,0),t[e]|=this._encodeShort(i.y+2+o,16),t[e+1]=this._encodeShort(i.x+2+n,0),t[e+1]|=this._encodeShort(i.y+2,16)}_encodeByte(e,t){return(255&e)<<t}_encodeShort(e,t){return(65535&e)<<t}}const s=e=>{switch(e){case i.DataType.FLOAT:case i.DataType.INT:case i.DataType.UNSIGNED_INT:return 4;case i.DataType.SHORT:case i.DataType.UNSIGNED_SHORT:case i.DataType.HALF_FLOAT:return 2;case i.DataType.BYTE:case i.DataType.UNSIGNED_BYTE:return 1}},a=(e,t,r)=>{const i=t/r;if(1===e)switch(i){case 0:return".x";case 1:return".y";case 2:return".z";case 3:return".w"}else if(2===e)switch(i){case 0:return".xy";case 1:return".yz";case 2:return".zw"}else if(3===e)switch(i){case 0:return".xyz";case 1:return".yzw"}return""};e.VTLMaterial=o,Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})}))},"esri/views/2d/engine/vectorTiles/MemoryBuffer":function(){define(["../../../../core/has"],(function(e){"use strict";return class{constructor(e){this._array=[],this._stride=e}get array(){return this._array}get index(){return 4*this._array.length/this._stride}get itemSize(){return this._stride}get sizeInBytes(){return 4*this._array.length}reset(){this.array.length=0}toBuffer(){return new Uint32Array(this._array).buffer}static i1616to32(e,t){return 65535&e|t<<16}static i8888to32(e,t,r,i){return 255&e|(255&t)<<8|(255&r)<<16|i<<24}static i8816to32(e,t,r){return 255&e|(255&t)<<8|r<<16}}}))},"esri/views/2d/engine/vectorTiles/shaders/enums":function(){define(["exports"],(function(e){"use strict";var t,r;e.EncodingType=void 0,(t=e.EncodingType||(e.EncodingType={}))[t.R8_SIGNED=0]="R8_SIGNED",t[t.R8_UNSIGNED=1]="R8_UNSIGNED",t[t.R16_SIGNED=2]="R16_SIGNED",t[t.R16_UNSIGNED=3]="R16_UNSIGNED",t[t.R8G8_SIGNED=4]="R8G8_SIGNED",t[t.R8G8_UNSIGNED=5]="R8G8_UNSIGNED",t[t.R16G16_SIGNED=6]="R16G16_SIGNED",t[t.R16G16_UNSIGNED=7]="R16G16_UNSIGNED",t[t.R8G8B8A8_SIGNED=8]="R8G8B8A8_SIGNED",t[t.R8G8B8A8_UNSIGNED=9]="R8G8B8A8_UNSIGNED",t[t.R8G8B8A8_COLOR=10]="R8G8B8A8_COLOR",t[t.R16G16B16A16_DASHARRAY=11]="R16G16B16A16_DASHARRAY",t[t.R16G16B16A16_PATTERN=12]="R16G16B16A16_PATTERN",e.AttributeStatus=void 0,(r=e.AttributeStatus||(e.AttributeStatus={}))[r.UNIFORM=0]="UNIFORM",r[r.DATA_DRIVEN=1]="DATA_DRIVEN",r[r.INTERPOLATED_DATA_DRIVEN=2]="INTERPOLATED_DATA_DRIVEN",r[r.UNUSED=3]="UNUSED",Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})}))},"esri/views/webgl/enums":function(){define(["exports"],(function(e){"use strict";var t,r,i,n,o,s,a,l,c,u,h,p,y,_,d,f,m,T,g,E,S,A,R,I,b,x,v,L,w,D,N,P,O,M,U,C;e.FramebufferBit=void 0,(t=e.FramebufferBit||(e.FramebufferBit={}))[t.DEPTH=256]="DEPTH",t[t.STENCIL=1024]="STENCIL",t[t.COLOR=16384]="COLOR",e.BufferContent=void 0,(r=e.BufferContent||(e.BufferContent={}))[r.COLOR=6144]="COLOR",r[r.DEPTH=6145]="DEPTH",r[r.STENCIL=6146]="STENCIL",r[r.DEPTH_STENCIL=34041]="DEPTH_STENCIL",e.PrimitiveType=void 0,(i=e.PrimitiveType||(e.PrimitiveType={}))[i.POINTS=0]="POINTS",i[i.LINES=1]="LINES",i[i.LINE_LOOP=2]="LINE_LOOP",i[i.LINE_STRIP=3]="LINE_STRIP",i[i.TRIANGLES=4]="TRIANGLES",i[i.TRIANGLE_STRIP=5]="TRIANGLE_STRIP",i[i.TRIANGLE_FAN=6]="TRIANGLE_FAN",e.BlendFactor=void 0,(n=e.BlendFactor||(e.BlendFactor={}))[n.ZERO=0]="ZERO",n[n.ONE=1]="ONE",n[n.SRC_COLOR=768]="SRC_COLOR",n[n.ONE_MINUS_SRC_COLOR=769]="ONE_MINUS_SRC_COLOR",n[n.SRC_ALPHA=770]="SRC_ALPHA",n[n.ONE_MINUS_SRC_ALPHA=771]="ONE_MINUS_SRC_ALPHA",n[n.DST_ALPHA=772]="DST_ALPHA",n[n.ONE_MINUS_DST_ALPHA=773]="ONE_MINUS_DST_ALPHA",n[n.DST_COLOR=774]="DST_COLOR",n[n.ONE_MINUS_DST_COLOR=775]="ONE_MINUS_DST_COLOR",n[n.SRC_ALPHA_SATURATE=776]="SRC_ALPHA_SATURATE",n[n.CONSTANT_COLOR=32769]="CONSTANT_COLOR",n[n.ONE_MINUS_CONSTANT_COLOR=32770]="ONE_MINUS_CONSTANT_COLOR",n[n.CONSTANT_ALPHA=32771]="CONSTANT_ALPHA",n[n.ONE_MINUS_CONSTANT_ALPHA=32772]="ONE_MINUS_CONSTANT_ALPHA",e.BlendOperation=void 0,(o=e.BlendOperation||(e.BlendOperation={}))[o.ADD=32774]="ADD",o[o.MIN=32775]="MIN",o[o.MAX=32776]="MAX",o[o.SUBTRACT=32778]="SUBTRACT",o[o.REVERSE_SUBTRACT=32779]="REVERSE_SUBTRACT",e.BufferType=void 0,(s=e.BufferType||(e.BufferType={}))[s.ARRAY_BUFFER=34962]="ARRAY_BUFFER",s[s.ELEMENT_ARRAY_BUFFER=34963]="ELEMENT_ARRAY_BUFFER",s[s.UNIFORM_BUFFER=35345]="UNIFORM_BUFFER",s[s.PIXEL_PACK_BUFFER=35051]="PIXEL_PACK_BUFFER",s[s.PIXEL_UNPACK_BUFFER=35052]="PIXEL_UNPACK_BUFFER",s[s.COPY_READ_BUFFER=36662]="COPY_READ_BUFFER",s[s.COPY_WRITE_BUFFER=36663]="COPY_WRITE_BUFFER",s[s.TRANSFORM_FEEDBACK_BUFFER=35982]="TRANSFORM_FEEDBACK_BUFFER",e.Face=void 0,(a=e.Face||(e.Face={}))[a.FRONT=1028]="FRONT",a[a.BACK=1029]="BACK",a[a.FRONT_AND_BACK=1032]="FRONT_AND_BACK",e.CullMode=void 0,(l=e.CullMode||(e.CullMode={}))[l.CW=2304]="CW",l[l.CCW=2305]="CCW",e.DataType=void 0,(c=e.DataType||(e.DataType={}))[c.BYTE=5120]="BYTE",c[c.UNSIGNED_BYTE=5121]="UNSIGNED_BYTE",c[c.SHORT=5122]="SHORT",c[c.UNSIGNED_SHORT=5123]="UNSIGNED_SHORT",c[c.INT=5124]="INT",c[c.UNSIGNED_INT=5125]="UNSIGNED_INT",c[c.FLOAT=5126]="FLOAT",c[c.HALF_FLOAT=5131]="HALF_FLOAT",e.CompareFunction=void 0,(u=e.CompareFunction||(e.CompareFunction={}))[u.NEVER=512]="NEVER",u[u.LESS=513]="LESS",u[u.EQUAL=514]="EQUAL",u[u.LEQUAL=515]="LEQUAL",u[u.GREATER=516]="GREATER",u[u.NOTEQUAL=517]="NOTEQUAL",u[u.GEQUAL=518]="GEQUAL",u[u.ALWAYS=519]="ALWAYS",e.StencilOperation=void 0,(h=e.StencilOperation||(e.StencilOperation={}))[h.ZERO=0]="ZERO",h[h.KEEP=7680]="KEEP",h[h.REPLACE=7681]="REPLACE",h[h.INCR=7682]="INCR",h[h.DECR=7683]="DECR",h[h.INVERT=5386]="INVERT",h[h.INCR_WRAP=34055]="INCR_WRAP",h[h.DECR_WRAP=34056]="DECR_WRAP",e.TextureSamplingMode=void 0,(p=e.TextureSamplingMode||(e.TextureSamplingMode={}))[p.NEAREST=9728]="NEAREST",p[p.LINEAR=9729]="LINEAR",p[p.NEAREST_MIPMAP_NEAREST=9984]="NEAREST_MIPMAP_NEAREST",p[p.LINEAR_MIPMAP_NEAREST=9985]="LINEAR_MIPMAP_NEAREST",p[p.NEAREST_MIPMAP_LINEAR=9986]="NEAREST_MIPMAP_LINEAR",p[p.LINEAR_MIPMAP_LINEAR=9987]="LINEAR_MIPMAP_LINEAR",e.TextureWrapMode=void 0,(y=e.TextureWrapMode||(e.TextureWrapMode={}))[y.CLAMP_TO_EDGE=33071]="CLAMP_TO_EDGE",y[y.REPEAT=10497]="REPEAT",y[y.MIRRORED_REPEAT=33648]="MIRRORED_REPEAT",e.TextureType=void 0,(_=e.TextureType||(e.TextureType={}))[_.TEXTURE_2D=3553]="TEXTURE_2D",_[_.TEXTURE_CUBE_MAP=34067]="TEXTURE_CUBE_MAP",_[_.TEXTURE_3D=32879]="TEXTURE_3D",_[_.TEXTURE_CUBE_MAP_POSITIVE_X=34069]="TEXTURE_CUBE_MAP_POSITIVE_X",_[_.TEXTURE_CUBE_MAP_NEGATIVE_X=34070]="TEXTURE_CUBE_MAP_NEGATIVE_X",_[_.TEXTURE_CUBE_MAP_POSITIVE_Y=34071]="TEXTURE_CUBE_MAP_POSITIVE_Y",_[_.TEXTURE_CUBE_MAP_NEGATIVE_Y=34072]="TEXTURE_CUBE_MAP_NEGATIVE_Y",_[_.TEXTURE_CUBE_MAP_POSITIVE_Z=34073]="TEXTURE_CUBE_MAP_POSITIVE_Z",_[_.TEXTURE_CUBE_MAP_NEGATIVE_Z=34074]="TEXTURE_CUBE_MAP_NEGATIVE_Z",_[_.TEXTURE_2D_ARRAY=35866]="TEXTURE_2D_ARRAY",e.TextureConstants=void 0,(d=e.TextureConstants||(e.TextureConstants={}))[d.MIN_LOD=33082]="MIN_LOD",d[d.MAX_LOD=33083]="MAX_LOD",d[d.BASE_LEVEL=33084]="BASE_LEVEL",d[d.MAX_LEVEL=33085]="MAX_LEVEL",d[d.MAX_TEXTURE_SIZE=3379]="MAX_TEXTURE_SIZE",e.PixelFormat=void 0,(f=e.PixelFormat||(e.PixelFormat={}))[f.ALPHA=6406]="ALPHA",f[f.RGB=6407]="RGB",f[f.RGBA=6408]="RGBA",f[f.LUMINANCE=6409]="LUMINANCE",f[f.LUMINANCE_ALPHA=6410]="LUMINANCE_ALPHA",f[f.RED=6403]="RED",f[f.RG=33319]="RG",f[f.RED_INTEGER=36244]="RED_INTEGER",f[f.RG_INTEGER=33320]="RG_INTEGER",f[f.RGB_INTEGER=36248]="RGB_INTEGER",f[f.RGBA_INTEGER=36249]="RGBA_INTEGER",e.SizedPixelFormat=void 0,(m=e.SizedPixelFormat||(e.SizedPixelFormat={}))[m.RGBA4=32854]="RGBA4",m[m.R16F=33325]="R16F",m[m.RG16F=33327]="RG16F",m[m.RGB32F=34837]="RGB32F",m[m.RGBA16F=34842]="RGBA16F",m[m.R32F=33326]="R32F",m[m.RG32F=33328]="RG32F",m[m.RGBA32F=34836]="RGBA32F",m[m.R11F_G11F_B10F=35898]="R11F_G11F_B10F",m[m.RGB8=32849]="RGB8",m[m.RGBA8=32856]="RGBA8",m[m.RGB5_A1=32855]="RGB5_A1",m[m.R8=33321]="R8",m[m.RG8=33323]="RG8",m[m.R8I=33329]="R8I",m[m.R8UI=33330]="R8UI",m[m.R16I=33331]="R16I",m[m.R16UI=33332]="R16UI",m[m.R32I=33333]="R32I",m[m.R32UI=33334]="R32UI",m[m.RG8I=33335]="RG8I",m[m.RG8UI=33336]="RG8UI",m[m.RG16I=33337]="RG16I",m[m.RG16UI=33338]="RG16UI",m[m.RG32I=33339]="RG32I",m[m.RG32UI=33340]="RG32UI",m[m.RGB16F=34843]="RGB16F",m[m.RGB9_E5=35901]="RGB9_E5",m[m.SRGB8=35905]="SRGB8",m[m.SRGB8_ALPHA8=35907]="SRGB8_ALPHA8",m[m.RGB565=36194]="RGB565",m[m.RGBA32UI=36208]="RGBA32UI",m[m.RGB32UI=36209]="RGB32UI",m[m.RGBA16UI=36214]="RGBA16UI",m[m.RGB16UI=36215]="RGB16UI",m[m.RGBA8UI=36220]="RGBA8UI",m[m.RGB8UI=36221]="RGB8UI",m[m.RGBA32I=36226]="RGBA32I",m[m.RGB32I=36227]="RGB32I",m[m.RGBA16I=36232]="RGBA16I",m[m.RGB16I=36233]="RGB16I",m[m.RGBA8I=36238]="RGBA8I",m[m.RGB8I=36239]="RGB8I",m[m.R8_SNORM=36756]="R8_SNORM",m[m.RG8_SNORM=36757]="RG8_SNORM",m[m.RGB8_SNORM=36758]="RGB8_SNORM",m[m.RGBA8_SNORM=36759]="RGBA8_SNORM",m[m.RGB10_A2=32857]="RGB10_A2",m[m.RGB10_A2UI=36975]="RGB10_A2UI",e.UnsizedDepthFormat=void 0,(T=e.UnsizedDepthFormat||(e.UnsizedDepthFormat={}))[T.DEPTH_COMPONENT=6402]="DEPTH_COMPONENT",T[T.DEPTH_STENCIL=34041]="DEPTH_STENCIL",e.SizedDepthStencilFormat=void 0,(g=e.SizedDepthStencilFormat||(e.SizedDepthStencilFormat={}))[g.DEPTH24_STENCIL8=35056]="DEPTH24_STENCIL8",g[g.DEPTH32F_STENCIL8=36013]="DEPTH32F_STENCIL8",e.SizedDepthFormat=void 0,(E=e.SizedDepthFormat||(e.SizedDepthFormat={}))[E.DEPTH_COMPONENT16=33189]="DEPTH_COMPONENT16",E[E.DEPTH_COMPONENT24=33190]="DEPTH_COMPONENT24",E[E.DEPTH_COMPONENT32F=36012]="DEPTH_COMPONENT32F",e.SizedStencilFormat=void 0,(S=e.SizedStencilFormat||(e.SizedStencilFormat={}))[S.STENCIL_INDEX8=36168]="STENCIL_INDEX8",e.PixelType=void 0,(A=e.PixelType||(e.PixelType={}))[A.FLOAT=5126]="FLOAT",A[A.UNSIGNED_BYTE=5121]="UNSIGNED_BYTE",A[A.UNSIGNED_INT_24_8=34042]="UNSIGNED_INT_24_8",A[A.UNSIGNED_SHORT_4_4_4_4=32819]="UNSIGNED_SHORT_4_4_4_4",A[A.UNSIGNED_SHORT_5_5_5_1=32820]="UNSIGNED_SHORT_5_5_5_1",A[A.UNSIGNED_SHORT_5_6_5=33635]="UNSIGNED_SHORT_5_6_5",A[A.BYTE=5120]="BYTE",A[A.UNSIGNED_SHORT=5123]="UNSIGNED_SHORT",A[A.SHORT=5122]="SHORT",A[A.UNSIGNED_INT=5125]="UNSIGNED_INT",A[A.INT=5124]="INT",A[A.HALF_FLOAT=5131]="HALF_FLOAT",A[A.UNSIGNED_INT_2_10_10_10_REV=33640]="UNSIGNED_INT_2_10_10_10_REV",A[A.UNSIGNED_INT_10F_11F_11F_REV=35899]="UNSIGNED_INT_10F_11F_11F_REV",A[A.UNSIGNED_INT_5_9_9_9_REV=35902]="UNSIGNED_INT_5_9_9_9_REV",A[A.FLOAT_32_UNSIGNED_INT_24_8_REV=36269]="FLOAT_32_UNSIGNED_INT_24_8_REV",e.Usage=void 0,(R=e.Usage||(e.Usage={}))[R.STATIC_DRAW=35044]="STATIC_DRAW",R[R.DYNAMIC_DRAW=35048]="DYNAMIC_DRAW",R[R.STREAM_DRAW=35040]="STREAM_DRAW",R[R.STATIC_READ=35045]="STATIC_READ",R[R.DYNAMIC_READ=35049]="DYNAMIC_READ",R[R.STREAM_READ=35041]="STREAM_READ",R[R.STATIC_COPY=35046]="STATIC_COPY",R[R.DYNAMIC_COPY=35050]="DYNAMIC_COPY",R[R.STREAM_COPY=35042]="STREAM_COPY",e.ShaderType=void 0,(I=e.ShaderType||(e.ShaderType={}))[I.FRAGMENT_SHADER=35632]="FRAGMENT_SHADER",I[I.VERTEX_SHADER=35633]="VERTEX_SHADER",e.FramebufferTarget=void 0,(b=e.FramebufferTarget||(e.FramebufferTarget={}))[b.FRAMEBUFFER=36160]="FRAMEBUFFER",b[b.READ_FRAMEBUFFER=36008]="READ_FRAMEBUFFER",b[b.DRAW_FRAMEBUFFER=36009]="DRAW_FRAMEBUFFER",e.ResourceType=void 0,(x=e.ResourceType||(e.ResourceType={}))[x.Texture=0]="Texture",x[x.TileTexture=1]="TileTexture",x[x.BufferObject=2]="BufferObject",x[x.VertexArrayObject=3]="VertexArrayObject",x[x.Shader=4]="Shader",x[x.Program=5]="Program",x[x.FramebufferObject=6]="FramebufferObject",x[x.Renderbuffer=7]="Renderbuffer",x[x.TransformFeedback=8]="TransformFeedback",x[x.Sync=9]="Sync",x[x.UNCOUNTED=10]="UNCOUNTED",x[x.LinesOfCode=10]="LinesOfCode",x[x.Uniform=11]="Uniform",x[x.COUNT=12]="COUNT",e.SpecialDrawBuffers=void 0,(v=e.SpecialDrawBuffers||(e.SpecialDrawBuffers={}))[v.NONE=0]="NONE",v[v.BACK=1029]="BACK",e.CompressedTextureFormat=void 0,(L=e.CompressedTextureFormat||(e.CompressedTextureFormat={}))[L.COMPRESSED_RGB_S3TC_DXT1_EXT=33776]="COMPRESSED_RGB_S3TC_DXT1_EXT",L[L.COMPRESSED_RGBA_S3TC_DXT1_EXT=33777]="COMPRESSED_RGBA_S3TC_DXT1_EXT",L[L.COMPRESSED_RGBA_S3TC_DXT3_EXT=33778]="COMPRESSED_RGBA_S3TC_DXT3_EXT",L[L.COMPRESSED_RGBA_S3TC_DXT5_EXT=33779]="COMPRESSED_RGBA_S3TC_DXT5_EXT",L[L.COMPRESSED_R11_EAC=37488]="COMPRESSED_R11_EAC",L[L.COMPRESSED_SIGNED_R11_EAC=37489]="COMPRESSED_SIGNED_R11_EAC",L[L.COMPRESSED_RG11_EAC=37490]="COMPRESSED_RG11_EAC",L[L.COMPRESSED_SIGNED_RG11_EAC=37491]="COMPRESSED_SIGNED_RG11_EAC",L[L.COMPRESSED_RGB8_ETC2=37492]="COMPRESSED_RGB8_ETC2",L[L.COMPRESSED_SRGB8_ETC2=37493]="COMPRESSED_SRGB8_ETC2",L[L.COMPRESSED_RGB8_PUNCHTHROUGH_ALPHA1_ETC2=37494]="COMPRESSED_RGB8_PUNCHTHROUGH_ALPHA1_ETC2",L[L.COMPRESSED_SRGB8_PUNCHTHROUGH_ALPHA1_ETC2=37495]="COMPRESSED_SRGB8_PUNCHTHROUGH_ALPHA1_ETC2",L[L.COMPRESSED_RGBA8_ETC2_EAC=37496]="COMPRESSED_RGBA8_ETC2_EAC",L[L.COMPRESSED_SRGB8_ALPHA8_ETC2_EAC=37497]="COMPRESSED_SRGB8_ALPHA8_ETC2_EAC",e.UniformType=void 0,(w=e.UniformType||(e.UniformType={}))[w.FLOAT=5126]="FLOAT",w[w.FLOAT_VEC2=35664]="FLOAT_VEC2",w[w.FLOAT_VEC3=35665]="FLOAT_VEC3",w[w.FLOAT_VEC4=35666]="FLOAT_VEC4",w[w.INT=5124]="INT",w[w.INT_VEC2=35667]="INT_VEC2",w[w.INT_VEC3=35668]="INT_VEC3",w[w.INT_VEC4=35669]="INT_VEC4",w[w.BOOL=35670]="BOOL",w[w.BOOL_VEC2=35671]="BOOL_VEC2",w[w.BOOL_VEC3=35672]="BOOL_VEC3",w[w.BOOL_VEC4=35673]="BOOL_VEC4",w[w.FLOAT_MAT2=35674]="FLOAT_MAT2",w[w.FLOAT_MAT3=35675]="FLOAT_MAT3",w[w.FLOAT_MAT4=35676]="FLOAT_MAT4",w[w.SAMPLER_2D=35678]="SAMPLER_2D",w[w.SAMPLER_CUBE=35680]="SAMPLER_CUBE",w[w.UNSIGNED_INT=5125]="UNSIGNED_INT",w[w.UNSIGNED_INT_VEC2=36294]="UNSIGNED_INT_VEC2",w[w.UNSIGNED_INT_VEC3=36295]="UNSIGNED_INT_VEC3",w[w.UNSIGNED_INT_VEC4=36296]="UNSIGNED_INT_VEC4",w[w.FLOAT_MAT2x3=35685]="FLOAT_MAT2x3",w[w.FLOAT_MAT2x4=35686]="FLOAT_MAT2x4",w[w.FLOAT_MAT3x2=35687]="FLOAT_MAT3x2",w[w.FLOAT_MAT3x4=35688]="FLOAT_MAT3x4",w[w.FLOAT_MAT4x2=35689]="FLOAT_MAT4x2",w[w.FLOAT_MAT4x3=35690]="FLOAT_MAT4x3",w[w.SAMPLER_3D=35679]="SAMPLER_3D",w[w.SAMPLER_2D_SHADOW=35682]="SAMPLER_2D_SHADOW",w[w.SAMPLER_2D_ARRAY=36289]="SAMPLER_2D_ARRAY",w[w.SAMPLER_2D_ARRAY_SHADOW=36292]="SAMPLER_2D_ARRAY_SHADOW",w[w.SAMPLER_CUBE_SHADOW=36293]="SAMPLER_CUBE_SHADOW",w[w.INT_SAMPLER_2D=36298]="INT_SAMPLER_2D",w[w.INT_SAMPLER_3D=36299]="INT_SAMPLER_3D",w[w.INT_SAMPLER_CUBE=36300]="INT_SAMPLER_CUBE",w[w.INT_SAMPLER_2D_ARRAY=36303]="INT_SAMPLER_2D_ARRAY",w[w.UNSIGNED_INT_SAMPLER_2D=36306]="UNSIGNED_INT_SAMPLER_2D",w[w.UNSIGNED_INT_SAMPLER_3D=36307]="UNSIGNED_INT_SAMPLER_3D",w[w.UNSIGNED_INT_SAMPLER_CUBE=36308]="UNSIGNED_INT_SAMPLER_CUBE",w[w.UNSIGNED_INT_SAMPLER_2D_ARRAY=36311]="UNSIGNED_INT_SAMPLER_2D_ARRAY",e.SyncParameter=void 0,(D=e.SyncParameter||(e.SyncParameter={}))[D.OBJECT_TYPE=37138]="OBJECT_TYPE",D[D.SYNC_CONDITION=37139]="SYNC_CONDITION",D[D.SYNC_STATUS=37140]="SYNC_STATUS",D[D.SYNC_FLAGS=37141]="SYNC_FLAGS",e.SyncStatus=void 0,(N=e.SyncStatus||(e.SyncStatus={}))[N.UNSIGNALED=37144]="UNSIGNALED",N[N.SIGNALED=37145]="SIGNALED",e.ClientWaitSyncStatus=void 0,(P=e.ClientWaitSyncStatus||(e.ClientWaitSyncStatus={}))[P.ALREADY_SIGNALED=37146]="ALREADY_SIGNALED",P[P.TIMEOUT_EXPIRED=37147]="TIMEOUT_EXPIRED",P[P.CONDITION_SATISFIED=37148]="CONDITION_SATISFIED",P[P.WAIT_FAILED=37149]="WAIT_FAILED",e.SyncCondition=void 0,(O=e.SyncCondition||(e.SyncCondition={}))[O.SYNC_GPU_COMMANDS_COMPLETE=37143]="SYNC_GPU_COMMANDS_COMPLETE",e.SyncFlag=void 0,(M=e.SyncFlag||(e.SyncFlag={}))[M.SYNC_FLUSH_COMMANDS_BIT=1]="SYNC_FLUSH_COMMANDS_BIT",e.ErrorConstant=void 0,(U=e.ErrorConstant||(e.ErrorConstant={}))[U.INVALID_ENUM=1280]="INVALID_ENUM",U[U.INVALID_VALUE=1281]="INVALID_VALUE",U[U.INVALID_OPERATION=1282]="INVALID_OPERATION",U[U.OUT_OF_MEMORY=1285]="OUT_OF_MEMORY",U[U.INVALID_FRAMEBUFFER_OPERATION=1286]="INVALID_FRAMEBUFFER_OPERATION",U[U.CONTEXT_LOST_WEBGL=37442]="CONTEXT_LOST_WEBGL",e.Extension=void 0,(C=e.Extension||(e.Extension={}))[C.COMPLETION_STATUS_KHR=37297]="COMPLETION_STATUS_KHR",e.ColorAttachment0=36064,e.ColorAttachment1=36065,e.ColorAttachment10=36074,e.ColorAttachment11=36075,e.ColorAttachment12=36076,e.ColorAttachment13=36077,e.ColorAttachment14=36078,e.ColorAttachment15=36079,e.ColorAttachment2=36066,e.ColorAttachment3=36067,e.ColorAttachment4=36068,e.ColorAttachment5=36069,e.ColorAttachment6=36070,e.ColorAttachment7=36071,e.ColorAttachment8=36072,e.ColorAttachment9=36073,e.DepthAttachment=36096,e.DepthStencilAttachment=33306,e.StencilAttachment=36128,e.baseTextureUnit=33984,Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})}))},"esri/views/webgl/VertexElementDescriptor":function(){define(["exports"],(function(e){"use strict";e.VertexElementDescriptor=class{constructor(e,t,r,i,n,o=!1,s=0){this.name=e,this.count=t,this.type=r,this.offset=i,this.stride=n,this.normalized=o,this.divisor=s}},Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})}))},"esri/views/2d/engine/vectorTiles/shaders/VTLCircleMaterial":function(){define(["exports","./enums","./VTLMaterial","../../../../webgl/enums","../../../../webgl/VertexElementDescriptor"],(function(e,t,r,i,n){"use strict";class o extends r.VTLMaterial{static{this.ATTRIBUTES=["circle-radius","circle-color","circle-opacity","circle-stroke-width","circle-stroke-color","circle-stroke-opacity","circle-blur"]}static{this.GEOMETRY_LAYOUT=[new n.VertexElementDescriptor("a_pos",2,i.DataType.SHORT,0,4)]}static{this.ATTRIBUTES_INFO={"circle-radius":{name:"radius",type:t.EncodingType.R8_UNSIGNED},"circle-color":{name:"color",type:t.EncodingType.R8G8B8A8_COLOR},"circle-opacity":{name:"opacity",type:t.EncodingType.R8_UNSIGNED,precisionFactor:100},"circle-stroke-width":{name:"stroke_width",type:t.EncodingType.R8_UNSIGNED,precisionFactor:4},"circle-stroke-color":{name:"stroke_color",type:t.EncodingType.R8G8B8A8_COLOR},"circle-stroke-opacity":{name:"stroke_opacity",type:t.EncodingType.R8_UNSIGNED,precisionFactor:100},"circle-blur":{name:"blur",type:t.EncodingType.R8_UNSIGNED,precisionFactor:32}}}constructor(e){super(e)}geometryInfo(){return o.GEOMETRY_LAYOUT}opacityInfo(){return null}attributes(){return o.ATTRIBUTES}attributesInfo(){return o.ATTRIBUTES_INFO}}e.VTLCircleMaterial=o,Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})}))},"esri/views/2d/engine/vectorTiles/shaders/VTLFillMaterial":function(){define(["exports","./enums","./VTLMaterial","../../../../webgl/enums","../../../../webgl/VertexElementDescriptor"],(function(e,t,r,i,n){"use strict";class o extends r.VTLMaterial{static{this.ATTRIBUTES=["fill-color","fill-opacity","fill-pattern"]}static{this.GEOMETRY_LAYOUT=[new n.VertexElementDescriptor("a_pos",2,i.DataType.SHORT,0,4)]}static{this.ATTRIBUTES_INFO={"fill-color":{name:"color",type:t.EncodingType.R8G8B8A8_COLOR},"fill-opacity":{name:"opacity",type:t.EncodingType.R8_UNSIGNED,precisionFactor:100},"fill-pattern":{name:"tlbr",type:t.EncodingType.R16G16B16A16_PATTERN,isOptional:!0}}}constructor(e){super(e)}geometryInfo(){return o.GEOMETRY_LAYOUT}opacityInfo(){return null}attributes(){return o.ATTRIBUTES}attributesInfo(){return o.ATTRIBUTES_INFO}}class s extends r.VTLMaterial{static{this.ATTRIBUTES_OUTLINE=["fill-outline-color","fill-opacity"]}static{this.ATTRIBUTES_FILL=["fill-color","fill-opacity"]}static{this.GEOMETRY_LAYOUT=[new n.VertexElementDescriptor("a_pos",2,i.DataType.SHORT,0,8),new n.VertexElementDescriptor("a_offset",2,i.DataType.BYTE,4,8),new n.VertexElementDescriptor("a_xnormal",2,i.DataType.BYTE,6,8)]}static{this.ATTRIBUTES_INFO_OUTLINE={"fill-outline-color":{name:"color",type:t.EncodingType.R8G8B8A8_COLOR},"fill-opacity":{name:"opacity",type:t.EncodingType.R8_UNSIGNED,precisionFactor:100}}}static{this.ATTRIBUTES_INFO_FILL={"fill-color":{name:"color",type:t.EncodingType.R8G8B8A8_COLOR},"fill-opacity":{name:"opacity",type:t.EncodingType.R8_UNSIGNED,precisionFactor:100}}}constructor(e,t){super(e),this._usefillColor=t}geometryInfo(){return s.GEOMETRY_LAYOUT}opacityInfo(){return null}attributes(){return this._usefillColor?s.ATTRIBUTES_FILL:s.ATTRIBUTES_OUTLINE}attributesInfo(){return this._usefillColor?s.ATTRIBUTES_INFO_FILL:s.ATTRIBUTES_INFO_OUTLINE}}e.VTLFillMaterial=o,e.VTLOutlineMaterial=s,Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})}))},"esri/views/2d/engine/vectorTiles/shaders/VTLLineMaterial":function(){define(["exports","./enums","./VTLMaterial","../../../../webgl/enums","../../../../webgl/VertexElementDescriptor"],(function(e,t,r,i,n){"use strict";class o extends r.VTLMaterial{static{this.ATTRIBUTES=["line-blur","line-color","line-gap-width","line-offset","line-opacity","line-width","line-pattern","line-dasharray"]}static{this.GEOMETRY_LAYOUT=[new n.VertexElementDescriptor("a_pos",2,i.DataType.SHORT,0,16),new n.VertexElementDescriptor("a_extrude_offset",4,i.DataType.BYTE,4,16),new n.VertexElementDescriptor("a_dir_normal",4,i.DataType.BYTE,8,16),new n.VertexElementDescriptor("a_accumulatedDistance",2,i.DataType.UNSIGNED_SHORT,12,16)]}static{this.ATTRIBUTES_INFO={"line-width":{name:"width",type:t.EncodingType.R8_UNSIGNED,precisionFactor:2},"line-gap-width":{name:"gap_width",type:t.EncodingType.R8_UNSIGNED,precisionFactor:2},"line-offset":{name:"offset",type:t.EncodingType.R8_SIGNED,precisionFactor:2},"line-color":{name:"color",type:t.EncodingType.R8G8B8A8_COLOR},"line-opacity":{name:"opacity",type:t.EncodingType.R8_UNSIGNED,precisionFactor:100},"line-blur":{name:"blur",type:t.EncodingType.R8_UNSIGNED,precisionFactor:4},"line-pattern":{name:"tlbr",type:t.EncodingType.R16G16B16A16_PATTERN,isOptional:!0},"line-dasharray":{name:"tlbr",type:t.EncodingType.R16G16B16A16_DASHARRAY,isOptional:!0}}}constructor(e){super(e)}geometryInfo(){return o.GEOMETRY_LAYOUT}opacityInfo(){return null}attributes(){return o.ATTRIBUTES}attributesInfo(){return o.ATTRIBUTES_INFO}}e.VTLLineMaterial=o,Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})}))},"esri/views/2d/engine/vectorTiles/shaders/VTLSymbolMaterial":function(){define(["exports","./enums","./VTLMaterial","../../../../webgl/enums","../../../../webgl/VertexElementDescriptor"],(function(e,t,r,i,n){"use strict";const o=[new n.VertexElementDescriptor("a_pos",2,i.DataType.SHORT,0,16),new n.VertexElementDescriptor("a_vertexOffset",2,i.DataType.SHORT,4,16),new n.VertexElementDescriptor("a_texAngleRange",4,i.DataType.UNSIGNED_BYTE,8,16),new n.VertexElementDescriptor("a_levelInfo",4,i.DataType.UNSIGNED_BYTE,12,16)],s=[new n.VertexElementDescriptor("a_opacityInfo",1,i.DataType.UNSIGNED_BYTE,0,1)];class a extends r.VTLMaterial{static{this.ATTRIBUTES=["icon-color","icon-opacity","icon-halo-blur","icon-halo-color","icon-halo-width","icon-size"]}static{this.ATTRIBUTES_INFO={"icon-color":{name:"color",type:t.EncodingType.R8G8B8A8_COLOR},"icon-opacity":{name:"opacity",type:t.EncodingType.R8_UNSIGNED,precisionFactor:100},"icon-halo-color":{name:"halo_color",type:t.EncodingType.R8G8B8A8_COLOR},"icon-halo-width":{name:"halo_width",type:t.EncodingType.R8_UNSIGNED,precisionFactor:4},"icon-halo-blur":{name:"halo_blur",type:t.EncodingType.R8_UNSIGNED,precisionFactor:4},"icon-size":{name:"size",type:t.EncodingType.R8_UNSIGNED,precisionFactor:32,isLayout:!0}}}constructor(e){super(e)}geometryInfo(){return o}opacityInfo(){return s}attributes(){return a.ATTRIBUTES}attributesInfo(){return a.ATTRIBUTES_INFO}}class l extends r.VTLMaterial{static{this.ATTRIBUTES=["text-color","text-opacity","text-halo-blur","text-halo-color","text-halo-width","text-size"]}static{this.ATTRIBUTES_INFO={"text-color":{name:"color",type:t.EncodingType.R8G8B8A8_COLOR},"text-opacity":{name:"opacity",type:t.EncodingType.R8_UNSIGNED,precisionFactor:100},"text-halo-color":{name:"halo_color",type:t.EncodingType.R8G8B8A8_COLOR},"text-halo-width":{name:"halo_width",type:t.EncodingType.R8_UNSIGNED,precisionFactor:4},"text-halo-blur":{name:"halo_blur",type:t.EncodingType.R8_UNSIGNED,precisionFactor:4},"text-size":{name:"size",type:t.EncodingType.R8_UNSIGNED,isLayout:!0}}}constructor(e){super(e)}geometryInfo(){return o}opacityInfo(){return s}attributes(){return l.ATTRIBUTES}attributesInfo(){return l.ATTRIBUTES_INFO}}e.VTLIconMaterial=a,e.VTLTextMaterial=l,Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})}))},"esri/views/2d/engine/vectorTiles/style/Filter":function(){define(["../expression/expression","../expression/types"],(function(e,t){"use strict";class r{constructor(e){this._expression=e}filter(e,t){if(!this._expression)return!0;try{return this._expression.evaluate(e,t)}catch(e){return console.log(e.message),!0}}static createFilter(i){if(!i)return null;this.isLegacyFilter(i)&&(i=this.convertLegacyFilter(i));try{const n=e.createExpression(i,null,t.booleanType);return new r(n)}catch(e){return console.log(e.message),null}}static isLegacyFilter(e){if(!Array.isArray(e))return!0;if(0===e.length)return!0;switch(e[0]){case"==":case"!=":case">":case"<":case">=":case"<=":return 3===e.length&&"string"==typeof e[1]&&!Array.isArray(e[2]);case"in":return e.length>=3&&"string"==typeof e[1]&&!Array.isArray(e[2]);case"!in":case"none":case"!has":return!0;case"any":case"all":for(let t=1;t<e.length;t++)if(this.isLegacyFilter(e[t]))return!0;return!1;case"has":return 2===e.length&&("$id"===e[1]||"$type"===e[1]);default:return!1}}static convertLegacyFilter(e){if(!Array.isArray(e)||0===e.length)return!0;const t=e[0];if(1===e.length)return"any"!==t;switch(t){case"==":return r.convertComparison("==",e[1],e[2]);case"!=":return r.negate(r.convertComparison("==",e[1],e[2]));case">":case"<":case">=":case"<=":return r.convertComparison(t,e[1],e[2]);case"in":return r.convertIn(e[1],e.slice(2));case"!in":return r.negate(r.convertIn(e[1],e.slice(2)));case"any":case"all":case"none":return r.convertCombining(t,e.slice(1));case"has":return r.convertHas(e[1]);case"!has":return r.negate(r.convertHas(e[1]));default:throw new Error("Unexpected legacy filter.")}}static convertComparison(e,t,r){switch(t){case"$type":return[e,["geometry-type"],r];case"$id":return[e,["id"],r];default:return[e,["get",t],r]}}static convertIn(e,t){switch(e){case"$type":return["in",["geometry-type"],["literal",t]];case"$id":return["in",["id"],["literal",t]];default:return["in",["get",e],["literal",t]]}}static convertHas(e){switch(e){case"$type":return!0;case"$id":return["has-id"];default:return["has",e]}}static convertCombining(e,t){return[e].concat(t.map(this.convertLegacyFilter))}static negate(e){return["!",e]}}return r}))},"esri/views/2d/engine/vectorTiles/expression/expression":function(){define(["exports","../../../../../Color","../../../../../core/colorUtils","../../../../../geometry/support/TileClipper","../../../unitBezier","../GeometryUtils","./types"],(function(e,t,r,i,n,o,s){"use strict";class a{constructor(e){this._parent=e,this._vars={}}add(e,t){this._vars[e]=t}get(e){return this._vars[e]?this._vars[e]:this._parent?this._parent.get(e):null}}class l{constructor(){this.type=s.valueType}static parse(e){if(e.length>1)throw new Error('"id" does not expect arguments');return new l}evaluate(e,t){return e?.id}}class c{constructor(){this.type=s.stringType}static parse(e){if(e.length>1)throw new Error('"geometry-type" does not expect arguments');return new c}evaluate(e,t){if(!e)return null;switch(e.type){case i.GeometryType.Point:return"Point";case i.GeometryType.LineString:return"LineString";case i.GeometryType.Polygon:return"Polygon";default:return null}}}class u{constructor(){this.type=s.objectType}static parse(e){if(e.length>1)throw new Error('"properties" does not expect arguments');return new u}evaluate(e,t){return e?.values}}class h{constructor(){this.type=s.numberType}static parse(e){if(e.length>1)throw new Error('"zoom" does not expect arguments');return new h}evaluate(e,t){return t}}class p{constructor(e,t,r){this._lhs=e,this._rhs=t,this._compare=r,this.type=s.booleanType}static parse(e,t,r){if(3!==e.length&&4!==e.length)throw new Error(`"${e[0]}" expects 2 or 3 arguments`);if(4===e.length)throw new Error(`"${e[0]}" collator not supported`);return new p(te(e[1],t),te(e[2],t),r)}evaluate(e,t){return this._compare(this._lhs.evaluate(e,t),this._rhs.evaluate(e,t))}}class y extends p{static parse(e,t){return p.parse(e,t,((e,t)=>e===t))}}class _ extends p{static parse(e,t){return p.parse(e,t,((e,t)=>e!==t))}}class d extends p{static parse(e,t){return p.parse(e,t,((e,t)=>e<t))}}class f extends p{static parse(e,t){return p.parse(e,t,((e,t)=>e<=t))}}class m extends p{static parse(e,t){return p.parse(e,t,((e,t)=>e>t))}}class T extends p{static parse(e,t){return p.parse(e,t,((e,t)=>e>=t))}}class g{constructor(e){this._arg=e,this.type=s.booleanType}static parse(e,t){if(2!==e.length)throw new Error('"!" expects 1 argument');return new g(te(e[1],t))}evaluate(e,t){return!this._arg.evaluate(e,t)}}class E{constructor(e){this._args=e,this.type=s.booleanType}static parse(e,t){const r=[];for(let i=1;i<e.length;i++)r.push(te(e[i],t));return new E(r)}evaluate(e,t){for(const r of this._args)if(!r.evaluate(e,t))return!1;return!0}}class S{constructor(e){this._args=e,this.type=s.booleanType}static parse(e,t){const r=[];for(let i=1;i<e.length;i++)r.push(te(e[i],t));return new S(r)}evaluate(e,t){for(const r of this._args)if(r.evaluate(e,t))return!0;return!1}}class A{constructor(e){this._args=e,this.type=s.booleanType}static parse(e,t){const r=[];for(let i=1;i<e.length;i++)r.push(te(e[i],t));return new A(r)}evaluate(e,t){for(const r of this._args)if(r.evaluate(e,t))return!1;return!0}}class R{constructor(e,t,r){this.type=e,this._args=t,this._fallback=r}static parse(e,t,r){if(e.length<4)throw new Error('"case" expects at least 3 arguments');if(e.length%2==1)throw new Error('"case" expects an odd number of arguments');let i;const n=[];for(let o=1;o<e.length-1;o+=2){const s=te(e[o],t),a=te(e[o+1],t,r);i||(i=a.type),n.push({condition:s,output:a})}const o=te(e[e.length-1],t,r);return i||(i=o.type),new R(i,n,o)}evaluate(e,t){for(const r of this._args)if(r.condition.evaluate(e,t))return r.output.evaluate(e,t);return this._fallback.evaluate(e,t)}}class I{constructor(e,t){this.type=e,this._args=t}static parse(e,t){if(e.length<2)throw new Error('"coalesce" expects at least 1 argument');let r;const i=[];for(let n=1;n<e.length;n++){const o=te(e[n],t);r||(r=o.type),i.push(o)}return new I(r,i)}evaluate(e,t){for(const r of this._args){const i=r.evaluate(e,t);if(null!==i)return i}return null}}class b{constructor(e,t,r,i,n){this.type=e,this._input=t,this._labels=r,this._outputs=i,this._fallback=n}static parse(e,t){if(e.length<3)throw new Error('"match" expects at least 3 arguments');if(e.length%2==0)throw new Error('"case" expects an even number of arguments');let r;const i=te(e[1],t),n=[],o={};let s;for(let i=2;i<e.length-1;i+=2){let a=e[i];Array.isArray(a)||(a=[a]);for(const e of a){const t=typeof e;if("string"!==t&&"number"!==t)throw new Error('"match" requires string or number literal as labels');if(s){if(t!==s)throw new Error('"match" requires labels to have the same type')}else s=t;o[e]=n.length}const l=te(e[i+1],t);r||(r=l.type),n.push(l)}return new b(r,i,o,n,te(e[e.length-1],t))}evaluate(e,t){const r=this._input.evaluate(e,t);return(this._outputs[this._labels[r]]||this._fallback).evaluate(e,t)}}class x{constructor(e,t,r,i,n){this._operator=e,this.type=t,this.interpolation=r,this.input=i,this._stops=n}static parse(e,t,r){const i=e[0];if(e.length<5)throw new Error(`"${i}" expects at least 4 arguments`);const n=e[1];if(!Array.isArray(n)||0===n.length)throw new Error(`"${n}" is not a valid interpolation`);switch(n[0]){case"linear":if(1!==n.length)throw new Error("Linear interpolation cannot have parameters");break;case"exponential":if(2!==n.length||"number"!=typeof n[1])throw new Error("Exponential interpolation requires one numeric argument");break;case"cubic-bezier":if(5!==n.length)throw new Error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1");for(let e=1;e<5;e++){const t=n[e];if("number"!=typeof t||t<0||t>1)throw new Error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1")}break;default:throw new Error(`"${e[0]}" unknown interpolation type "${n[0]}"`)}if(e.length%2!=1)throw new Error(`"${i}" expects an even number of arguments`);const o=te(e[2],t,s.numberType);let a;"interpolate-hcl"===i||"interpolate-lab"===i?a=s.colorType:r&&"value"!==r.kind&&(a=r);const l=[];for(let r=3;r<e.length;r+=2){const n=e[r];if("number"!=typeof n)throw new Error(`"${i}" requires stop inputs as literal numbers`);if(l.length&&l[l.length-1][0]>=n)throw new Error(`"${i}" requires strictly ascending stop inputs`);const o=te(e[r+1],t,a);a||(a=o.type),l.push([n,o])}if(a&&a!==s.colorType&&a!==s.numberType&&("array"!==a.kind||a.itemType!==s.numberType))throw new Error(`"${i}" cannot interpolate type ${s.typeToString(a)}`);return new x(i,a,n,o,l)}evaluate(e,i){const n=this._stops;if(1===n.length)return n[0][1].evaluate(e,i);const a=this.input.evaluate(e,i);if(a<=n[0][0])return n[0][1].evaluate(e,i);if(a>=n[n.length-1][0])return n[n.length-1][1].evaluate(e,i);let l=0;for(;++l<n.length&&!(a<n[l][0]););const c=n[l-1][0],u=n[l][0],h=x.interpolationRatio(this.interpolation,a,c,u),p=n[l-1][1].evaluate(e,i),y=n[l][1].evaluate(e,i);if("interpolate"===this._operator){if("array"===this.type.kind&&Array.isArray(p)&&Array.isArray(y))return p.map(((e,t)=>o.interpolate(e,y[t],h)));if("color"===this.type.kind&&p instanceof t&&y instanceof t){const e=new t(p),r=new t(y);return new t([o.interpolate(e.r,r.r,h),o.interpolate(e.g,r.g,h),o.interpolate(e.b,r.b,h),o.interpolate(e.a,r.a,h)])}if("number"===this.type.kind&&"number"==typeof p&&"number"==typeof y)return o.interpolate(p,y,h);throw new Error(`"${this._operator}" cannot interpolate type ${s.typeToString(this.type)}`)}if("interpolate-hcl"===this._operator){const e=r.toLCH(p),i=r.toLCH(y),n=i.h-e.h,s=r.toRGB({h:e.h+h*(n>180||n<-180?n-360*Math.round(n/360):n),c:o.interpolate(e.c,i.c,h),l:o.interpolate(e.l,i.l,h)});return new t({a:o.interpolate(p.a,y.a,h),...s})}if("interpolate-lab"===this._operator){const e=r.toLAB(p),i=r.toLAB(y),n=r.toRGB({l:o.interpolate(e.l,i.l,h),a:o.interpolate(e.a,i.a,h),b:o.interpolate(e.b,i.b,h)});return new t({a:o.interpolate(p.a,y.a,h),...n})}throw new Error(`Unexpected operator "${this._operator}"`)}interpolationUniformValue(e,t){const r=this._stops;if(1===r.length)return 0;if(e>=r[r.length-1][0])return 0;let i=0;for(;++i<r.length&&!(e<r[i][0]););const n=r[i-1][0],o=r[i][0];return x.interpolationRatio(this.interpolation,t,n,o)}getInterpolationRange(e){const t=this._stops;if(1===t.length){const e=t[0][0];return[e,e]}const r=t[t.length-1][0];if(e>=r)return[r,r];let i=0;for(;++i<t.length&&!(e<t[i][0]););return[t[i-1][0],t[i][0]]}static interpolationRatio(e,t,r,i){let o=0;return"linear"===e[0]?o=x._exponentialInterpolationRatio(t,1,r,i):"exponential"===e[0]?o=x._exponentialInterpolationRatio(t,e[1],r,i):"cubic-bezier"===e[0]&&(o=n.unitBezier(e[1],e[2],e[3],e[4])(x._exponentialInterpolationRatio(t,1,r,i),1e-5)),o<0?o=0:o>1&&(o=1),o}static _exponentialInterpolationRatio(e,t,r,i){const n=i-r;if(0===n)return 0;const o=e-r;return 1===t?o/n:(t**o-1)/(t**n-1)}}class v{constructor(e,t,r){this.type=e,this._input=t,this._stops=r}static parse(e,t){if(e.length<5)throw new Error('"step" expects at least 4 arguments');if(e.length%2!=1)throw new Error('"step" expects an even number of arguments');const r=te(e[1],t,s.numberType);let i;const n=[];n.push([-1/0,te(e[2],t)]);for(let r=3;r<e.length;r+=2){const o=e[r];if("number"!=typeof o)throw new Error('"step" requires stop inputs as literal numbers');if(n.length&&n[n.length-1][0]>=o)throw new Error('"step" requires strictly ascending stop inputs');const s=te(e[r+1],t);i||(i=s.type),n.push([o,s])}return new v(i,r,n)}evaluate(e,t){const r=this._stops;if(1===r.length)return r[0][1].evaluate(e,t);const i=this._input.evaluate(e,t);let n=0;for(;++n<r.length&&!(i<r[n][0]););return this._stops[n-1][1].evaluate(e,t)}}class L{constructor(e,t){this.type=e,this._output=t}static parse(e,t,r){if(e.length<4)throw new Error('"let" expects at least 3 arguments');if(e.length%2==1)throw new Error('"let" expects an odd number of arguments');const i=new a(t);for(let r=1;r<e.length-1;r+=2){const n=e[r];if("string"!=typeof n)throw new Error(`"let" requires a string to define variable names - found ${n}`);i.add(n,te(e[r+1],t))}const n=te(e[e.length-1],i,r);return new L(n.type,n)}evaluate(e,t){return this._output.evaluate(e,t)}}class w{constructor(e,t){this.type=e,this.output=t}static parse(e,t,r){if(2!==e.length||"string"!=typeof e[1])throw new Error('"var" requires just one literal string argument');const i=t.get(e[1]);if(!i)throw new Error(`${e[1]} must be defined before being used in a "var" expression`);return new w(r||s.valueType,i)}evaluate(e,t){return this.output.evaluate(e,t)}}class D{constructor(e,t,r){this.type=e,this._index=t,this._array=r}static parse(e,t){if(3!==e.length)throw new Error('"at" expects 2 arguments');const r=te(e[1],t,s.numberType),i=te(e[2],t);return new D(i.type.itemType,r,i)}evaluate(e,t){const r=this._index.evaluate(e,t),i=this._array.evaluate(e,t);if(r<0||r>=i.length)throw new Error('"at" index out of bounds');if(r!==Math.floor(r))throw new Error('"at" index must be an integer');return i[r]}}class N{constructor(e,t){this._key=e,this._obj=t,this.type=s.valueType}static parse(e,t){let r,i;switch(e.length){case 2:return r=te(e[1],t),new N(r);case 3:return r=te(e[1],t),i=te(e[2],t),new N(r,i);default:throw new Error('"get" expects 1 or 2 arguments')}}evaluate(e,t){const r=this._key.evaluate(e,t);return this._obj?this._obj.evaluate(e,t)[r]:e?.values[r]}}class P{constructor(e,t){this._key=e,this._obj=t,this.type=s.booleanType}static parse(e,t){let r,i;switch(e.length){case 2:return r=te(e[1],t),new P(r);case 3:return r=te(e[1],t),i=te(e[2],t),new P(r,i);default:throw new Error('"has" expects 1 or 2 arguments')}}evaluate(e,t){const r=this._key.evaluate(e,t);return this._obj?r in this._obj.evaluate(e,t):!!e?.values[r]}}class O{constructor(e,t){this._key=e,this._vals=t,this.type=s.booleanType}static parse(e,t){if(3!==e.length)throw new Error('"in" expects 2 arguments');return new O(te(e[1],t),te(e[2],t))}evaluate(e,t){const r=this._key.evaluate(e,t);return this._vals.evaluate(e,t).includes(r)}}class M{constructor(e,t,r){this._item=e,this._array=t,this._from=r,this.type=s.numberType}static parse(e,t){if(e.length<3||e.length>4)throw new Error('"index-of" expects 3 or 4 arguments');const r=te(e[1],t),i=te(e[2],t);if(4===e.length){const n=te(e[3],t,s.numberType);return new M(r,i,n)}return new M(r,i)}evaluate(e,t){const r=this._item.evaluate(e,t),i=this._array.evaluate(e,t);if(this._from){const n=this._from.evaluate(e,t);if(n!==Math.floor(n))throw new Error('"index-of" index must be an integer');return i.indexOf(r,n)}return i.indexOf(r)}}class U{constructor(e){this._arg=e,this.type=s.numberType}static parse(e,t){if(2!==e.length)throw new Error('"length" expects 2 arguments');const r=te(e[1],t);return new U(r)}evaluate(e,t){const r=this._arg.evaluate(e,t);if("string"==typeof r)return r.length;if(Array.isArray(r))return r.length;throw new Error('"length" expects string or array')}}class C{constructor(e,t,r,i){this.type=e,this._array=t,this._from=r,this._to=i}static parse(e,t){if(e.length<3||e.length>4)throw new Error('"slice" expects 2 or 3 arguments');const r=te(e[1],t),i=te(e[2],t,s.numberType);if(i.type!==s.numberType)throw new Error('"slice" index must return a number');if(4===e.length){const n=te(e[3],t,s.numberType);if(n.type!==s.numberType)throw new Error('"slice" index must return a number');return new C(r.type,r,i,n)}return new C(r.type,r,i)}evaluate(e,t){const r=this._array.evaluate(e,t);if(!Array.isArray(r)&&"string"!=typeof r)throw new Error('"slice" input must be an array or a string');const i=this._from.evaluate(e,t);if(i<0||i>=r.length)throw new Error('"slice" index out of bounds');if(i!==Math.floor(i))throw new Error('"slice" index must be an integer');if(this._to){const n=this._to.evaluate(e,t);if(n<0||n>=r.length)throw new Error('"slice" index out of bounds');if(n!==Math.floor(n))throw new Error('"slice" index must be an integer');return r.slice(i,n)}return r.slice(i)}}class B{constructor(){this.type=s.booleanType}static parse(e){if(1!==e.length)throw new Error('"has-id" expects no arguments');return new B}evaluate(e,t){return void 0!==e?.id}}class G{constructor(e,t){this._args=e,this._calculate=t,this.type=s.numberType}static parse(e,t,r){const i=e.slice(1).map((e=>te(e,t)));return new G(i,r)}evaluate(e,t){let r;return this._args&&(r=this._args.map((r=>r.evaluate(e,t)))),this._calculate(r)}}class F extends G{static parse(e,t){switch(e.length){case 2:return G.parse(e,t,(e=>-e[0]));case 3:return G.parse(e,t,(e=>e[0]-e[1]));default:throw new Error('"-" expects 1 or 2 arguments')}}}class V extends G{static parse(e,t){return G.parse(e,t,(e=>{let t=1;for(const r of e)t*=r;return t}))}}class z extends G{static parse(e,t){if(3===e.length)return G.parse(e,t,(e=>e[0]/e[1]));throw new Error('"/" expects 2 arguments')}}class k extends G{static parse(e,t){if(3===e.length)return G.parse(e,t,(e=>e[0]%e[1]));throw new Error('"%" expects 2 arguments')}}class H extends G{static parse(e,t){if(3===e.length)return G.parse(e,t,(e=>e[0]**e[1]));throw new Error('"^" expects 1 or 2 arguments')}}class j extends G{static parse(e,t){return G.parse(e,t,(e=>{let t=0;for(const r of e)t+=r;return t}))}}class Y{constructor(e,t){this._args=e,this._calculate=t,this.type=s.numberType}static{this.ops={abs:e=>Math.abs(e[0]),acos:e=>Math.acos(e[0]),asin:e=>Math.asin(e[0]),atan:e=>Math.atan(e[0]),ceil:e=>Math.ceil(e[0]),cos:e=>Math.cos(e[0]),e:()=>Math.E,floor:e=>Math.floor(e[0]),ln:e=>Math.log(e[0]),ln2:()=>Math.LN2,log10:e=>Math.log(e[0])/Math.LN10,log2:e=>Math.log(e[0])/Math.LN2,max:e=>Math.max(...e),min:e=>Math.min(...e),pi:()=>Math.PI,round:e=>Math.round(e[0]),sin:e=>Math.sin(e[0]),sqrt:e=>Math.sqrt(e[0]),tan:e=>Math.tan(e[0])}}static parse(e,t){const r=e.slice(1).map((e=>te(e,t)));return new Y(r,Y.ops[e[0]])}evaluate(e,t){let r;return this._args&&(r=this._args.map((r=>r.evaluate(e,t)))),this._calculate(r)}}class ${constructor(e){this._args=e,this.type=s.stringType}static parse(e,t){return new $(e.slice(1).map((e=>te(e,t))))}evaluate(e,t){return this._args.map((r=>r.evaluate(e,t))).join("")}}class W{constructor(e,t){this._arg=e,this._calculate=t,this.type=s.stringType}static{this.ops={downcase:e=>e.toLowerCase(),upcase:e=>e.toUpperCase()}}static parse(e,t){if(2!==e.length)throw new Error(`${e[0]} expects 1 argument`);const r=te(e[1],t);return new W(r,W.ops[e[0]])}evaluate(e,t){return this._calculate(this._arg.evaluate(e,t))}}class q{constructor(e){this._args=e,this.type=s.colorType}static parse(e,t){if(4!==e.length)throw new Error('"rgb" expects 3 arguments');const r=e.slice(1).map((e=>te(e,t)));return new q(r)}evaluate(e,r){const i=this._validate(this._args[0].evaluate(e,r)),n=this._validate(this._args[1].evaluate(e,r)),o=this._validate(this._args[2].evaluate(e,r));return new t({r:i,g:n,b:o})}_validate(e){if("number"!=typeof e||e<0||e>255)throw new Error(`${e}: invalid color component`);return Math.round(e)}}class X{constructor(e){this._args=e,this.type=s.colorType}static parse(e,t){if(5!==e.length)throw new Error('"rgba" expects 4 arguments');const r=e.slice(1).map((e=>te(e,t)));return new X(r)}evaluate(e,r){const i=this._validate(this._args[0].evaluate(e,r)),n=this._validate(this._args[1].evaluate(e,r)),o=this._validate(this._args[2].evaluate(e,r)),s=this._validateAlpha(this._args[3].evaluate(e,r));return new t({r:i,g:n,b:o,a:s})}_validate(e){if("number"!=typeof e||e<0||e>255)throw new Error(`${e}: invalid color component`);return Math.round(e)}_validateAlpha(e){if("number"!=typeof e||e<0||e>1)throw new Error(`${e}: invalid alpha color component`);return e}}class K{constructor(e){this._color=e,this.type=s.arrayType(s.numberType,4)}static parse(e,t){if(2!==e.length)throw new Error('"to-rgba" expects 1 argument');const r=te(e[1],t);return new K(r)}evaluate(e,r){return new t(this._color.evaluate(e,r)).toRgba()}}class Q{constructor(e,t){this.type=e,this._args=t}static parse(e,t){const r=e[0];if(e.length<2)throw new Error(`${r} expects at least one argument`);let i,n=1;if("array"===r){if(e.length>2){switch(e[1]){case"string":i=s.stringType;break;case"number":i=s.numberType;break;case"boolean":i=s.booleanType;break;default:throw new Error('"array" type argument must be string, number or boolean')}n++}else i=s.valueType;let t;if(e.length>3){if(t=e[2],null!==t&&("number"!=typeof t||t<0||t!==Math.floor(t)))throw new Error('"array" length argument must be a positive integer literal');n++}i=s.arrayType(i,t)}else switch(r){case"string":i=s.stringType;break;case"number":i=s.numberType;break;case"boolean":i=s.booleanType;break;case"object":i=s.objectType}const o=[];for(;n<e.length;n++){const r=te(e[n],t);o.push(r)}return new Q(i,o)}evaluate(e,t){let r;for(const i of this._args){const n=i.evaluate(e,t);if(r=s.getType(n),s.matchType(r,this.type))return n}throw new Error(`Expected ${s.typeToString(this.type)} but got ${s.typeToString(r)}`)}}class J{static{this.types={"to-boolean":s.booleanType,"to-color":s.colorType,"to-number":s.numberType,"to-string":s.stringType}}constructor(e,t){this.type=e,this._args=t}static parse(e,t){const r=e[0],i=J.types[r];if(i===s.booleanType||i===s.stringType){if(2!==e.length)throw new Error(`${r} expects one argument`)}else if(e.length<2)throw new Error(`${r} expects at least one argument`);const n=[];for(let r=1;r<e.length;r++){const i=te(e[r],t);n.push(i)}return new J(i,n)}evaluate(e,r){if(this.type===s.booleanType)return Boolean(this._args[0].evaluate(e,r));if(this.type===s.stringType)return s.valueToString(this._args[0].evaluate(e,r));if(this.type===s.numberType){for(const t of this._args){const i=Number(t.evaluate(e,r));if(!isNaN(i))return i}return null}if(this.type===s.colorType){for(const i of this._args)try{const n=J.toColor(i.evaluate(e,r));if(n instanceof t)return n}catch{}return null}}static toBoolean(e){return Boolean(e)}static toString(e){return s.valueToString(e)}static toNumber(e){const t=Number(e);if(isNaN(t))throw new Error(`"${e}" is not a number`);return t}static toColor(e){if(e instanceof t)return e;if("string"==typeof e){const r=t.fromString(e);if(r)return r;throw new Error(`"${e}" is not a color`)}if(Array.isArray(e))return t.fromArray(e);throw new Error(`"${e}" is not a color`)}}class Z{constructor(e){this._val=e,this.type=s.getType(e)}static parse(e){if(2!==e.length)throw new Error('"literal" expects 1 argument');return new Z(e[1])}evaluate(e,t){return this._val}}class ee{constructor(e){this._arg=e,this.type=s.stringType}static parse(e,t){if(2!==e.length)throw new Error('"typeof" expects 1 argument');return new ee(te(e[1],t))}evaluate(e,t){return s.typeToString(s.getType(this._arg.evaluate(e,t)))}}function te(e,t,r){const i=typeof e;if("string"===i||"boolean"===i||"number"===i||null===e){if(r)switch(r.kind){case"string":"string"!==i&&(e=J.toString(e));break;case"number":"number"!==i&&(e=J.toNumber(e));break;case"color":e=J.toColor(e)}e=["literal",e]}if(!Array.isArray(e)||0===e.length)throw new Error("Expression must be a non empty array");const n=e[0];if("string"!=typeof n)throw new Error("First element of expression must be a string");const o=re[n];if(void 0===o)throw new Error(`Invalid expression operator "${n}"`);if(!o)throw new Error(`Unimplemented expression operator "${n}"`);return o.parse(e,t,r)}const re={array:Q,boolean:Q,collator:null,format:null,image:null,literal:Z,number:Q,"number-format":null,object:Q,string:Q,"to-boolean":J,"to-color":J,"to-number":J,"to-string":J,typeof:ee,accumulated:null,"feature-state":null,"geometry-type":c,id:l,"line-progress":null,properties:u,at:D,get:N,has:P,in:O,"index-of":M,length:U,slice:C,"!":g,"!=":_,"<":d,"<=":f,"==":y,">":m,">=":T,all:E,any:S,case:R,coalesce:I,match:b,within:null,interpolate:x,"interpolate-hcl":x,"interpolate-lab":x,step:v,let:L,var:w,concat:$,downcase:W,"is-supported-script":null,"resolved-locale":null,upcase:W,rgb:q,rgba:X,"to-rgba":K,"-":F,"*":V,"/":z,"%":k,"^":H,"+":j,abs:Y,acos:Y,asin:Y,atan:Y,ceil:Y,cos:Y,e:Y,floor:Y,ln:Y,ln2:Y,log10:Y,log2:Y,max:Y,min:Y,pi:Y,round:Y,sin:Y,sqrt:Y,tan:Y,zoom:h,"heatmap-density":null,"has-id":B,none:A};e.ALL=E,e.ANY=S,e.Add=j,e.Assert=Q,e.At=D,e.Calculate=Y,e.Case=R,e.Coalesce=I,e.Coerce=J,e.Concat=$,e.Div=z,e.EQ=y,e.GE=T,e.GT=m,e.GeomType=c,e.Get=N,e.Has=P,e.HasID=B,e.ID=l,e.In=O,e.IndexOf=M,e.Interpolate=x,e.LE=f,e.LT=d,e.Length=U,e.Let=L,e.Literal=Z,e.Match=b,e.Mod=k,e.Mul=V,e.NE=_,e.NONE=A,e.NOT=g,e.Pow=H,e.Properties=u,e.Rgb=q,e.Rgba=X,e.Slice=C,e.Step=v,e.String=W,e.Sub=F,e.ToRgba=K,e.TypeOf=ee,e.Var=w,e.Zoom=h,e.createExpression=te,e.ops=re,Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})}))},"esri/core/colorUtils":function(){define(["exports","../Color","./arrayUtils","./lang","./mathUtils","../chunks/vec42","./libs/gl-matrix-2/factories/vec4f64"],(function(e,t,r,i,n,o,s){"use strict";function a(e){return"r"in e&&"g"in e&&"b"in e}function l(e){return"h"in e&&"s"in e&&"v"in e}function c(e){return"l"in e&&"a"in e&&"b"in e}function u(e){return"l"in e&&"c"in e&&"h"in e}const h=[[.4124,.3576,.1805],[.2126,.7152,.0722],[.0193,.1192,.9505]],p=[[3.2406,-1.5372,-.4986],[-.9689,1.8758,.0415],[.0557,-.204,1.057]];function y(e,t){const r=[];let i,n;if(e[0].length!==t.length)throw new Error("dimensions do not match");const o=e.length,s=e[0].length;let a=0;for(i=0;i<o;i++){for(a=0,n=0;n<s;n++)a+=e[i][n]*t[n];r.push(a)}return r}function _(e){const t=[e.r/255,e.g/255,e.b/255].map((e=>e<=.04045?e/12.92:((e+.055)/1.055)**2.4)),r=y(h,t);return{x:100*r[0],y:100*r[1],z:100*r[2]}}function d(e){const t=y(p,[e.x/100,e.y/100,e.z/100]).map((e=>{const t=e<=.0031308?12.92*e:1.055*e**(1/2.4)-.055;return Math.min(1,Math.max(t,0))}));return{r:Math.round(255*t[0]),g:Math.round(255*t[1]),b:Math.round(255*t[2])}}function f(e){const t=[e.x/95.047,e.y/100,e.z/108.883].map((e=>e>(6/29)**3?e**(1/3):1/3*(29/6)**2*e+4/29));return{l:116*t[1]-16,a:500*(t[0]-t[1]),b:200*(t[1]-t[2])}}function m(e){const t=e.l,r=[(t+16)/116+e.a/500,(t+16)/116,(t+16)/116-e.b/200].map((e=>e>6/29?e**3:3*(6/29)**2*(e-4/29)));return{x:95.047*r[0],y:100*r[1],z:108.883*r[2]}}function T(e){return a(e)?e:u(e)?function(e){return d(m(function(e){const t=e.l,r=e.c,i=e.h;return{l:t,a:r*Math.cos(i),b:r*Math.sin(i)}}(e)))}(e):c(e)?function(e){return d(m(e))}(e):function(e){return"x"in e&&"y"in e&&"z"in e}(e)?d(e):l(e)?function(e){const t=(e.h+360)%360/60,r=e.s/100,i=e.v/100*255,n=i*r,o=n*(1-Math.abs(t%2-1));let s;switch(Math.floor(t)){case 0:s={r:n,g:o,b:0};break;case 1:s={r:o,g:n,b:0};break;case 2:s={r:0,g:n,b:o};break;case 3:s={r:0,g:o,b:n};break;case 4:s={r:o,g:0,b:n};break;case 5:case 6:s={r:n,g:0,b:o};break;default:s={r:0,g:0,b:0}}return s.r=Math.round(s.r+i-n),s.g=Math.round(s.g+i-n),s.b=Math.round(s.b+i-n),s}(e):e}function g(e){return l(e)?e:function(e){const t=e.r,r=e.g,i=e.b,n=Math.max(t,r,i),o=n-Math.min(t,r,i);let s=n,a=0===o?0:n===t?(r-i)/o%6:n===r?(i-t)/o+2:(t-r)/o+4,l=0===o?0:o/s;return a<0&&(a+=6),a*=60,l*=100,s*=100/255,{h:a,s:l,v:s}}(T(e))}function E(e){return c(e)?e:function(e){return f(_(e))}(T(e))}function S(e){let{r,g:i,b:n,a:o}=e;return o<1&&(r=Math.round(o*r+255*(1-o)),i=Math.round(o*i+255*(1-o)),n=Math.round(o*n+255*(1-o))),new t({r,g:i,b:n})}function A(e,t){const{r,g:i,b:n}=t?.ignoreAlpha?e:S(e);return.2126*r+.7152*i+.0722*n}var R;function I(e){return e[0]??=0,e[1]??=0,e[2]??=0,e}e.BrightnessThreshold=void 0,(R=e.BrightnessThreshold||(e.BrightnessThreshold={}))[R.Low=160]="Low",R[R.High=225]="High";const b=(e,t)=>{const r=Math.floor(10*t())-5;return Math.min(255,Math.max(0,e+r))};function x(e,i,n,o={}){const s=e.r,a=e.g,l=e.b,c=i.r,u=i.g,h=i.b,p=Math.round(s+(c-s)*n),y=Math.round(a+(u-a)*n),_=Math.round(l+(h-l)*n);if(!o.offset)return new t([p,y,_]);const d=r.getRandomNumberGenerator(o.seed);return new t([b(p,d),b(y,d),b(_,d)])}e.colorEquals=function(e,t){return e===t||null!=e&&e.equals(t)},e.colorVectorEquals=function(e,t){return e===t||null!=e&&null!=t&&o.equals(e,t)},e.colorVectorToColorAndOpacity=function(e){return s.fromValues(e[0],e[1],e[2],e.length>3?e[3]:1)},e.createUniqueColors=function(e,n,o={}){if(0===e.length||n<=0)return[];if(1===(e=e.map((e=>"string"==typeof e?new t(e):e))).length||1===n){const t=[],r=e[0];for(let e=0;e<n;e++)t.push(r.clone());return t}if(o.shuffle&&(e=r.shuffle(i.clone(e),o.seed)),e.length>=n){const t=[],r=(e.length-1)/(n-1);for(let i=0;i<n;i++){const n=Math.round(i*r);t.push(e[n].clone())}return t}return function(e,t,i={}){const n=[],o=e.length-1,s=Math.ceil((t-e.length)/o);e:for(let r=0;r<o;r++){const o=e[r],a=e[r+1];for(let r=1;r<=s;r++){const l=r/(s+1);if(n.push(x(o,a,l,i)),n.length+e.length===t)break e}}return[...e.map((e=>e.clone())),...r.shuffle(n,i.seed??1)]}(e,n,o)},e.darken=function(e,t){const r=E(e);r.l*=1-t;const i=T(r),n=e.clone();return n.setColor(i),n.a=e.a,n},e.desaturate=function(e,t){const r=g(e);r.s*=t;const i=T(r),n=e.clone();return n.setColor(i),n.a=e.a,n},e.getColorLuminance=A,e.getColorTheme=function(e){return S(e).isBright?"light":"dark"},e.getContrast=function(r,i=e.BrightnessThreshold.High){return A(r,{ignoreAlpha:!0})>i?new t([0,0,0,r.a]):new t([255,255,255,r.a])},e.isRGB=a,e.multiplyOpacity=function(e,t){const r=e.clone();return r.a*=t,r},e.multiplyOpacityToUnitRGBA=function(e,r){const i=t.toUnitRGBA(e);return i[3]*=r,i},e.toHSV=g,e.toLAB=E,e.toLCH=function(e){return u(e)?e:function(e){return function(e){const t=e.l,r=e.a,i=e.b,n=Math.sqrt(r*r+i*i);let o=Math.atan2(i,r);return o=o>0?o:o+2*Math.PI,{l:t,c:n,h:o}}(f(_(e)))}(T(e))},e.toRGB=T,e.unitRGBAFromColor=function(e){return t.toUnitRGBA(e)},e.validateColor=I,e.validateColorAndOpacity=function(e){return e.length=4,I(e),e[3]??=1,n.clamp(e[3],0,1),e},Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})}))},"esri/views/2d/unitBezier":function(){define(["exports"],(function(e){"use strict";function t(e,t,r,i){const n=3*e,o=3*(r-e)-n,s=1-n-o,a=3*t,l=3*(i-t)-a,c=1-a-l;function u(e){return((s*e+o)*e+n)*e}return function(e,t=1e-6){return r=function(e,t){let r,i,a,l,c,h;for(a=e,h=0;h<8;h++){if(l=u(a)-e,Math.abs(l)<t)return a;if(c=(3*s*(p=a)+2*o)*p+n,Math.abs(c)<1e-6)break;a-=l/c}var p;if(r=0,i=1,a=e,a<r)return r;if(a>i)return i;for(;r<i;){if(l=u(a),Math.abs(l-e)<t)return a;e>l?r=a:i=a,a=.5*(i-r)+r}return a}(e,t),((c*r+l)*r+a)*r;var r}}const r=/^cubic-bezier\((.*)\)/,i={};i.ease=t(.25,.1,.25,1),i.linear=t(0,0,1,1),i.easeIn=i["ease-in"]=t(.42,0,1,1),i.easeOut=i["ease-out"]=t(0,0,.58,1),i.easeInOut=i["ease-in-out"]=t(.42,0,.58,1),e.easingFunctions=i,e.parse=function(e){let n=i[e]||null;if(!n){const i=r.exec(e);if(i){const e=i[1].split(",").map((e=>parseFloat(e.trim())));4!==e.length||e.some((e=>isNaN(e)))||(n=t.apply(t,e))}}return n},e.unitBezier=t,Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})}))},"esri/views/2d/engine/vectorTiles/expression/types":function(){define(["exports","../../../../../Color"],(function(e,t){"use strict";const r={kind:"null"},i={kind:"number"},n={kind:"string"},o={kind:"boolean"},s={kind:"color"},a={kind:"object"},l={kind:"value"};function c(e,t){return{kind:"array",itemType:e,n:t}}const u=[r,i,n,o,s,a,c(l)];e.arrayType=c,e.booleanType=o,e.colorType=s,e.getType=function e(u){if(null===u)return r;if("string"==typeof u)return n;if("boolean"==typeof u)return o;if("number"==typeof u)return i;if(u instanceof t)return s;if(Array.isArray(u)){let t;for(const r of u){const i=e(r);if(t){if(t!==i){t=l;break}}else t=i}return c(t||l,u.length)}return"object"==typeof u?a:l},e.matchType=function e(t,r){if("array"===r.kind)return"array"===t.kind&&(0===t.n&&"value"===t.itemType.kind||e(t.itemType,r.itemType))&&("number"!=typeof r.n||r.n===t.n);if("value"===r.kind)for(const r of u)if(e(t,r))return!0;return r.kind===t.kind},e.nullType=r,e.numberType=i,e.objectType=a,e.stringType=n,e.typeToString=function e(t){if("array"===t.kind){const r=e(t.itemType);return"number"==typeof t.n?`array<${r}, ${t.n}>`:"value"===t.itemType.kind?"array":`array<${r}>`}return t.kind},e.valueToString=function(e){if(null===e)return"";const r=typeof e;return"string"===r?e:"number"===r||"boolean"===r?String(e):e instanceof t?e.toString():JSON.stringify(e)},e.valueType=l,Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})}))},"esri/views/2d/engine/vectorTiles/style/StyleProperty":function(){define(["../../../../../Color","../../../../../colorUtils","../GeometryUtils","../expression/expression","../expression/types"],(function(e,t,r,i,n){"use strict";class o{constructor(e,t){let r;switch(this.isDataDriven=!1,this.interpolator=null,e.type){case"number":case"color":r=!0;break;case"array":r="number"===e.value;break;default:r=!1}if((null==t||""===t&&"color"===e.type)&&(t=e.default),Array.isArray(t)&&t.length>0&&i.ops[t[0]]){const r={number:n.numberType,color:n.colorType,string:n.stringType,boolean:n.booleanType,enum:n.stringType};try{const o="array"===e.type?n.arrayType(r[e.value]||n.valueType,e.length):r[e.type],s=i.createExpression(t,null,o);this.getValue=this._buildExpression(s,e),this.isDataDriven=!0,s instanceof i.Interpolate&&s.input instanceof i.Zoom&&(this.interpolator=s)}catch(t){console.log(t.message),this.getValue=this._buildSimple(e.default)}return}r&&"interval"===t.type&&(r=!1);const o=t?.stops&&t.stops.length>0;if(o)for(const r of t.stops)r[1]=this._validate(r[1],e);if(this.isDataDriven=!!t&&!!t.property,this.isDataDriven)if(void 0!==t.default&&(t.default=this._validate(t.default,e)),o)switch(t.type){case"identity":this.getValue=this._buildIdentity(t,e);break;case"categorical":this.getValue=this._buildCategorical(t,e);break;default:this.getValue=r?this._buildInterpolate(t,e):this._buildInterval(t,e)}else this.getValue=this._buildIdentity(t,e);else o?this.getValue=r?this._buildZoomInterpolate(t):this._buildZoomInterval(t):(t=this._validate(t,e),this.getValue=this._buildSimple(t))}_validate(e,t){if("number"===t.type){if(null!=t.minimum&&e<t.minimum)return t.minimum;if(null!=t.maximum&&e>t.maximum)return t.maximum}else"color"===t.type?e=o._parseColor(e):"enum"===t.type?"string"==typeof e&&(e=t.values.indexOf(e)):"array"===t.type&&"enum"===t.value?e=e.map((e=>"string"==typeof e?t.values.indexOf(e):e)):"string"===t.type&&(e=n.valueToString(e));return e}_buildSimple(e){return()=>e}_buildExpression(e,t){return(r,i)=>{try{const n=e.evaluate(i,r);return void 0===n?t.default:this._validate(n,t)}catch(e){return console.log(e.message),t.default}}}_buildIdentity(e,t){return(r,i)=>{let n;return i&&(n=i.values[e.property]),void 0!==n&&(n=this._validate(n,t)),null!=n?n:void 0!==e.default?e.default:t.default}}_buildCategorical(e,t){return(r,i)=>{let n;return i&&(n=i.values[e.property]),n=this._categorical(n,e.stops),void 0!==n?n:void 0!==e.default?e.default:t.default}}_buildInterval(e,t){return(r,i)=>{let n;return i&&(n=i.values[e.property]),"number"==typeof n?this._interval(n,e.stops):void 0!==e.default?e.default:t.default}}_buildInterpolate(e,t){return(r,i)=>{let n;return i&&(n=i.values[e.property]),"number"==typeof n?this._interpolate(n,e.stops,e.base||1):void 0!==e.default?e.default:t.default}}_buildZoomInterpolate(e){return t=>this._interpolate(t,e.stops,e.base||1)}_buildZoomInterval(e){return t=>this._interval(t,e.stops)}_categorical(e,t){const r=t.length;for(let i=0;i<r;i++)if(t[i][0]===e)return t[i][1]}_interval(e,t){const r=t.length;let i=0;for(let n=0;n<r&&t[n][0]<=e;n++)i=n;return t[i][1]}_interpolate(e,t,i){let n,o;const s=t.length;for(let r=0;r<s;r++){const i=t[r];if(!(i[0]<=e)){o=i;break}n=i}if(n&&o){const t=o[0]-n[0],s=e-n[0],a=1===i?s/t:(i**s-1)/(i**t-1);if(Array.isArray(n[1])){const e=n[1],t=o[1],i=[];for(let n=0;n<e.length;n++)i.push(r.interpolate(e[n],t[n],a));return i}return r.interpolate(n[1],o[1],a)}return n?n[1]:o?o[1]:void 0}static _isEmpty(e){for(const t in e)if(e.hasOwnProperty(t))return!1;return!0}static _parseColor(r){return Array.isArray(r)?r:"string"==typeof r?t.parseToUnitRgba(r)??void 0:r instanceof e&&!this._isEmpty(r)?e.toUnitRGBA(r):void 0}}return o}))},"esri/views/2d/engine/webgl/definitions":function(){define(["exports"],(function(e){"use strict";var t;e.AttributeDataType=void 0,(t=e.AttributeDataType||(e.AttributeDataType={}))[t.FilterFlags=0]="FilterFlags",t[t.Animation=1]="Animation",t[t.GPGPU=2]="GPGPU",t[t.VV=3]="VV",t[t.DD0=4]="DD0",t[t.DD1=5]="DD1",t[t.DD2=6]="DD2",t[t.LocalTimeOrigin=7]="LocalTimeOrigin",e.MAX_TILE_RESHUFFLES_PER_FRAME=1,e.RESHUFFLING_EXEMPT_DRAW_CALLS=10,e.RESHUFFLING_EXEMPT_MEMORY_BYTES=1<<20,e.RESHUFFLING_TARGET_DRAW_EFFICIENCY=.75,e.RESHUFFLING_TARGET_MEMORY_EFFICIENCY=.75,e.angleFactor256=256/360,e.animationUnit=2,e.attributeStoreInitialSize=256,e.attributeStoreTextureSize=1024,e.averageGlyphMosaicItem={metrics:{width:15,height:17,left:0,top:-7,advance:14}},e.backbufferStencilClipped=1,e.backbufferStencilVisible=0,e.bitsetFillHasPatternHeightPrecisionFactor=32,e.bitsetFillHasPatternWidthPrecisionFactor=64,e.bitsetFillHasUnresolvedReplacementColor=8,e.bitsetFillRandomPatternOffset=4,e.bitsetGenericConsiderAlphaOnly=16,e.bitsetGenericLockColor=2,e.bitsetLineScaleDash=4,e.bitsetMarkerAlignmentMap=1,e.bitsetMarkerAlignmentScreen=0,e.bitsetMarkerOutlineAllowColorOverride=4,e.bitsetMarkerScaleSymbolsProportionally=8,e.bitsetTypeFillOutline=1,e.bufferDataMinimumSize=128,e.bufferDataPoolSize=4,e.chartMaxFields=10,e.collisionBoxPadding=16,e.collisionBucketSize=128,e.collisionEarlyRejectBucketSize=16,e.collisionMaxZoomDelta=1,e.collisionPlacementPadding=8,e.collisionTileBoxSize=4,e.compressionFactorForU16=128,e.dataDrivenUnit0=4,e.dataDrivenUnit1=5,e.dataDrivenUnit2=6,e.debugLabels=!1,e.defaultSdfTextureSize=128,e.displayRecordIntPerElement=8,e.dotDensityMaxFields=8,e.effectFlag0=128,e.enableEarlyLabelDiscard=!1,e.extrudeScale=64,e.filterFlag0=64,e.filterFlagsUnit=1,e.glyphSize=24,e.gpgpuUnit=12,e.gradientTextureExternalPadding=1,e.heuristicGlyphsPerFeature=10,e.heuristicGlyphsPerLine=50,e.hittestSmallSymbolThreshold=3,e.hittestToleranceDesktop=1,e.hittestToleranceMobile=3,e.hittestToleranceSmallSymbol=3,e.labelPlacementOffsetPadding=4,e.localTimeOriginUnit=13,e.magicLabelLineHeight=29,e.maxGeohashLevel=12,e.maxGpuUploadsPerFrame=2,e.maxHighlightReasons=6,e.maxRepresentableInt=16777216,e.maxTextLineWidth=512,e.minMaxZoomPrecisionFactor=10,e.minTextLineWidth=32,e.nanMagicNumber=1e-30,e.patchPixelBufferAllocSize=500,e.patternFillRasterizationScale=2,e.pictureFillColor=4294967295,e.randomInsidePolygonTextureSize=1024,e.rasterTileSize=256,e.rasterizedVectorMarkerMinSize=128,e.spritePadding=4,e.svgSdfTextureInnerSize=248,e.svgSdfTextureSize=256,e.textureBindingBitmap=0,e.textureBindingGlyphAtlas=0,e.textureBindingHighlight0=5,e.textureBindingHighlight1=6,e.textureBindingRenderer0=5,e.textureBindingRenderer1=6,e.textureBindingSpriteAtlas=0,e.textureUploadManagerBudget=4,e.textureUploadManagerChunkSize=128,e.thinLineHalfWidthThreshold=1.05,e.tileSize=512,e.visualVariableUnit=3,e.vtlHighResCutoff=1.15,e.vtlTextureBindingUnitGlyphs=6,e.vtlTextureBindingUnitSprites=5,e.webglMaxInnerStops=6,e.webglMaxStops=8,Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})}))},"esri/views/webgl/capabilities":function(){define(["exports","./capabilities/DebugRendererInfo"],(function(e,t){"use strict";let r;class i{constructor(){this.available=!1,this.majorPerformanceCaveat=!1,this.maxTextureSize=0,this.supportsVertexShaderSamplers=!1,this.supportsHighPrecisionFragment=!1,this.supportsColorBufferFloat=!1,this.supportsColorBufferFloatBlend=!1,this.supportsColorBufferHalfFloat=!1,this.unmaskedRenderer="unloaded"}}e.getWebGLCapabilities=function(){return r??=function(){const e=new i,r=function(e){if("undefined"==typeof WebGL2RenderingContext)return null;const r=document.createElement("canvas");if(!r)return null;let i=r.getContext("webgl2",{failIfMajorPerformanceCaveat:!0});if(null==i&&(i=r.getContext("webgl2"),null!=i&&(e.majorPerformanceCaveat=!0,e.unmaskedRenderer=t.loadRendererInfo(i)?.getUnmaskedRenderer()??"unknown")),null==i)return i;e.available=!0,e.maxTextureSize=i.getParameter(i.MAX_TEXTURE_SIZE),e.supportsVertexShaderSamplers=i.getParameter(i.MAX_VERTEX_TEXTURE_IMAGE_UNITS)>0;const n=i.getShaderPrecisionFormat(i.FRAGMENT_SHADER,i.HIGH_FLOAT);return n&&(e.supportsHighPrecisionFragment=n.precision>0),i}(e);return null==r||(e.supportsColorBufferFloat=null!==r.getExtension("EXT_color_buffer_float"),e.supportsColorBufferFloatBlend=null!==r.getExtension("EXT_float_blend"),e.supportsColorBufferHalfFloat=e.supportsColorBufferFloat||null!==r.getExtension("EXT_color_buffer_half_float")),e}(),r},Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})}))},"esri/views/webgl/capabilities/DebugRendererInfo":function(){define(["exports"],(function(e){"use strict";class t{constructor(e){this.getUnmaskedRenderer=e}}e.RendererInfo=t,e.loadRendererInfo=function(e){const r=e.getExtension("WEBGL_debug_renderer_info");return r?new t((()=>e.getParameter(r.UNMASKED_RENDERER_WEBGL))):null},Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})}))},"*noref":1}}),define(["../chunks/tslib.es6","../request","../core/asyncUtils","../core/Error","../core/lang","../core/MultiOriginJSONSupport","../core/promiseUtils","../core/urlUtils","../core/accessorSupport/decorators/property","../core/has","../core/Logger","../core/accessorSupport/decorators/reader","../core/accessorSupport/decorators/subclass","../core/accessorSupport/decorators/writer","../geometry/Extent","../geometry/SpatialReference","./Layer","./mixins/APIKeyMixin","./mixins/ArcGISCachedService","./mixins/ArcGISService","./mixins/BlendLayer","./mixins/CustomParametersMixin","./mixins/OperationalLayer","./mixins/PortalLayer","./mixins/RefreshableLayer","./mixins/ScaleRangeLayer","./support/imageUtils","./support/SpriteSource","./support/TileInfo","./support/TilemapCache","./support/vectorTileLayerLoader","../portal/support/jsonContext","../portal/support/urlUtils","../chunks/persistableUrlUtils","../views/2d/engine/vectorTiles/tileInfoUtils","../views/2d/engine/vectorTiles/style/StyleRepository","../views/webgl/capabilities"],(function(e,t,r,i,n,o,s,a,l,c,u,h,p,y,_,d,f,m,T,g,E,S,A,R,I,b,x,v,L,w,D,N,P,O,M,U,C){"use strict";let B=class extends(E.BlendLayer(b.ScaleRangeLayer(I.RefreshableLayer(T.ArcGISCachedService(g.ArcGISService(A.OperationalLayer(R.PortalLayer(S.CustomParametersMixin(m.APIKeyMixin(o.MultiOriginJSONMixin(f))))))))))){constructor(...e){super(...e),this._spriteSourceMap=new Map,this.currentStyleInfo=null,this.isReference=null,this.operationalLayerType="VectorTileLayer",this.path=null,this.refreshInterval=0,this.style=null,this.tilemapCache=null,this.type="vector-tile",this.url=null}normalizeCtorArgs(e,t){return"string"==typeof e?{url:e,...t}:e}destroy(){if(this.sourceNameToSource)for(const e of Object.values(this.sourceNameToSource))e?.destroy();this.primarySource?.destroy(),this._spriteSourceMap.clear()}async prefetchResources(e){await this.loadSpriteSource(globalThis.devicePixelRatio||1,e)}load(e){const r=this.loadFromPortal({supportedTypes:["Vector Tile Service"],supportsData:!1},e).catch(s.throwIfAbortError).then((async()=>{if(!this.portalItem?.id)return;const r=`${this.portalItem.itemCdnUrl}/resources/styles/root.json`;(await t(r,{...e,query:{f:"json",...this.customParameters,token:this.apiKey},authMode:this.portalItem.portal.authMode})).data&&this.read({url:r},N.createForItemRead(this.portalItem,"portal-item"))})).catch(s.throwIfAbortError).then((()=>this._loadStyle(e)));return this.addResolvingPromise(r),Promise.resolve(this)}get attributionDataUrl(){const e=this.currentStyleInfo,t=e?.serviceUrl&&a.urlToObject(e.serviceUrl);if(!t)return null;const r=this._getDefaultAttribution(t.path);return r?a.addQueryParameters(r,{...this.customParameters,token:this.apiKey}):null}get capabilities(){const e=this.primarySource;return e?e.capabilities:{operations:{supportsExportTiles:!1,supportsTileMap:!1},exportTiles:null}}get fullExtent(){return this.primarySource?.fullExtent||null}get initialExtent(){return this.primarySource?.initialExtent||null}get parsedUrl(){return this.serviceUrl?a.urlToObject(this.serviceUrl):null}get serviceUrl(){return this.currentStyleInfo?.serviceUrl||null}get spatialReference(){return this.tileInfo?.spatialReference??null}get styleUrl(){return this.currentStyleInfo?.styleUrl||null}writeStyleUrl(e,t){e&&a.isProtocolRelative(e)&&(e=`https:${e}`);const r=P.parseKnownArcGISOnlineDomain(e);t.styleUrl=O.ensureMainOnlineDomain(e,r)}get tileInfo(){const e=[];for(const t in this.sourceNameToSource)e.push(this.sourceNameToSource[t]);let t=this.primarySource?.tileInfo||new L;if(e.length>1)for(let r=0;r<e.length;r++)M.areSchemasOverlapping(t,e[r].tileInfo)&&(t=M.unionTileInfos(t,e[r].tileInfo));return t}readTilemapCache(e,t){const r=t.capabilities?.includes("Tilemap");return r?new w.TilemapCache({layer:this}):null}readVersion(e,t){return t.version?parseFloat(t.version):parseFloat(t.currentVersion)}async loadSpriteSource(e=1,t){if(!this._spriteSourceMap.has(e)){const r=C.getWebGLCapabilities().maxTextureSize,i=this.currentStyleInfo?.spriteUrl?a.addQueryParameters(this.currentStyleInfo.spriteUrl,{...this.customParameters,token:this.apiKey}):null,n=new v({type:"url",spriteUrl:i,pixelRatio:e,spriteFormat:this.currentStyleInfo?.spriteFormat},r);await n.load(t),this._spriteSourceMap.set(e,n)}return this._spriteSourceMap.get(e)}async setSpriteSource(e,t){if(!e)return null;const r=C.getWebGLCapabilities().maxTextureSize,i=e.spriteUrl,n=i?a.addQueryParameters(i,{...this.customParameters,token:this.apiKey}):null;if(!n&&"url"===e.type)return null;const o=new v(e,r);try{await o.load(t);const r=e.pixelRatio||1;return this._spriteSourceMap.clear(),this._spriteSourceMap.set(r,o),n&&this.currentStyleInfo&&(this.currentStyleInfo.spriteUrl=n),this.emit("spriteSource-change",{spriteSource:o}),o}catch(e){s.throwIfAbortError(e)}return null}async loadStyle(e,t){const i=e||this.style||this.url;return this._loadingTask&&"string"==typeof i&&this.url===i||(this._loadingTask?.abort(),this._loadingTask=r.createTask((e=>(this._spriteSourceMap.clear(),this._getSourceAndStyle(i,{signal:e}))),t)),this._loadingTask.promise}getStyleLayerId(e){return this.styleRepository.getStyleLayerId(e)}getStyleLayerIndex(e){return this.styleRepository.getStyleLayerIndex(e)}getPaintProperties(e){return n.clone(this.styleRepository?.getPaintProperties(e))}setPaintProperties(e,t){const r=this.styleRepository.isPainterDataDriven(e);this.styleRepository.setPaintProperties(e,t);const i=this.styleRepository.isPainterDataDriven(e);this.emit("paint-change",{layer:e,paint:t,isDataDriven:r||i})}getStyleLayer(e){return n.clone(this.styleRepository.getStyleLayer(e))}setStyleLayer(e,t){this.styleRepository.setStyleLayer(e,t),this.emit("style-layer-change",{layer:e,index:t})}deleteStyleLayer(e){this.styleRepository.deleteStyleLayer(e),this.emit("delete-style-layer",{layer:e})}getLayoutProperties(e){return n.clone(this.styleRepository.getLayoutProperties(e))}setLayoutProperties(e,t){this.styleRepository.setLayoutProperties(e,t),this.emit("layout-change",{layer:e,layout:t})}setStyleLayerVisibility(e,t){this.styleRepository.setStyleLayerVisibility(e,t),this.emit("style-layer-visibility-change",{layer:e,visibility:t})}getStyleLayerVisibility(e){return this.styleRepository.getStyleLayerVisibility(e)}write(e,t){return t?.origin&&!this.styleUrl?(t.messages&&t.messages.push(new i("vectortilelayer:unsupported",`VectorTileLayer (${this.title}, ${this.id}) with style defined by JSON only are not supported`,{layer:this})),null):super.write(e,t)}getTileUrl(e,t,r){return null}async _getSourceAndStyle(e,t){if(!e)throw new Error("invalid style!");const r=await D.loadMetadata(e,{...t,query:{...this.customParameters,token:this.apiKey}});"webp"===r.spriteFormat&&(await x.checkWebPSupport("lossy")||(r.spriteFormat="png")),this._set("currentStyleInfo",{...r}),"string"==typeof e?(this.url=e,this.style=null):(this.url=null,this.style=e),this._set("sourceNameToSource",r.sourceNameToSource),this._set("primarySource",r.sourceNameToSource[r.primarySourceName]),this._set("styleRepository",new U(r.style,!1)),this.read(r.layerDefinition,{origin:"service"}),this.emit("load-style")}_getDefaultAttribution(e){const t=e.match(/^https?:\/\/(?:basemaps|basemapsbeta|basemapsdev)(?:-api)?\.arcgis\.com(\/[^/]+)?\/arcgis\/rest\/services\/([^/]+(\/[^/]+)*)\/vectortileserver/i),r=["OpenBasemap_v2","OpenBasemap_GCS_v2","OpenStreetMap_v2","OpenStreetMap_Daylight_v2","OpenStreetMap_Export_v2","OpenStreetMap_FTS_v2","OpenStreetMap_GCS_v2","World_Basemap","World_Basemap_v2","World_Basemap_Export_v2","World_Basemap_GCS_v2","World_Basemap_WGS84","World_Contours_v2","World_Hillshade_v2"];if(!t)return;const i=t[2]&&t[2].toLowerCase();if(!i)return;const n=t[1]||"";for(const e of r)if(e.toLowerCase().includes(i))return a.normalize(`//static.arcgis.com/attribution/Vector${n}/${e}`)}async _loadStyle(e){return this._loadingTask?.promise??this.loadStyle(null,e)}};return e.__decorate([l.property({readOnly:!0})],B.prototype,"attributionDataUrl",null),e.__decorate([l.property({type:["show","hide"]})],B.prototype,"listMode",void 0),e.__decorate([l.property({json:{read:!0,write:!0}})],B.prototype,"blendMode",void 0),e.__decorate([l.property({readOnly:!0,json:{read:!1}})],B.prototype,"capabilities",null),e.__decorate([l.property({readOnly:!0})],B.prototype,"currentStyleInfo",void 0),e.__decorate([l.property({json:{read:!1},readOnly:!0,type:_})],B.prototype,"fullExtent",null),e.__decorate([l.property({json:{read:!1},readOnly:!0,type:_})],B.prototype,"initialExtent",null),e.__decorate([l.property({type:Boolean,json:{read:!1,write:{enabled:!0,overridePolicy:()=>({enabled:!1})}}})],B.prototype,"isReference",void 0),e.__decorate([l.property({type:["VectorTileLayer"]})],B.prototype,"operationalLayerType",void 0),e.__decorate([l.property({readOnly:!0})],B.prototype,"parsedUrl",null),e.__decorate([l.property({type:String,json:{origins:{"web-scene":{read:!0,write:!0}},read:!1}})],B.prototype,"path",void 0),e.__decorate([l.property({type:Number,json:{write:!1,origins:{"web-map":{write:!1},"web-scene":{write:!1},"portal-item":{write:!1}}}})],B.prototype,"refreshInterval",void 0),e.__decorate([l.property()],B.prototype,"style",void 0),e.__decorate([l.property({readOnly:!0})],B.prototype,"serviceUrl",null),e.__decorate([l.property({type:d,readOnly:!0})],B.prototype,"spatialReference",null),e.__decorate([l.property({readOnly:!0})],B.prototype,"styleRepository",void 0),e.__decorate([l.property({readOnly:!0})],B.prototype,"sourceNameToSource",void 0),e.__decorate([l.property({readOnly:!0})],B.prototype,"primarySource",void 0),e.__decorate([l.property({type:String,readOnly:!0,json:{write:{ignoreOrigin:!0},origins:{"web-document":{write:{ignoreOrigin:!0,isRequired:!0}}}}})],B.prototype,"styleUrl",null),e.__decorate([y.writer(["portal-item","web-document"],"styleUrl")],B.prototype,"writeStyleUrl",null),e.__decorate([l.property({json:{read:!1,origins:{service:{read:!1}}},readOnly:!0,type:L})],B.prototype,"tileInfo",null),e.__decorate([l.property()],B.prototype,"tilemapCache",void 0),e.__decorate([h.reader("service","tilemapCache",["capabilities","tileInfo"])],B.prototype,"readTilemapCache",null),e.__decorate([l.property({json:{read:!1},readOnly:!0,value:"vector-tile"})],B.prototype,"type",void 0),e.__decorate([l.property({json:{origins:{"web-document":{read:{source:"styleUrl"}},"portal-item":{read:{source:"url"}}},write:!1,read:!1}})],B.prototype,"url",void 0),e.__decorate([l.property({readOnly:!0})],B.prototype,"version",void 0),e.__decorate([h.reader("version",["version","currentVersion"])],B.prototype,"readVersion",null),B=e.__decorate([p.subclass("esri.layers.VectorTileLayer")],B),B}));