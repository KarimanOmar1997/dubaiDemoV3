// All material copyright Esri, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.33/esri/copyright.txt for details.
//>>built
define(["exports","../../chunks/tslib.es6","../../PopupTemplate","../../core/JSONSupport","../../core/lang","../../core/object","../../core/screenUtils","../../core/accessorSupport/decorators/property","../../core/accessorSupport/ensureType","../../core/accessorSupport/decorators/reader","../../core/accessorSupport/decorators/subclass","../../core/accessorSupport/decorators/writer","./AggregateField","./commonProperties","./featureLayerUtils","./LabelClass","../../renderers/SimpleRenderer","../../renderers/support/jsonUtils","../../renderers/support/typeUtils","../../symbols/support/typeUtils"],(function(e,r,t,o,s,l,a,p,i,n,d,u,c,y,f,b,_,m,h,g){"use strict";var S;function w(e){return"simple"===e.type&&!e.visualVariables?.length}return e.default=S=class extends o{constructor(e){super(e),this.type="cluster",this.clusterRadius=a.toPt("80px"),this.clusterMinSize=a.toPt("12px"),this.clusterMaxSize=a.toPt("50px"),this.maxScale=0,this.popupEnabled=!0,this.popupTemplate=null,this.renderer=null,this.symbol=null,this.labelingInfo=null,this.labelsVisible=!0,this.fields=[]}readRenderer(e,r,t){const o=r.drawingInfo?.renderer;return o?.authoringInfo?.isAutoGenerated?null:o?w(o)?null:m.read(o,r,t)??void 0:f.createDefaultRenderer(r,t)}readSymbol(e,r,t){const o=r.drawingInfo?.renderer;if(o?.authoringInfo?.isAutoGenerated)return null;if(o&&w(o)){const e=m.read(o,r,t);return e?.symbol}return null}writeSymbol(e,r,t,o){const s=this.renderer?.authoringInfo?.isAutoGenerated;if(!this.renderer||s){const t=new _({symbol:e});r.drawingInfo={renderer:t.write({},o)}}}writeFields(e,r,t){const o=e.filter((e=>"avg_angle"!==e.statisticType)).map((e=>e.toJSON()));l.setDeepValue(t,o,r)}readFields(e,r,t){return e.filter((e=>!e.isAutoGenerated)).map((e=>c.fromJSON(e)))}clone(){return new S({clusterRadius:this.clusterRadius,clusterMinSize:this.clusterMinSize,clusterMaxSize:this.clusterMaxSize,labelingInfo:s.clone(this.labelingInfo),labelsVisible:this.labelsVisible,fields:s.clone(this.fields),maxScale:this.maxScale,renderer:s.clone(this.renderer),symbol:s.clone(this.symbol),popupEnabled:this.popupEnabled,popupTemplate:s.clone(this.popupTemplate)})}},r.__decorate([p.property({type:["cluster"],readOnly:!0,json:{write:!0}})],e.default.prototype,"type",void 0),r.__decorate([p.property({cast:e=>"auto"===e?e:i.ensureNumber(a.toPt(e)),json:{write:!0}})],e.default.prototype,"clusterRadius",void 0),r.__decorate([p.property({type:Number,cast:a.toPt,json:{write:!0}})],e.default.prototype,"clusterMinSize",void 0),r.__decorate([p.property({type:Number,cast:a.toPt,json:{write:!0}})],e.default.prototype,"clusterMaxSize",void 0),r.__decorate([p.property({type:Number,json:{default:0,name:"visibilityInfo.maxScale"}})],e.default.prototype,"maxScale",void 0),r.__decorate([p.property(y.popupEnabled)],e.default.prototype,"popupEnabled",void 0),r.__decorate([p.property({type:t,json:{read:{source:"popupInfo"},write:{target:"popupInfo"}}})],e.default.prototype,"popupTemplate",void 0),r.__decorate([p.property({types:h.rendererTypes,json:{write:{target:"drawingInfo.renderer"}}})],e.default.prototype,"renderer",void 0),r.__decorate([n.reader("renderer",["drawingInfo.renderer"])],e.default.prototype,"readRenderer",null),r.__decorate([p.property({types:g.symbolTypesCluster})],e.default.prototype,"symbol",void 0),r.__decorate([n.reader("symbol",["drawingInfo.renderer"])],e.default.prototype,"readSymbol",null),r.__decorate([u.writer("symbol")],e.default.prototype,"writeSymbol",null),r.__decorate([p.property({type:[b],json:{read:{source:"drawingInfo.labelingInfo"},write:{target:"drawingInfo.labelingInfo"}}})],e.default.prototype,"labelingInfo",void 0),r.__decorate([p.property(y.labelsVisible)],e.default.prototype,"labelsVisible",void 0),r.__decorate([p.property({type:[c],json:{write:!0}})],e.default.prototype,"fields",void 0),r.__decorate([u.writer("fields")],e.default.prototype,"writeFields",null),r.__decorate([n.reader("fields")],e.default.prototype,"readFields",null),e.default=S=r.__decorate([d.subclass("esri.layers.support.FeatureReductionCluster")],e.default),e.default}));