// All material copyright Esri, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.33/esri/copyright.txt for details.
//>>built
define(["exports","../../../geometry/GeometryCursor","../../../geometry/SpatialReference","../CIMEffects","../enums"],(function(t,e,i,n,s){"use strict";class o{static{this.instance=null}static local(){return null===o.instance&&(o.instance=new o),o.instance}execute(t,e,i,n,s,o,h){return new r(t,e,i,n,s,o,h)}}class r{constructor(t,e,i,n,o,r,h){switch(this._preventClipping=h,this._inputGeometries=t,this._tileKey=n,this._geometryEngine=o,this._maxInflateSize=r*i,this._width=(void 0!==e.width?e.width:2)*i,e.method){case s.GeometricEffectDonutMethod.Mitered:case s.GeometricEffectDonutMethod.Bevelled:case s.GeometricEffectDonutMethod.Rounded:case s.GeometricEffectDonutMethod.TrueBuffer:case s.GeometricEffectDonutMethod.Square:}this._option=e.option}next(){let t;for(;t=this._inputGeometries.next();){if("esriGeometryEnvelope"===t.geometryType&&this._width>0){const i=t.asJSON();return Math.min(i.xmax-i.xmin,i.ymax-i.ymin)-2*this._width<0?t:e.GeometryCursor.fromJSONCIM({paths:[[[i.xmin+this._width,i.ymin+this._width],[i.xmax-this._width,i.ymin+this._width],[i.xmax-this._width,i.ymax-this._width],[i.xmin+this._width,i.ymax-this._width],[i.xmin+this._width,i.ymin+this._width]],[[i.xmin,i.ymin],[i.xmin,i.ymax],[i.xmax,i.ymax],[i.xmax,i.ymin],[i.xmin,i.ymin]]]})}if("esriGeometryPolygon"===t.geometryType){if(0===this._width)return t.clone();const e=this._geometryEngine;if(null==e)return null;const s=!this._preventClipping&&this._tileKey?n.clipCursorToTileExtent(t,this._maxInflateSize,!0):t.clone();if(!s)continue;const o=e.buffer(i.WebMercator,s.asJSON(),-this._width,1);if(o)for(const t of o.rings)if(t){s.startPath();for(const e of t.reverse())s.pushXY(e[0],s.yFactor*e[1])}return s}}return null}}t.EffectDonut=o,Object.defineProperty(t,Symbol.toStringTag,{value:"Module"})}));