// All material copyright Esri, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.33/esri/copyright.txt for details.
//>>built
define(["exports","../CIMCursor","../CurveHelper","../enums"],(function(t,e,i,s){"use strict";class n{static{this.instance=null}static local(){return null===n.instance&&(n.instance=new n),n.instance}execute(t,e,i,s,n){return new r(t,e,i)}}class r extends e.PathTransformationCursor{constructor(t,e,s){super(t,!1,!0),this._curveHelper=new i.CurveHelper,this._placePerPart=e.placePerPart??!1,this._angleToLine=void 0===e.angleToLine||e.angleToLine,this._offset=void 0!==e.offset?e.offset*s:0,this._type=e.extremityPlacement,this._position=void 0!==e.offsetAlongLine?e.offsetAlongLine*s:0,this._beginProcessed=!1}processMultiPath(t){return this._placePerPart?super.processMultiPath(t):this.processPath(t)}processPath(t){let e;switch(this._type){case s.ExtremityPlacement.Both:default:this._beginProcessed?(e=this._atExtremities(t,this._position,!1),this._beginProcessed=!1,this.iterateMultiPath=!1,this.iteratePath=!1):(e=this._atExtremities(t,this._position,!0),this._beginProcessed=!0,this.iterateMultiPath=!0,this.iteratePath=!0);break;case s.ExtremityPlacement.JustBegin:e=this._atExtremities(t,this._position,!0);break;case s.ExtremityPlacement.JustEnd:e=this._atExtremities(t,this._position,!1);case s.ExtremityPlacement.None:}return e}_atExtremities(t,e,i){if(this._placePerPart||(i?t.seekPath(0):t.seekPath(t.totalSize-1)),i||t.seekPathEnd(),i?t.nextPoint():t.prevPoint()){let s=0,[n,r]=[0,0],[a,o]=[t.x,t.y];const h=[0,0];for(;i?t.nextPoint():t.prevPoint();){n=a,r=o,a=t.x,o=t.y;const i=this._curveHelper.getLength(n,r,a,o);if(s+i>e){const t=(e-s)/i,[l,c]=this._curveHelper.getAngleCS(h,n,r,a,o,t),P=this._curveHelper.getCoord2D(n,r,a,o,t);return this.internalPlacement.setTranslate(P[0]-this._offset*c,P[1]+this._offset*l),this._angleToLine&&this.internalPlacement.setRotateCS(-l,-c),this.internalPlacement}s+=i}}return null}}t.PlacementAtExtremities=n,Object.defineProperty(t,Symbol.toStringTag,{value:"Module"})}));