// All material copyright Esri, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.33/esri/copyright.txt for details.
//>>built
define(["exports","../../../../../core/libs/gl-matrix-2/math/mat3","../../../../../core/libs/gl-matrix-2/factories/mat3f32","../../../../../core/libs/gl-matrix-2/math/common","../constants","./CollisionJob","./SymbolDeclutterer","./SymbolRepository","./util","../style/StyleDefinition"],(function(t,e,i,o,l,s,r,n,a,c){"use strict";const y=i.create();t.declutterSingleTile=function(t,i){const m=t.transforms.tileUnitsToPixels,u=o.toRadian(i),b=Math.cos(u),f=Math.sin(u),S=Math.ceil(512*(Math.abs(f)+Math.abs(b)));e.identity(y),e.translate(y,y,[S/2,S/2]),e.rotate(y,y,u),e.translate(y,y,[-256,-256]),e.scale(y,y,[1/8,1/8,1]),t.transforms.tileUnitsToPixels=y;const g=[],p=new n.SymbolRepository(l.tileCoordSize,g),h=new r.SymbolDeclutterer("vector-tile",g,p,null,((e,o,l)=>new s.CollisionJob(e,o,l,t.styleRepository,t.key.level,i)),((t,e)=>{a.writeOpacityToBuffers(t,e,!1)}),(()=>0),(e=>{const i=t.styleRepository.getStyleLayerByUID(e).getLayoutProperty("visibility");return!i||i.getValue()!==c.Visibility.NONE}));g.push(t),p.registerVectorTile(t),h.setScreenSize(S,S),h.continue(1/0),p.unregisterVectorTile(t),t.transforms.tileUnitsToPixels=m},Object.defineProperty(t,Symbol.toStringTag,{value:"Module"})}));