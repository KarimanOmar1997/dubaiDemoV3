// All material copyright Esri, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.33/esri/copyright.txt for details.
//>>built
define(["exports","../../vectorTiles/style/StyleDefinition","./WGLBrush","../../../../webgl/enums"],(function(e,t,r,i){"use strict";e.WGLBrushVTLCircle=class extends r{constructor(){super(...arguments),this._programOptions={id:!1}}dispose(){}drawMany(e,r){const{context:n,displayLevel:a,requiredLevel:l,state:s,painter:o,spriteMosaic:c,styleLayerUID:u,requestRender:d,allowDelayedRender:y}=e;if(!r.some((e=>e.layerData.get(u)?.circleIndexCount??!1)))return;const f=e.styleLayer,p=f.circleMaterial,m=o.vectorTilesMaterialManager,g=f.getPaintValue("circle-translate",a),v=f.getPaintValue("circle-translate-anchor",a),M=this._programOptions,T=m.getMaterialProgram(n,p,M);if(y&&null!=d&&!T.compiled)return void d();n.useProgram(T),T.setUniformMatrix3fv("u_displayMat3",v===t.TranslateAnchor.VIEWPORT?s.displayMat3:s.displayViewMat3),T.setUniform2fv("u_circleTranslation",g),T.setUniform1f("u_depth",f.z),T.setUniform1f("u_antialiasingWidth",1.2);let E=-1;for(const e of r){if(!e.layerData.has(u))continue;e.key.level!==E&&(E=e.key.level,p.setDataUniforms(T,a,f,E,c));const t=e.layerData.get(u);if(!t.circleIndexCount)continue;t.prepareForRendering(n);const r=t.vao;null!=r&&(n.bindVAO(r),T.setUniformMatrix3fv("u_dvsMat3",e.transforms.displayViewScreenMat3),l!==e.key.level?n.setStencilFunction(i.CompareFunction.EQUAL,e.stencilRef,255):n.setStencilFunction(i.CompareFunction.GREATER,255,255),n.drawElements(i.PrimitiveType.TRIANGLES,t.circleIndexCount,i.DataType.UNSIGNED_INT,Uint32Array.BYTES_PER_ELEMENT*t.circleIndexStart),e.triangleCount+=t.circleIndexCount/3)}}},Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})}));