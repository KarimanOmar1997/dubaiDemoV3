// All material copyright Esri, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.33/esri/copyright.txt for details.
//>>built
define(["exports","../../definitions"],(function(t,e){"use strict";function n(t,e,n){return t[0]=e[0]-n[0],t[1]=e[1]-n[1],t}function s(t,e){return Math.sqrt(t*t+e*e)}function i(t){const e=s(t[0],t[1]);t[0]/=e,t[1]/=e}function r(t,e){return t[e+1]}function h(t){return t.length-1}function a(t){let e=0;for(let n=0;n<h(t);n++)e+=d(t,n);return e}function d(t,e,n=1){let[s,i]=r(t,e);return[s,i]=[Math.round(s),Math.round(i)],Math.sqrt(s*s+i*i)*n}class u{constructor(t,e,n,s,i){this._segments=t,this._index=e,this._distance=n,this._xStart=s,this._yStart=i,this._done=!1}static create(t){return new u(t,0,0,t[0][0],t[0][1])}clone(){return new u(this._segments,this._index,this._distance,this.xStart,this.yStart)}equals(t){return this._index===t._index||t._index===this._index-1&&(0===this._distance||1===t._distance)||t._index===this._index+1&&(1===this._distance||0===t._distance)}leq(t){return this._index<t._index||this._index===t._index&&this._distance<=t._distance}geq(t){return this._index>t._index||this._index===t._index&&this._distance>=t._distance}get _segment(){return this._segments[this._index+1]}get angle(){const t=this.dy,e=(0*t+-1*-this.dx)/(1*this.length);let n=Math.acos(e);return t>0&&(n=2*Math.PI-n),n}get xStart(){return this._xStart}get yStart(){return this._yStart}get x(){return this.xStart+this.distance*this.dx}get y(){return this.yStart+this.distance*this.dy}get dx(){return this._segment[0]}get dy(){return this._segment[1]}get xMidpoint(){return this.xStart+.5*this.dx}get yMidpoint(){return this.yStart+.5*this.dy}get xEnd(){return this.xStart+this.dx}get yEnd(){return this.yStart+this.dy}get length(){const{dx:t,dy:e}=this;return Math.sqrt(t*t+e*e)}get remainingLength(){return this.length*(1-this._distance)}get backwardLength(){return this.length*this._distance}get distance(){return this._distance}get done(){return this._done}hasPrev(){return this._index-1>=0}hasNext(){return this._index+1<h(this._segments)}next(){return this.hasNext()?(this._xStart+=this.dx,this._yStart+=this.dy,this._distance=0,this._index+=1,this):null}prev(){return this.hasPrev()?(this._index-=1,this._xStart-=this.dx,this._yStart-=this.dy,this._distance=1,this):(this._done=!0,null)}_seekBackwards(t,e){const n=this.backwardLength;if(t<=n)return this._distance=(n-t)/this.length,this;let s=this.backwardLength;for(;this.prev();){if(s+this.length>t)return this._seekBackwards(t-s);s+=this.length}return this._distance=0,e?this:null}seek(t,e=!1){if(t<0)return this._seekBackwards(Math.abs(t),e);if(t<=this.remainingLength)return this._distance=(this.backwardLength+t)/this.length,this;let n=this.remainingLength;for(;this.next();){if(n+this.length>t)return this.seek(t-n,e);n+=this.length}return this._distance=1,e?this:null}}function c(t,e,n,s,i){if(n<e)return;const r=s.clone().seek(n/2);if(null==r)return;t(r.clone(),n,i),n=(n-e)/2;const h=r.seek(e/2);c(t,e,n,s,i+1),c(t,e,n,h,i+1)}function o(t,e){const r=1e-6;if(e<=0)return;const h=t.length;if(h<3)return;const a=[];let d=0;a.push(0);for(let e=1;e<h;e++)d+=(u=t[e],c=t[e-1],s(u[0]-c[0],u[1]-c[1])),a.push(d);var u,c;e=Math.min(e,.2*d);const o=[];o.push(t[0][0]),o.push(t[0][1]);const _=t[h-1][0],l=t[h-1][1],g=n([0,0],t[0],t[1]);i(g),t[0][0]+=e*g[0],t[0][1]+=e*g[1],n(g,t[h-1],t[h-2]),i(g),t[h-1][0]+=e*g[0],t[h-1][1]+=e*g[1];for(let t=1;t<h;t++)a[t]+=e;a[h-1]+=e;const x=.5*e;for(let n=1;n<h-1;n++){let s=0,i=0,d=0;for(let h=n-1;h>=0&&!(a[h+1]<a[n]-x);h--){const u=x+a[h+1]-a[n],c=a[h+1]-a[h],o=a[n]-a[h]<x?1:u/c;if(Math.abs(o)<r)break;const _=o*o,l=o*u-.5*_*c,g=o*c/e,f=t[h+1],y=t[h][0]-f[0],S=t[h][1]-f[1];s+=g/l*(f[0]*o*u+.5*_*(u*y-c*f[0])-_*o*c*y/3),i+=g/l*(f[1]*o*u+.5*_*(u*S-c*f[1])-_*o*c*S/3),d+=g}for(let u=n+1;u<h&&!(a[u-1]>a[n]+x);u++){const h=x-a[u-1]+a[n],c=a[u]-a[u-1],o=a[u]-a[n]<x?1:h/c;if(Math.abs(o)<r)break;const _=o*o,l=o*h-.5*_*c,g=o*c/e,f=t[u-1],y=t[u][0]-f[0],S=t[u][1]-f[1];s+=g/l*(f[0]*o*h+.5*_*(h*y-c*f[0])-_*o*c*y/3),i+=g/l*(f[1]*o*h+.5*_*(h*S-c*f[1])-_*o*c*S/3),d+=g}o.push(s/d),o.push(i/d)}o.push(_),o.push(l);for(let e=0,n=0;e<h;e++)t[e][0]=o[n++],t[e][1]=o[n++]}t.SegmentCursor=u,t.pathDivide=function(t,n,s,i=!0){const r=a(t),h=u.create(t),d=r/2;if(!i)return h.seek(d),void(h.x<e.tileSize&&h.y<e.tileSize&&h.x>=0&&h.y>=0&&s(h.clone(),0,d+0*n,r));const c=Math.max((r-n)/2,0),o=Math.floor(c/n),_=d-o*n;h.seek(_);for(let t=-o;t<=o;t++)h.x<e.tileSize&&h.y<e.tileSize&&h.x>=0&&h.y>=0&&s(h.clone(),t,d+t*n,r),h.seek(n)},t.pathLength=a,t.pathSubdivide=function(t,e,n){c(n,e,a(t),u.create(t),0)},t.segmentAt=r,t.segmentCount=h,t.segmentLength=d,t.smoothPaths=function(t,e){const n=e;for(let e=0;e<t.length;e++){let s=t[e];o(s,n);const i=[];i.push(s[0]);for(let t=1;t<s.length;t++){const[e,n]=s[t-1],[r,h]=s[t],a=r-e,d=h-n;i.push([a,d])}t[e]=i,s=i}return t},Object.defineProperty(t,Symbol.toStringTag,{value:"Module"})}));