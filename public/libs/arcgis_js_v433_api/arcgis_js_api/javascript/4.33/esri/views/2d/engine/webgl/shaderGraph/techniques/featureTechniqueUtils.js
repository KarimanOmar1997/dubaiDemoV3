// All material copyright Esri, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.33/esri/copyright.txt for details.
//>>built
define(["exports","../../../../../../core/unitUtils","../../definitions","../../enums","../../../../../webgl/enums"],(function(e,t,i,n,o){"use strict";const s={color:{write:[!0,!0,!0,!0],blendMode:"composite"},depth:!1,stencil:{write:!1,test:{ref:e=>e.stencilRef,compare:o.CompareFunction.EQUAL,mask:255,op:{fail:o.StencilOperation.KEEP,zFail:o.StencilOperation.KEEP,zPass:o.StencilOperation.REPLACE}}}},r={color:{write:[!0,!0,!0,!0],blendMode:"additive"},depth:!1,stencil:!1},l={...s,color:{write:[!0,!0,!0,!0],blendMode:"delete"}};function a({pixelRatio:e,state:i,displayLevel:n,requiredLevel:o},s){const r=1/2**(n-s.key.level),l=1/2**(o-s.key.level);return{displayMat3:i.displayMat3,displayViewMat3:i.displayViewMat3,displayViewScreenMat3:s.transforms.displayViewScreenMat3,viewMat3:i.viewMat3,tileMat3:s.transforms.tileMat3,displayZoomFactor:r,requiredZoomFactor:l,tileOffset:[s.x,s.y],currentScale:i.scale,currentZoom:n,metersPerSRUnit:t.getMetersPerUnitForSR(i.spatialReference),rotation:i.rotation,pixelRatio:e}}function c(e){return"highlight"===e.passOptions?.type}function u(e){return"hittest"===e.passOptions?.type}function p(e){if(!u(e))return null;const{position:t,distance:i,smallSymbolDistance:n,smallSymbolSizeThreshold:o}=e.passOptions;return{position:t,distance:i,smallSymbolDistance:n,smallSymbolSizeThreshold:o}}function f(e){if(!c(e))return null;const{activeReasons:t,highlightAll:i}=e.passOptions;return{activeReasons:t,highlightAll:i?1:0}}e.getFeaturePipelineState=function(e){return u(e)?r:c(e)&&"clear"===e.passOptions.stepType?l:s},e.getFeatureUniforms=function(e,t){const{attributeView:i,context:n}=e;return{storage:i.getUniforms(n),view:a(e,t),hittestRequest:p(e),highlight:f(e)}},e.getLocalTileOffset=function(e){const{row:t,col:n}=e.key,o=n*i.tileSize,s=t*i.tileSize;return{tileOffsetFromLocalOrigin:[o%i.maxRepresentableInt,s%i.maxRepresentableInt],maxIntsToLocalOrigin:[Math.floor(o/i.maxRepresentableInt),Math.floor(s/i.maxRepresentableInt)]}},e.getSelectionDefines=function(e){return{inside:e.selection===n.FeatureSelection.InsideEffect,outside:e.selection===n.FeatureSelection.OutsideEffect}},e.getViewUniforms=a,e.isHighlight=c,e.isHittest=u,e.resolveDynamicUniforms=function(e,t,i){const n={};for(const o in i)"function"!=typeof i[o]?n[o]=i[o]:n[o]=i[o](e,t);return n},Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})}));