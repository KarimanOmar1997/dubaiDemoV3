// All material copyright Esri, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.33/esri/copyright.txt for details.
//>>built
define(["exports","../../graph/glsl","./constants","./utils"],(function(t,n,e,i){"use strict";function u(t,e){return n.dot(t,n.normalize(e))}function l(t,e,i){const l=i.subtract(e),a=u(t.subtract(e),l),r=n.clamp(a.divide(n.length(l)),new n.Float(0),new n.Float(1));return n.distance(t,e.add(r.multiply(i.subtract(e))))}function a(t){const e=n.abs(t);return n.step(e.x.add(e.y).add(e.z),new n.Float(1.05))}function r(t,e,i,u){const l=new n.Mat3(i.x.multiply(u.y).subtract(u.x.multiply(i.y)),u.x.multiply(e.y).subtract(e.x.multiply(u.y)),e.x.multiply(i.y).subtract(i.x.multiply(e.y)),i.y.subtract(u.y),u.y.subtract(e.y),e.y.subtract(i.y),u.x.subtract(i.x),e.x.subtract(u.x),i.x.subtract(e.x)),a=e.x.multiply(i.y.subtract(u.y)),r=i.x.multiply(u.y.subtract(e.y)),s=u.x.multiply(e.y.subtract(i.y)),c=a.add(r).add(s);return new n.Float(1).divide(c).multiply(l.multiply(new n.Vec3(1,t)))}function s(t,e,i,u){return n.equal(a(r(t,e,i,u)),new n.Float(1))}function c(t,u,a,r){const c=a.subtract(u),o=r.subtract(u),y=i.cross2(c,o),d=n.and(n.lessThan(y,new n.Float(e.epsilonHitTest)),n.greaterThan(y,new n.Float(-.05)));return n.cond([n.and(n.not(d),s(t.xy,u,a,r)),new n.Float(-1)],[!0,()=>{const e=l(t,u,a),i=l(t,a,r),s=l(t,r,u);return n.min(n.min(e,i),s)}])}t.distPointSegment=l,t.distPointTriangle=c,t.failHittest=function(t){return t.distance.add(1)},t.hittestFill=function(t,e,i){const{viewMat3:u,tileMat3:l}=t.view,a=u.multiply(l),r=a.multiply(new n.Vec3(e.pos,1)),s=a.multiply(new n.Vec3(i.nextPos1,1)),o=a.multiply(new n.Vec3(i.nextPos2,1));return c(t.hittestRequest.position,r.xy,s.xy,o.xy)},t.hittestMarker=function(t,e,i){return n.distance(t,i).subtract(e)},t.inTriangle=a,t.projectScalar=u,t.xyToBarycentric=r,Object.defineProperty(t,Symbol.toStringTag,{value:"Module"})}));