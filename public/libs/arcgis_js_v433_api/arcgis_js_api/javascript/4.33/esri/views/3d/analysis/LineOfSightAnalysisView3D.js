// All material copyright Esri, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.33/esri/copyright.txt for details.
//>>built
define(["../../../chunks/tslib.es6","../../../core/Accessor","../../../core/Collection","../../../core/Evented","../../../core/has","../../../core/maybe","../../../core/accessorSupport/decorators/property","../../../core/Logger","../../../core/RandomLCG","../../../core/accessorSupport/decorators/subclass","../../../core/libs/gl-matrix-2/factories/vec3f64","./AnalysisView3D","./LineOfSight/LineOfSightController","./LineOfSight/LineOfSightTool","./LineOfSight/LineOfSightVisualization","../../analysis/analysisViewUtils"],(function(t,e,i,o,r,s,a,n,l,p,y,c,u,d,h,_){"use strict";let g=class extends(c.AnalysisView3D(o.EventedMixin(e))){constructor(t){super(t),this.type="line-of-sight-view-3d",this.analysis=null,this.tool=null,this.computations=new i,this.cursorTarget=null,this.editable=!0,this.elevationAlignedObserver=null,this.observerEngineLocation=y.create(),this.userOperation=null}initialize(){const t=this.view,e=this.analysis;this._analysisController=new u.LineOfSightController({analysis:e,analysisViewData:this,view:t}),this._analysisVisualization=new h.LineOfSightVisualization({analysis:e,analysisViewData:this,view:t,isDecoration:!this.parent}),this.addHandles([this._analysisController.on("result-changed",(t=>{t.target!==this.cursorTarget&&this.emit("result-changed",t)})),_.connectAnalysisViewToTool(this,d.LineOfSightTool)])}destroy(){_.removeAnalysisViewTool(this),this.userOperation=s.abortMaybe(this.userOperation),this._analysisController=s.destroyMaybe(this._analysisController),this._analysisVisualization=s.destroyMaybe(this._analysisVisualization)}get results(){return this.computations.map((t=>t.result))}get priority(){return this._analysisController.priority}set priority(t){this._analysisController.priority=t}get updating(){return null!=this._analysisController&&this._analysisController.updating||null!=this._analysisVisualization&&this._analysisVisualization.updating}place(t){return _.startPlaceOperation(this,{placementOptions:t})}getResultForTarget(t){return this.computations.find((e=>e.target===t))?.result}get testInfo(){}};return t.__decorate([a.property({readOnly:!0})],g.prototype,"type",void 0),t.__decorate([a.property({constructOnly:!0,nonNullable:!0})],g.prototype,"analysis",void 0),t.__decorate([a.property()],g.prototype,"tool",void 0),t.__decorate([a.property({readOnly:!0})],g.prototype,"results",null),t.__decorate([a.property()],g.prototype,"priority",null),t.__decorate([a.property()],g.prototype,"computations",void 0),t.__decorate([a.property()],g.prototype,"cursorTarget",void 0),t.__decorate([a.property()],g.prototype,"editable",void 0),t.__decorate([a.property()],g.prototype,"elevationAlignedObserver",void 0),t.__decorate([a.property()],g.prototype,"observerEngineLocation",void 0),t.__decorate([a.property()],g.prototype,"updating",null),t.__decorate([a.property()],g.prototype,"userOperation",void 0),t.__decorate([a.property()],g.prototype,"_analysisController",void 0),t.__decorate([a.property()],g.prototype,"_analysisVisualization",void 0),g=t.__decorate([p.subclass("esri.views.3d.analysis.LineOfSightAnalysisView3D")],g),g}));