// All material copyright Esri, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.33/esri/copyright.txt for details.
//>>built
define(["exports","../../../../Color","../../../../core/colorUtils","../../../../core/maybe","../../../../core/reactiveUtils","./sliceToolUtils","../../interactive/Manipulator3D","../../interactive/manipulatorUtils","../../interactive/RenderObject","../../webgl-engine/lib/Attribute","../../webgl-engine/lib/Geometry","../../webgl-engine/lib/GeometryUtil","../../webgl-engine/lib/Material","../../webgl-engine/lib/VertexAttribute","../../webgl-engine/materials/ImageMaterial","../../webgl-engine/materials/RibbonLineMaterial","../../../interactive/interfaces"],(function(e,t,i,a,r,l,n,o,c,s,u,d,b,g,p,m,M){"use strict";class y extends n.Manipulator3D{constructor(e,a){const l=i.multiplyOpacity(e.effectiveTheme.accentColor,.5),n=i.getContrast(e.effectiveTheme.accentColor),c=a(l,n),s=new p.ImageMaterial({draped:!1,texture:c.texture,writeDepth:!1,renderOccluded:b.RenderOccludedFlag.Opaque,isDecoration:!0}),u=o.rotateManipulatorDefaults.calloutWidth,d=new m.RibbonLineMaterial({width:u,renderOccluded:b.RenderOccludedFlag.OccludeAndTransparent,isDecoration:!0});super({view:e,...h({imageMaterial:s,calloutMaterial:d})}),this._material=s,this._textureHandle=c,this._themeHandle=r.watch((()=>e.effectiveTheme.accentColor),(e=>{const r=i.multiplyOpacity(e,.5),l=i.getContrast(e),n=this._textureHandle;this._textureHandle=a(r,l),s.setParameters({texture:this._textureHandle.texture}),n?.release(),d.setParameters({color:t.toUnitRGBA(e)})}),r.initial)}destroy(){this._textureHandle=a.releaseMaybe(this._textureHandle),this._themeHandle.remove(),this._material.dispose(),super.destroy()}}function h({imageMaterial:e,calloutMaterial:t}){const{focusMultiplier:i,calloutLength:a,discRadius:r}=o.rotateManipulatorDefaults,n=r*i,b=(e,t)=>{const i=[0,1,2,2,3,0];return new u.Geometry(t,[[g.VertexAttribute.POSITION,new s.Attribute([a-e,-e,0,a+e,-e,0,a+e,e,0,a-e,e,0],i,3,!0)],[g.VertexAttribute.UV0,new s.Attribute([0,0,1,0,1,1,0,1],i,2,!0)]])},p=d.createPolylineGeometry(t,[[0,0,0],[a-r,0,0]]),m=d.createPolylineGeometry(t,[[0,0,0],[a-n,0,0]]),y=l.DidPointerMoveRecentlyFlag;return{autoScaleRenderObjects:!1,collisionPriority:1,collisionType:{type:"disc",direction:[0,0,1],offset:[a,0,0]},focusMultiplier:i,radius:r,renderObjects:[new c.RenderObject(b(r,e),M.ManipulatorStateFlags.Unfocused|y),new c.RenderObject(p,M.ManipulatorStateFlags.Unfocused|y),new c.RenderObject(b(n,e),M.ManipulatorStateFlags.Focused|y),new c.RenderObject(m,M.ManipulatorStateFlags.Focused|y)],state:y}}e.RotateManipulator=y,Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})}));