// All material copyright Esri, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.33/esri/copyright.txt for details.
//>>built
define(["exports","../../../../chunks/vec32","../../../../core/libs/gl-matrix-2/factories/vec3f64","../../../../geometry/support/ray","../../../../chunks/sphere","./common","./InteractionType"],(function(t,e,n,r,i,o,c){"use strict";function a(t,e,n=o.defaultConstraintOptions){if(!t.state.isLocal)return 0;const r=t.state.constraints.distance;if(!t.pointsOfInterest.surfaceOrigin.renderLocation||r===1/0)return 0;u.min=0,u.max=r,function(t,e,n){const r=e.interactionType;if(r===c.InteractionType.NONE)return;const{min:i,max:u}=n,{interactionStartCamera:f,interactionFactor:d}=e;if(!f)return;const p=r===c.InteractionType.ZOOM||r===c.InteractionType.PAN,y=a(t,f),m=0===y?0:s(t,f);n.min=i,n.max=u;const l=.05*m;o.adjustRangeForInteraction(y,m,p,d,l,n)}(t,n,u);const i=s(t,e),f=u.max-i;return f>=-1e-6?0:f}function s(t,n){const r=t.pointsOfInterest.surfaceOrigin;return r.renderLocation?e.distance(n.eye,r.renderLocation):0}const u={min:0,max:0},f=n.create(),d=n.create(),p=n.create(),y=n.create(),m=n.create();t.applyDistanceConstraint=function(t,n,c=o.defaultConstraintOptions){const u=a(t,n,c);if(0===u)return!1;const l=t.pointsOfInterest.surfaceOrigin;if(!l.renderLocation)return!1;const O=s(t,n)+u,g=e.copy(f,n.eye),C=o.interactionDirectionTowardsConstraintMinimization(n,c.interactionDirection,function(t,n,r){return e.direction(r,t.eye,n)}(n,l.renderLocation,y),p);if(!i.intersectRay(i.fromCenterAndRadius(l.renderLocation,O),r.wrap(n.eye,C),m))return!1;n.eye=m;const I=e.subtract(d,n.eye,g);n.center=e.add(m,n.center,I);const x=t.renderCoordsHelper.getAltitude(n.center),L=t.renderCoordsHelper.intersectInfiniteManifold(n.ray,x,m);return null!=L&&(n.center=L),!0},t.getDistanceConstraintError=a,Object.defineProperty(t,Symbol.toStringTag,{value:"Module"})}));