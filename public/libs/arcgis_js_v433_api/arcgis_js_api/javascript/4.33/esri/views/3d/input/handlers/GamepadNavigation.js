// All material copyright Esri, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.33/esri/copyright.txt for details.
//>>built
define(["exports","../../../../core/Handles","../../../../core/reactiveUtils","../../state/controllers/CameraController","../../state/controllers/GamepadKeyboardController","../../../input/InputHandler"],(function(e,a,t,r,n,i){"use strict";class l extends i.InputHandler{constructor(e){super(!0),this._view=e,this._watchHandles=new a,this._handle=this.registerIncoming("gamepad",(e=>this._handleEventGamepad(e))),this._handle.pause()}onInstall(e){super.onInstall(e),this._watchHandles.add([t.watch((()=>this._view.navigation.gamepad.enabled),(e=>{e?this._handle.resume():(this._handle.pause(),this._cameraControllerGamepad&&(this._cameraControllerGamepad.finishController(),this._cameraControllerGamepad=null))}),t.initial),t.watch((()=>this._view.navigation.gamepad.device),(e=>{this._cameraControllerGamepad&&e&&this._cameraControllerGamepad.gamepadDevice!==e&&(this._cameraControllerGamepad.finishController(),this._cameraControllerGamepad=null)}))])}onUninstall(){this._watchHandles.removeAll(),super.onUninstall()}_handleEventGamepad(e){const a=this._view.navigation.gamepad.device;if(a&&e.data.device!==a)return;const t=this._cameraControllerGamepad?.running;if(t||n.GamepadKeyboardController.activatesFor(this._view,e.data)){if(!t){const a=new n.GamepadKeyboardController({view:this._view,gamepadDevice:e.data.device});this._view.state.switchCameraController(a),a.state!==r.State.Rejected&&(this._cameraControllerGamepad=a)}this._cameraControllerGamepad&&this._cameraControllerGamepad.running&&this._cameraControllerGamepad.gamepadDevice===e.data.device&&this._cameraControllerGamepad.handleEventGamepad(e.data)}}}e.GamepadNavigation=l,Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})}));