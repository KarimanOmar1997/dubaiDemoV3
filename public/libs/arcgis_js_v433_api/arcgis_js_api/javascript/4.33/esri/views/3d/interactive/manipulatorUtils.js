// All material copyright Esri, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.33/esri/copyright.txt for details.
//>>built
define(["exports","../../../core/colorUtils","../../../core/libs/gl-matrix-2/math/mat4","../../../chunks/vec32","../../../geometry/support/vectorStacks","../../../layers/graphics/hydratedFeatures","./editingTools/manipulatedObjectUtils","../layers/graphics/graphicUtils","../webgl-engine/lib/basicInterfaces","../webgl-engine/lib/Material","../webgl-engine/materials/ColorMaterial","../webgl-engine/materials/ShadedColorMaterial"],(function(e,t,r,a,n,o,c,l,i,s,u,d){"use strict";const g=Object.freeze({calloutLength:40,calloutWidth:1,discRadius:27,focusMultiplier:1.1}),p=Object.freeze({autoScaleRenderObjects:!1,worldSized:!0});function m(e,t,r,o){const c=a.normalize(n.sv3d.get(),e),l=a.normalize(n.sv3d.get(),t),i=a.cross(n.sv3d.get(),c,l);return o[0]=c[0],o[1]=c[1],o[2]=c[2],o[3]=0,o[4]=l[0],o[5]=l[1],o[6]=l[2],o[7]=0,o[8]=i[0],o[9]=i[1],o[10]=i[2],o[11]=0,o[12]=r[0],o[13]=r[1],o[14]=r[2],o[15]=1,o}e.calculateInputRotationTransform=function(e,t,o,c){const l=a.subtract(n.sv3d.get(),e,o),i=m(l,a.cross(n.sv3d.get(),c,l),o,n.sm4d.get());r.invert(i,i);const s=a.transformMat4(n.sv3d.get(),t,i);return Math.atan2(s[1],s[0])},e.calculateTranslateRotateFromBases=m,e.createManipulatorMaterial=function(e,r=s.RenderOccludedFlag.OccludeAndTransparent,a=!0){const n=t.colorVectorToColorAndOpacity(e),o=!(e[3]<1);return a?new d.ShadedColorMaterial({color:n,writeDepth:o,cullFace:i.CullFaceOptions.Back,renderOccluded:r,isDecoration:!0}):new u.ColorMaterial({color:n,writeDepth:o,cullFace:i.CullFaceOptions.Back,renderOccluded:r,isDecoration:!0})},e.createManipulatorOutlineMaterial=function(e,r=s.RenderOccludedFlag.OccludeAndTransparent){const a=t.colorVectorToColorAndOpacity(e);return new u.ColorMaterial({color:a,writeDepth:!0,cullFace:i.CullFaceOptions.Front,renderOccluded:r,isDecoration:!0})},e.getGraphicAttachmentOrigin=function(e,t){const r=e.getViewForGraphic(t);return null!=r&&"computeAttachmentOrigin"in r?r.computeAttachmentOrigin(t,e.spatialReference):null},e.placeAtObject=function(e,t){const r=t.origin;null==r?function(e,t){if(null==t)return;const r="mesh"===t.type?t.origin:l.computeCentroid(t);null!=r&&(e.location=o.hydrateGeometry(r))}(e,c.manipulatedObjectGeometry(t)):e.elevationAlignedLocation=r},e.rotateManipulatorDefaults=g,e.worldScaledManipulatorSettings=p,Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})}));