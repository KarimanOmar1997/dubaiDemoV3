// All material copyright Esri, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.33/esri/copyright.txt for details.
//>>built
require({cache:{"esri/core/libs/gl-matrix-2/math/quat":function(){define(["exports","../factories/mat3f64","../factories/quatf64","../factories/vec3f64","./common","../../../../chunks/vec32","../../../../chunks/vec42"],(function(t,e,r,o,n,a,i){"use strict";function s(t){return t[0]=0,t[1]=0,t[2]=0,t[3]=1,t}function c(t,e,r){r*=.5;const o=Math.sin(r);return t[0]=o*e[0],t[1]=o*e[1],t[2]=o*e[2],t[3]=Math.cos(r),t}function u(t,e){const r=2*Math.acos(e[3]),o=Math.sin(r/2);return o>n.getEpsilon()?(t[0]=e[0]/o,t[1]=e[1]/o,t[2]=e[2]/o):(t[0]=1,t[1]=0,t[2]=0),r}function l(t,e,r){const o=e[0],n=e[1],a=e[2],i=e[3],s=r[0],c=r[1],u=r[2],l=r[3];return t[0]=o*l+i*s+n*u-a*c,t[1]=n*l+i*c+a*s-o*u,t[2]=a*l+i*u+o*c-n*s,t[3]=i*l-o*s-n*c-a*u,t}function f(t,e,r){r*=.5;const o=e[0],n=e[1],a=e[2],i=e[3],s=Math.sin(r),c=Math.cos(r);return t[0]=o*c+i*s,t[1]=n*c+a*s,t[2]=a*c-n*s,t[3]=i*c-o*s,t}function d(t,e,r){r*=.5;const o=e[0],n=e[1],a=e[2],i=e[3],s=Math.sin(r),c=Math.cos(r);return t[0]=o*c-a*s,t[1]=n*c+i*s,t[2]=a*c+o*s,t[3]=i*c-n*s,t}function p(t,e,r){r*=.5;const o=e[0],n=e[1],a=e[2],i=e[3],s=Math.sin(r),c=Math.cos(r);return t[0]=o*c+n*s,t[1]=n*c-o*s,t[2]=a*c+i*s,t[3]=i*c-a*s,t}function h(t,e){const r=e[0],o=e[1],n=e[2];return t[0]=r,t[1]=o,t[2]=n,t[3]=Math.sqrt(Math.abs(1-r*r-o*o-n*n)),t}function m(t,e,r,o){const a=e[0],i=e[1],s=e[2],c=e[3];let u,l,f,d,p,h=r[0],m=r[1],b=r[2],g=r[3];return l=a*h+i*m+s*b+c*g,l<0&&(l=-l,h=-h,m=-m,b=-b,g=-g),1-l>n.getEpsilon()?(u=Math.acos(l),f=Math.sin(u),d=Math.sin((1-o)*u)/f,p=Math.sin(o*u)/f):(d=1-o,p=o),t[0]=d*a+p*h,t[1]=d*i+p*m,t[2]=d*s+p*b,t[3]=d*c+p*g,t}function b(t){const e=n.RANDOM,r=e(),o=e(),a=e(),i=Math.sqrt(1-r),s=Math.sqrt(r);return t[0]=i*Math.sin(2*Math.PI*o),t[1]=i*Math.cos(2*Math.PI*o),t[2]=s*Math.sin(2*Math.PI*a),t[3]=s*Math.cos(2*Math.PI*a),t}function g(t,e){const r=e[0],o=e[1],n=e[2],a=e[3],i=r*r+o*o+n*n+a*a,s=i?1/i:0;return t[0]=-r*s,t[1]=-o*s,t[2]=-n*s,t[3]=a*s,t}function y(t,e){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t[3]=e[3],t}function M(t,e){const r=e[0]+e[4]+e[8];let o;if(r>0)o=Math.sqrt(r+1),t[3]=.5*o,o=.5/o,t[0]=(e[5]-e[7])*o,t[1]=(e[6]-e[2])*o,t[2]=(e[1]-e[3])*o;else{let r=0;e[4]>e[0]&&(r=1),e[8]>e[3*r+r]&&(r=2);const n=(r+1)%3,a=(r+2)%3;o=Math.sqrt(e[3*r+r]-e[3*n+n]-e[3*a+a]+1),t[r]=.5*o,o=.5/o,t[3]=(e[3*n+a]-e[3*a+n])*o,t[n]=(e[3*n+r]+e[3*r+n])*o,t[a]=(e[3*a+r]+e[3*r+a])*o}return t}function S(t,e,r,o){const n=.5*Math.PI/180;e*=n,r*=n,o*=n;const a=Math.sin(e),i=Math.cos(e),s=Math.sin(r),c=Math.cos(r),u=Math.sin(o),l=Math.cos(o);return t[0]=a*c*l-i*s*u,t[1]=i*s*l+a*c*u,t[2]=i*c*u-a*s*l,t[3]=i*c*l+a*s*u,t}function I(t){return"quat("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+")"}const T=i.copy,_=i.set,v=i.add,A=l,w=i.scale,P=i.dot,x=i.lerp,C=i.length,O=C,E=i.squaredLength,R=E,N=i.normalize,j=i.exactEquals,U=i.equals;function V(t,e,r){const o=a.dot(e,r);return o<-.999999?(a.cross(F,q,e),a.len(F)<1e-6&&a.cross(F,D,e),a.normalize(F,F),c(t,F,Math.PI),t):o>.999999?(t[0]=0,t[1]=0,t[2]=0,t[3]=1,t):(a.cross(F,e,r),t[0]=F[0],t[1]=F[1],t[2]=F[2],t[3]=1+o,N(t,t))}const F=o.create(),q=o.fromValues(1,0,0),D=o.fromValues(0,1,0);function L(t,e,r,o,n,a){return m(z,e,n,a),m(k,r,o,a),m(t,z,k,2*a*(1-a)),t}const z=r.create(),k=r.create();function B(t,e,r,o){const n=G;return n[0]=r[0],n[3]=r[1],n[6]=r[2],n[1]=o[0],n[4]=o[1],n[7]=o[2],n[2]=-e[0],n[5]=-e[1],n[8]=-e[2],N(t,M(t,n))}const G=e.create(),Y=Object.freeze(Object.defineProperty({__proto__:null,add:v,calculateW:h,conjugate:y,copy:T,dot:P,equals:U,exactEquals:j,fromEuler:S,fromMat3:M,getAxisAngle:u,identity:s,invert:g,len:O,length:C,lerp:x,mul:A,multiply:l,normalize:N,random:b,rotateX:f,rotateY:d,rotateZ:p,rotationTo:V,scale:w,set:_,setAxes:B,setAxisAngle:c,slerp:m,sqlerp:L,sqrLen:R,squaredLength:E,str:I},Symbol.toStringTag,{value:"Module"}));t.add=v,t.calculateW=h,t.conjugate=y,t.copy=T,t.dot=P,t.equals=U,t.exactEquals=j,t.fromEuler=S,t.fromMat3=M,t.getAxisAngle=u,t.identity=s,t.invert=g,t.len=O,t.length=C,t.lerp=x,t.mul=A,t.multiply=l,t.normalize=N,t.quat=Y,t.random=b,t.rotateX=f,t.rotateY=d,t.rotateZ=p,t.rotationTo=V,t.scale=w,t.set=_,t.setAxes=B,t.setAxisAngle=c,t.slerp=m,t.sqlerp=L,t.sqrLen=R,t.squaredLength=E,t.str=I,Object.defineProperty(t,Symbol.toStringTag,{value:"Module"})}))},"esri/core/libs/gl-matrix-2/factories/mat3f64":function(){define(["exports"],(function(t){"use strict";function e(){return[1,0,0,0,1,0,0,0,1]}function r(t){return[t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7],t[8]]}function o(t,e,r,o,n,a,i,s,c){return[t,e,r,o,n,a,i,s,c]}const n=[1,0,0,0,1,0,0,0,1],a=Object.freeze(Object.defineProperty({__proto__:null,IDENTITY:n,clone:r,create:e,fromValues:o},Symbol.toStringTag,{value:"Module"}));t.IDENTITY=n,t.clone=r,t.create=e,t.fromValues=o,t.mat3f64=a,Object.defineProperty(t,Symbol.toStringTag,{value:"Module"})}))},"esri/core/libs/gl-matrix-2/factories/quatf64":function(){define(["exports"],(function(t){"use strict";function e(){return[0,0,0,1]}function r(t){return[t[0],t[1],t[2],t[3]]}function o(t,e,r,o){return[t,e,r,o]}const n=[0,0,0,1],a=Object.freeze(Object.defineProperty({__proto__:null,IDENTITY:n,clone:r,create:e,fromValues:o},Symbol.toStringTag,{value:"Module"}));t.IDENTITY=n,t.clone=r,t.create=e,t.fromValues=o,t.quatf64=a,Object.defineProperty(t,Symbol.toStringTag,{value:"Module"})}))},"esri/chunks/vec32":function(){define(["exports","../core/libs/gl-matrix-2/factories/vec3f64","../core/libs/gl-matrix-2/math/common"],(function(t,e,r){"use strict";function o(t){const e=t[0],r=t[1],o=t[2];return Math.sqrt(e*e+r*r+o*o)}function n(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t}function a(t,e,r,o){return t[0]=e,t[1]=r,t[2]=o,t}function i(t,e,r){return t[0]=e[0]+r[0],t[1]=e[1]+r[1],t[2]=e[2]+r[2],t}function s(t,e,r){return t[0]=e[0]-r[0],t[1]=e[1]-r[1],t[2]=e[2]-r[2],t}function c(t,e,r){return t[0]=e[0]*r[0],t[1]=e[1]*r[1],t[2]=e[2]*r[2],t}function u(t,e,r){return t[0]=e[0]/r[0],t[1]=e[1]/r[1],t[2]=e[2]/r[2],t}function l(t,e){return t[0]=Math.ceil(e[0]),t[1]=Math.ceil(e[1]),t[2]=Math.ceil(e[2]),t}function f(t,e){return t[0]=Math.floor(e[0]),t[1]=Math.floor(e[1]),t[2]=Math.floor(e[2]),t}function d(t,e){return t[0]=Math.abs(e[0]),t[1]=Math.abs(e[1]),t[2]=Math.abs(e[2]),t}function p(t,e){return t[0]=Math.sign(e[0]),t[1]=Math.sign(e[1]),t[2]=Math.sign(e[2]),t}function h(t,e,r){return t[0]=Math.min(e[0],r[0]),t[1]=Math.min(e[1],r[1]),t[2]=Math.min(e[2],r[2]),t}function m(t,e,r){return t[0]=Math.max(e[0],r[0]),t[1]=Math.max(e[1],r[1]),t[2]=Math.max(e[2],r[2]),t}function b(t,e=0,r=1){return t[0]=Math.min(Math.max(t[0],e),r),t[1]=Math.min(Math.max(t[1],e),r),t[2]=Math.min(Math.max(t[2],e),r),t}function g(t,e){return t[0]=Math.round(e[0]),t[1]=Math.round(e[1]),t[2]=Math.round(e[2]),t}function y(t,e,r){return t[0]=e[0]*r,t[1]=e[1]*r,t[2]=e[2]*r,t}function M(t,e,r,o){return t[0]=e[0]+r[0]*o,t[1]=e[1]+r[1]*o,t[2]=e[2]+r[2]*o,t}function S(t,e){const r=e[0]-t[0],o=e[1]-t[1],n=e[2]-t[2];return Math.sqrt(r*r+o*o+n*n)}function I(t,e){const r=e[0]-t[0],o=e[1]-t[1],n=e[2]-t[2];return r*r+o*o+n*n}function T(t){const e=t[0],r=t[1],o=t[2];return e*e+r*r+o*o}function _(t,e){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t}function v(t,e){return t[0]=1/e[0],t[1]=1/e[1],t[2]=1/e[2],t}function A(t,e){const r=e[0],o=e[1],n=e[2];let a=r*r+o*o+n*n;return a>0&&(a=1/Math.sqrt(a),t[0]=e[0]*a,t[1]=e[1]*a,t[2]=e[2]*a),t}function w(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]}function P(t,e,r){const o=e[0],n=e[1],a=e[2],i=r[0],s=r[1],c=r[2];return t[0]=n*c-a*s,t[1]=a*i-o*c,t[2]=o*s-n*i,t}function x(t,e,r){const o=e[0],n=e[1],a=e[2],i=r[0],s=r[1],c=r[2],u=n*c-a*s,l=a*i-o*c,f=o*s-n*i,d=Math.sqrt(u*u+l*l+f*f);return t[0]=u/d,t[1]=l/d,t[2]=f/d,t}function C(t,e,r,o){const n=e[0],a=e[1],i=e[2];return t[0]=n+o*(r[0]-n),t[1]=a+o*(r[1]-a),t[2]=i+o*(r[2]-i),t}function O(t,e,r,o,n,a){const i=a*a,s=i*(2*a-3)+1,c=i*(a-2)+a,u=i*(a-1),l=i*(3-2*a);return t[0]=e[0]*s+r[0]*c+o[0]*u+n[0]*l,t[1]=e[1]*s+r[1]*c+o[1]*u+n[1]*l,t[2]=e[2]*s+r[2]*c+o[2]*u+n[2]*l,t}function E(t,e,r,o,n,a){const i=1-a,s=i*i,c=a*a,u=s*i,l=3*a*s,f=3*c*i,d=c*a;return t[0]=e[0]*u+r[0]*l+o[0]*f+n[0]*d,t[1]=e[1]*u+r[1]*l+o[1]*f+n[1]*d,t[2]=e[2]*u+r[2]*l+o[2]*f+n[2]*d,t}function R(t,e=1){const o=r.RANDOM,n=2*o()*Math.PI,a=2*o()-1,i=Math.sqrt(1-a*a)*e;return t[0]=Math.cos(n)*i,t[1]=Math.sin(n)*i,t[2]=a*e,t}function N(t,e,r){const o=e[0],n=e[1],a=e[2];return t[0]=r[0]*o+r[4]*n+r[8]*a+r[12],t[1]=r[1]*o+r[5]*n+r[9]*a+r[13],t[2]=r[2]*o+r[6]*n+r[10]*a+r[14],t}function j(t,e,r){const o=e[0],n=e[1],a=e[2];return t[0]=o*r[0]+n*r[3]+a*r[6],t[1]=o*r[1]+n*r[4]+a*r[7],t[2]=o*r[2]+n*r[5]+a*r[8],t}function U(t,e,r){const o=r[0],n=r[1],a=r[2],i=r[3],s=e[0],c=e[1],u=e[2],l=n*u-a*c,f=a*s-o*u,d=o*c-n*s,p=n*d-a*f,h=a*l-o*d,m=o*f-n*l,b=2*i;return t[0]=s+l*b+2*p,t[1]=c+f*b+2*h,t[2]=u+d*b+2*m,t}function V(t,e,r,o){const n=[],a=[];return n[0]=e[0]-r[0],n[1]=e[1]-r[1],n[2]=e[2]-r[2],a[0]=n[0],a[1]=n[1]*Math.cos(o)-n[2]*Math.sin(o),a[2]=n[1]*Math.sin(o)+n[2]*Math.cos(o),t[0]=a[0]+r[0],t[1]=a[1]+r[1],t[2]=a[2]+r[2],t}function F(t,e,r,o){const n=[],a=[];return n[0]=e[0]-r[0],n[1]=e[1]-r[1],n[2]=e[2]-r[2],a[0]=n[2]*Math.sin(o)+n[0]*Math.cos(o),a[1]=n[1],a[2]=n[2]*Math.cos(o)-n[0]*Math.sin(o),t[0]=a[0]+r[0],t[1]=a[1]+r[1],t[2]=a[2]+r[2],t}function q(t,e,r,o){const n=[],a=[];return n[0]=e[0]-r[0],n[1]=e[1]-r[1],n[2]=e[2]-r[2],a[0]=n[0]*Math.cos(o)-n[1]*Math.sin(o),a[1]=n[0]*Math.sin(o)+n[1]*Math.cos(o),a[2]=n[2],t[0]=a[0]+r[0],t[1]=a[1]+r[1],t[2]=a[2]+r[2],t}function D(t,e){A(L,t),A(z,e);const r=w(L,z);return r>1?0:r<-1?Math.PI:Math.acos(r)}const L=e.create(),z=e.create();function k(t){return"vec3("+t[0]+", "+t[1]+", "+t[2]+")"}function B(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]}function G(t,e){if(t===e)return!0;const o=t[0],n=t[1],a=t[2],i=e[0],s=e[1],c=e[2],u=r.getEpsilon();return Math.abs(o-i)<=u*Math.max(1,Math.abs(o),Math.abs(i))&&Math.abs(n-s)<=u*Math.max(1,Math.abs(n),Math.abs(s))&&Math.abs(a-c)<=u*Math.max(1,Math.abs(a),Math.abs(c))}function Y(t,e,r){const o=r[0]-e[0],n=r[1]-e[1],a=r[2]-e[2];let i=o*o+n*n+a*a;return i>0?(i=1/Math.sqrt(i),t[0]=o*i,t[1]=n*i,t[2]=a*i,t):(t[0]=0,t[1]=0,t[2]=0,t)}const X=s,Q=c,Z=u,W=S,H=I,K=o,J=T,$=Object.freeze(Object.defineProperty({__proto__:null,abs:d,add:i,angle:D,bezier:E,ceil:l,clamp:b,copy:n,cross:P,crossAndNormalize:x,direction:Y,dist:W,distance:S,div:Z,divide:u,dot:w,equals:G,exactEquals:B,floor:f,hermite:O,inverse:v,len:K,length:o,lerp:C,max:m,min:h,mul:Q,multiply:c,negate:_,normalize:A,random:R,rotateX:V,rotateY:F,rotateZ:q,round:g,scale:y,scaleAndAdd:M,set:a,sign:p,sqrDist:H,sqrLen:J,squaredDistance:I,squaredLength:T,str:k,sub:X,subtract:s,transformMat3:j,transformMat4:N,transformQuat:U},Symbol.toStringTag,{value:"Module"}));t.abs=d,t.add=i,t.angle=D,t.bezier=E,t.ceil=l,t.clamp=b,t.copy=n,t.cross=P,t.crossAndNormalize=x,t.direction=Y,t.dist=W,t.distance=S,t.div=Z,t.divide=u,t.dot=w,t.equals=G,t.exactEquals=B,t.floor=f,t.hermite=O,t.inverse=v,t.len=K,t.length=o,t.lerp=C,t.max=m,t.min=h,t.mul=Q,t.multiply=c,t.negate=_,t.normalize=A,t.random=R,t.rotateX=V,t.rotateY=F,t.rotateZ=q,t.round=g,t.scale=y,t.scaleAndAdd=M,t.set=a,t.sign=p,t.sqrDist=H,t.sqrLen=J,t.squaredDistance=I,t.squaredLength=T,t.str=k,t.sub=X,t.subtract=s,t.transformMat3=j,t.transformMat4=N,t.transformQuat=U,t.vec3=$}))},"esri/core/libs/gl-matrix-2/factories/vec3f32":function(){define(["exports"],(function(t){"use strict";function e(){return new Float32Array(3)}function r(t){const e=new Float32Array(3);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e}function o(t,e,r){const o=new Float32Array(3);return o[0]=t,o[1]=e,o[2]=r,o}function n(){return e()}function a(){return o(1,1,1)}function i(){return o(1,0,0)}function s(){return o(0,1,0)}function c(){return o(0,0,1)}const u=n(),l=a(),f=i(),d=s(),p=c(),h=Object.freeze(Object.defineProperty({__proto__:null,ONES:l,UNIT_X:f,UNIT_Y:d,UNIT_Z:p,ZEROS:u,clone:r,create:e,fromValues:o,ones:a,unitX:i,unitY:s,unitZ:c,zeros:n},Symbol.toStringTag,{value:"Module"}));t.ONES=l,t.UNIT_X=f,t.UNIT_Y=d,t.UNIT_Z=p,t.ZEROS=u,t.clone=r,t.create=e,t.fromValues=o,t.ones=a,t.unitX=i,t.unitY=s,t.unitZ=c,t.vec3f32=h,t.zeros=n,Object.defineProperty(t,Symbol.toStringTag,{value:"Module"})}))},"esri/views/3d/layers/i3s/PointCloudWorkerUtil":function(){define(["exports","../../../../core/has","../../../../renderers/PointCloudClassBreaksRenderer","../../../../renderers/PointCloudStretchRenderer","../../../../renderers/PointCloudUniqueValueRenderer","./I3SBinaryReader","./LEPCC"],(function(t,e,r,o,n,a,i){"use strict";function s(t,e){const r=new Float64Array(e);for(let o=0;o<e;o++)r[o]=t[3*o+2];return r}function c(t){switch(t){default:case null:case"none":return t=>t;case"low-four-bit":return t=>15&t;case"high-four-bit":return t=>(240&t)>>4;case"absolute-value":return t=>Math.abs(t);case"modulo-ten":return t=>t%10}}function u(t){let e=0;for(const r of t||[])e|=1<<r;return e}t.elevationFromPositions=s,t.evaluateRenderer=function(t,e,a,i){const{rendererJSON:s,isRGBRenderer:u}=t;let l=null,f=null;if(e&&u)l=e;else if(e&&"pointCloudUniqueValueRenderer"===s?.type){f=n.fromJSON(s);const t=f.colorUniqueValueInfos;l=new Uint8Array(3*i);const r=c(f.fieldTransformType);for(let o=0;o<i;o++){const n=(r?r(e[o]):e[o])+"";for(let e=0;e<t.length;e++)if(t[e].values.includes(n)){l[3*o]=t[e].color.r,l[3*o+1]=t[e].color.g,l[3*o+2]=t[e].color.b;break}}}else if(e&&"pointCloudStretchRenderer"===s?.type){f=o.fromJSON(s);const t=f.stops;l=new Uint8Array(3*i);const r=c(f.fieldTransformType);for(let o=0;o<i;o++){const n=r?r(e[o]):e[o],a=t.length-1;if(n<t[0].value)l[3*o]=t[0].color.r,l[3*o+1]=t[0].color.g,l[3*o+2]=t[0].color.b;else if(n>=t[a].value)l[3*o]=t[a].color.r,l[3*o+1]=t[a].color.g,l[3*o+2]=t[a].color.b;else for(let e=1;e<t.length;e++)if(n<t[e].value){const r=(n-t[e-1].value)/(t[e].value-t[e-1].value);l[3*o]=t[e].color.r*r+t[e-1].color.r*(1-r),l[3*o+1]=t[e].color.g*r+t[e-1].color.g*(1-r),l[3*o+2]=t[e].color.b*r+t[e-1].color.b*(1-r);break}}}else if(e&&"pointCloudClassBreaksRenderer"===s?.type){f=r.fromJSON(s);const t=f.colorClassBreakInfos;l=new Uint8Array(3*i);const o=c(f.fieldTransformType);for(let r=0;r<i;r++){const n=o?o(e[r]):e[r];for(let e=0;e<t.length;e++)if(n>=t[e].minValue&&n<=t[e].maxValue){l[3*r]=t[e].color.r,l[3*r+1]=t[e].color.g,l[3*r+2]=t[e].color.b;break}}}else l=new Uint8Array(3*i).fill(255);if(a&&f?.colorModulation){const t=f.colorModulation.minValue,e=f.colorModulation.maxValue,r=.3;for(let o=0;o<i;o++){const n=a[o],i=n>=e?1:n<=t?r:r+(1-r)*(n-t)/(e-t);l[3*o]=i*l[3*o],l[3*o+1]=i*l[3*o+1],l[3*o+2]=i*l[3*o+2]}}return l},t.filterInPlace=function(t,e,r,o,n){const a=t.length/3;let i=0;for(let s=0;s<a;s++){let a=!0;for(let t=0;t<o.length&&a;t++){const{filterJSON:e}=o[t],r=n[t].values[s];switch(e.type){case"pointCloudValueFilter":{const t="exclude"===e.mode;e.values.includes(r)===t&&(a=!1);break}case"pointCloudBitfieldFilter":{const t=u(e.requiredSetBits),o=u(e.requiredClearBits);(r&t)===t&&0===(r&o)||(a=!1);break}case"pointCloudReturnFilter":{const t=15&r,o=r>>>4&15,n=o>1,i=1===t,s=t===o;let c=!1;for(const t of e.includedReturns)if("last"===t&&s||"firstOfMany"===t&&i&&n||"lastOfMany"===t&&s&&n||"single"===t&&!n){c=!0;break}c||(a=!1);break}}}a&&(r[i]=s,t[3*i]=t[3*s],t[3*i+1]=t[3*s+1],t[3*i+2]=t[3*s+2],e[3*i]=e[3*s],e[3*i+1]=e[3*s+1],e[3*i+2]=e[3*s+2],i++)}return i},t.getAttributeValues=function(t,e,r){return t?.attributeInfo.useElevation?e?s(e,r):null:t?.attributeInfo.storageInfo?a.readBinaryAttribute(t.attributeInfo.storageInfo,t.buffer,r,!0):null},t.readGeometry=function(t,e){if(null==t.encoding||""===t.encoding){const r=a.createGeometryIndexFromSchema(e,t);if(null==r.vertexAttributes.position)return;const o=a.createTypedView(e,r.vertexAttributes.position),n=r.header.fields,i=[n.offsetX,n.offsetY,n.offsetZ],s=[n.scaleX,n.scaleY,n.scaleZ],c=o.length/3,u=new Float64Array(3*c);for(let t=0;t<c;t++)u[3*t]=o[3*t]*s[0]+i[0],u[3*t+1]=o[3*t+1]*s[1]+i[1],u[3*t+2]=o[3*t+2]*s[2]+i[2];return u}if("lepcc-xyz"===t.encoding)return i.decodeXYZ(e).result},Object.defineProperty(t,Symbol.toStringTag,{value:"Module"})}))},"esri/renderers/PointCloudClassBreaksRenderer":function(){define(["exports","../chunks/tslib.es6","../core/lang","../core/accessorSupport/decorators/property","../core/has","../core/Logger","../core/accessorSupport/decorators/enumeration","../core/accessorSupport/decorators/subclass","./PointCloudRenderer","./support/RendererLegendOptions","./support/pointCloud/ColorClassBreakInfo"],(function(t,e,r,o,n,a,i,s,c,u,l){"use strict";var f;return t.default=f=class extends c{constructor(t){super(t),this.type="point-cloud-class-breaks",this.field=null,this.legendOptions=null,this.fieldTransformType=null,this.colorClassBreakInfos=null}clone(){return new f({...this.cloneProperties(),field:this.field,fieldTransformType:this.fieldTransformType,colorClassBreakInfos:r.clone(this.colorClassBreakInfos),legendOptions:r.clone(this.legendOptions)})}},e.__decorate([i.enumeration({pointCloudClassBreaksRenderer:"point-cloud-class-breaks"})],t.default.prototype,"type",void 0),e.__decorate([o.property({json:{write:{isRequired:!0}},type:String})],t.default.prototype,"field",void 0),e.__decorate([o.property({type:u,json:{write:!0}})],t.default.prototype,"legendOptions",void 0),e.__decorate([o.property({type:c.fieldTransformTypeKebabDict.apiValues,json:{type:c.fieldTransformTypeKebabDict.jsonValues,read:c.fieldTransformTypeKebabDict.read,write:c.fieldTransformTypeKebabDict.write}})],t.default.prototype,"fieldTransformType",void 0),e.__decorate([o.property({type:[l],json:{write:{isRequired:!0}}})],t.default.prototype,"colorClassBreakInfos",void 0),t.default=f=e.__decorate([s.subclass("esri.renderers.PointCloudClassBreaksRenderer")],t.default),t.default}))},"esri/renderers/PointCloudRenderer":function(){define(["exports","../chunks/tslib.es6","../core/jsonMap","../core/JSONSupport","../core/lang","../core/accessorSupport/decorators/property","../core/has","../core/Logger","../core/accessorSupport/decorators/subclass","./support/pointCloud/ColorModulation","./support/pointCloud/pointSizeAlgorithmTypeUtils"],(function(t,e,r,o,n,a,i,s,c,u,l){"use strict";const f=r.strict()({pointCloudClassBreaksRenderer:"point-cloud-class-breaks",pointCloudRGBRenderer:"point-cloud-rgb",pointCloudStretchRenderer:"point-cloud-stretch",pointCloudUniqueValueRenderer:"point-cloud-unique-value"});return t.default=class extends o{constructor(t){super(t),this.type=void 0,this.pointSizeAlgorithm=null,this.colorModulation=null,this.pointsPerInch=10}clone(){return console.warn(".clone() is not implemented for "+this.declaredClass),null}cloneProperties(){return{pointSizeAlgorithm:n.clone(this.pointSizeAlgorithm),colorModulation:n.clone(this.colorModulation),pointsPerInch:n.clone(this.pointsPerInch)}}},e.__decorate([a.property({type:f.apiValues,readOnly:!0,nonNullable:!0,json:{type:f.jsonValues,read:!1,write:{writer:f.write,isRequired:!0}}})],t.default.prototype,"type",void 0),e.__decorate([a.property({types:l.pointSizeAlgorithmTypes,json:{write:!0}})],t.default.prototype,"pointSizeAlgorithm",void 0),e.__decorate([a.property({type:u,json:{write:!0}})],t.default.prototype,"colorModulation",void 0),e.__decorate([a.property({json:{write:!0},nonNullable:!0,type:Number})],t.default.prototype,"pointsPerInch",void 0),t.default=e.__decorate([c.subclass("esri.renderers.PointCloudRenderer")],t.default),(t.default||(t.default={})).fieldTransformTypeKebabDict=new r.JSONMap({none:"none",lowFourBit:"low-four-bit",highFourBit:"high-four-bit",absoluteValue:"absolute-value",moduloTen:"modulo-ten"}),t.default}))},"esri/renderers/support/pointCloud/ColorModulation":function(){define(["../../../chunks/tslib.es6","../../../core/JSONSupport","../../../core/accessorSupport/decorators/property","../../../core/has","../../../core/Logger","../../../core/RandomLCG","../../../core/accessorSupport/decorators/subclass"],(function(t,e,r,o,n,a,i){"use strict";var s;let c=s=class extends e{constructor(){super(...arguments),this.field=null,this.minValue=0,this.maxValue=255}clone(){return new s({field:this.field,minValue:this.minValue,maxValue:this.maxValue})}};return t.__decorate([r.property({type:String,json:{write:{isRequired:!0}}})],c.prototype,"field",void 0),t.__decorate([r.property({type:Number,nonNullable:!0,json:{write:{isRequired:!0}}})],c.prototype,"minValue",void 0),t.__decorate([r.property({type:Number,nonNullable:!0,json:{write:{isRequired:!0}}})],c.prototype,"maxValue",void 0),c=s=t.__decorate([i.subclass("esri.renderers.support.pointCloud.ColorModulation")],c),c}))},"esri/renderers/support/pointCloud/pointSizeAlgorithmTypeUtils":function(){define(["exports","./PointSizeAlgorithm","./PointSizeFixedSizeAlgorithm","./PointSizeSplatAlgorithm"],(function(t,e,r,o){"use strict";const n={key:"type",base:e,typeMap:{"fixed-size":r,splat:o}};t.pointSizeAlgorithmTypes=n,Object.defineProperty(t,Symbol.toStringTag,{value:"Module"})}))},"esri/renderers/support/pointCloud/PointSizeAlgorithm":function(){define(["../../../chunks/tslib.es6","../../../core/jsonMap","../../../core/JSONSupport","../../../core/accessorSupport/decorators/property","../../../core/has","../../../core/Logger","../../../core/RandomLCG","../../../core/accessorSupport/decorators/subclass"],(function(t,e,r,o,n,a,i,s){"use strict";const c=new e.JSONMap({pointCloudFixedSizeAlgorithm:"fixed-size",pointCloudSplatAlgorithm:"splat"});let u=class extends r{};return t.__decorate([o.property({type:c.apiValues,readOnly:!0,nonNullable:!0,json:{type:c.jsonValues,read:!1,write:{writer:c.write,isRequired:!0}}})],u.prototype,"type",void 0),u=t.__decorate([s.subclass("esri.renderers.support.pointCloud.PointSizeAlgorithm")],u),u}))},"esri/renderers/support/pointCloud/PointSizeFixedSizeAlgorithm":function(){define(["../../../chunks/tslib.es6","../../../core/accessorSupport/decorators/property","../../../core/has","../../../core/Logger","../../../core/RandomLCG","../../../core/accessorSupport/decorators/enumeration","../../../core/accessorSupport/decorators/subclass","./PointSizeAlgorithm"],(function(t,e,r,o,n,a,i,s){"use strict";var c;let u=c=class extends s{constructor(){super(...arguments),this.type="fixed-size",this.size=0,this.useRealWorldSymbolSizes=null}clone(){return new c({size:this.size,useRealWorldSymbolSizes:this.useRealWorldSymbolSizes})}};return t.__decorate([a.enumeration({pointCloudFixedSizeAlgorithm:"fixed-size"})],u.prototype,"type",void 0),t.__decorate([e.property({type:Number,nonNullable:!0,json:{write:{isRequired:!0}}})],u.prototype,"size",void 0),t.__decorate([e.property({type:Boolean,json:{write:!0}})],u.prototype,"useRealWorldSymbolSizes",void 0),u=c=t.__decorate([i.subclass("esri.renderers.support.pointCloud.PointSizeFixedSizeAlgorithm")],u),u}))},"esri/renderers/support/pointCloud/PointSizeSplatAlgorithm":function(){define(["../../../chunks/tslib.es6","../../../core/accessorSupport/decorators/property","../../../core/has","../../../core/Logger","../../../core/RandomLCG","../../../core/accessorSupport/decorators/enumeration","../../../core/accessorSupport/decorators/subclass","./PointSizeAlgorithm"],(function(t,e,r,o,n,a,i,s){"use strict";var c;let u=c=class extends s{constructor(){super(...arguments),this.type="splat",this.scaleFactor=1}clone(){return new c({scaleFactor:this.scaleFactor})}};return t.__decorate([a.enumeration({pointCloudSplatAlgorithm:"splat"})],u.prototype,"type",void 0),t.__decorate([e.property({type:Number,value:1,nonNullable:!0,json:{write:{isRequired:!0}}})],u.prototype,"scaleFactor",void 0),u=c=t.__decorate([i.subclass("esri.renderers.support.pointCloud.PointSizeSplatAlgorithm")],u),u}))},"esri/renderers/support/RendererLegendOptions":function(){define(["../../chunks/tslib.es6","../../core/Clonable","../../core/jsonMap","../../core/JSONSupport","../../core/accessorSupport/decorators/property","../../core/accessorSupport/ensureType","../../core/has","../../core/RandomLCG","../../core/accessorSupport/decorators/enumeration","../../core/accessorSupport/decorators/subclass"],(function(t,e,r,o,n,a,i,s,c,u){"use strict";var l;const f=r.strict()({ascendingValues:"ascending-values",descendingValues:"descending-values"});let d=l=class extends(e.ClonableMixin(o)){static from(t){return a.ensureClass(l,t)}constructor(t){super(t),this.title=null,this.order=null}};return t.__decorate([n.property({type:String,json:{write:!0}})],d.prototype,"title",void 0),t.__decorate([c.enumeration(f)],d.prototype,"order",void 0),d=l=t.__decorate([u.subclass("esri.renderers.support.RendererLegendOptions")],d),d}))},"esri/renderers/support/pointCloud/ColorClassBreakInfo":function(){define(["../../../chunks/tslib.es6","../../../Color","../../../core/JSONSupport","../../../core/lang","../../../core/accessorSupport/decorators/property","../../../core/accessorSupport/ensureType","../../../core/accessorSupport/decorators/subclass"],(function(t,e,r,o,n,a,i){"use strict";var s;let c=s=class extends r{constructor(){super(...arguments),this.description=null,this.label=null,this.minValue=0,this.maxValue=0,this.color=null}clone(){return new s({description:this.description,label:this.label,minValue:this.minValue,maxValue:this.maxValue,color:o.clone(this.color)})}};return t.__decorate([n.property({type:String,json:{write:!0}})],c.prototype,"description",void 0),t.__decorate([n.property({type:String,json:{write:!0}})],c.prototype,"label",void 0),t.__decorate([n.property({type:Number,json:{read:{source:"classMinValue"},write:{target:"classMinValue",isRequired:!0}}})],c.prototype,"minValue",void 0),t.__decorate([n.property({type:Number,json:{read:{source:"classMaxValue"},write:{target:"classMaxValue",isRequired:!0}}})],c.prototype,"maxValue",void 0),t.__decorate([n.property({type:e,json:{type:[a.Integer],write:{isRequired:!0}}})],c.prototype,"color",void 0),c=s=t.__decorate([i.subclass("esri.renderers.support.pointCloud.ColorClassBreakInfo")],c),c}))},"esri/renderers/PointCloudStretchRenderer":function(){define(["exports","../chunks/tslib.es6","../core/lang","../core/accessorSupport/decorators/property","../core/has","../core/Logger","../core/accessorSupport/decorators/enumeration","../core/accessorSupport/decorators/subclass","./PointCloudRenderer","./support/RendererLegendOptions","./visualVariables/support/ColorStop"],(function(t,e,r,o,n,a,i,s,c,u,l){"use strict";var f;return t.default=f=class extends c{constructor(t){super(t),this.type="point-cloud-stretch",this.field=null,this.legendOptions=null,this.fieldTransformType=null,this.stops=null}clone(){return new f({...this.cloneProperties(),field:r.clone(this.field),fieldTransformType:r.clone(this.fieldTransformType),stops:r.clone(this.stops),legendOptions:r.clone(this.legendOptions)})}},e.__decorate([i.enumeration({pointCloudStretchRenderer:"point-cloud-stretch"})],t.default.prototype,"type",void 0),e.__decorate([o.property({json:{write:{isRequired:!0}},type:String})],t.default.prototype,"field",void 0),e.__decorate([o.property({type:u,json:{write:!0}})],t.default.prototype,"legendOptions",void 0),e.__decorate([o.property({type:c.fieldTransformTypeKebabDict.apiValues,json:{type:c.fieldTransformTypeKebabDict.jsonValues,read:c.fieldTransformTypeKebabDict.read,write:c.fieldTransformTypeKebabDict.write}})],t.default.prototype,"fieldTransformType",void 0),e.__decorate([o.property({type:[l],json:{write:{isRequired:!0}}})],t.default.prototype,"stops",void 0),t.default=f=e.__decorate([s.subclass("esri.renderers.PointCloudStretchRenderer")],t.default),t.default}))},"esri/renderers/visualVariables/support/ColorStop":function(){define(["../../../chunks/tslib.es6","../../../Color","../../../core/JSONSupport","../../../core/accessorSupport/decorators/property","../../../core/accessorSupport/ensureType","../../../core/has","../../../core/RandomLCG","../../../core/accessorSupport/decorators/subclass","../../../core/accessorSupport/decorators/writer"],(function(t,e,r,o,n,a,i,s,c){"use strict";var u;let l=u=class extends r{constructor(t){super(t),this.color=null,this.label=null,this.value=null}writeValue(t,e,r){e[r]=t??0}clone(){return new u({color:this.color&&this.color.clone(),label:this.label,value:this.value})}};return t.__decorate([o.property({type:e,json:{type:[n.Integer],write:{isRequired:!0}}})],l.prototype,"color",void 0),t.__decorate([o.property({type:String,json:{write:!0}})],l.prototype,"label",void 0),t.__decorate([o.property({type:Number,json:{write:{writerEnsuresNonNull:!0}}})],l.prototype,"value",void 0),t.__decorate([c.writer("value")],l.prototype,"writeValue",null),l=u=t.__decorate([s.subclass("esri.renderers.visualVariables.support.ColorStop")],l),l}))},"esri/renderers/PointCloudUniqueValueRenderer":function(){define(["exports","../chunks/tslib.es6","../core/lang","../core/accessorSupport/decorators/property","../core/has","../core/Logger","../core/accessorSupport/decorators/enumeration","../core/accessorSupport/decorators/subclass","./PointCloudRenderer","./support/RendererLegendOptions","./support/pointCloud/ColorUniqueValueInfo"],(function(t,e,r,o,n,a,i,s,c,u,l){"use strict";var f;return t.default=f=class extends c{constructor(t){super(t),this.type="point-cloud-unique-value",this.field=null,this.fieldTransformType=null,this.colorUniqueValueInfos=null,this.legendOptions=null}clone(){return new f({...this.cloneProperties(),field:r.clone(this.field),fieldTransformType:r.clone(this.fieldTransformType),colorUniqueValueInfos:r.clone(this.colorUniqueValueInfos),legendOptions:r.clone(this.legendOptions)})}},e.__decorate([i.enumeration({pointCloudUniqueValueRenderer:"point-cloud-unique-value"})],t.default.prototype,"type",void 0),e.__decorate([o.property({json:{write:{isRequired:!0}},type:String})],t.default.prototype,"field",void 0),e.__decorate([o.property({type:c.fieldTransformTypeKebabDict.apiValues,json:{type:c.fieldTransformTypeKebabDict.jsonValues,read:c.fieldTransformTypeKebabDict.read,write:c.fieldTransformTypeKebabDict.write}})],t.default.prototype,"fieldTransformType",void 0),e.__decorate([o.property({type:[l],json:{write:{isRequired:!0}}})],t.default.prototype,"colorUniqueValueInfos",void 0),e.__decorate([o.property({type:u,json:{write:!0}})],t.default.prototype,"legendOptions",void 0),t.default=f=e.__decorate([s.subclass("esri.renderers.PointCloudUniqueValueRenderer")],t.default),t.default}))},"esri/renderers/support/pointCloud/ColorUniqueValueInfo":function(){define(["../../../chunks/tslib.es6","../../../Color","../../../core/JSONSupport","../../../core/lang","../../../core/accessorSupport/decorators/property","../../../core/accessorSupport/ensureType","../../../core/accessorSupport/decorators/subclass"],(function(t,e,r,o,n,a,i){"use strict";var s;let c=s=class extends r{constructor(){super(...arguments),this.description=null,this.label=null,this.values=null,this.color=null}clone(){return new s({description:this.description,label:this.label,values:o.clone(this.values),color:o.clone(this.color)})}};return t.__decorate([n.property({type:String,json:{write:!0}})],c.prototype,"description",void 0),t.__decorate([n.property({type:String,json:{write:!0}})],c.prototype,"label",void 0),t.__decorate([n.property({type:[String],json:{write:{isRequired:!0}}})],c.prototype,"values",void 0),t.__decorate([n.property({type:e,json:{type:[a.Integer],write:{isRequired:!0}}})],c.prototype,"color",void 0),c=s=t.__decorate([i.subclass("esri.renderers.support.pointCloud.ColorUniqueValueInfo")],c),c}))},"esri/views/3d/layers/i3s/I3SBinaryReader":function(){define(["exports","../../../../core/Error","../../../../core/lang","../../../../core/Logger","../../../../core/typedArrayUtil","../../../../geometry/support/UCharArray","../../../../geometry/support/UShortArray","./LEPCC","../../webgl-engine/lib/VertexAttribute"],(function(t,e,r,o,n,a,i,s,c){"use strict";const u=()=>o.getLogger("esri.views.3d.layers.i3s.I3SBinaryReader");function l(t,r,o){let n="",a=0;for(;a<o;){const i=t[r+a];if(i<128)n+=String.fromCharCode(i),a++;else if(i>=192&&i<224){if(a+1>=o)throw new e("utf8-decode-error","UTF-8 Decode failed. Two byte character was truncated.");const s=(31&i)<<6|63&t[r+a+1];n+=String.fromCharCode(s),a+=2}else if(i>=224&&i<240){if(a+2>=o)throw new e("utf8-decode-error","UTF-8 Decode failed. Multi byte character was truncated.");const s=(15&i)<<12|(63&t[r+a+1])<<6|63&t[r+a+2];n+=String.fromCharCode(s),a+=3}else{if(!(i>=240&&i<248))throw new e("utf8-decode-error","UTF-8 Decode failed. Invalid multi byte sequence.");{if(a+3>=o)throw new e("utf8-decode-error","UTF-8 Decode failed. Multi byte character was truncated.");const s=(7&i)<<18|(63&t[r+a+1])<<12|(63&t[r+a+2])<<6|63&t[r+a+3];if(s>=65536){const t=55296+(s-65536>>10),e=56320+(1023&s);n+=String.fromCharCode(t,e)}else n+=String.fromCharCode(s);a+=4}}}return n}function f(t,e){const r={byteOffset:0,byteCount:0,fields:Object.create(null)};let o=0;for(let n=0;n<e.length;n++){const a=e[n],i=a.valueType||a.type,s=v[i];r.fields[a.property]=s(t,o),o+=_[i].BYTES_PER_ELEMENT}return r.byteCount=o,r}function d(t,e,r){return p(t,e,r).map((t=>{const e=t?Date.parse(t):null;return null==e||Number.isNaN(e)?null:e}))}function p(t,r,o){const n=[];let a,i,s=0;for(i=0;i<t;i+=1){if(a=r[i],a>0){if(n.push(l(o,s,a-1)),0!==o[s+a-1])throw new e("string-array-error","Invalid string array: missing null termination.")}else n.push(null);s+=a}return n}function h(t,e){return new(0,_[e.valueType])(t,e.byteOffset,e.count*e.valuesPerElement)}function m(t,e){if(!t)return null;const r=t[e];return n.isInt16Array(t)?r===n.minInt16?null:r:n.isInt32Array(t)?r===n.minInt32?null:r:r!=r?null:r}function b(t,e){return new Uint8Array(t,e.byteOffset,e.byteCount)}function g(t,o,n){const a=null!=o.header?f(t,o.header):{byteOffset:0,byteCount:0,fields:{count:n}},i={header:a,byteOffset:a.byteCount,byteCount:0,entries:Object.create(null)};let s=a.byteCount;for(let t=0;t<o.ordering.length;t++){const n=o.ordering[t],c=r.clone(o[n]);if(c.count=a.fields.count??0,"String"===c.valueType){if(c.byteOffset=s,c.byteCount=a.fields[n+"ByteCount"],"UTF-8"!==c.encoding)throw new e("unsupported-encoding","Unsupported String encoding.",{encoding:c.encoding});if(c.timeEncoding&&"ECMA_ISO8601"!==c.timeEncoding)throw new e("unsupported-time-encoding","Unsupported time encoding.",{timeEncoding:c.timeEncoding})}else{if(!A(c.valueType))throw new e("unsupported-value-type","Unsupported binary valueType",{valueType:c.valueType});{const t=w(c.valueType);s+=s%t!==0?t-s%t:0,c.byteOffset=s,c.byteCount=t*c.valuesPerElement*c.count}}s+=c.byteCount??0,i.entries[n]=c}return i.byteCount=s-i.byteOffset,i}function y(t,r,o){if(r!==t&&u().error(`Invalid ${o} buffer size\n expected: ${t}, actual: ${r})`),r<t)throw new e("buffer-too-small","Binary buffer is too small",{expectedSize:t,actualSize:r})}function M(t){return{isDraco:!1,isLegacy:!1,color:null!=t.color,normal:null!=t.normal,uv0:null!=t.uv0,uvRegion:null!=t.uvRegion,featureIndex:null!=t.faceRange&&null!=t.featureId}}function S(t){const e={isDraco:!1,isLegacy:!0,color:!1,normal:!1,uv0:!1,uvRegion:!1,featureIndex:!1};for(const r of t.ordering)if(t.vertexAttributes[r])switch(r){case"position":break;case"normal":e.normal=!0;break;case"color":e.color=!0;break;case"uv0":e.uv0=!0;break;case"region":e.uvRegion=!0}return t.featureAttributes&&t.featureAttributeOrder&&(e.featureIndex=!0),e}function I(t){const e={isDraco:!0,isLegacy:!1,color:!1,normal:!1,uv0:!1,uvRegion:!1,featureIndex:!1};for(const r of t)switch(r){case"position":break;case"normal":e.normal=!0;break;case"uv0":e.uv0=!0;break;case"color":e.color=!0;break;case"uv-region":e.uvRegion=!0;break;case"feature-index":e.featureIndex=!0}return e}const T={position:c.VertexAttribute.POSITION,normal:c.VertexAttribute.NORMAL,color:c.VertexAttribute.COLOR,uv0:c.VertexAttribute.UV0,region:c.VertexAttribute.UVREGION},_={Float32:Float32Array,Float64:Float64Array,UInt8:Uint8Array,Int8:Int8Array,UInt16:Uint16Array,Int16:Int16Array,UInt32:Uint32Array,Int32:Int32Array},v={Float32:(t,e)=>new DataView(t,0).getFloat32(e,!0),Float64:(t,e)=>new DataView(t,0).getFloat64(e,!0),UInt8:(t,e)=>new DataView(t,0).getUint8(e),Int8:(t,e)=>new DataView(t,0).getInt8(e),UInt16:(t,e)=>new DataView(t,0).getUint16(e,!0),Int16:(t,e)=>new DataView(t,0).getInt16(e,!0),UInt32:(t,e)=>new DataView(t,0).getUint32(e,!0),Int32:(t,e)=>new DataView(t,0).getInt32(e,!0)};function A(t){return _.hasOwnProperty(t)}function w(t){return A(t)?_[t].BYTES_PER_ELEMENT:0}t.createAttributeDataIndex=g,t.createGeometryDescriptor=function(t,e){return t&&t.compressedAttributes&&"draco"===t.compressedAttributes.encoding?I(t.compressedAttributes.attributes):t?M(t):S(e)},t.createGeometryDescriptorForDraco=I,t.createGeometryDescriptorFromDefinition=M,t.createGeometryDescriptorFromSchema=S,t.createGeometryIndexFromSchema=function(t,e){const r=f(t,e&&e.header);let o=r.byteCount;const n={isDraco:!1,header:r,byteOffset:r.byteCount,byteCount:0,vertexAttributes:{}},a=r.fields,i=null!=a.vertexCount?a.vertexCount:a.count;for(const t of e.ordering){if(!e.vertexAttributes[t])continue;const r={...e.vertexAttributes[t],byteOffset:o,count:i},a=T[t]||"_"+t;n.vertexAttributes[a]=r,o+=w(r.valueType)*r.valuesPerElement*i}const s=a.faceCount;if(e.faces&&s){n.faces={};for(const t of e.ordering){if(!e.faces[t])continue;const r={...e.faces[t],byteOffset:o,count:s};n.faces[t]=r,o+=w(r.valueType)*r.valuesPerElement*s}}const c=a.featureCount;if(e.featureAttributes&&e.featureAttributeOrder&&c){n.featureAttributes={};for(const t of e.featureAttributeOrder){if(!e.featureAttributes[t])continue;const r={...e.featureAttributes[t],byteOffset:o,count:c};n.featureAttributes[t]=r,o+=("UInt64"===r.valueType?8:w(r.valueType))*r.valuesPerElement*c}}return y(o,t.byteLength,"geometry"),n.byteCount=o-n.byteOffset,n},t.createRawView=b,t.createTypedView=h,t.getBytesPerValue=w,t.getCachedAttributeValue=m,t.isValueType=A,t.readBinaryAttribute=function(t,r,o,c=!1){if("lepcc-rgb"===t.encoding)return c?s.decodeRGB(r):a.compactUCharArray(s.decodeRGB(r));if("lepcc-intensity"===t.encoding)return c?s.decodeIntensity(r):i.compactUShortArray(s.decodeIntensity(r));if(null!=t.encoding&&""!==t.encoding)throw new e("unknown-attribute-storage-info-encoding","Unknown Attribute Storage Info Encoding");t["attributeByteCounts "]&&!t.attributeByteCounts&&(u().warn("Warning: Trailing space in 'attributeByteCounts '."),t.attributeByteCounts=t["attributeByteCounts "]),"ObjectIds"===t.ordering[0]&&t.hasOwnProperty("objectIds")&&(u().warn("Warning: Case error in objectIds"),t.ordering[0]="objectIds");const l=g(r,t,o);y(l.byteOffset+l.byteCount,r.byteLength,"attribute");const f=l.entries.attributeValues||l.entries.objectIds;if(f){if("String"===f.valueType){const t=l.entries.attributeByteCounts,e=h(r,t),o=b(r,f);return f.timeEncoding?d(t.count,e,o):p(t.count,e,o)}return c?h(r,f):function(t,e){const r=h(t,e);if(r.length>=n.nativeArrayMaxSize)return r;const o=new Array;return r.forEach(((t,e)=>o.push(m(r,e)))),o}(r,f)}throw new e("bad-attribute-storage-info","Bad attributeStorageInfo specification.")},t.readDateStringArray=d,t.readHeader=f,t.readStringArray=p,t.valueType2ArrayBufferReader=v,t.valueType2TypedArrayClassMap=_,Object.defineProperty(t,Symbol.toStringTag,{value:"Module"})}))},"esri/geometry/support/UCharArray":function(){define(["exports","../../core/typedArrayUtil"],(function(t,e){"use strict";t.compactUCharArray=function(t){return Array.isArray(t)?t.length<e.nativeArrayMaxSize?t:new Uint8Array(t):t.length<e.nativeArrayMaxSize?Array.from(t):t},Object.defineProperty(t,Symbol.toStringTag,{value:"Module"})}))},"esri/geometry/support/UShortArray":function(){define(["exports","../../core/typedArrayUtil"],(function(t,e){"use strict";t.compactUShortArray=function(t){return Array.isArray(t)?t.length<e.nativeArrayMaxSize?t:new Uint16Array(t):t.length<e.nativeArrayMaxSize?Array.from(t):t},Object.defineProperty(t,Symbol.toStringTag,{value:"Module"})}))},"esri/views/3d/layers/i3s/LEPCC":function(){define(["exports","../../../../core/Error"],(function(t,e){"use strict";const r=!0;function o(t,e,o){return{identifier:String.fromCharCode.apply(null,new Uint8Array(t,o+0,10)),version:e.getUint16(o+10,r),checksum:e.getUint32(o+12,r)}}function n(t,e,r){const o=[];e=a(t,e,o);const n=[];for(let i=0;i<o.length;i++){n.length=0,e=a(t,e,n);for(let t=0;t<n.length;t++)r.push(n[t]+o[i])}return e}function a(t,o,n){const a=new DataView(t,o),i=a.getUint8(0),s=31&i,c=!!(32&i),u=(192&i)>>6;let l=0;if(0===u)l=a.getUint32(1,r),o+=5;else if(1===u)l=a.getUint16(1,r),o+=3;else{if(2!==u)throw new e("lepcc-decode-error","Bad count type");l=a.getUint8(1),o+=2}if(c)throw new e("lepcc-decode-error","LUT not implemented");const f=Math.ceil(l*s/8),d=new Uint8Array(t,o,f);let p=0,h=0,m=0;const b=-1>>>32-s;for(let t=0;t<l;t++){for(;h<s;)p|=d[m]<<h,h+=8,m+=1;n[t]=p&b,p>>>=s,h-=s,h+s>32&&(p|=d[m-1]>>8-h)}return o+m}t.decodeIntensity=function(t){const n=new DataView(t,0);let i=0;const{identifier:s,version:c}=o(t,n,i);if(i+=16,"Intensity "!==s)throw new e("lepcc-decode-error","Bad identifier");if(c>1)throw new e("lepcc-decode-error","Unknown version");const u=function(t,e){return{sizeLo:t.getUint32(e+0,r),sizeHi:t.getUint32(e+4,r),count:t.getUint32(e+8,r),scaleFactor:t.getUint16(e+12,r),bitsPerPoint:t.getUint8(e+14),reserved:t.getUint8(e+15)}}(n,i);if(i+=16,u.sizeHi*2**32+u.sizeLo!==t.byteLength)throw new e("lepcc-decode-error","Bad size");const l=new Uint16Array(u.count);if(8===u.bitsPerPoint){if(u.count+i!==t.byteLength)throw new e("lepcc-decode-error","Bad size");const r=new Uint8Array(t,i,u.count);for(let t=0;t<u.count;t++)l[t]=r[t]*u.scaleFactor}else if(16===u.bitsPerPoint){if(2*u.count+i!==t.byteLength)throw new e("lepcc-decode-error","Bad size");const r=new Uint16Array(t,i,u.count);for(let t=0;t<u.count;t++)l[t]=r[t]*u.scaleFactor}else{const r=[];if(a(t,i,r)!==t.byteLength)throw new e("lepcc-decode-error","Bad size");for(let t=0;t<u.count;t++)l[t]=r[t]*u.scaleFactor}return l},t.decodeRGB=function(t){const n=new DataView(t,0);let a=0;const{identifier:i,version:s}=o(t,n,a);if(a+=16,"ClusterRGB"!==i)throw new e("lepcc-decode-error","Bad identifier");if(s>1)throw new e("lepcc-decode-error","Unknown version");const c=function(t,e){return{sizeLo:t.getUint32(e+0,r),sizeHi:t.getUint32(e+4,r),count:t.getUint32(e+8,r),colorMapCount:t.getUint16(e+12,r),lookupMethod:t.getUint8(e+14),compressionMethod:t.getUint8(e+15)}}(n,a);if(a+=16,c.sizeHi*2**32+c.sizeLo!==t.byteLength)throw new e("lepcc-decode-error","Bad size");if((2===c.lookupMethod||1===c.lookupMethod)&&0===c.compressionMethod){if(3*c.colorMapCount+c.count+a!==t.byteLength||c.colorMapCount>256)throw new e("lepcc-decode-error","Bad count");const r=new Uint8Array(t,a,3*c.colorMapCount),o=new Uint8Array(t,a+3*c.colorMapCount,c.count),n=new Uint8Array(3*c.count);for(let t=0;t<c.count;t++){const e=o[t];n[3*t]=r[3*e],n[3*t+1]=r[3*e+1],n[3*t+2]=r[3*e+2]}return n}if(0===c.lookupMethod&&0===c.compressionMethod){if(3*c.count+a!==t.byteLength||0!==c.colorMapCount)throw new e("lepcc-decode-error","Bad count");return new Uint8Array(t,a).slice()}if(c.lookupMethod<=2&&1===c.compressionMethod){if(a+3!==t.byteLength||1!==c.colorMapCount)throw new e("lepcc-decode-error","Bad count");const r=n.getUint8(a),o=n.getUint8(a+1),i=n.getUint8(a+2),s=new Uint8Array(3*c.count);for(let t=0;t<c.count;t++)s[3*t]=r,s[3*t+1]=o,s[3*t+2]=i;return s}throw new e("lepcc-decode-error","Bad method "+c.lookupMethod+","+c.compressionMethod)},t.decodeXYZ=function(t){const a=new DataView(t,0);let i=0;const{identifier:s,version:c}=o(t,a,i);if(i+=16,"LEPCC     "!==s)throw new e("lepcc-decode-error","Bad identifier");if(c>1)throw new e("lepcc-decode-error","Unknown version");const u=function(t,e){return{sizeLo:t.getUint32(e+0,r),sizeHi:t.getUint32(e+4,r),minX:t.getFloat64(e+8,r),minY:t.getFloat64(e+16,r),minZ:t.getFloat64(e+24,r),maxX:t.getFloat64(e+32,r),maxY:t.getFloat64(e+40,r),maxZ:t.getFloat64(e+48,r),errorX:t.getFloat64(e+56,r),errorY:t.getFloat64(e+64,r),errorZ:t.getFloat64(e+72,r),count:t.getUint32(e+80,r),reserved:t.getUint32(e+84,r)}}(a,i);if(i+=88,u.sizeHi*2**32+u.sizeLo!==t.byteLength)throw new e("lepcc-decode-error","Bad size");const l=new Float64Array(3*u.count),f=[],d=[],p=[],h=[];if(i=n(t,i,f),i=n(t,i,d),i=n(t,i,p),i=n(t,i,h),i!==t.byteLength)throw new e("lepcc-decode-error","Bad length");let m=0,b=0;for(let t=0;t<f.length;t++){b+=f[t];let e=0;for(let r=0;r<d[t];r++){e+=p[m];const t=h[m];l[3*m]=Math.min(u.maxX,u.minX+2*u.errorX*e),l[3*m+1]=Math.min(u.maxY,u.minY+2*u.errorY*b),l[3*m+2]=Math.min(u.maxZ,u.minZ+2*u.errorZ*t),m++}}return{errorX:u.errorX,errorY:u.errorY,errorZ:u.errorZ,result:l}},Object.defineProperty(t,Symbol.toStringTag,{value:"Module"})}))},"esri/views/3d/webgl-engine/lib/VertexAttribute":function(){define(["exports"],(function(t){"use strict";var e;t.VertexAttribute=void 0,(e=t.VertexAttribute||(t.VertexAttribute={})).POSITION="position",e.NORMAL="normal",e.NORMALCOMPRESSED="normalCompressed",e.UV0="uv0",e.UVI="uvi",e.COLOR="color",e.SYMBOLCOLOR="symbolColor",e.SIZE="size",e.ROTATION="rotation",e.TANGENT="tangent",e.OFFSET="offset",e.PERSPECTIVEDIVIDE="perspectiveDivide",e.CENTEROFFSETANDDISTANCE="centerOffsetAndDistance",e.LENGTH="length",e.NEXTDELTA="nextDelta",e.PREVIOUSDELTA="previousDelta",e.U0="u0",e.LINEPARAMETERS="lineParameters",e.COLORFEATUREATTRIBUTE="colorFeatureAttribute",e.SIZEFEATUREATTRIBUTE="sizeFeatureAttribute",e.OPACITYFEATUREATTRIBUTE="opacityFeatureAttribute",e.DISTANCETOSTART="distanceToStart",e.UVMAPSPACE="uvMapSpace",e.BOUNDINGRECT="boundingRect",e.UVREGION="uvRegion",e.PROFILERIGHT="profileRight",e.PROFILEUP="profileUp",e.PROFILEVERTEXANDNORMAL="profileVertexAndNormal",e.PROFILEAUXDATA="profileAuxData",e.INSTANCEMODELORIGINHI="instanceModelOriginHi",e.INSTANCEMODELORIGINLO="instanceModelOriginLo",e.INSTANCEMODEL="instanceModel",e.INSTANCEMODELNORMAL="instanceModelNormal",e.INSTANCECOLOR="instanceColor",e.INSTANCEFEATUREATTRIBUTE="instanceFeatureAttribute",e.LOCALTRANSFORM="localTransform",e.GLOBALTRANSFORM="globalTransform",e.BOUNDINGSPHERE="boundingSphere",e.MODELORIGIN="modelOrigin",e.MODELSCALEFACTORS="modelScaleFactors",e.FEATUREATTRIBUTE="featureAttribute",e.STATE="state",e.LODLEVEL="lodLevel",e.POSITION0="position0",e.POSITION1="position1",e.NORMAL2COMPRESSED="normal2Compressed",e.COMPONENTINDEX="componentIndex",e.VARIANTOFFSET="variantOffset",e.VARIANTSTROKE="variantStroke",e.VARIANTEXTENSION="variantExtension",e.SIDENESS="sideness",e.START="start",e.END="end",e.UP="up",e.START_UP="startUp",e.END_UP="endUp",e.EXTRUDE="extrude",e.OLIDCOLOR="objectAndLayerIdColor",e.INSTANCEOBJECTANDLAYERIDCOLOR="instanceObjectAndLayerIdColor",t.affectsGeometry=function(e){return e===t.VertexAttribute.POSITION},Object.defineProperty(t,Symbol.toStringTag,{value:"Module"})}))},"esri/views/3d/support/orientedBoundingBox":function(){define(["exports","../../../core/libs/gl-matrix-2/math/mat3","../../../core/libs/gl-matrix-2/factories/mat3f64","../../../core/libs/gl-matrix-2/factories/mat4f64","../../../core/libs/gl-matrix-2/math/quat","../../../core/libs/gl-matrix-2/factories/quatf64","../../../chunks/vec32","../../../core/libs/gl-matrix-2/factories/vec3f64","../../../chunks/vec42","../../../core/libs/gl-matrix-2/factories/vec4f64","../../../geometry/ellipsoidUtils","../../../geometry/spatialReferenceEllipsoidUtils","../../../geometry/projection/computeTranslationToOriginAndRotation","../../../geometry/projection/projectBuffer","../../../geometry/projection/projectors","../../../geometry/support/plane","../../../geometry/support/spatialReferenceUtils","../../../geometry/support/vectorStacks","../../ViewingMode","./dito","../webgl-engine/lib/Attribute"],(function(t,e,r,o,n,a,i,s,c,u,l,f,d,p,h,m,b,g,y,M,S){"use strict";class I{constructor(t=s.ZEROS,e=G,r=a.IDENTITY){this._data=[t[0],t[1],t[2],e[0],e[1],e[2],r[0],r[1],r[2],r[3]]}clone(){const t=new I;return t._data=this._data.slice(),t}invalidate(){this._data[3]=-1}get isValid(){return this._data[3]>=0}static fromData(t){const e=new I;return e._data=t.slice(),e}static fromJSON(t){return new I(t.center,t.halfSize,t.quaternion)}copy(t){this._data=t.data.slice()}get center(){return i.set(g.sv3d.get(),this._data[0],this._data[1],this._data[2])}get centerX(){return this._data[0]}get centerY(){return this._data[1]}get centerZ(){return this._data[2]}getCenter(t){return t[0]=this._data[0],t[1]=this._data[1],t[2]=this._data[2],t}set center(t){this._data[0]=t[0],this._data[1]=t[1],this._data[2]=t[2]}setCenter(t,e,r){this._data[0]=t,this._data[1]=e,this._data[2]=r}get halfSize(){return i.set(g.sv3d.get(),this._data[3],this._data[4],this._data[5])}get halfSizeX(){return this._data[3]}get halfSizeY(){return this._data[4]}get halfSizeZ(){return this._data[5]}getHalfSize(t){return t[0]=this._data[3],t[1]=this._data[4],t[2]=this._data[5],t}set halfSize(t){this._data[3]=t[0],this._data[4]=t[1],this._data[5]=t[2]}get quaternion(){return n.set(g.sq4d.get(),this._data[6],this._data[7],this._data[8],this._data[9])}getQuaternion(t){return t[0]=this._data[6],t[1]=this._data[7],t[2]=this._data[8],t[3]=this._data[9],t}set quaternion(t){this._data[6]=t[0],this._data[7]=t[1],this._data[8]=t[2],this._data[9]=t[3]}get data(){return this._data}getCorners(t){const e=T,r=this._data;e[0]=r[6],e[1]=r[7],e[2]=r[8],e[3]=r[9];for(let o=0;o<8;++o){const n=t[o];n[0]=(1&o?-1:1)*r[3],n[1]=(2&o?-1:1)*r[4],n[2]=(4&o?-1:1)*r[5],i.transformQuat(n,n,e),n[0]+=r[0],n[1]+=r[1],n[2]+=r[2]}}doesIntersectFrustumConservativeApproximation(t){return this.intersectPlane(t[0])<=0&&this.intersectPlane(t[1])<=0&&this.intersectPlane(t[2])<=0&&this.intersectPlane(t[3])<=0&&this.intersectPlane(t[4])<=0&&this.intersectPlane(t[5])<=0}get radius(){const t=this._data[3],e=this._data[4],r=this._data[5];return Math.sqrt(t*t+e*e+r*r)}intersectSphere(t){A[0]=this._data[0]-t[0],A[1]=this._data[1]-t[1],A[2]=this._data[2]-t[2];const e=this.getQuaternion(_);return n.conjugate(T,e),i.transformQuat(A,A,T),i.abs(A,A),w[0]=Math.min(A[0],this._data[3]),w[1]=Math.min(A[1],this._data[4]),w[2]=Math.min(A[2],this._data[5]),i.sqrDist(w,A)<t[3]*t[3]}intersectSphereWithMBS(t,e=this.radius){const r=this._data;A[0]=r[0]-t[0],A[1]=r[1]-t[1],A[2]=r[2]-t[2];const o=t[3],n=o+e;return!(i.sqrLen(A)>n*n)&&(T[0]=-r[6],T[1]=-r[7],T[2]=-r[8],T[3]=r[9],i.transformQuat(A,A,T),i.abs(A,A),w[0]=Math.min(A[0],r[3]),w[1]=Math.min(A[1],r[4]),w[2]=Math.min(A[2],r[5]),i.sqrDist(w,A)<o*o)}intersectPlane(t){const e=t[0]*this._data[0]+t[1]*this._data[1]+t[2]*this._data[2]+t[3],r=this.projectedRadius(m.getNormal(t));return e>r?1:e<-r?-1:0}intersectRay(t,e,r=0){const o=this._data,n=T;n[0]=-o[6],n[1]=-o[7],n[2]=-o[8],n[3]=o[9],A[0]=t[0]-o[0],A[1]=t[1]-o[1],A[2]=t[2]-o[2];const a=i.transformQuat(A,A,T),s=i.transformQuat(w,e,T);let c=-1/0,u=1/0;const l=this.getHalfSize(F);for(let t=0;t<3;t++){const e=a[t],o=s[t],n=l[t]+r;if(Math.abs(o)>1e-6){const t=(n-e)/o,r=(-n-e)/o;c=Math.max(c,Math.min(t,r)),u=Math.min(u,Math.max(t,r))}else if(e>n||e<-n)return!1}return c<=u}projectedArea(t,r,o,a){const s=this.getQuaternion(_);n.conjugate(T,s),A[0]=t[0]-this._data[0],A[1]=t[1]-this._data[1],A[2]=t[2]-this._data[2],i.transformQuat(A,A,T);const u=this.getHalfSize(F),l=A[0]<-u[0]?-1:A[0]>u[0]?1:0,f=A[1]<-u[1]?-1:A[1]>u[1]?1:0,d=A[2]<-u[2]?-1:A[2]>u[2]?1:0,p=Math.abs(l)+Math.abs(f)+Math.abs(d);if(0===p)return 1/0;const h=1===p?4:6,m=6*(l+3*f+9*d+13);e.fromQuat(q,s),e.scale(q,q,u);const b=this.getCenter(U);for(let t=0;t<h;t++){const e=O[m+t];i.set(A,((1&e)<<1)-1,(2&e)-1,((4&e)>>1)-1),i.transformMat3(A,A,q),i.add(P,b,A),P[3]=1,c.transformMat4(P,P,r);const o=1/Math.max(1e-6,P[3]);C[2*t]=P[0]*o,C[2*t+1]=P[1]*o}const g=2*h-2;let y=C[0]*(C[3]-C[g+1])+C[g]*(C[1]-C[g-1]);for(let t=2;t<g;t+=2)y+=C[t]*(C[t+3]-C[t-1]);return Math.abs(y)*o*a*.125}projectedRadius(t){const e=this.getQuaternion(_);return n.conjugate(T,e),i.transformQuat(A,t,T),Math.abs(A[0]*this._data[3])+Math.abs(A[1]*this._data[4])+Math.abs(A[2]*this._data[5])}minimumDistancePlane(t){return t[0]*this._data[0]+t[1]*this._data[1]+t[2]*this._data[2]+t[3]-this.projectedRadius(m.getNormal(t))}maximumDistancePlane(t){return t[0]*this._data[0]+t[1]*this._data[1]+t[2]*this._data[2]+t[3]+this.projectedRadius(m.getNormal(t))}toAaBoundingBox(t){const r=this.getQuaternion(_),o=e.fromQuat(q,r),n=this._data[3]*Math.abs(o[0])+this._data[4]*Math.abs(o[3])+this._data[5]*Math.abs(o[6]),a=this._data[3]*Math.abs(o[1])+this._data[4]*Math.abs(o[4])+this._data[5]*Math.abs(o[7]),i=this._data[3]*Math.abs(o[2])+this._data[4]*Math.abs(o[5])+this._data[5]*Math.abs(o[8]);t[0]=this._data[0]-n,t[1]=this._data[1]-a,t[2]=this._data[2]-i,t[3]=this._data[0]+n,t[4]=this._data[1]+a,t[5]=this._data[2]+i}transform(t,e,r,o=0,a=f.getSphericalPCPF(r),s=f.getSphericalPCPF(e),c=h.getProjector(e,s)){if(r===a)e.isGeographic?function(t,e,r,o,a=f.getSphericalPCPF(r)){const s=l.getReferenceEllipsoid(r),c=1+Math.max(0,o)/(s.radius+t.centerZ);t.getCenter(j),j[2]+=o,p.projectBuffer(j,r,0,j,a,0),e.center=j;const u=t.getQuaternion(_);e.quaternion=u,n.conjugate(T,u),i.set(z,0,0,1),i.transformQuat(z,z,T);const d=t.getHalfSize(F);i.set(z,d[0]*Math.abs(z[0]),d[1]*Math.abs(z[1]),d[2]*Math.abs(z[2])),i.scale(z,z,s.inverseFlattening),i.add(z,d,z),e.halfSize=i.scale(z,z,c)}(this,t,e,o,s):function(t,e,r,o,a=f.getSphericalPCPF(r),s=h.getProjector(r,a)){t.getCorners(L),t.getCenter(j),j[2]+=o,d.computeTranslationToOriginAndRotation(r,j,D,a),e.setCenter(D[12],D[13],D[14]);const c=2*Math.sqrt(1+D[0]+D[5]+D[10]);T[0]=(D[6]-D[9])/c,T[1]=(D[8]-D[2])/c,T[2]=(D[1]-D[4])/c,T[3]=.25*c;const u=t.getQuaternion(_);e.quaternion=n.multiply(T,T,u),n.conjugate(T,T),i.set(k,0,0,0);const l=e.getCenter(V);for(const t of L)t[2]+=o,s(t,0,t,0),i.sub(z,t,l),i.transformQuat(z,z,T),i.abs(z,z),i.max(k,k,z);e.halfSize=k}(this,t,e,o,s,c);else if(e.isWGS84&&(r.isWebMercator||b.isPlateCarree(r)))!function(t,e,r,o,n){e.getCenter(U),U[2]+=n;const a=f.getSphericalPCPF(r);p.projectBuffer(U,t,0,U,a,0),E(a,e,U,r,o)}(e,this,r,t,o);else if(e.isWebMercator&&b.isPlateCarree(r))!function(t,e,r,o,n){e.getCenter(U),U[2]+=n,E(t,e,U,r,o)}(e,this,r,t,o);else{const n=this.getCenter(U);n[2]+=o,p.projectBuffer(n,e,0,n,r,0),t.center=n,this!==t&&(t.quaternion=this.getQuaternion(_),t.halfSize=this.getHalfSize(F))}}}const T=a.create(),_=a.create(),v=a.create(),A=s.create(),w=s.create(),P=u.create();function x(t,e=new I){return M.computeOBB(t,e),e}const C=[.1,.2,.3,.4,.5,.6,.7,.8,.9,1,1.1,1.2],O=(()=>{const t=new Int8Array(162);let e=0;const r=r=>{for(let o=0;o<r.length;o++)t[e+o]=r[o];e+=6};return r([6,2,3,1,5,4]),r([0,2,3,1,5,4]),r([0,2,3,7,5,4]),r([0,1,3,2,6,4]),r([0,1,3,2,0,0]),r([0,1,5,7,3,2]),r([0,1,3,7,6,4]),r([0,1,3,7,6,2]),r([0,1,5,7,6,2]),r([0,1,5,4,6,2]),r([0,1,5,4,0,0]),r([0,1,3,7,5,4]),r([0,2,6,4,0,0]),r([0,0,0,0,0,0]),r([1,3,7,5,0,0]),r([2,3,7,6,4,0]),r([2,3,7,6,0,0]),r([2,3,1,5,7,6]),r([0,1,5,7,6,2]),r([0,1,5,7,6,4]),r([0,1,3,7,6,4]),r([4,5,7,6,2,0]),r([4,5,7,6,0,0]),r([4,5,1,3,7,6]),r([0,2,3,7,5,4]),r([6,2,3,7,5,4]),r([6,2,3,1,5,4]),t})();function E(t,r,o,n,a){const i=r.getQuaternion(_),s=e.fromQuat(q,i),c=r.getHalfSize(F);for(let t=0;t<8;++t){for(let e=0;e<3;++e)j[e]=c[e]*(t&1<<e?-1:1);for(let e=0;e<3;++e){let r=o[e];for(let t=0;t<3;++t)r+=j[t]*s[3*t+e];R[3*t+e]=r}}p.projectBuffer(R,t,0,R,n,0,8),x(N,a)}const R=new Array(24),N=new S.Vertices(R,3),j=s.create(),U=s.create(),V=s.create(),F=s.create(),q=r.create(),D=o.create(),L=[[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0]],z=s.create(),k=s.create(),B=s.create(),G=s.freeze(-1,-1,-1);t.Obb=I,t.compute=x,t.computeOffsetObb=function(t,e,r,o,a){const c=t.getQuaternion(_);a.quaternion=c,n.conjugate(T,c);const u=t.getCenter(U),l=t.getHalfSize(F);if(o===y.ViewingMode.Global){i.transformQuat(z,u,T),i.abs(k,z),i.min(B,k,l),i.sub(B,k,B);const o=i.length(B);i.add(B,k,l);const n=i.length(B);if(o<r)a.center=u,i.set(z,r,r,r),a.halfSize=i.add(z,l,z);else{const s=n>0?1+e/n:1,c=o>0?1+r/o:1,u=(c+s)/2,f=(c-s)/2;i.scale(B,k,f),a.halfSize=i.scaleAndAdd(B,B,l,u),i.scale(B,k,u),i.scaleAndAdd(B,B,l,f),i.sign(z,z),i.multiply(z,B,z);const d=t.getQuaternion(v);a.center=i.transformQuat(z,z,d)}}else{a.center=i.scaleAndAdd(z,u,s.UNIT_Z,(r+e)/2);const t=i.transformQuat(z,s.UNIT_Z,T);i.abs(t,t),a.halfSize=i.scaleAndAdd(k,l,t,(r-e)/2)}return a},Object.defineProperty(t,Symbol.toStringTag,{value:"Module"})}))},"esri/core/libs/gl-matrix-2/math/mat3":function(){define(["exports","./common"],(function(t,e){"use strict";function r(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[4],t[4]=e[5],t[5]=e[6],t[6]=e[8],t[7]=e[9],t[8]=e[10],t}function o(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t}function n(t,e,r,o,n,a,i,s,c,u){return t[0]=e,t[1]=r,t[2]=o,t[3]=n,t[4]=a,t[5]=i,t[6]=s,t[7]=c,t[8]=u,t}function a(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=1,t[5]=0,t[6]=0,t[7]=0,t[8]=1,t}function i(t,e){if(t===e){const r=e[1],o=e[2],n=e[5];t[1]=e[3],t[2]=e[6],t[3]=r,t[5]=e[7],t[6]=o,t[7]=n}else t[0]=e[0],t[1]=e[3],t[2]=e[6],t[3]=e[1],t[4]=e[4],t[5]=e[7],t[6]=e[2],t[7]=e[5],t[8]=e[8];return t}function s(t,e){const r=e[0],o=e[1],n=e[2],a=e[3],i=e[4],s=e[5],c=e[6],u=e[7],l=e[8],f=l*i-s*u,d=-l*a+s*c,p=u*a-i*c;let h=r*f+o*d+n*p;return h?(h=1/h,t[0]=f*h,t[1]=(-l*o+n*u)*h,t[2]=(s*o-n*i)*h,t[3]=d*h,t[4]=(l*r-n*c)*h,t[5]=(-s*r+n*a)*h,t[6]=p*h,t[7]=(-u*r+o*c)*h,t[8]=(i*r-o*a)*h,t):null}function c(t,e){const r=e[0],o=e[1],n=e[2],a=e[3],i=e[4],s=e[5],c=e[6],u=e[7],l=e[8];return t[0]=i*l-s*u,t[1]=n*u-o*l,t[2]=o*s-n*i,t[3]=s*c-a*l,t[4]=r*l-n*c,t[5]=n*a-r*s,t[6]=a*u-i*c,t[7]=o*c-r*u,t[8]=r*i-o*a,t}function u(t){const e=t[0],r=t[1],o=t[2],n=t[3],a=t[4],i=t[5],s=t[6],c=t[7],u=t[8];return e*(u*a-i*c)+r*(-u*n+i*s)+o*(c*n-a*s)}function l(t,e,r){const o=e[0],n=e[1],a=e[2],i=e[3],s=e[4],c=e[5],u=e[6],l=e[7],f=e[8],d=r[0],p=r[1],h=r[2],m=r[3],b=r[4],g=r[5],y=r[6],M=r[7],S=r[8];return t[0]=d*o+p*i+h*u,t[1]=d*n+p*s+h*l,t[2]=d*a+p*c+h*f,t[3]=m*o+b*i+g*u,t[4]=m*n+b*s+g*l,t[5]=m*a+b*c+g*f,t[6]=y*o+M*i+S*u,t[7]=y*n+M*s+S*l,t[8]=y*a+M*c+S*f,t}function f(t,e,r){const o=e[0],n=e[1],a=e[2],i=e[3],s=e[4],c=e[5],u=e[6],l=e[7],f=e[8],d=r[0],p=r[1];return t[0]=o,t[1]=n,t[2]=a,t[3]=i,t[4]=s,t[5]=c,t[6]=d*o+p*i+u,t[7]=d*n+p*s+l,t[8]=d*a+p*c+f,t}function d(t,e,r){const o=e[0],n=e[1],a=e[2],i=e[3],s=e[4],c=e[5],u=e[6],l=e[7],f=e[8],d=Math.sin(r),p=Math.cos(r);return t[0]=p*o+d*i,t[1]=p*n+d*s,t[2]=p*a+d*c,t[3]=p*i-d*o,t[4]=p*s-d*n,t[5]=p*c-d*a,t[6]=u,t[7]=l,t[8]=f,t}function p(t,e,r){const o=r[0],n=r[1],a=r[2];return t[0]=o*e[0],t[1]=o*e[1],t[2]=o*e[2],t[3]=n*e[3],t[4]=n*e[4],t[5]=n*e[5],t[6]=a*e[6],t[7]=a*e[7],t[8]=a*e[8],t}function h(t,e,r){const o=r[0],n=r[1];return t[0]=o*e[0],t[1]=o*e[1],t[2]=o*e[2],t[3]=n*e[3],t[4]=n*e[4],t[5]=n*e[5],t}function m(t,e){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=1,t[5]=0,t[6]=e[0],t[7]=e[1],t[8]=1,t}function b(t,e){const r=Math.sin(e),o=Math.cos(e);return t[0]=o,t[1]=r,t[2]=0,t[3]=-r,t[4]=o,t[5]=0,t[6]=0,t[7]=0,t[8]=1,t}function g(t,e){return t[0]=e[0],t[1]=0,t[2]=0,t[3]=0,t[4]=e[1],t[5]=0,t[6]=0,t[7]=0,t[8]=1,t}function y(t,e){return t[0]=e[0],t[1]=e[1],t[2]=0,t[3]=e[2],t[4]=e[3],t[5]=0,t[6]=e[4],t[7]=e[5],t[8]=1,t}function M(t,e){const r=e[0],o=e[1],n=e[2],a=e[3],i=r+r,s=o+o,c=n+n,u=r*i,l=o*i,f=o*s,d=n*i,p=n*s,h=n*c,m=a*i,b=a*s,g=a*c;return t[0]=1-f-h,t[3]=l-g,t[6]=d+b,t[1]=l+g,t[4]=1-u-h,t[7]=p-m,t[2]=d-b,t[5]=p+m,t[8]=1-u-f,t}function S(t,e){const r=e[0],o=e[1],n=e[2],a=e[4],i=e[5],s=e[6],c=e[8],u=e[9],l=e[10],f=l*i-s*u,d=-l*a+s*c,p=u*a-i*c,h=r*f+o*d+n*p;if(!h)return null;const m=1/h;return t[0]=f*m,t[1]=(-l*o+n*u)*m,t[2]=(s*o-n*i)*m,t[3]=d*m,t[4]=(l*r-n*c)*m,t[5]=(-s*r+n*a)*m,t[6]=p*m,t[7]=(-u*r+o*c)*m,t[8]=(i*r-o*a)*m,t}function I(t,e){const r=e[0],o=e[1],n=e[2],a=e[3],i=e[4],s=e[5],c=e[6],u=e[7],l=e[8],f=e[9],d=e[10],p=e[11],h=e[12],m=e[13],b=e[14],g=e[15],y=r*s-o*i,M=r*c-n*i,S=r*u-a*i,I=o*c-n*s,T=o*u-a*s,_=n*u-a*c,v=l*m-f*h,A=l*b-d*h,w=l*g-p*h,P=f*b-d*m,x=f*g-p*m,C=d*g-p*b;let O=y*C-M*x+S*P+I*w-T*A+_*v;return O?(O=1/O,t[0]=(s*C-c*x+u*P)*O,t[1]=(c*w-i*C-u*A)*O,t[2]=(i*x-s*w+u*v)*O,t[3]=(n*x-o*C-a*P)*O,t[4]=(r*C-n*w+a*A)*O,t[5]=(o*w-r*x-a*v)*O,t[6]=(m*_-b*T+g*I)*O,t[7]=(b*S-h*_-g*M)*O,t[8]=(h*T-m*S+g*y)*O,t):null}function T(t,e,r){return t[0]=2/e,t[1]=0,t[2]=0,t[3]=0,t[4]=-2/r,t[5]=0,t[6]=-1,t[7]=1,t[8]=1,t}function _(t){return"mat3("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+", "+t[4]+", "+t[5]+", "+t[6]+", "+t[7]+", "+t[8]+")"}function v(t){return Math.sqrt(t[0]**2+t[1]**2+t[2]**2+t[3]**2+t[4]**2+t[5]**2+t[6]**2+t[7]**2+t[8]**2)}function A(t,e,r){return t[0]=e[0]+r[0],t[1]=e[1]+r[1],t[2]=e[2]+r[2],t[3]=e[3]+r[3],t[4]=e[4]+r[4],t[5]=e[5]+r[5],t[6]=e[6]+r[6],t[7]=e[7]+r[7],t[8]=e[8]+r[8],t}function w(t,e,r){return t[0]=e[0]-r[0],t[1]=e[1]-r[1],t[2]=e[2]-r[2],t[3]=e[3]-r[3],t[4]=e[4]-r[4],t[5]=e[5]-r[5],t[6]=e[6]-r[6],t[7]=e[7]-r[7],t[8]=e[8]-r[8],t}function P(t,e,r){return t[0]=e[0]*r,t[1]=e[1]*r,t[2]=e[2]*r,t[3]=e[3]*r,t[4]=e[4]*r,t[5]=e[5]*r,t[6]=e[6]*r,t[7]=e[7]*r,t[8]=e[8]*r,t}function x(t,e,r,o){return t[0]=e[0]+r[0]*o,t[1]=e[1]+r[1]*o,t[2]=e[2]+r[2]*o,t[3]=e[3]+r[3]*o,t[4]=e[4]+r[4]*o,t[5]=e[5]+r[5]*o,t[6]=e[6]+r[6]*o,t[7]=e[7]+r[7]*o,t[8]=e[8]+r[8]*o,t}function C(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]&&t[4]===e[4]&&t[5]===e[5]&&t[6]===e[6]&&t[7]===e[7]&&t[8]===e[8]}function O(t,r){const o=t[0],n=t[1],a=t[2],i=t[3],s=t[4],c=t[5],u=t[6],l=t[7],f=t[8],d=r[0],p=r[1],h=r[2],m=r[3],b=r[4],g=r[5],y=r[6],M=r[7],S=r[8],I=e.getEpsilon();return Math.abs(o-d)<=I*Math.max(1,Math.abs(o),Math.abs(d))&&Math.abs(n-p)<=I*Math.max(1,Math.abs(n),Math.abs(p))&&Math.abs(a-h)<=I*Math.max(1,Math.abs(a),Math.abs(h))&&Math.abs(i-m)<=I*Math.max(1,Math.abs(i),Math.abs(m))&&Math.abs(s-b)<=I*Math.max(1,Math.abs(s),Math.abs(b))&&Math.abs(c-g)<=I*Math.max(1,Math.abs(c),Math.abs(g))&&Math.abs(u-y)<=I*Math.max(1,Math.abs(u),Math.abs(y))&&Math.abs(l-M)<=I*Math.max(1,Math.abs(l),Math.abs(M))&&Math.abs(f-S)<=I*Math.max(1,Math.abs(f),Math.abs(S))}function E(t){const r=e.getEpsilon(),o=t[0],n=t[1],a=t[2],i=t[3],s=t[4],c=t[5],u=t[6],l=t[7],f=t[8];return Math.abs(1-(o*o+i*i+u*u))<=r&&Math.abs(1-(n*n+s*s+l*l))<=r&&Math.abs(1-(a*a+c*c+f*f))<=r}const R=l,N=w,j=Object.freeze(Object.defineProperty({__proto__:null,add:A,adjoint:c,copy:o,determinant:u,equals:O,exactEquals:C,frob:v,fromMat2d:y,fromMat4:r,fromQuat:M,fromRotation:b,fromScaling:g,fromTranslation:m,identity:a,invert:s,isOrthoNormal:E,mul:R,multiply:l,multiplyScalar:P,multiplyScalarAndAdd:x,normalFromMat4:I,normalFromMat4Legacy:S,projection:T,rotate:d,scale:p,scaleByVec2:h,set:n,str:_,sub:N,subtract:w,translate:f,transpose:i},Symbol.toStringTag,{value:"Module"}));t.add=A,t.adjoint=c,t.copy=o,t.determinant=u,t.equals=O,t.exactEquals=C,t.frob=v,t.fromMat2d=y,t.fromMat4=r,t.fromQuat=M,t.fromRotation=b,t.fromScaling=g,t.fromTranslation=m,t.identity=a,t.invert=s,t.isOrthoNormal=E,t.mat3=j,t.mul=R,t.multiply=l,t.multiplyScalar=P,t.multiplyScalarAndAdd=x,t.normalFromMat4=I,t.normalFromMat4Legacy=S,t.projection=T,t.rotate=d,t.scale=p,t.scaleByVec2=h,t.set=n,t.str=_,t.sub=N,t.subtract=w,t.translate=f,t.transpose=i,Object.defineProperty(t,Symbol.toStringTag,{value:"Module"})}))},"esri/core/libs/gl-matrix-2/factories/mat4f64":function(){define(["exports"],(function(t){"use strict";function e(){return[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]}function r(t){return[t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7],t[8],t[9],t[10],t[11],t[12],t[13],t[14],t[15]]}function o(t,e,r,o,n,a,i,s,c,u,l,f,d,p,h,m){return[t,e,r,o,n,a,i,s,c,u,l,f,d,p,h,m]}const n=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],a=Object.freeze(Object.defineProperty({__proto__:null,IDENTITY:n,clone:r,create:e,fromValues:o},Symbol.toStringTag,{value:"Module"}));t.IDENTITY=n,t.clone=r,t.create=e,t.fromValues=o,t.mat4f64=a,Object.defineProperty(t,Symbol.toStringTag,{value:"Module"})}))},"esri/geometry/spatialReferenceEllipsoidUtils":function(){define(["exports","./ellipsoidUtils","./SpatialReference","./support/spatialReferenceUtils"],(function(t,e,r,o){"use strict";const n=new r(e.SphericalECEFSpatialReferenceLike),a=new r(e.SphericalPCPFMarsLike),i=new r(e.SphericalPCPFMoonLike),s=new r(e.WGS84ECEFSpatialReferenceLike),c=new Map,u=a.wkt.toUpperCase(),l=i.wkt.toUpperCase();t.SphericalECEFSpatialReference=n,t.SphericalPCPFMars=a,t.SphericalPCPFMoon=i,t.WGS84ECEFSpatialReference=s,t.getSphericalPCPF=function(t){const e=c.get(t);if(e)return e;let r=n;if(t)if(t===a)r=a;else if(t===i)r=i;else{const e=t.wkid,n=t.latestWkid;if(null!=e||null!=n)o.isWKIDFromMars(e)||o.isWKIDFromMars(n)?r=a:(o.isWKIDFromMoon(e)||o.isWKIDFromMoon(n))&&(r=i);else{const e=t.wkt2??t.wkt;if(e){const t=e.toUpperCase();t===u?r=a:t===l&&(r=i)}}}return c.set(t,r),r},Object.defineProperty(t,Symbol.toStringTag,{value:"Module"})}))},"esri/geometry/projection/computeTranslationToOriginAndRotation":function(){define(["exports","../../core/mathUtils","../../core/libs/gl-matrix-2/math/mat4","../../core/libs/gl-matrix-2/factories/vec3f64","./localRotationUtils","./projectors","../support/spatialReferenceUtils"],(function(t,e,r,o,n,a,i){"use strict";function s(t){return t===a.ProjectionID.SPHERICAL_ECEF||t===a.ProjectionID.SPHERICAL_MARS_PCPF||t===a.ProjectionID.SPHERICAL_MOON_PCPF||t===a.ProjectionID.WGS84_ECEF}const c=e.deg2rad(1),u=o.create(),l=o.create();t.computeTranslationToOriginAndRotation=function(t,e,o,f){const d=a.getProjectorClassification(t,f);if(null==d)return!1;const p=d.source.spatialReferenceId,h=d.dest.spatialReferenceId;if(p===h&&!s(h)&&(p!==a.ProjectionID.UNKNOWN||i.equals(t,f)))return r.fromTranslation(o,e),!0;if(s(h)){const t=a.projectionTable[p][a.ProjectionID.LON_LAT],r=a.projectionTable[a.ProjectionID.LON_LAT][h];return null!=t&&null!=r&&(t(e,0,u,0),r(u,0,l,0),n.computeENUToPCPFLocalRotation(c*u[0],c*u[1],o),o[12]=l[0],o[13]=l[1],o[14]=l[2],!0)}const m=s(p);if((h===a.ProjectionID.WEB_MERCATOR||h===a.ProjectionID.PLATE_CARREE||h===a.ProjectionID.WGS84||h===a.ProjectionID.CGCS2000)&&(p===a.ProjectionID.WGS84||m||p===a.ProjectionID.WEB_MERCATOR||p===a.ProjectionID.CGCS2000)){const t=a.projectionTable[p][a.ProjectionID.LON_LAT],i=a.projectionTable[a.ProjectionID.LON_LAT][h];return null!=t&&null!=i&&(t(e,0,u,0),i(u,0,l,0),m?n.computePCPFToENULocalRotation(c*u[0],c*u[1],o):r.identity(o),o[12]=l[0],o[13]=l[1],o[14]=l[2],!0)}return!1},Object.defineProperty(t,Symbol.toStringTag,{value:"Module"})}))},"esri/core/libs/gl-matrix-2/math/mat4":function(){define(["exports","../factories/vec3f64","./common"],(function(t,e,r){"use strict";function o(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t}function n(t,e,r,o,n,a,i,s,c,u,l,f,d,p,h,m,b){return t[0]=e,t[1]=r,t[2]=o,t[3]=n,t[4]=a,t[5]=i,t[6]=s,t[7]=c,t[8]=u,t[9]=l,t[10]=f,t[11]=d,t[12]=p,t[13]=h,t[14]=m,t[15]=b,t}function a(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function i(t,e){if(t===e){const r=e[1],o=e[2],n=e[3],a=e[6],i=e[7],s=e[11];t[1]=e[4],t[2]=e[8],t[3]=e[12],t[4]=r,t[6]=e[9],t[7]=e[13],t[8]=o,t[9]=a,t[11]=e[14],t[12]=n,t[13]=i,t[14]=s}else t[0]=e[0],t[1]=e[4],t[2]=e[8],t[3]=e[12],t[4]=e[1],t[5]=e[5],t[6]=e[9],t[7]=e[13],t[8]=e[2],t[9]=e[6],t[10]=e[10],t[11]=e[14],t[12]=e[3],t[13]=e[7],t[14]=e[11],t[15]=e[15];return t}function s(t,e){return c(t,e)||a(t),t}function c(t,e){const r=e[0],o=e[1],n=e[2],a=e[3],i=e[4],s=e[5],c=e[6],u=e[7],l=e[8],f=e[9],d=e[10],p=e[11],h=e[12],m=e[13],b=e[14],g=e[15],y=r*s-o*i,M=r*c-n*i,S=r*u-a*i,I=o*c-n*s,T=o*u-a*s,_=n*u-a*c,v=l*m-f*h,A=l*b-d*h,w=l*g-p*h,P=f*b-d*m,x=f*g-p*m,C=d*g-p*b;let O=y*C-M*x+S*P+I*w-T*A+_*v;return O?(O=1/O,t[0]=(s*C-c*x+u*P)*O,t[1]=(n*x-o*C-a*P)*O,t[2]=(m*_-b*T+g*I)*O,t[3]=(d*T-f*_-p*I)*O,t[4]=(c*w-i*C-u*A)*O,t[5]=(r*C-n*w+a*A)*O,t[6]=(b*S-h*_-g*M)*O,t[7]=(l*_-d*S+p*M)*O,t[8]=(i*x-s*w+u*v)*O,t[9]=(o*w-r*x-a*v)*O,t[10]=(h*T-m*S+g*y)*O,t[11]=(f*S-l*T-p*y)*O,t[12]=(s*A-i*P-c*v)*O,t[13]=(r*P-o*A+n*v)*O,t[14]=(m*M-h*I-b*y)*O,t[15]=(l*I-f*M+d*y)*O,t):null}function u(t,e){const r=e[0],o=e[1],n=e[2],a=e[3],i=e[4],s=e[5],c=e[6],u=e[7],l=e[8],f=e[9],d=e[10],p=e[11],h=e[12],m=e[13],b=e[14],g=e[15];return t[0]=s*(d*g-p*b)-f*(c*g-u*b)+m*(c*p-u*d),t[1]=-(o*(d*g-p*b)-f*(n*g-a*b)+m*(n*p-a*d)),t[2]=o*(c*g-u*b)-s*(n*g-a*b)+m*(n*u-a*c),t[3]=-(o*(c*p-u*d)-s*(n*p-a*d)+f*(n*u-a*c)),t[4]=-(i*(d*g-p*b)-l*(c*g-u*b)+h*(c*p-u*d)),t[5]=r*(d*g-p*b)-l*(n*g-a*b)+h*(n*p-a*d),t[6]=-(r*(c*g-u*b)-i*(n*g-a*b)+h*(n*u-a*c)),t[7]=r*(c*p-u*d)-i*(n*p-a*d)+l*(n*u-a*c),t[8]=i*(f*g-p*m)-l*(s*g-u*m)+h*(s*p-u*f),t[9]=-(r*(f*g-p*m)-l*(o*g-a*m)+h*(o*p-a*f)),t[10]=r*(s*g-u*m)-i*(o*g-a*m)+h*(o*u-a*s),t[11]=-(r*(s*p-u*f)-i*(o*p-a*f)+l*(o*u-a*s)),t[12]=-(i*(f*b-d*m)-l*(s*b-c*m)+h*(s*d-c*f)),t[13]=r*(f*b-d*m)-l*(o*b-n*m)+h*(o*d-n*f),t[14]=-(r*(s*b-c*m)-i*(o*b-n*m)+h*(o*c-n*s)),t[15]=r*(s*d-c*f)-i*(o*d-n*f)+l*(o*c-n*s),t}function l(t){const e=t[0],r=t[1],o=t[2],n=t[3],a=t[4],i=t[5],s=t[6],c=t[7],u=t[8],l=t[9],f=t[10],d=t[11],p=t[12],h=t[13],m=t[14],b=t[15];return(e*i-r*a)*(f*b-d*m)-(e*s-o*a)*(l*b-d*h)+(e*c-n*a)*(l*m-f*h)+(r*s-o*i)*(u*b-d*p)-(r*c-n*i)*(u*m-f*p)+(o*c-n*s)*(u*h-l*p)}function f(t,e,r){const o=e[0],n=e[1],a=e[2],i=e[3],s=e[4],c=e[5],u=e[6],l=e[7],f=e[8],d=e[9],p=e[10],h=e[11],m=e[12],b=e[13],g=e[14],y=e[15];let M=r[0],S=r[1],I=r[2],T=r[3];return t[0]=M*o+S*s+I*f+T*m,t[1]=M*n+S*c+I*d+T*b,t[2]=M*a+S*u+I*p+T*g,t[3]=M*i+S*l+I*h+T*y,M=r[4],S=r[5],I=r[6],T=r[7],t[4]=M*o+S*s+I*f+T*m,t[5]=M*n+S*c+I*d+T*b,t[6]=M*a+S*u+I*p+T*g,t[7]=M*i+S*l+I*h+T*y,M=r[8],S=r[9],I=r[10],T=r[11],t[8]=M*o+S*s+I*f+T*m,t[9]=M*n+S*c+I*d+T*b,t[10]=M*a+S*u+I*p+T*g,t[11]=M*i+S*l+I*h+T*y,M=r[12],S=r[13],I=r[14],T=r[15],t[12]=M*o+S*s+I*f+T*m,t[13]=M*n+S*c+I*d+T*b,t[14]=M*a+S*u+I*p+T*g,t[15]=M*i+S*l+I*h+T*y,t}function d(t,e,r){const o=r[0],n=r[1],a=r[2];if(e===t)t[12]=e[0]*o+e[4]*n+e[8]*a+e[12],t[13]=e[1]*o+e[5]*n+e[9]*a+e[13],t[14]=e[2]*o+e[6]*n+e[10]*a+e[14],t[15]=e[3]*o+e[7]*n+e[11]*a+e[15];else{const r=e[0],i=e[1],s=e[2],c=e[3],u=e[4],l=e[5],f=e[6],d=e[7],p=e[8],h=e[9],m=e[10],b=e[11];t[0]=r,t[1]=i,t[2]=s,t[3]=c,t[4]=u,t[5]=l,t[6]=f,t[7]=d,t[8]=p,t[9]=h,t[10]=m,t[11]=b,t[12]=r*o+u*n+p*a+e[12],t[13]=i*o+l*n+h*a+e[13],t[14]=s*o+f*n+m*a+e[14],t[15]=c*o+d*n+b*a+e[15]}return t}function p(t,e,r){const o=r[0],n=r[1],a=r[2];return t[0]=e[0]*o,t[1]=e[1]*o,t[2]=e[2]*o,t[3]=e[3]*o,t[4]=e[4]*n,t[5]=e[5]*n,t[6]=e[6]*n,t[7]=e[7]*n,t[8]=e[8]*a,t[9]=e[9]*a,t[10]=e[10]*a,t[11]=e[11]*a,t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t}function h(t,e,n,a){let i=a[0],s=a[1],c=a[2],u=Math.sqrt(i*i+s*s+c*c);if(u<=r.getEpsilon())return void o(t,e);u=1/u,i*=u,s*=u,c*=u;const l=Math.sin(n),f=Math.cos(n),d=1-f,p=e[0],h=e[1],m=e[2],b=e[3],g=e[4],y=e[5],M=e[6],S=e[7],I=e[8],T=e[9],_=e[10],v=e[11],A=i*i*d+f,w=s*i*d+c*l,P=c*i*d-s*l,x=i*s*d-c*l,C=s*s*d+f,O=c*s*d+i*l,E=i*c*d+s*l,R=s*c*d-i*l,N=c*c*d+f;t[0]=p*A+g*w+I*P,t[1]=h*A+y*w+T*P,t[2]=m*A+M*w+_*P,t[3]=b*A+S*w+v*P,t[4]=p*x+g*C+I*O,t[5]=h*x+y*C+T*O,t[6]=m*x+M*C+_*O,t[7]=b*x+S*C+v*O,t[8]=p*E+g*R+I*N,t[9]=h*E+y*R+T*N,t[10]=m*E+M*R+_*N,t[11]=b*E+S*R+v*N,e!==t&&(t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15])}function m(t,e,r){const o=Math.sin(r),n=Math.cos(r),a=e[4],i=e[5],s=e[6],c=e[7],u=e[8],l=e[9],f=e[10],d=e[11];return e!==t&&(t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[4]=a*n+u*o,t[5]=i*n+l*o,t[6]=s*n+f*o,t[7]=c*n+d*o,t[8]=u*n-a*o,t[9]=l*n-i*o,t[10]=f*n-s*o,t[11]=d*n-c*o,t}function b(t,e,r){const o=Math.sin(r),n=Math.cos(r),a=e[0],i=e[1],s=e[2],c=e[3],u=e[8],l=e[9],f=e[10],d=e[11];return e!==t&&(t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[0]=a*n-u*o,t[1]=i*n-l*o,t[2]=s*n-f*o,t[3]=c*n-d*o,t[8]=a*o+u*n,t[9]=i*o+l*n,t[10]=s*o+f*n,t[11]=c*o+d*n,t}function g(t,e,r){const o=Math.sin(r),n=Math.cos(r),a=e[0],i=e[1],s=e[2],c=e[3],u=e[4],l=e[5],f=e[6],d=e[7];return e!==t&&(t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[0]=a*n+u*o,t[1]=i*n+l*o,t[2]=s*n+f*o,t[3]=c*n+d*o,t[4]=u*n-a*o,t[5]=l*n-i*o,t[6]=f*n-s*o,t[7]=d*n-c*o,t}function y(t,e){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=e[0],t[13]=e[1],t[14]=e[2],t[15]=1,t}function M(t,e){return t[0]=e[0],t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=e[1],t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=e[2],t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function S(t,e,o){if(0===e)return a(t);let n=o[0],i=o[1],s=o[2],c=Math.sqrt(n*n+i*i+s*s);if(c<=r.getEpsilon())return null;c=1/c,n*=c,i*=c,s*=c;const u=Math.sin(e),l=Math.cos(e),f=1-l;return t[0]=n*n*f+l,t[1]=i*n*f+s*u,t[2]=s*n*f-i*u,t[3]=0,t[4]=n*i*f-s*u,t[5]=i*i*f+l,t[6]=s*i*f+n*u,t[7]=0,t[8]=n*s*f+i*u,t[9]=i*s*f-n*u,t[10]=s*s*f+l,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function I(t,e){const r=Math.sin(e),o=Math.cos(e);return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=o,t[6]=r,t[7]=0,t[8]=0,t[9]=-r,t[10]=o,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function T(t,e){const r=Math.sin(e),o=Math.cos(e);return t[0]=o,t[1]=0,t[2]=-r,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=r,t[9]=0,t[10]=o,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function _(t,e){const r=Math.sin(e),o=Math.cos(e);return t[0]=o,t[1]=r,t[2]=0,t[3]=0,t[4]=-r,t[5]=o,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function v(t,e,r){const o=e[0],n=e[1],a=e[2],i=e[3],s=o+o,c=n+n,u=a+a,l=o*s,f=o*c,d=o*u,p=n*c,h=n*u,m=a*u,b=i*s,g=i*c,y=i*u;return t[0]=1-(p+m),t[1]=f+y,t[2]=d-g,t[3]=0,t[4]=f-y,t[5]=1-(l+m),t[6]=h+b,t[7]=0,t[8]=d+g,t[9]=h-b,t[10]=1-(l+p),t[11]=0,t[12]=r[0],t[13]=r[1],t[14]=r[2],t[15]=1,t}function A(t,e){const r=w,o=-e[0],n=-e[1],a=-e[2],i=e[3],s=e[4],c=e[5],u=e[6],l=e[7],f=o*o+n*n+a*a+i*i;return f>0?(r[0]=2*(s*i+l*o+c*a-u*n)/f,r[1]=2*(c*i+l*n+u*o-s*a)/f,r[2]=2*(u*i+l*a+s*n-c*o)/f):(r[0]=2*(s*i+l*o+c*a-u*n),r[1]=2*(c*i+l*n+u*o-s*a),r[2]=2*(u*i+l*a+s*n-c*o)),v(t,e,r),t}const w=e.create();function P(t,e){return t[0]=e[12],t[1]=e[13],t[2]=e[14],t}function x(t,e){const r=e[0],o=e[1],n=e[2],a=e[4],i=e[5],s=e[6],c=e[8],u=e[9],l=e[10];return t[0]=Math.sqrt(r*r+o*o+n*n),t[1]=Math.sqrt(a*a+i*i+s*s),t[2]=Math.sqrt(c*c+u*u+l*l),t}function C(t,e){const r=e[0]+e[5]+e[10];let o=0;return r>0?(o=2*Math.sqrt(r+1),t[3]=.25*o,t[0]=(e[6]-e[9])/o,t[1]=(e[8]-e[2])/o,t[2]=(e[1]-e[4])/o):e[0]>e[5]&&e[0]>e[10]?(o=2*Math.sqrt(1+e[0]-e[5]-e[10]),t[3]=(e[6]-e[9])/o,t[0]=.25*o,t[1]=(e[1]+e[4])/o,t[2]=(e[8]+e[2])/o):e[5]>e[10]?(o=2*Math.sqrt(1+e[5]-e[0]-e[10]),t[3]=(e[8]-e[2])/o,t[0]=(e[1]+e[4])/o,t[1]=.25*o,t[2]=(e[6]+e[9])/o):(o=2*Math.sqrt(1+e[10]-e[0]-e[5]),t[3]=(e[1]-e[4])/o,t[0]=(e[8]+e[2])/o,t[1]=(e[6]+e[9])/o,t[2]=.25*o),t}function O(t,e,r,o){const n=e[0],a=e[1],i=e[2],s=e[3],c=n+n,u=a+a,l=i+i,f=n*c,d=n*u,p=n*l,h=a*u,m=a*l,b=i*l,g=s*c,y=s*u,M=s*l,S=o[0],I=o[1],T=o[2];return t[0]=(1-(h+b))*S,t[1]=(d+M)*S,t[2]=(p-y)*S,t[3]=0,t[4]=(d-M)*I,t[5]=(1-(f+b))*I,t[6]=(m+g)*I,t[7]=0,t[8]=(p+y)*T,t[9]=(m-g)*T,t[10]=(1-(f+h))*T,t[11]=0,t[12]=r[0],t[13]=r[1],t[14]=r[2],t[15]=1,t}function E(t,e,r,o,n){const a=e[0],i=e[1],s=e[2],c=e[3],u=a+a,l=i+i,f=s+s,d=a*u,p=a*l,h=a*f,m=i*l,b=i*f,g=s*f,y=c*u,M=c*l,S=c*f,I=o[0],T=o[1],_=o[2],v=n[0],A=n[1],w=n[2],P=(1-(m+g))*I,x=(p+S)*I,C=(h-M)*I,O=(p-S)*T,E=(1-(d+g))*T,R=(b+y)*T,N=(h+M)*_,j=(b-y)*_,U=(1-(d+m))*_;return t[0]=P,t[1]=x,t[2]=C,t[3]=0,t[4]=O,t[5]=E,t[6]=R,t[7]=0,t[8]=N,t[9]=j,t[10]=U,t[11]=0,t[12]=r[0]+v-(P*v+O*A+N*w),t[13]=r[1]+A-(x*v+E*A+j*w),t[14]=r[2]+w-(C*v+R*A+U*w),t[15]=1,t}function R(t,e){const r=e[0],o=e[1],n=e[2],a=e[3],i=r+r,s=o+o,c=n+n,u=r*i,l=o*i,f=o*s,d=n*i,p=n*s,h=n*c,m=a*i,b=a*s,g=a*c;return t[0]=1-f-h,t[1]=l+g,t[2]=d-b,t[3]=0,t[4]=l-g,t[5]=1-u-h,t[6]=p+m,t[7]=0,t[8]=d+b,t[9]=p-m,t[10]=1-u-f,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function N(t,e,r,o,n,a,i){const s=1/(r-e),c=1/(n-o),u=1/(a-i);return t[0]=2*a*s,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=2*a*c,t[6]=0,t[7]=0,t[8]=(r+e)*s,t[9]=(n+o)*c,t[10]=(i+a)*u,t[11]=-1,t[12]=0,t[13]=0,t[14]=i*a*2*u,t[15]=0,t}function j(t,e,r,o,n){const a=1/Math.tan(e/2);let i;return t[0]=a/r,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=a,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[11]=-1,t[12]=0,t[13]=0,t[15]=0,null!=n&&n!==1/0?(i=1/(o-n),t[10]=(n+o)*i,t[14]=2*n*o*i):(t[10]=-1,t[14]=-2*o),t}function U(t,e,r,o){const n=Math.tan(e.upDegrees*Math.PI/180),a=Math.tan(e.downDegrees*Math.PI/180),i=Math.tan(e.leftDegrees*Math.PI/180),s=Math.tan(e.rightDegrees*Math.PI/180),c=2/(i+s),u=2/(n+a);return t[0]=c,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=u,t[6]=0,t[7]=0,t[8]=-(i-s)*c*.5,t[9]=(n-a)*u*.5,t[10]=o/(r-o),t[11]=-1,t[12]=0,t[13]=0,t[14]=o*r/(r-o),t[15]=0,t}function V(t,e,r,o,n,a,i){const s=1/(e-r),c=1/(o-n),u=1/(a-i);return t[0]=-2*s,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=-2*c,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=2*u,t[11]=0,t[12]=(e+r)*s,t[13]=(n+o)*c,t[14]=(i+a)*u,t[15]=1,t}function F(t,e,o,n){const i=e[0],s=e[1],c=e[2];let u=i-o[0],l=s-o[1],f=c-o[2];const d=r.getEpsilon();if(Math.abs(u)<d&&Math.abs(l)<d&&Math.abs(f)<d)return void a(t);let p=1/Math.sqrt(u*u+l*l+f*f);u*=p,l*=p,f*=p;const h=n[0],m=n[1],b=n[2];let g=m*f-b*l,y=b*u-h*f,M=h*l-m*u;p=Math.sqrt(g*g+y*y+M*M),p?(p=1/p,g*=p,y*=p,M*=p):(g=0,y=0,M=0);let S=l*M-f*y,I=f*g-u*M,T=u*y-l*g;p=Math.sqrt(S*S+I*I+T*T),p?(p=1/p,S*=p,I*=p,T*=p):(S=0,I=0,T=0),t[0]=g,t[1]=S,t[2]=u,t[3]=0,t[4]=y,t[5]=I,t[6]=l,t[7]=0,t[8]=M,t[9]=T,t[10]=f,t[11]=0,t[12]=-(g*i+y*s+M*c),t[13]=-(S*i+I*s+T*c),t[14]=-(u*i+l*s+f*c),t[15]=1}function q(t,e,r,o){const n=e[0],a=e[1],i=e[2],s=o[0],c=o[1],u=o[2];let l=n-r[0],f=a-r[1],d=i-r[2],p=l*l+f*f+d*d;p>0&&(p=1/Math.sqrt(p),l*=p,f*=p,d*=p);let h=c*d-u*f,m=u*l-s*d,b=s*f-c*l;return p=h*h+m*m+b*b,p>0&&(p=1/Math.sqrt(p),h*=p,m*=p,b*=p),t[0]=h,t[1]=m,t[2]=b,t[3]=0,t[4]=f*b-d*m,t[5]=d*h-l*b,t[6]=l*m-f*h,t[7]=0,t[8]=l,t[9]=f,t[10]=d,t[11]=0,t[12]=n,t[13]=a,t[14]=i,t[15]=1,t}function D(t){return"mat4("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+", "+t[4]+", "+t[5]+", "+t[6]+", "+t[7]+", "+t[8]+", "+t[9]+", "+t[10]+", "+t[11]+", "+t[12]+", "+t[13]+", "+t[14]+", "+t[15]+")"}function L(t){return Math.sqrt(t[0]**2+t[1]**2+t[2]**2+t[3]**2+t[4]**2+t[5]**2+t[6]**2+t[7]**2+t[8]**2+t[9]**2+t[10]**2+t[11]**2+t[12]**2+t[13]**2+t[14]**2+t[15]**2)}function z(t,e,r){return t[0]=e[0]+r[0],t[1]=e[1]+r[1],t[2]=e[2]+r[2],t[3]=e[3]+r[3],t[4]=e[4]+r[4],t[5]=e[5]+r[5],t[6]=e[6]+r[6],t[7]=e[7]+r[7],t[8]=e[8]+r[8],t[9]=e[9]+r[9],t[10]=e[10]+r[10],t[11]=e[11]+r[11],t[12]=e[12]+r[12],t[13]=e[13]+r[13],t[14]=e[14]+r[14],t[15]=e[15]+r[15],t}function k(t,e,r){return t[0]=e[0]-r[0],t[1]=e[1]-r[1],t[2]=e[2]-r[2],t[3]=e[3]-r[3],t[4]=e[4]-r[4],t[5]=e[5]-r[5],t[6]=e[6]-r[6],t[7]=e[7]-r[7],t[8]=e[8]-r[8],t[9]=e[9]-r[9],t[10]=e[10]-r[10],t[11]=e[11]-r[11],t[12]=e[12]-r[12],t[13]=e[13]-r[13],t[14]=e[14]-r[14],t[15]=e[15]-r[15],t}function B(t,e,r){return t[0]=e[0]*r,t[1]=e[1]*r,t[2]=e[2]*r,t[3]=e[3]*r,t[4]=e[4]*r,t[5]=e[5]*r,t[6]=e[6]*r,t[7]=e[7]*r,t[8]=e[8]*r,t[9]=e[9]*r,t[10]=e[10]*r,t[11]=e[11]*r,t[12]=e[12]*r,t[13]=e[13]*r,t[14]=e[14]*r,t[15]=e[15]*r,t}function G(t,e,r,o){return t[0]=e[0]+r[0]*o,t[1]=e[1]+r[1]*o,t[2]=e[2]+r[2]*o,t[3]=e[3]+r[3]*o,t[4]=e[4]+r[4]*o,t[5]=e[5]+r[5]*o,t[6]=e[6]+r[6]*o,t[7]=e[7]+r[7]*o,t[8]=e[8]+r[8]*o,t[9]=e[9]+r[9]*o,t[10]=e[10]+r[10]*o,t[11]=e[11]+r[11]*o,t[12]=e[12]+r[12]*o,t[13]=e[13]+r[13]*o,t[14]=e[14]+r[14]*o,t[15]=e[15]+r[15]*o,t}function Y(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]&&t[4]===e[4]&&t[5]===e[5]&&t[6]===e[6]&&t[7]===e[7]&&t[8]===e[8]&&t[9]===e[9]&&t[10]===e[10]&&t[11]===e[11]&&t[12]===e[12]&&t[13]===e[13]&&t[14]===e[14]&&t[15]===e[15]}function X(t,e){if(t===e)return!0;const o=t[0],n=t[1],a=t[2],i=t[3],s=t[4],c=t[5],u=t[6],l=t[7],f=t[8],d=t[9],p=t[10],h=t[11],m=t[12],b=t[13],g=t[14],y=t[15],M=e[0],S=e[1],I=e[2],T=e[3],_=e[4],v=e[5],A=e[6],w=e[7],P=e[8],x=e[9],C=e[10],O=e[11],E=e[12],R=e[13],N=e[14],j=e[15],U=r.getEpsilon();return Math.abs(o-M)<=U*Math.max(1,Math.abs(o),Math.abs(M))&&Math.abs(n-S)<=U*Math.max(1,Math.abs(n),Math.abs(S))&&Math.abs(a-I)<=U*Math.max(1,Math.abs(a),Math.abs(I))&&Math.abs(i-T)<=U*Math.max(1,Math.abs(i),Math.abs(T))&&Math.abs(s-_)<=U*Math.max(1,Math.abs(s),Math.abs(_))&&Math.abs(c-v)<=U*Math.max(1,Math.abs(c),Math.abs(v))&&Math.abs(u-A)<=U*Math.max(1,Math.abs(u),Math.abs(A))&&Math.abs(l-w)<=U*Math.max(1,Math.abs(l),Math.abs(w))&&Math.abs(f-P)<=U*Math.max(1,Math.abs(f),Math.abs(P))&&Math.abs(d-x)<=U*Math.max(1,Math.abs(d),Math.abs(x))&&Math.abs(p-C)<=U*Math.max(1,Math.abs(p),Math.abs(C))&&Math.abs(h-O)<=U*Math.max(1,Math.abs(h),Math.abs(O))&&Math.abs(m-E)<=U*Math.max(1,Math.abs(m),Math.abs(E))&&Math.abs(b-R)<=U*Math.max(1,Math.abs(b),Math.abs(R))&&Math.abs(g-N)<=U*Math.max(1,Math.abs(g),Math.abs(N))&&Math.abs(y-j)<=U*Math.max(1,Math.abs(y),Math.abs(j))}function Q(t){const e=r.getEpsilon(),o=t[0],n=t[1],a=t[2],i=t[4],s=t[5],c=t[6],u=t[8],l=t[9],f=t[10];return Math.abs(1-(o*o+i*i+u*u))<=e&&Math.abs(1-(n*n+s*s+l*l))<=e&&Math.abs(1-(a*a+c*c+f*f))<=e}function Z(t){return 1===t[0]&&0===t[1]&&0===t[2]&&0===t[4]&&1===t[5]&&0===t[6]&&0===t[8]&&0===t[9]&&1===t[10]}const W=f,H=k,K=Object.freeze(Object.defineProperty({__proto__:null,add:z,adjoint:u,copy:o,determinant:l,equals:X,exactEquals:Y,frob:L,fromQuat:R,fromQuat2:A,fromRotation:S,fromRotationTranslation:v,fromRotationTranslationScale:O,fromRotationTranslationScaleOrigin:E,fromScaling:M,fromTranslation:y,fromXRotation:I,fromYRotation:T,fromZRotation:_,frustum:N,getRotation:C,getScale:x,getTranslation:P,hasIdentityRotation:Z,identity:a,invert:c,invertOrIdentity:s,isOrthoNormal:Q,lookAt:F,mul:W,multiply:f,multiplyScalar:B,multiplyScalarAndAdd:G,ortho:V,perspective:j,perspectiveFromFieldOfView:U,rotate:h,rotateX:m,rotateY:b,rotateZ:g,scale:p,set:n,str:D,sub:H,subtract:k,targetTo:q,translate:d,transpose:i},Symbol.toStringTag,{value:"Module"}));t.add=z,t.adjoint=u,t.copy=o,t.determinant=l,t.equals=X,t.exactEquals=Y,t.frob=L,t.fromQuat=R,t.fromQuat2=A,t.fromRotation=S,t.fromRotationTranslation=v,t.fromRotationTranslationScale=O,t.fromRotationTranslationScaleOrigin=E,t.fromScaling=M,t.fromTranslation=y,t.fromXRotation=I,t.fromYRotation=T,t.fromZRotation=_,t.frustum=N,t.getRotation=C,t.getScale=x,t.getTranslation=P,t.hasIdentityRotation=Z,t.identity=a,t.invert=c,t.invertOrIdentity=s,t.isOrthoNormal=Q,t.lookAt=F,t.mat4=K,t.mul=W,t.multiply=f,t.multiplyScalar=B,t.multiplyScalarAndAdd=G,t.ortho=V,t.perspective=j,t.perspectiveFromFieldOfView=U,t.rotate=h,t.rotateX=m,t.rotateY=b,t.rotateZ=g,t.scale=p,t.set=n,t.str=D,t.sub=H,t.subtract=k,t.targetTo=q,t.translate=d,t.transpose=i,Object.defineProperty(t,Symbol.toStringTag,{value:"Module"})}))},"esri/geometry/projection/localRotationUtils":function(){define(["exports","../../core/libs/gl-matrix-2/math/mat4"],(function(t,e){"use strict";function r(t,e,r){const o=Math.sin(t),n=Math.cos(t),a=Math.sin(e),i=Math.cos(e),s=r;return s[0]=-o,s[4]=-a*n,s[8]=i*n,s[12]=0,s[1]=n,s[5]=-a*o,s[9]=i*o,s[13]=0,s[2]=0,s[6]=i,s[10]=a,s[14]=0,s[3]=0,s[7]=0,s[11]=0,s[15]=1,s}t.computeENUToPCPFLocalRotation=r,t.computePCPFToENULocalRotation=function(t,o,n){return r(t,o,n),e.transpose(n,n),n},Object.defineProperty(t,Symbol.toStringTag,{value:"Module"})}))},"esri/geometry/support/plane":function(){define(["exports","../../core/mathUtils","../../chunks/vec32","../../core/libs/gl-matrix-2/factories/vec3f64","../../chunks/vec42","./vector","./vectorStacks","../../views/3d/support/mathUtils"],(function(t,e,r,o,n,a,i,s){"use strict";function c(t=P){return[t[0],t[1],t[2],t[3]]}const u=n.exactEquals,l=n.equals;function f(t,e){return d(e[0],e[1],e[2],e[3],t)}function d(t,e,r,o,n=c()){return n[0]=t,n[1]=e,n[2]=r,n[3]=o,n}function p(t,e,r){const o=e[0]*e[0]+e[1]*e[1]+e[2]*e[2],n=Math.abs(o-1)>1e-5&&o>1e-12?1/Math.sqrt(o):1;return r[0]=e[0]*n,r[1]=e[1]*n,r[2]=e[2]*n,r[3]=-(r[0]*t[0]+r[1]*t[1]+r[2]*t[2]),r}function h(t,e,r,o=c()){const n=r[0]-e[0],a=r[1]-e[1],i=r[2]-e[2],s=t[0]-e[0],u=t[1]-e[1],l=t[2]-e[2],f=a*l-i*u,d=i*s-n*l,p=n*u-a*s,h=f*f+d*d+p*p,m=Math.abs(h-1)>1e-5&&h>1e-12?1/Math.sqrt(h):1;return o[0]=f*m,o[1]=d*m,o[2]=p*m,o[3]=-(o[0]*t[0]+o[1]*t[1]+o[2]*t[2]),o}function m(t,e,o,n=0,a=Math.floor(o*(1/3)),i=Math.floor(o*(2/3))){if(o<3)return!1;e(g,n);let s=a,c=!1;for(;s<o-1&&!c;)e(y,s),s++,c=!r.exactEquals(g,y);if(!c)return!1;for(s=Math.max(s,i),c=!1;s<o&&!c;)e(M,s),s++,r.subtract(S,g,y),r.normalize(S,S),r.subtract(I,y,M),r.normalize(I,I),c=!r.exactEquals(g,M)&&!r.exactEquals(y,M)&&Math.abs(r.dot(S,I))<b;return c?(h(g,y,M,t),!0):(0!==n||1!==a||2!==i)&&m(t,e,o,0,1,2)}const b=.99619469809,g=o.create(),y=o.create(),M=o.create(),S=o.create(),I=o.create();function T(t,e,o){const n=r.scale(i.sv3d.get(),t,r.dot(t,e));return r.subtract(o,e,n),o}function _(t,e){return r.dot(t,e)+t[3]}var v;function A(e){return e===t.IntersectResult.INTERSECTS_INSIDE_OUT||e===t.IntersectResult.INTERSECTS_OUTSIDE_IN}function w(o,n,a,i,s){const c=r.dot(o,a),u=_(o,n);if(0===c)return u>=0?t.IntersectResult.INSIDE:t.IntersectResult.OUTSIDE;let l=-u/c;return i&t.IntersectFlags.CLAMP&&(l=e.clamp(l,0,1)),!(i&t.IntersectFlags.INFINITE_MIN)&&l<0||!(i&t.IntersectFlags.INFINITE_MAX)&&l>1?u>=0?t.IntersectResult.INSIDE:t.IntersectResult.OUTSIDE:(r.add(s,n,r.scale(s,a,l)),u>=0?t.IntersectResult.INTERSECTS_INSIDE_OUT:t.IntersectResult.INTERSECTS_OUTSIDE_IN)}t.IntersectResult=void 0,(v=t.IntersectResult||(t.IntersectResult={}))[v.INTERSECTS_INSIDE_OUT=0]="INTERSECTS_INSIDE_OUT",v[v.INTERSECTS_OUTSIDE_IN=1]="INTERSECTS_OUTSIDE_IN",v[v.INSIDE=2]="INSIDE",v[v.OUTSIDE=3]="OUTSIDE";const P=[0,0,1,0];var x;t.IntersectFlags=void 0,(x=t.IntersectFlags||(t.IntersectFlags={}))[x.NONE=0]="NONE",x[x.CLAMP=1]="CLAMP",x[x.INFINITE_MIN=4]="INFINITE_MIN",x[x.INFINITE_MAX=8]="INFINITE_MAX";const C=t.IntersectFlags.INFINITE_MIN|t.IntersectFlags.INFINITE_MAX,O=t.IntersectFlags.INFINITE_MAX;t.clip=function(t,e){const o=r.dot(t,e.ray.direction),n=-_(t,e.ray.origin);if(n<0&&o>=0)return!1;if(o>-1e-6&&o<1e-6)return n>0;if((n<0||o<0)&&!(n<0&&o<0))return!0;const a=n/o;return o>0?a<e.c1&&(e.c1=a):a>e.c0&&(e.c0=a),e.c0<=e.c1},t.clipInfinite=function(t,e){const o=r.dot(t,e.ray.direction),n=-_(t,e.ray.origin);if(o>-1e-6&&o<1e-6)return n>0;const a=n/o;return o>0?a<e.c1&&(e.c1=a):a>e.c0&&(e.c0=a),e.c0<=e.c1},t.copy=f,t.create=c,t.distance=function(t,e){return Math.abs(_(t,e))},t.equals=l,t.exactEquals=u,t.fromArray=function(t,e,o=!0){const n=e.length/3;return m(t,((t,o)=>r.set(t,e[3*o+0],e[3*o+1],e[3*o+2])),o?n-1:n)},t.fromManyPoints=m,t.fromNormalAndOffset=function(t,e,o){return r.copy(o,t),o[3]=e,o},t.fromPoints=h,t.fromPositionAndNormal=p,t.fromValues=d,t.fromVectorsAndPoint=function(t,e,o,n){return r.cross(M,e,t),p(o,M,n)},t.getNormal=function(t){return t},t.intersectLine=function(t,e,o,n){return A(w(t,e,r.subtract(i.sv3d.get(),o,e),C,n))},t.intersectLineOrRay=w,t.intersectLineSegment=function(e,r,o){return A(w(e,r.origin,r.vector,t.IntersectFlags.NONE,o))},t.intersectLineSegmentClamp=function(e,r,o){return A(w(e,r.origin,r.vector,t.IntersectFlags.CLAMP,o))},t.intersectRay=function(t,e,r){return null!=e&&A(w(t,e.origin,e.direction,O,r))},t.isPointInside=function(t,e){return _(t,e)>=0},t.negate=function(t,e){return e[0]=-t[0],e[1]=-t[1],e[2]=-t[2],e[3]=-t[3],e},t.projectPoint=function(t,e,o){const n=r.scale(i.sv3d.get(),t,-t[3]),a=T(t,r.subtract(i.sv3d.get(),e,n),i.sv3d.get());return r.add(o,a,n),o},t.projectPointLocal=function(t,e,o,n){const c=t,u=i.sv3d.get(),l=i.sv3d.get();s.tangentFrame(c,u,l);const f=r.subtract(i.sv3d.get(),o,e),d=a.projectPointSignedLength(u,f),p=a.projectPointSignedLength(l,f),h=a.projectPointSignedLength(c,f);return r.set(n,d,p,h)},t.projectVector=T,t.setOffsetFromPoint=function(t,e,o){return e!==t&&f(t,e),t[3]=-r.dot(t,o),t},t.signedDistance=_,t.up=P,t.wrap=function(t=P[0],e=P[1],r=P[2],o=P[3]){return d(t,e,r,o,i.sv4d.get())},Object.defineProperty(t,Symbol.toStringTag,{value:"Module"})}))},"esri/geometry/support/vector":function(){define(["exports","../../core/mathUtils","../../chunks/vec32","../../core/libs/gl-matrix-2/factories/vec3f64"],(function(t,e,r,o){"use strict";const n=o.create(),a=o.create();t.angle=function(t,o){const n=r.dot(t,o)/(r.length(t)*r.length(o));return-e.acosClamped(n)},t.angleAroundAxis=function(t,o,i){r.normalize(n,t),r.normalize(a,o);const s=r.dot(n,a),c=e.acosClamped(s),u=r.cross(n,n,a);return r.dot(u,i)<0?2*Math.PI-c:c},t.projectPoint=function(t,e,o){const n=r.dot(t,e)/r.dot(t,t);return r.scale(o,t,n)},t.projectPointSignedLength=function(t,e){return r.dot(t,e)/r.length(t)},Object.defineProperty(t,Symbol.toStringTag,{value:"Module"})}))},"esri/geometry/support/vectorStacks":function(){define(["exports","../../core/VectorStack"],(function(t,e){"use strict";const r=e.VectorStack.createVec2f64(),o=e.VectorStack.createVec3f64(),n=e.VectorStack.createVec4f64(),a=e.VectorStack.createMat3f64(),i=e.VectorStack.createMat4f64(),s=e.VectorStack.createQuatf64();t.sm3d=a,t.sm4d=i,t.sq4d=s,t.sv2d=r,t.sv3d=o,t.sv4d=n,Object.defineProperty(t,Symbol.toStringTag,{value:"Module"})}))},"esri/core/VectorStack":function(){define(["exports","./has","./nextTick","./libs/gl-matrix-2/factories/mat3f64","./libs/gl-matrix-2/factories/mat4f64","./libs/gl-matrix-2/factories/quatf64","./libs/gl-matrix-2/factories/vec2f64","./libs/gl-matrix-2/factories/vec3f64","./libs/gl-matrix-2/factories/vec4f64"],(function(t,e,r,o,n,a,i,s,c){"use strict";class u{constructor(t){this._create=t,this._items=new Array,this._itemsPtr=0}get(){return 0===this._itemsPtr&&r.nextTick((()=>this._reset())),this._itemsPtr>=this._items.length&&this._items.push(this._create()),this._items[this._itemsPtr++]}_reset(){const t=2*this._itemsPtr;this._items.length>t&&(this._items.length=t),this._itemsPtr=0}static createVec2f64(){return new u(i.create)}static createVec3f64(){return new u(s.create)}static createVec4f64(){return new u(c.create)}static createMat3f64(){return new u(o.create)}static createMat4f64(){return new u(n.create)}static createQuatf64(){return new u(a.create)}get test(){}}t.VectorStack=u,Object.defineProperty(t,Symbol.toStringTag,{value:"Module"})}))},"esri/core/libs/gl-matrix-2/factories/vec2f64":function(){define(["exports"],(function(t){"use strict";function e(){return[0,0]}function r(t){return[t[0],t[1]]}function o(t,e){return[t,e]}function n(t,e){return[t,e]}function a(t,e=[0,0]){const r=Math.min(2,t.length);for(let o=0;o<r;++o)e[o]=t[o];return e}function i(){return[0,0]}function s(){return o(1,1)}function c(){return o(1,0)}function u(){return o(0,1)}const l=[0,0],f=s(),d=c(),p=u(),h=Object.freeze(Object.defineProperty({__proto__:null,ONES:f,UNIT_X:d,UNIT_Y:p,ZEROS:l,clone:r,create:e,freeze:n,fromArray:a,fromValues:o,ones:s,unitX:c,unitY:u,zeros:i},Symbol.toStringTag,{value:"Module"}));t.ONES=f,t.UNIT_X=d,t.UNIT_Y=p,t.ZEROS=l,t.clone=r,t.create=e,t.freeze=n,t.fromArray=a,t.fromValues=o,t.ones=s,t.unitX=c,t.unitY=u,t.vec2f64=h,t.zeros=i,Object.defineProperty(t,Symbol.toStringTag,{value:"Module"})}))},"esri/views/3d/support/mathUtils":function(){define(["exports","../../../core/mathUtils","../../../chunks/vec32","../../../core/libs/gl-matrix-2/factories/vec3f64"],(function(t,e,r,o){"use strict";const n=o.create(),a=o.create(),i=o.create(),s=o.create(),c=o.create();t.angle=function(t,o,n){t=r.normalize(s,t),o=r.normalize(c,o);const a=e.acosClamped(r.dot(t,o));if(n){const e=r.cross(i,t,o);if(r.dot(e,n)<0)return-a}return a},t.bilerp=function(t,e,r,o,n,a){const i=t+(e-t)*n;return i+(r+(o-r)*n-i)*a},t.cosCapped=function(t,e){return t>e?Math.cos(e):Math.cos(t)},t.fovx2fovy=function(t,e,r){return 2*Math.atan(r*Math.tan(.5*t)/e)},t.fovy2fovx=function(t,e,r){return 2*Math.atan(e*Math.tan(.5*t)/r)},t.makeOrthonormal=function(t,e,o){o=o||t;const n=r.dot(t,e);r.set(o,t[0]-n*e[0],t[1]-n*e[1],t[2]-n*e[2]),r.normalize(o,o)},t.makePiecewiseLinearFunction=function(t){const e=t.length;return r=>{if(r<=t[0][0])return t[0][1];if(r>=t[e-1][0])return t[e-1][1];let o=1;for(;r>t[o][0];)o++;const n=t[o-1][0],a=t[o][0],i=(a-r)/(a-n);return i*t[o-1][1]+(1-i)*t[o][1]}},t.maxScale=function(t){const e=t[0]*t[0]+t[4]*t[4]+t[8]*t[8],r=t[1]*t[1]+t[5]*t[5]+t[9]*t[9],o=t[2]*t[2]+t[6]*t[6]+t[10]*t[10];return Math.sqrt(Math.max(e,r,o))},t.midpoint3d=function(t,e){if(r.set(e,0,0,0),t.length>0){for(let o=0;o<t.length;++o)r.add(e,e,t[o]);r.scale(e,e,1/t.length)}},t.planeFromPoints=function(t,e,o,i){r.subtract(n,e,t),r.subtract(a,o,t),r.cross(i,n,a),r.normalize(i,i),i[3]=-r.dot(t,i)},t.scaleFromMatrix=function(t,e){const o=Math.sqrt(e[0]*e[0]+e[4]*e[4]+e[8]*e[8]),n=Math.sqrt(e[1]*e[1]+e[5]*e[5]+e[9]*e[9]),a=Math.sqrt(e[2]*e[2]+e[6]*e[6]+e[10]*e[10]);return r.set(t,o,n,a),t},t.slerp=function(t,e,n,a=o.create()){const i=r.length(t),u=r.length(e),l=r.dot(t,e)/(i*u);if(l<.9999999999999999){const o=Math.acos(l),f=((1-n)*i+n*u)/Math.sin(o),d=f/i*Math.sin((1-n)*o),p=f/u*Math.sin(n*o);return r.scale(s,t,d),r.scale(c,e,p),r.add(a,s,c)}return r.lerp(a,t,e,n)},t.slerpTangent=function(t,e,n,a=o.create(),i=o.create()){const u=r.length(t),l=r.length(e),f=r.dot(t,e)/(u*l);if(f<.9999999999999999){const o=Math.acos(f),d=Math.sin(o),p=Math.sin(n*o),h=Math.sin((1-n)*o),m=(1-n)*u+n*l;{const o=m/d,n=o/u*h,i=o/l*p;r.scale(s,t,n),r.scale(c,e,i),r.add(a,s,c)}{const a=1/u*(-Math.cos((1-n)*o)*o*m+h*(-u+l));r.scale(s,t,a);const f=1/l*(Math.cos(n*o)*o*m+p*(-u+l));r.scale(c,e,f),r.add(i,s,c),r.scale(i,i,1/d)}return i}return r.lerp(a,t,e,n),r.subtract(i,e,t),r.normalize(i,i),i},t.tangentFrame=function(t,e,o){Math.abs(t[0])>Math.abs(t[1])?r.set(e,0,1,0):r.set(e,1,0,0),r.cross(o,t,e),r.cross(e,o,t),r.normalize(o,o),r.normalize(e,e)},Object.defineProperty(t,Symbol.toStringTag,{value:"Module"})}))},"esri/views/ViewingMode":function(){define(["exports"],(function(t){"use strict";var e;t.ViewingMode=void 0,(e=t.ViewingMode||(t.ViewingMode={}))[e.Global=1]="Global",e[e.Local=2]="Local",t.stringFromViewingMode=function(e){return e===t.ViewingMode.Global?"global":"local"},t.viewingModeFromString=function(e){return"global"===e?t.ViewingMode.Global:t.ViewingMode.Local},Object.defineProperty(t,Symbol.toStringTag,{value:"Module"})}))},"esri/views/3d/support/dito":function(){define(["exports","../../../core/libs/gl-matrix-2/factories/mat3f64","../../../core/libs/gl-matrix-2/factories/quatf64","../../../core/libs/gl-matrix-2/factories/vec2f64","../../../chunks/vec32","../../../core/libs/gl-matrix-2/factories/vec3f64","../webgl-engine/lib/Attribute"],(function(t,e,r,o,n,a,i){"use strict";const s=1e-6,c=a.create(),u=a.create(),l=a.create(),f=a.create(),d=a.create(),p=a.create(),h=a.create(),m=a.create(),b=a.create(),g=a.create(),y=[0,0,0],M=o.create(),S=a.create(),I=a.create(),T=a.create(),_=a.create(),v=a.create(),A=a.create();function w(t,e,r,o,n,a){if($(e)<s)return;K(S,r,e),K(I,o,e),K(T,n,e),x(t,e,M),v[1]=M[0],_[1]=M[1],A[1]=_[1]-v[1];const i=[r,o,n],c=[S,I,T];for(let r=0;r<3;++r){x(t,i[r],M),v[0]=M[0],_[0]=M[1],x(t,c[r],M),v[2]=M[0],_[2]=M[1],A[0]=_[0]-v[0],A[2]=_[2]-v[2];const o=X(A);o<a.quality&&(H(a.b0,i[r]),H(a.b1,e),H(a.b2,c[r]),a.quality=o)}}const P=a.create();function x(t,e,r){const{data:o,size:n}=t;r[0]=Number.POSITIVE_INFINITY,r[1]=Number.NEGATIVE_INFINITY;for(let t=0;t<o.length;t+=n){const n=o[t]*e[0]+o[t+1]*e[1]+o[t+2]*e[2];r[0]=Math.min(r[0],n),r[1]=Math.max(r[1],n)}}function C(t,e,o){o.center=t,o.halfSize=n.scale(e,e,.5),o.quaternion=r.IDENTITY}const O=a.create(),E=a.create(),R=a.create(),N=a.create(),j=a.create(),U=a.create();function V(t,e,r){H(O,e),Math.abs(e[0])>Math.abs(e[1])&&Math.abs(e[0])>Math.abs(e[2])?O[0]=0:Math.abs(e[1])>Math.abs(e[2])?O[1]=0:O[2]=0,$(O)<s&&(O[0]=O[1]=O[2]=1),K(E,e,O),J(E,E),K(R,e,E),J(R,R),F(t,e,E,R,N,j),Z(U,j,N),B(e,E,R,N,j,U,r)}function F(t,e,r,o,n,a){x(t,e,M),n[0]=M[0],a[0]=M[1],x(t,r,M),n[1]=M[0],a[1]=M[1],x(t,o,M),n[2]=M[0],a[2]=M[1]}const q=a.create(),D=a.create(),L=a.create(),z=e.fromValues(1,0,0,0,1,0,0,0,1),k=r.create();function B(t,e,r,o,a,i,s){z[0]=t[0],z[1]=t[1],z[2]=t[2],z[3]=e[0],z[4]=e[1],z[5]=e[2],z[6]=r[0],z[7]=r[1],z[8]=r[2],s.quaternion=function(t,e){const r=e[0]+e[4]+e[8];if(r>0){let o=Math.sqrt(r+1);t[3]=.5*o,o=.5/o,t[0]=(e[5]-e[7])*o,t[1]=(e[6]-e[2])*o,t[2]=(e[1]-e[3])*o}else{let r=0;e[4]>e[0]&&(r=1),e[8]>e[3*r+r]&&(r=2);const o=(r+1)%3,n=(r+2)%3;let a=Math.sqrt(e[3*r+r]-e[3*o+o]-e[3*n+n]+1);t[r]=.5*a,a=.5/a,t[3]=(e[3*o+n]-e[3*n+o])*a,t[o]=(e[3*o+r]+e[3*r+o])*a,t[n]=(e[3*n+r]+e[3*r+n])*a}return t}(k,z),Q(q,o,a),W(q,q,.5),W(D,t,q[0]),W(L,e,q[1]),Q(D,D,L),W(L,r,q[2]),s.center=n.add(D,D,L),s.halfSize=n.scale(q,i,.5)}class G{constructor(t){this.minVert=new Array(7),this.maxVert=new Array(7),this.buffer=new ArrayBuffer(448);let e=0;this.minProj=new Float64Array(this.buffer,e,7),e+=56,this.maxProj=new Float64Array(this.buffer,e,7),e+=56;for(let t=0;t<7;++t)this.minVert[t]=new Float64Array(this.buffer,e,3),e+=24;for(let t=0;t<7;++t)this.maxVert[t]=new Float64Array(this.buffer,e,3),e+=24;for(let t=0;t<7;++t)this.minProj[t]=Number.POSITIVE_INFINITY,this.maxProj[t]=Number.NEGATIVE_INFINITY;const r=new Array(7),o=new Array(7),{data:n,size:a}=t;for(let t=0;t<n.length;t+=a){let e=n[t];e<this.minProj[0]&&(this.minProj[0]=e,r[0]=t),e>this.maxProj[0]&&(this.maxProj[0]=e,o[0]=t),e=n[t+1],e<this.minProj[1]&&(this.minProj[1]=e,r[1]=t),e>this.maxProj[1]&&(this.maxProj[1]=e,o[1]=t),e=n[t+2],e<this.minProj[2]&&(this.minProj[2]=e,r[2]=t),e>this.maxProj[2]&&(this.maxProj[2]=e,o[2]=t),e=n[t]+n[t+1]+n[t+2],e<this.minProj[3]&&(this.minProj[3]=e,r[3]=t),e>this.maxProj[3]&&(this.maxProj[3]=e,o[3]=t),e=n[t]+n[t+1]-n[t+2],e<this.minProj[4]&&(this.minProj[4]=e,r[4]=t),e>this.maxProj[4]&&(this.maxProj[4]=e,o[4]=t),e=n[t]-n[t+1]+n[t+2],e<this.minProj[5]&&(this.minProj[5]=e,r[5]=t),e>this.maxProj[5]&&(this.maxProj[5]=e,o[5]=t),e=n[t]-n[t+1]-n[t+2],e<this.minProj[6]&&(this.minProj[6]=e,r[6]=t),e>this.maxProj[6]&&(this.maxProj[6]=e,o[6]=t)}for(let t=0;t<7;++t){let e=r[t];H(this.minVert[t],n,e),e=o[t],H(this.maxVert[t],n,e)}}}class Y{constructor(){this.b0=a.fromValues(1,0,0),this.b1=a.fromValues(0,1,0),this.b2=a.fromValues(0,0,1),this.quality=0}}function X(t){return t[0]*t[1]+t[0]*t[2]+t[1]*t[2]}function Q(t,e,r){t[0]=e[0]+r[0],t[1]=e[1]+r[1],t[2]=e[2]+r[2]}function Z(t,e,r){t[0]=e[0]-r[0],t[1]=e[1]-r[1],t[2]=e[2]-r[2]}function W(t,e,r){t[0]=e[0]*r,t[1]=e[1]*r,t[2]=e[2]*r}function H(t,e,r=0){t[0]=e[r],t[1]=e[r+1],t[2]=e[r+2]}function K(t,e,r){const o=e[0],n=e[1],a=e[2],i=r[0],s=r[1],c=r[2];t[0]=n*c-a*s,t[1]=a*i-o*c,t[2]=o*s-n*i}function J(t,e){const r=e[0]*e[0]+e[1]*e[1]+e[2]*e[2];if(r>0){const o=1/Math.sqrt(r);t[0]=e[0]*o,t[1]=e[1]*o,t[2]=e[2]*o}}function $(t){return t[0]*t[0]+t[1]*t[1]+t[2]*t[2]}function tt(t,e){const r=e[0]-t[0],o=e[1]-t[1],n=e[2]-t[2];return r*r+o*o+n*n}function et(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]}t.computeOBB=function(t,e){const{data:r,size:o}=t,n=r.length/o;if(n<=0)return;const S=new G(t);Q(c,S.minProj,S.maxProj),W(c,c,.5),Z(u,S.maxProj,S.minProj);const I=X(u),T=new Y;T.quality=I,n<14&&(t=new i.Vertices(new Float64Array(S.buffer,112,42),3));const _=a.create(),v=a.create(),A=a.create(),x=a.create(),O=a.create(),E=a.create(),R=a.create();switch(function(t,e,r,o,n,a,i,c,u,l){if(function(t,e,r){let o=tt(t.maxVert[0],t.minVert[0]),n=0;for(let e=1;e<7;++e){const r=tt(t.maxVert[e],t.minVert[e]);r>o&&(o=r,n=e)}H(e,t.minVert[n]),H(r,t.maxVert[n])}(t,o,n),tt(o,n)<s)return 1;Z(i,o,n),J(i,i);const f=function(t,e,r,o){const{data:n,size:a}=t;let i=Number.NEGATIVE_INFINITY,s=0;for(let t=0;t<n.length;t+=a){y[0]=n[t]-e[0],y[1]=n[t+1]-e[1],y[2]=n[t+2]-e[2];const o=r[0]*y[0]+r[1]*y[1]+r[2]*y[2],a=r[0]*r[0]+r[1]*r[1]+r[2]*r[2],c=y[0]*y[0]+y[1]*y[1]+y[2]*y[2]-o*o/a;c>i&&(i=c,s=t)}return H(o,n,s),i}(e,o,i,a);return f<s?2:(Z(c,n,a),J(c,c),Z(u,a,o),J(u,u),K(r,c,i),J(r,r),w(e,r,i,c,u,l),0)}(S,t,R,_,v,A,x,O,E,T)){case 1:return void C(c,u,e);case 2:return void V(t,x,e)}!function(t,e,r,o,n,a,i,c,u){(function(t,e,r,o,n){!function(t,e,r,o,n){const{data:a,size:i}=t;H(o,a),H(n,o),r[0]=et(P,e),r[1]=r[0];for(let t=i;t<a.length;t+=i){const i=a[t]*e[0]+a[t+1]*e[1]+a[t+2]*e[2];i<r[0]&&(r[0]=i,H(o,a,t)),i>r[1]&&(r[1]=i,H(n,a,t))}}(t,e,M,n,o);const a=et(r,e);M[1]-s<=a&&(o[0]=void 0),M[0]+s>=a&&(n[0]=void 0)})(t,e,r,l,f),void 0!==l[0]&&(Z(d,l,r),J(d,d),Z(p,l,o),J(p,p),Z(h,l,n),J(h,h),K(m,p,a),J(m,m),K(b,h,i),J(b,b),K(g,d,c),J(g,g),w(t,m,a,p,d,u),w(t,b,i,h,p,u),w(t,g,c,d,h,u)),void 0!==f[0]&&(Z(d,f,r),J(d,d),Z(p,f,o),J(p,p),Z(h,f,n),J(h,h),K(m,p,a),J(m,m),K(b,h,i),J(b,b),K(g,d,c),J(g,g),w(t,m,a,p,d,u),w(t,b,i,h,p,u),w(t,g,c,d,h,u))}(t,R,_,v,A,x,O,E,T),F(t,T.b0,T.b1,T.b2,N,j);const U=a.create();Z(U,j,N),T.quality=X(U),T.quality<I?B(T.b0,T.b1,T.b2,N,j,U,e):C(c,u,e)},Object.defineProperty(t,Symbol.toStringTag,{value:"Module"})}))},"esri/views/3d/webgl-engine/lib/Attribute":function(){define(["exports"],(function(t){"use strict";class e{constructor(t,e,r=e){this.data=t,this.size=e,this.stride=r}}t.Attribute=class extends e{constructor(t,e,r,o=!1,n=r){super(t,r,n),this.indices=e,this.exclusive=o}},t.Vertices=e,Object.defineProperty(t,Symbol.toStringTag,{value:"Module"})}))},"*noref":1}}),define(["../../../core/arrayUtils","../../../core/typedArrayUtil","../../../core/libs/gl-matrix-2/math/quat","../../../core/libs/gl-matrix-2/factories/quatf64","../../../chunks/vec32","../../../core/libs/gl-matrix-2/factories/vec3f32","../../../geometry/SpatialReference","../../../geometry/projection/projectBuffer","./i3s/PointCloudWorkerUtil","../support/orientedBoundingBox"],(function(t,e,r,o,n,a,i,s,c,u){"use strict";class l{transform(t){const r=this._transform(t),o=[r.points.buffer,r.rgb.buffer];null!=r.pointIdFilterMap&&o.push(r.pointIdFilterMap.buffer);for(const t of r.attributes)"buffer"in t.values&&e.isArrayBuffer(t.values.buffer)&&t.values.buffer!==r.rgb.buffer&&o.push(t.values.buffer);return Promise.resolve({result:r,transferList:o})}_transform(e){const o=c.readGeometry(e.schema,e.geometryBuffer);let l=o.length/3,d=null;const p=new Array,h=c.getAttributeValues(e.primaryAttributeData,o,l);null!=e.primaryAttributeData&&h&&p.push({attributeInfo:e.primaryAttributeData.attributeInfo,values:h});const m=c.getAttributeValues(e.modulationAttributeData,o,l);null!=e.modulationAttributeData&&m&&p.push({attributeInfo:e.modulationAttributeData.attributeInfo,values:m});let b=c.evaluateRenderer(e.rendererInfo,h,m,l);if(e.filterInfo&&e.filterInfo.length>0&&null!=e.filterAttributesData){const r=e.filterAttributesData.filter(t.isSome).map((t=>{const e=c.getAttributeValues(t,o,l),r={attributeInfo:t.attributeInfo,values:e};return p.push(r),r}));d=new Uint32Array(l),l=c.filterInPlace(o,b,d,e.filterInfo,r)}for(const t of e.userAttributesData){const e=c.getAttributeValues(t,o,l);p.push({attributeInfo:t.attributeInfo,values:e})}3*l<b.length&&(b=new Uint8Array(b.buffer.slice(0,3*l))),function(t,e,r){if(0!==r)for(let o=0;o<e;o++)t[3*o+2]+=r}(o,l,e.elevationOffset);const g=function(t,e,o,i,c){if(!s.projectBuffer(t,i,0,t,c,0,e))throw new Error("Can't reproject");const u=a.clone(o.center),l=a.create(),d=a.create(),p=a.clone(o.halfSize);r.conjugate(f,o.quaternion);const h=new Float32Array(3*e);for(let r=0;r<e;r++){let e=3*r;l[0]=t[e]-u[0],l[1]=t[e+1]-u[1],l[2]=t[e+2]-u[2],n.transformQuat(d,l,f),p[0]=Math.max(p[0],Math.abs(d[0])),p[1]=Math.max(p[1],Math.abs(d[1])),p[2]=Math.max(p[2],Math.abs(d[2])),h[e++]=l[0],h[e++]=l[1],h[e]=l[2]}return o.halfSize=p,h}(o,l,u.Obb.fromData(e.obbData),i.fromJSON(e.inSR),i.fromJSON(e.outSR));return{obbData:e.obbData,points:g,rgb:b,attributes:p,pointIdFilterMap:d}}}const f=o.create();return function(){return new l}}));