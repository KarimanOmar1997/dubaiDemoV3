// All material copyright Esri, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.33/esri/copyright.txt for details.
//>>built
define(["exports","../../../../core/compilerUtils","../../../../symbols/support/ObjectSymbol3DLayerResource","./Graphics3DPathSymbolLayerConstants","./primitiveObjectSymbolUtils","./SymbolComplexity","../support/edgeUtils","../../webgl-engine/materials/DefaultMaterial"],(function(e,r,t,a,s,u,o,y){"use strict";const i=new u.EstimatedSymbolComplexity({});function l(e){let r=0,t=0,a=0,s=!1,o=0;const y=new u.SymbolComplexityMemory;for(const u of e)null!=u&&(r+=u.verticesPerFeature,t+=u.verticesPerCoordinate,a+=u.drawCallsPerFeature,y.bytesPerFeature+=u.memory.bytesPerFeature,y.bytesPerFeatureLabel+=u.memory.bytesPerFeatureLabel,y.resourceBytes+=u.memory.resourceBytes,y.draped.bytesPerFeature+=u.memory.bytesPerFeature,y.draped.bytesPerFeatureLabel+=u.memory.bytesPerFeatureLabel,s=s||u.estimated,++o);return s?new u.EstimatedAggregateSymbolComplexity(o,{verticesPerFeature:r,verticesPerCoordinate:t,drawCallsPerFeature:a,memory:y}):new u.AggregateSymbolComplexity(o,{verticesPerFeature:r,verticesPerCoordinate:t,drawCallsPerFeature:a,memory:y})}const b={};function m(e,s){const y=n(e,s),i=o.hasEdges(s)?2:0;switch(s.type){case"extrude":return new u.SymbolComplexity({verticesPerFeature:-12,verticesPerCoordinate:12,drawCallsPerFeature:i,memory:y});case"fill":if("mesh-3d"===e.type)return new u.SymbolComplexity({drawCallsPerFeature:i,memory:y});if(null!=s.outline&&s.outline.size>0)return new u.SymbolComplexity({verticesPerFeature:-12,verticesPerCoordinate:9,memory:y});case"water":return new u.SymbolComplexity({verticesPerFeature:-6,verticesPerCoordinate:3,memory:y});case"line":return new u.SymbolComplexity({verticesPerFeature:-6,verticesPerCoordinate:6,memory:y});case"object":return s.resource?.href?new u.EstimatedSymbolComplexity({verticesPerFeature:100,memory:y}):{...c(s.resource?.primitive??t.defaultPrimitive),memory:y};case"path":{let e=0,t=0;switch(s.profile){case"circle":e=a.pathNumCircleProfileSubdivisions;break;case"quad":e=4;break;default:return void r.neverReached(s.profile)}switch(s.join){case"round":t=a.pathNumRoundJoinSubdivisions;break;case"miter":case"bevel":t=1;break;default:return}const o=2*e,i=e*t*2,l=i+o;let b=-2*i-o;switch(s.cap){case"none":break;case"butt":case"square":b+=2*(e-1);break;case"round":b+=2*(e*(a.pathNumRoundCapExtrusionSubdivisions-1)*2+e);break;default:return}return new u.SymbolComplexity({verticesPerFeature:b,verticesPerCoordinate:l,memory:y})}case"text":{const r="label-3d"===e.type?0:2;return new u.SymbolComplexity({verticesPerFeature:6,memory:y,drawCallsPerFeature:r})}case"icon":return new u.SymbolComplexity({verticesPerFeature:6,memory:y});default:return}}function n(e,t){const a="point-3d"===e.type;switch(t.type){case"extrude":return t.edges&&t.edges.size>0?d.EXTRUDE_EDGES:d.EXTRUDE;case"fill":return null!=t.outline&&t.outline.size>0?d.FILL_OUTLINE:d.FILL;case"water":return d.FILL;case"line":return"round"===t.join?d.LINE_ROUND:d.LINE_MITER;case"path":switch(t.join){case"round":switch(t.profile){case"circle":return d.PATH_ROUND_CIRCLE;case"quad":return d.PATH_ROUND_QUAD;default:return void r.neverReached(t.profile)}case"miter":case"bevel":switch(t.profile){case"circle":return d.PATH_MITER_CIRCLE;case"quad":return d.PATH_MITER_QUAD;default:return void r.neverReached(t.profile)}default:return}case"object":return a?d.OBJECT_POINT:d.OBJECT_POLYGON;case"icon":case"text":return a?d.ICON_POINT:d.ICON_POLYGON;default:return}}function c(e){const r=b[e];if(r)return r;const t=P(s.primitiveLodResources(e,new y.DefaultMaterial({},{spherical:!0})).levels);return b[e]=new u.SymbolComplexity({verticesPerFeature:t}),b[e]}function P(e){return e.reduce(((e,r,t)=>e+r.numVertices*(1/10**t)),0)/e.reduce(((e,r,t)=>e+1/10**t),0)}const d={ICON_POINT:{bytesPerFeature:3062.2534325974652,bytesPerFeatureLabel:3605.891255,resourceBytes:0,draped:{bytesPerFeature:2029.6324697040875,bytesPerFeatureLabel:3844.951315}},ICON_POLYGON:{bytesPerFeature:3379.2552364427283,bytesPerFeatureLabel:3144.1341316666667,resourceBytes:0,draped:{bytesPerFeature:2594.5439970589305,bytesPerFeatureLabel:3391.0192816666668}},OBJECT_POINT:{bytesPerFeature:755.5754513856272,bytesPerFeatureLabel:3229.7766,resourceBytes:0,draped:{bytesPerFeature:755.5754513856272,bytesPerFeatureLabel:3229.7766}},OBJECT_POLYGON:{bytesPerFeature:1235.9612556276838,bytesPerFeatureLabel:2710.5796950000004,resourceBytes:0,draped:{bytesPerFeature:1235.9612556276838,bytesPerFeatureLabel:2710.5796950000004}},LINE_MITER:{bytesPerFeature:2343.0098144295366,bytesPerFeatureLabel:2863.2415183333333,resourceBytes:0,draped:{bytesPerFeature:2118.062960542706,bytesPerFeatureLabel:2993.8707950000003}},LINE_ROUND:{bytesPerFeature:3180.281669156425,bytesPerFeatureLabel:2884.062711666667,resourceBytes:0,draped:{bytesPerFeature:2687.1048133674676,bytesPerFeatureLabel:2965.844025}},PATH_MITER_CIRCLE:{bytesPerFeature:26642.015762630304,bytesPerFeatureLabel:3147.8341749999995,resourceBytes:0,draped:{bytesPerFeature:26642.015762630304,bytesPerFeatureLabel:3147.8341749999995}},PATH_ROUND_CIRCLE:{bytesPerFeature:21137.659435445064,bytesPerFeatureLabel:2827.1294000000003,resourceBytes:0,draped:{bytesPerFeature:21137.659435445064,bytesPerFeatureLabel:2827.1294000000003}},PATH_MITER_QUAD:{bytesPerFeature:25592.283303929427,bytesPerFeatureLabel:3354.641775,resourceBytes:0,draped:{bytesPerFeature:25592.283303929427,bytesPerFeatureLabel:3354.641775}},PATH_ROUND_QUAD:{bytesPerFeature:23212.92773696872,bytesPerFeatureLabel:3173.6644499999998,resourceBytes:0,draped:{bytesPerFeature:23212.92773696872,bytesPerFeatureLabel:3173.6644499999998}},FILL:{bytesPerFeature:3069.6014181747005,bytesPerFeatureLabel:3050.617135,resourceBytes:0,draped:{bytesPerFeature:2547.9765396831167,bytesPerFeatureLabel:3166.2821483333337}},FILL_OUTLINE:{bytesPerFeature:3653.779598313774,bytesPerFeatureLabel:2787.5897050000003,resourceBytes:0,draped:{bytesPerFeature:2884.528596112384,bytesPerFeatureLabel:2907.420548333333}},EXTRUDE:{bytesPerFeature:5785.658350054202,bytesPerFeatureLabel:2787.498365,resourceBytes:0,draped:{bytesPerFeature:5785.658350054202,bytesPerFeatureLabel:2787.498365}},EXTRUDE_EDGES:{bytesPerFeature:3380.451670091342,bytesPerFeatureLabel:2245.881308333333,resourceBytes:0,draped:{bytesPerFeature:3380.451670091342,bytesPerFeatureLabel:2245.881308333333}}};e.averageSymbolComplexities=function(e){const r=l(e);return r.numComplexities>0&&(r.verticesPerFeature/=r.numComplexities,r.verticesPerCoordinate/=r.numComplexities,r.drawCallsPerFeature/=r.numComplexities,r.memory.bytesPerFeature/=r.numComplexities,r.memory.bytesPerFeatureLabel/=r.numComplexities,r.memory.resourceBytes/=r.numComplexities,r.memory.draped.bytesPerFeature/=r.numComplexities,r.memory.draped.bytesPerFeatureLabel/=r.numComplexities),r},e.defaultSymbolComplexity=function(e){return"web-style"===e.type?i:l(e.symbolLayers.toArray().map((r=>m(e,r))))},e.defaultSymbolLayerComplexity=m,e.defaultSymbolLayerMemoryComplexity=n,e.emptySymbolComplexity=i,e.estimateNumVerticesForLods=P,e.totalSymbolComplexities=l,Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})}));