// All material copyright Esri, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.33/esri/copyright.txt for details.
//>>built
define(["exports","../../../../Graphic","../i3s/Intersector","../../webgl-engine/lib/IntersectorInterfaces","../../webgl-engine/lib/IntersectorResult","../../webgl-engine/lib/IntersectorType","../../webgl-engine/lib/RayIntersections"],(function(e,t,i,n,s,r,l){"use strict";e.Tiles3DIntersectionHandler=class{constructor(e){this.type=r.IntersectorType.TILES3D,this.slicePlaneEnabled=!1,this.isGround=!0,this.layerView=e,this.layerViewUid=e.uid}intersect(e,t,r,o,c,a){if(e.options.filteredLayerViewUids.includes(this.layerView.uid))return;const u=e.results,d=e.options.store===n.StoreResults.ALL,y=this.layerView.view.stage.renderView.componentObjectCollection,h=new l.MeshIntersectionOptions(a,e.options.normalRequired);this.layerView.objects.forEach((n=>{n.visible&&n.intersectionGeometry&&y.intersect(n,r,o,e.tolerance,null,h,((n,l,c,a)=>{if(l>=0){if(null!=t&&!t(r,o,l))return;const n=e=>{const t=new i.Tiles3DTarget(this.layerView.layer.uid,(()=>this._createTiles3DGraphic(this.layerView.layer,{})));e.set(this.type,t,l,c)};if(this.isGround&&(null==u.ground.distance||l<u.ground.distance)&&n(u.ground),e.options.isFiltered)return;if((null==u.min.distance||l<u.min.distance)&&n(u.min),(null==u.max.distance||l>u.max.distance)&&n(u.max),d){const t=new s.IntersectorResult(e.ray);n(t),e.results.all.push(t)}}}))}))}_createTiles3DGraphic(e,i){return new t({layer:e,sourceLayer:e,attributes:i})}},Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})}));