// All material copyright Esri, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.33/esri/copyright.txt for details.
//>>built
define(["exports","../../../../geometry/support/aaBoundingRect","../../../../geometry/support/DoubleArray","../../../../geometry/support/FloatArray","../../webgl-engine/lib/Attribute","../../webgl-engine/lib/Geometry","../../webgl-engine/lib/GeometryUtil","../../webgl-engine/lib/VertexAttribute"],(function(t,e,r,n,i,o,u,h){"use strict";function a(t,e){return u.createSquareGeometry(t,[[e[0],e[1],-1],[e[2],e[1],-1],[e[2],e[3],-1],[e[0],e[3],-1]])}const g=[0,0,1];t.computeImageExportSize=function(t,r,n){const i=e.width(t)/e.height(t),o={width:n,height:n};return i>1.0001?o.height=n/i:i<.9999&&(o.width=n*i),o.width=Math.round(o.width/(e.width(t)/e.width(r))),o.height=Math.round(o.height/(e.height(t)/e.height(r))),o},t.createGeometryForExtent=a,t.createOuterImageGeometry=function(t,u,l){if(!e.intersects(u,l))return a(t,l);const b=[u[1]-l[1],Math.min(u[3],l[3])-Math.max(u[1],l[1]),l[3]-u[3],123456],c=[u[0]-l[0],Math.min(u[2],l[2])-Math.max(u[0],l[0]),l[2]-u[2],123456],w=l[2]-l[0],m=l[3]-l[1],y=c[0]>0&&c[2]>0?3:2,A=b[0]>0&&b[2]>0?3:2,s=(A+1)*(y+1),d=r.newDoubleArray(3*s),f=n.newFloatArray(2*s),p=new Array(6*(A*y-1));let x=0,M=0,G=0,O=0,S=0;for(let t=0;t<4;t++){const e=b[t];if(e<=0)continue;let r=0;for(let e=0;e<4;e++){const n=c[e];n<=0||(d[M++]=l[0]+r,d[M++]=l[1]+x,d[M++]=-1,f[G++]=r/w,f[G++]=x/m,e<3&&t<3&&(1!==e||1!==t)&&(p[S++]=O,p[S++]=O+1,p[S++]=O+y+1,p[S++]=O+1,p[S++]=O+y+2,p[S++]=O+y+1),O++,r+=n)}x+=e}const V=new Array(p.length);return new o.Geometry(t,[[h.VertexAttribute.POSITION,new i.Attribute(d,p,3,!0)],[h.VertexAttribute.NORMAL,new i.Attribute(g,V,3,!0)],[h.VertexAttribute.UV0,new i.Attribute(f,p,2,!0)]])},Object.defineProperty(t,Symbol.toStringTag,{value:"Module"})}));