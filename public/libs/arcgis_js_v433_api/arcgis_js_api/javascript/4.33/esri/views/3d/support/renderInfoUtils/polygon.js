// All material copyright Esri, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.33/esri/copyright.txt for details.
//>>built
define(["exports","../../../../geometry/projection/projectBuffer","../../../../geometry/support/DoubleArray","../../../../geometry/support/triangulationUtils","../../layers/graphics/elevationAlignmentUtils","../../terrain/OverlayRenderer"],(function(o,e,n,t,i,s){"use strict";function r(o,e,t=null){return o.filter((({count:o})=>o>1)).map((({index:o,count:i})=>{const s=3*o,r=3*i;return null!=t?new p(o,i,n.doubleSubArray(e,s,r),n.doubleSubArray(t,s,r)):new u(o,i,n.doubleSubArray(e,s,r))}))}function l(o,e,t=null){const i=new Array;for(const{index:s,count:r,holeIndices:l,pathLengths:u}of o){if(r<=1)continue;const o=3*s,p=3*r,d=l.map((o=>o-s)),g=null!=t?new a(s,r,n.doubleSubArray(e,3*s,3*r),n.doubleSubArray(t,o,p),d,u):new c(s,r,n.doubleSubArray(e,3*s,3*r),d,u);i.push(g)}return i}class u{constructor(o,e,n){this.index=o,this.count=e,this.position=n}}class p extends u{constructor(o,e,n,t){super(o,e,n),this.mapPositions=t}}class a extends p{constructor(o,e,n,t,i,s){super(o,e,n,t),this.holeIndices=i,this.pathLengths=s}}class c extends u{constructor(o,e,n,t,i){super(o,e,n),this.holeIndices=t,this.pathLengths=i}}class d{constructor(o,e,n,t,i,s){this.position=o,this.mapPositions=e,this.polygons=n,this.outlines=t,this.projectionSuccess=i,this.sampledElevation=s}}o.PolygonRenderInfo=d,o.PolygonVertexData=a,o.PolygonVertexDataDraped=c,o.geometryToRenderInfo=function(o,e,s,u){const p=t.ringsToTriangulationInfo(o.rings,!!o.hasZ&&"on-the-ground"!==u.mode,t.CounterClockwiseMode.CCW_IS_HOLE,o.spatialReference),a=n.newDoubleArray(p.position.length),c=i.applyPerVertexElevationAlignment(p.position,o.spatialReference,0,a,0,p.position,0,p.position.length/3,e,s,u),g=null!=c;return new d(p.position,a,l(p.polygons,p.position,a),r(p.outlines,p.position,a),g,c)},o.geometryToRenderInfoDraped=function(o,n){const i=t.ringsToTriangulationInfo(o.rings,!1,t.CounterClockwiseMode.CCW_IS_HOLE),u=e.projectBuffer(i.position,o.spatialReference,0,i.position,n,0);for(let o=2;o<i.position.length;o+=3)i.position[o]=s.drapedZ;return{position:i.position,polygons:l(i.polygons,i.position),outlines:r(i.outlines,i.position),projectionSuccess:u}},Object.defineProperty(o,Symbol.toStringTag,{value:"Module"})}));