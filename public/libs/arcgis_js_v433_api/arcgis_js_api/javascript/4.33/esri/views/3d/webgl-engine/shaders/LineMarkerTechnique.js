// All material copyright Esri, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.33/esri/copyright.txt for details.
//>>built
define(["require","exports","../core/shaderLibrary/ShaderOutput","../core/shaderTechnique/ReloadableShaderModule","../core/shaderTechnique/ShaderTechnique","../lib/OrderIndependentTransparency","../lib/RenderSlot","../lib/StencilUtils","../lib/VertexAttribute","../../../../chunks/LineMarker.glsl","./LineMarkerTechniqueConfiguration","../../../webgl/renderState"],(function(e,t,i,r,l,n,s,a,u,o,c,p){"use strict";class d extends l.ShaderTechnique{constructor(t,i){super(t,i,new r.ReloadableShaderModule(o.LineMarker,(()=>new Promise(((t,i)=>e(["./LineMarker.glsl"],t,i))))),h)}_makePipelineState(e,t){const{output:r,oitPass:s,space:u,hasOccludees:o}=e;return p.makePipelineState({blending:i.isColorOrColorEmission(r)?n.blending(s):null,depthTest:u===c.LineMarkerSpace.Draped?null:{func:n.oitDepthTest(s)},depthWrite:n.depthWrite(e),drawBuffers:l.depthOnlyOutputBuffersOr(r,n.getDrawBuffers(s,r)),colorWrite:p.defaultColorWrite,stencilWrite:o?a.stencilWriteMaskOn:null,stencilTest:o?t?a.stencilToolMaskBaseParams:a.stencilBaseAllZerosParams:null,polygonOffset:{factor:0,units:-10}})}initializePipeline(e){return e.occluder?(this._occluderPipelineTransparent=p.makePipelineState({blending:p.unpremultipliedAlphaToPremultipliedAlpha,depthTest:a.depthCompareAlways,depthWrite:null,colorWrite:p.defaultColorWrite,stencilWrite:null,stencilTest:a.stencilToolTransparentOccluderParams}),this._occluderPipelineOpaque=p.makePipelineState({blending:p.unpremultipliedAlphaToPremultipliedAlpha,depthTest:a.depthCompareAlways,depthWrite:null,colorWrite:p.defaultColorWrite,stencilWrite:a.stencilWriteMaskOff,stencilTest:a.stencilToolMaskOccluderParams}),this._occluderPipelineMaskWrite=p.makePipelineState({blending:null,depthTest:a.depthCompareLess,depthWrite:null,colorWrite:null,stencilWrite:a.stencilWriteMaskOn,stencilTest:a.stencilToolMaskBaseParams})):this._occluderPipelineTransparent=this._occluderPipelineOpaque=this._occluderPipelineMaskWrite=null,this._occludeePipelineState=this._makePipelineState(e,!0),this._makePipelineState(e,!1)}getPipeline(e,t){return e?this._occludeePipelineState:t===s.RenderSlot.TRANSPARENT_OCCLUDER_MATERIAL?this._occluderPipelineTransparent??super.getPipeline():t===s.RenderSlot.OCCLUDER_MATERIAL?this._occluderPipelineOpaque??super.getPipeline():this._occluderPipelineMaskWrite??super.getPipeline()}}const h=new Map([[u.VertexAttribute.POSITION,0],[u.VertexAttribute.PREVIOUSDELTA,1],[u.VertexAttribute.UV0,2],[u.VertexAttribute.COLOR,3],[u.VertexAttribute.COLORFEATUREATTRIBUTE,3],[u.VertexAttribute.OPACITYFEATUREATTRIBUTE,4],[u.VertexAttribute.SIZE,5],[u.VertexAttribute.SIZEFEATUREATTRIBUTE,5],[u.VertexAttribute.NORMAL,6]]);t.LineMarkerTechnique=d,t.vertexAttributeLocations=h,Object.defineProperty(t,Symbol.toStringTag,{value:"Module"})}));