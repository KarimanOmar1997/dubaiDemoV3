// All material copyright Esri, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.33/esri/copyright.txt for details.
//>>built
require({cache:{"esri/views/View2D":function(){define(["require","../chunks/tslib.es6","../Viewpoint","../core/Collection","../core/CollectionFlattener","../core/Error","../core/has","../core/Logger","../core/maybe","../core/reactiveUtils","../core/workers/workers","../core/accessorSupport/decorators/property","../core/accessorSupport/decorators/cast","../core/RandomLCG","../core/accessorSupport/decorators/subclass","../core/accessorSupport/ensureType","../geometry/Polygon","../geometry/projectionUtils","../layers/support/TileInfo","./BreakpointsOwner","./DOMContainer","./PopupView","./View","./Viewport2DBaseMixin","./Viewport2DMixin","./2d/AnimationManager","./2d/layerViewModuleImportUtils","./2d/tiling/TileInfoView","./2d/tiling/TileKey","./2d/tiling/TileQueue","./2d/tiling/TileStrategy","./2d/viewpointUtils","./2d/engine/ManagedCanvas","./2d/layers/features/support/TileStore","./2d/layers/support/util","./2d/support/clippingUtils","./2d/support/highlightOptionsUtils","./2d/support/hitTestUtils","./2d/support/screenshotUtils","./2d/support/Timeline","./navigation/Navigation","./navigation/NavigationActionMap","./support/HighlightOptions","./support/WebGLRequirements","./ui/DefaultUI","./ui/2d/DefaultUI2D","../webmap/utils","../webmap/background/ColorBackground"],(function(e,t,i,r,o,n,s,a,l,c,u,h,d,p,m,g,_,f,y,w,v,T,S,b,E,M,x,P,R,A,I,C,D,O,L,N,F,k,U,G,V,z,B,H,W,j,Z,q){"use strict";let X,Y,K,$,Q,J,ee,te=class extends(E.Viewport2DMixin(b.Viewport2DBaseMixin(w.BreakpointsOwner(T.PopupView(v.DOMContainer(S)))))){constructor(e){super(e),this._magnifierView=null,this._gridView=null,this.stage=null,this._resolveWhenReady=[],this.rootLayerViews=new o({getCollections:()=>[this.basemapView?.baseLayerViews,this.layerViews,this.basemapView?.referenceLayerViews],getChildrenFunction:()=>null}),this.featuresTilingScheme=null,this.graphicsView=null,this.labelManager=null,this.navigation=new V({actionMap:new z({dragTertiary:"none"})}),this.renderingOptions={samplingMode:"dynamic",edgeLabelsVisible:!0,labelsAnimationTime:125,labelCollisionsEnabled:!0},this.supersampleScreenshotsEnabled=!0,this.supportsGround=!1,this.floors=new r,this.grid=null,this.map=null,this.spatialReferenceLocked=!1,this.timeline=new G.Timeline,this.type="2d",this.view2dType=null,this.ui=new j,this.test={takeScreenshot:async e=>U.takeRawScreenshot(this._getScreenshotView(e),e)},this.padding={top:0,right:0,bottom:0,left:0},u.initialize()}destroy(){this.layerViewManager.clear(),this._set("preconditionsReady",!1),this.frameTask=l.destroyMaybe(this.frameTask),this.goToManager.destroy(),this.rootLayerViews.destroy(),this.inputManager.destroy(),this._set("inputManager",null)}get graphicsTileStore(){return new O(this.featuresTilingScheme)}get constraintsInfo(){const e=this.defaultsFromMap?.tileInfo,t=this.spatialReference;return{lods:e?.spatialReference?.equals(t)?e.lods:null,spatialReference:t}}get initialExtentRequired(){if(!this.stateManager)return!1;const{scale:e,constraints:t,center:i,viewpoint:r,extent:o}=this;let n=this.zoom;return!(this.map&&"initialViewProperties"in this.map&&this.map.initialViewProperties?.viewpoint||o||(t?.effectiveLODs||(n=-1),i&&(0!==e||-1!==n)||null!=r?.targetGeometry&&("extent"===r.targetGeometry.type||r.scale)))}get defaultsFromMapSettings(){return{required:{extent:!1,heightModelInfo:!1,tileInfo:!0},requiresExtentInSpatialReference:this.spatialReferenceLocked}}get scheduler(){return this.frameTask.scheduler}get typeSpecificPreconditionsReady(){const e=this._getDefaultViewpoint();if(!e)return!1;const t=e.targetGeometry,i=this.spatialReference;return f.isLoadedOrLoadFor(t.spatialReference,i)}get background(){return Z.isWebMap(this.map)?this.map.initialViewProperties.background:null}set background(e){this._override("background",e)}get center(){return this.stateManager?.center??null}set center(e){this.stateManager.center=e}get highlightOptions(){return F.getDefaultHighlightOptions(this)}set highlightOptions(e){F.setDefaultHighlightOptions(this,e)}get padding(){return this.stateManager?.padding}set padding(e){this.stateManager&&(this.stateManager.padding=e)}get rendering(){return this.stage?.renderRequested??!1}get resolution(){return this.stateManager.resolution??0}get scale(){return this.stateManager?.scale??0}set scale(e){this.stateManager&&(this.stateManager.scale=e)}get tileInfo(){return this.featuresTilingScheme?.tileInfo}get updating(){const e=!(!this.magnifier.visible||null===this.magnifier.position||!this._magnifierView?.updatingHandles.updating),t=!this.destroyed&&(!this.layerViewManager||!this.labelManager||!this.graphicsView||!0===this.layerViewManager.updating||!0===this.labelManager.updating||!0===this.graphicsView.updating||this.allLayerViews.some((e=>!e.destroyed&&!("layerViews"in e)&&!0===e.updating))||e);if(s("esri-2d-log-updating")){const i=this.allLayerViews.reduce(((e,t)=>({...e,[`${t.layer.id}(${t.layer.type})`]:!t.destroyed&&!("layerViews"in t)&&t.updating})),{});console.log(`Updating MapView: ${t}\n-> Null LayerViewManager: ${!this.layerViewManager}\n-> Null LabelManager: ${!this.labelManager}\n-> Null GraphicsView: ${!this.graphicsView}\n-> layerViewManager.updating: ${this.layerViewManager?.updating}\n-> labelManager.updating: ${this.labelManager?.updating}\n-> graphicsView.updating: ${this.graphicsView?.updating}\n-> allLayerViews: ${JSON.stringify(i)}\n-> updatingMagnifier: ${e}\n`)}return t}get visibleArea(){const e=this.stateManager.visibleArea;return e?new _({rings:[e.map((e=>[e[0],e[1]]))],spatialReference:this.spatialReference}):e}get zoom(){return this.stateManager.zoom??-1}set zoom(e){this.stateManager.zoom=e}get navigating(){return this.mapViewNavigation?.interacting??!1}async hitTest(e,t){return k.hitTest(this,e,t)}async takeScreenshot(e){return U.takeScreenshot(this._getScreenshotView(e),e)}toScreen(e,t){return this.stateManager.toScreen(e,t)}whenLayerView(e){return super.whenLayerView(e)}graphicChanged(e){this.graphicsView&&this.graphicsView.graphicUpdateHandler(e)}whenReady(){return new Promise((e=>{this.ready?e(this):this._resolveWhenReady.push(e)}))}forceDOMReadyCycle(){this.forceReadyCycle()}getDefaultSpatialReference(){return this.map&&"initialViewProperties"in this.map&&this.map.initialViewProperties.spatialReference||this.defaultsFromMap?.spatialReference||null}getDefaultTimeZone(){return Z.isWebMap(this.map)?this.map.initialViewProperties.timeZone:null}getDefaultTimeExtent(){return Z.isWebMap(this.map)?this.map.initialViewProperties.timeExtent:null}hasLayerViewModule(e){return x.layerView2DImporter.hasLayerViewModule(e)}importLayerView(e){return x.layerView2DImporter.importLayerView(e)}pixelSizeAt(){return this.ready?this.resolution:(a.getLogger(this).error("#pixelSizeAt()","Map view cannot be used before it is ready"),null)}async popupHitTest(e){const t=this.toMap(e),i=await this.hitTest(e),r=this.allLayerViews.toArray().filter((i=>i.clips.every((i=>N.clipContainsPoint(this,i,e,t))))).reverse(),o=new globalThis.Map(r.map((e=>[e.layer.uid,e]))),n=[];let s=0,a=0;for(;s<i.results.length||a<r.length;){const e=i.results.at(s);if(e&&"graphic"!==e.type){++s;continue}const l=o.get((e?.layer??e?.graphic.layer)?.uid);if((!e||l)&&a<r.length&&r.at(a)!==l){const e=r.at(a);"fetchPopupFeaturesAtLocation"in e&&n.push({mapPoint:t,layerView:e}),++a}else e&&(n.push({graphic:e.graphic,layerView:l}),++s)}return{hits:n,location:t}}requestUpdate(){this.ready&&this.frameTask.requestUpdate()}async validate(){let e=H.check(this.type);if(s("safari")&&s("safari")<9&&(e=new n("mapview:browser-not-supported","This browser is not supported by MapView (Safari < 9)",{type:"safari",requiredVersion:9,detectedVersion:s("safari")})),null!=e){a.getLogger(this).warn("#validate()",e.message);const t=document.createElement("div");t.setAttribute("style","display: flex; flex-direction: column; gap: 8px; padding: 20px; height: 100%; justify-content: center; color: black; background: white; font-family: sans-serif;");const i=document.createElement("div");i.innerHTML="Unable to display map. WebGL2 support is required.",i.setAttribute("style","font-size: 24px; font-weight: bold;");const r=document.createElement("div");r.innerHTML="Ensure that your browser and hardware meet the minimum requirements.",r.setAttribute("style","font-size: 18px;");const o=document.createElement("a");throw o.innerHTML="https://esriurl.com/systemRequirements",o.target="_blank",o.setAttribute("style","font-size: 18px;"),o.href="https://esriurl.com/systemRequirements",t.appendChild(i),t.appendChild(r),t.appendChild(o),this.surface.appendChild(t),e}}loadAsyncDependencies(){return async function(){const[,{GraphicsView2D:t,GraphicContainer:i,LabelManager:r,MapViewNavigation:o,MagnifierView2D:n,GridView2D:s,Stage:a}]=await Promise.all([new Promise(((t,i)=>e(["./2d/webglDeps"],t,i))),new Promise(((t,i)=>e(["./2d/mapViewDeps"],t,i)))]);Y=t,K=i,$=r,Q=o,J=n,ee=s,X=a}()}_getDefaultViewpoint(){const{constraints:e,initialExtent:t,map:r,padding:o,size:n}=this;if(!e)return null;const s=r&&"initialViewProperties"in r?r.initialViewProperties:void 0,a=this.stateManager.getUserStartupOptions(this.size),l=s?.viewpoint,c=l?.targetGeometry?.extent??t,u=c?.center,h=l?.rotation??0,d=l?.scale||c&&C.extentToScale(c,[n[0]-o.left-o.right,n[1]-o.top-o.bottom]),p=a.center??u,m=a.rotation??h,g=a.scale??d;return p&&g?new i({targetGeometry:p,scale:g,rotation:m}):null}_startup(){this.timeline.begin("MapView Startup");const e=this._getDefaultViewpoint();this.stateManager.startup(e,this.size,this.spatialReference,this.defaultsFromMap.extent?.center),this.graphics.owner=this;const t=new D.ManagedCanvas(this.surface),i=new X(this.surface,{canvas:this.renderCanvas,contextOptions:{disabledExtensions:this.deactivatedWebGLExtensions,debugWebGLExtensions:this.debugWebGLExtensions},renderingOptions:this.renderingOptions,timeline:this.timeline},t);this.stage=i,this._magnifierView=new J,this._magnifierView.magnifier=this.magnifier,this._gridView=new ee;const r=new $({view:this});this._set("labelManager",r);const o=new M({view:this});this._set("animationManager",o);const n=new Q({view:this,animationManager:o});this._set("mapViewNavigation",n),this._setupSpatialReferenceDependentProperties(),this.addHandles([this.rootLayerViews.on("change",(()=>this._updateStageChildren())),i.on("webgl-error",(e=>this.fatalError=e.error)),c.watch((()=>this.stationary),(e=>i.stationary=e),c.syncAndInitial),c.watch((()=>this.background),(e=>{i.backgroundColor=e?.color,this._magnifierView.backgroundColor=e?.color}),c.syncAndInitial),c.watch((()=>this.magnifier),(e=>this._magnifierView.magnifier=e),c.syncAndInitial),c.watch((()=>this.grid),(e=>this._gridView.grid=e),c.syncAndInitial),c.watch((()=>this.renderingOptions),(e=>i.renderingOptions=e),c.syncAndInitial),c.watch((()=>this.highlights.items.map((e=>({name:e.name,options:{fillColor:e.color,haloColor:e.haloColor,fillOpacity:e.fillOpacity,haloOpacity:e.haloOpacity,haloWidth:e.haloWidth,haloBlur:e.haloBlur}})))),(()=>{i.highlightGradient=L.createOrReuseHighlightGradient(i.highlightGradient,this.highlights.items)}),c.syncAndInitial),c.watch((()=>this.state.id),(()=>i.state=this.state),c.syncAndInitial)],"map-view"),this._updateStageChildren();const s=this._resolveWhenReady;this._resolveWhenReady=[],s.forEach((e=>e(this))),this.timeline.end("MapView Startup"),this.frameTask.start(),this._set("ready",!0)}_teardown(){this._destroySpatialReferenceDependentProperties(),this.removeHandles("map-view"),this.mapViewNavigation.destroy(),this._set("mapViewNavigation",null),this.animation=null,this.animationManager.destroy(),this._set("animationManager",null),this.layerViewManager.clear(),this.labelManager.destroy(),this._magnifierView.destroy(),this._gridView.destroy(),this.stage.destroy(),this.stage=null,this._set("graphicsView",null),this._magnifierView=null,this._gridView=null,this._set("labelManager",null),this._set("mapViewNavigation",null),this.graphics.owner=null,this.frameTask.stop(),this.stationaryManager.clear(),this._set("ready",!1),this.stateManager.teardown()}_updateStageChildren(){this.stage.removeAllChildren(),this.rootLayerViews.forEach((e=>{this.stage.addChild(e.container)}));const e=this.graphicsView;this.stage.addChild(e.container),this.stage.addChild(this._magnifierView),this.stage.addChild(this._gridView)}_setupSpatialReferenceDependentProperties(){const e=new P(y.create({spatialReference:this.spatialReference,size:512,numLODs:36}));this._set("featuresTilingScheme",e);const t=new Y({view:this,graphics:this.graphics,requestUpdateCallback:()=>this.requestUpdate(),container:new K(e)});this._set("graphicsView",t)}_destroySpatialReferenceDependentProperties(){const e=this.graphicsView;this._set("graphicsView",null),e.destroy(),this._set("featuresTilingScheme",null)}_getScreenshotView(e){const{allLayerViews:t,padding:i,size:r,stage:o}=this;return{allLayerViews:t,backgroundColor:e?.ignoreBackground?null:this.background?.color,padding:i,size:r,stage:o}}_spatialReferenceChanged(e){if(this.ready){this.frameTask.stop();for(const e of this.allLayerViews)e.processDetach();this._destroySpatialReferenceDependentProperties(),this.stateManager.changeSpatialReference(e),this.stage.state=this.state,this._setupSpatialReferenceDependentProperties();for(const e of this.allLayerViews)e.processAttach();this.frameTask.requestFrame(),this.frameTask.start(),this._updateStageChildren()}}static{this.type="2d"}};return t.__decorate([h.property({constructOnly:!0})],te.prototype,"deactivatedWebGLExtensions",void 0),t.__decorate([h.property({constructOnly:!0})],te.prototype,"debugWebGLExtensions",void 0),t.__decorate([h.property({readOnly:!0})],te.prototype,"featuresTilingScheme",void 0),t.__decorate([h.property({readOnly:!0})],te.prototype,"graphicsTileStore",null),t.__decorate([h.property()],te.prototype,"graphicsView",void 0),t.__decorate([h.property()],te.prototype,"constraintsInfo",null),t.__decorate([h.property()],te.prototype,"initialExtentRequired",null),t.__decorate([h.property()],te.prototype,"labelManager",void 0),t.__decorate([h.property({type:V,nonNullable:!0})],te.prototype,"navigation",void 0),t.__decorate([h.property({constructOnly:!0})],te.prototype,"renderCanvas",void 0),t.__decorate([h.property()],te.prototype,"renderingOptions",void 0),t.__decorate([h.property({constructOnly:!0})],te.prototype,"supersampleScreenshotsEnabled",void 0),t.__decorate([h.property({readOnly:!0})],te.prototype,"supportsGround",void 0),t.__decorate([h.property()],te.prototype,"defaultsFromMapSettings",null),t.__decorate([h.property({readOnly:!0})],te.prototype,"typeSpecificPreconditionsReady",null),t.__decorate([h.property({type:q})],te.prototype,"background",null),t.__decorate([h.property()],te.prototype,"center",null),t.__decorate([h.property({type:r})],te.prototype,"floors",void 0),t.__decorate([h.property()],te.prototype,"grid",void 0),t.__decorate([h.property({type:B})],te.prototype,"highlightOptions",null),t.__decorate([h.property()],te.prototype,"map",void 0),t.__decorate([h.property()],te.prototype,"padding",null),t.__decorate([h.property({readOnly:!0})],te.prototype,"rendering",null),t.__decorate([h.property({readOnly:!0})],te.prototype,"resolution",null),t.__decorate([h.property()],te.prototype,"scale",null),t.__decorate([h.property({constructOnly:!0})],te.prototype,"spatialReferenceLocked",void 0),t.__decorate([h.property({readOnly:!0})],te.prototype,"tileInfo",null),t.__decorate([h.property({type:G.Timeline,readOnly:!0})],te.prototype,"timeline",void 0),t.__decorate([h.property({readOnly:!0})],te.prototype,"type",void 0),t.__decorate([h.property({readOnly:!0})],te.prototype,"updating",null),t.__decorate([h.property({readOnly:!0})],te.prototype,"view2dType",void 0),t.__decorate([h.property({readOnly:!0})],te.prototype,"visibleArea",null),t.__decorate([h.property()],te.prototype,"zoom",null),t.__decorate([h.property({readOnly:!0})],te.prototype,"navigating",null),t.__decorate([h.property(),d.cast((e=>e instanceof W?e:g.ensureClass(j,e)))],te.prototype,"ui",void 0),te=t.__decorate([m.subclass("esri.views.View2D")],te),te}))},"esri/layers/support/TileInfo":function(){define(["exports","../../chunks/tslib.es6","../../core/jsonMap","../../core/JSONSupport","../../core/unitUtils","../../core/accessorSupport/decorators/property","../../core/accessorSupport/ensureType","../../core/has","../../core/RandomLCG","../../core/accessorSupport/decorators/reader","../../core/accessorSupport/decorators/subclass","../../core/accessorSupport/decorators/writer","../../geometry/Point","../../geometry/SpatialReference","../../geometry/support/aaBoundingRect","../../geometry/support/spatialReferenceUtils","../../geometry/support/webMercatorUtils","./LOD","./TileKey"],(function(e,t,i,r,o,n,s,a,l,c,u,h,d,p,m,g,_,f,y){"use strict";var w;const v=new i.JSONMap({PNG:"png",PNG8:"png8",PNG24:"png24",PNG32:"png32",JPEG:"jpg",JPG:"jpg",DIB:"dib",TIFF:"tiff",EMF:"emf",PS:"ps",PDF:"pdf",GIF:"gif",SVG:"svg",SVGZ:"svgz",Mixed:"mixed",MIXED:"mixed",LERC:"lerc",LERC2D:"lerc2d",RAW:"raw",pbf:"pbf"});var T,S;return e.default=class extends r{static{w=this}static create(e={}){const{resolutionFactor:t=1,scales:i,size:r=256,spatialReference:n=p.WebMercator,numLODs:s=24}=e;if(!g.isValid(n)){const e=[];if(i)for(let t=0;t<i.length;t++){const r=i[t];e.push(new f({level:t,scale:r,resolution:r}))}else{let t=5e-4;for(let i=s-1;i>=0;i--)e.unshift(new f({level:i,scale:t,resolution:t})),t*=2}return new w({dpi:96,lods:e,origin:new d(0,0,n),size:[r,r],spatialReference:n})}const a=g.getInfo(n),l=e.origin?new d({x:e.origin.x,y:e.origin.y,spatialReference:n}):new d(a?{x:a.origin[0],y:a.origin[1],spatialReference:n}:{x:0,y:0,spatialReference:n}),c=1/(39.37*o.getMetersPerUnitForSR(n)*96),u=[];if(i)for(let e=0;e<i.length;e++){const t=i[e],r=t*c;u.push(new f({level:e,scale:t,resolution:r}))}else{let e=g.isGeographic(n)?512/r*591657527.5917094:256/r*591657527.591555;const i=Math.ceil(s/t);u.push(new f({level:0,scale:e,resolution:e*c}));for(let r=1;r<i;r++){const i=e/2**t,o=i*c;u.push(new f({level:r,scale:i,resolution:o})),e=i}}return new w({dpi:96,lods:u,origin:l,size:[r,r],spatialReference:n})}constructor(e){super(e),this.dpi=96,this.format=null,this.origin=null,this.size=null,this.spatialReference=null}get isWrappable(){const{spatialReference:e,origin:t}=this;if(e&&t){const i=g.getInfo(e);return e.isWrappable&&!!i&&Math.abs(i.origin[0]-t.x)<=i.dx}return!1}readOrigin(e,t){return d.fromJSON({spatialReference:t.spatialReference,...e})}set lods(e){let t=0,i=0;const r=[],o=this._levelToLOD={};e&&(t=-1/0,i=1/0,e.forEach((e=>{r.push(e.scale),t=e.scale>t?e.scale:t,i=e.scale<i?e.scale:i,o[e.level]=e}))),this._set("scales",r),this._set("lods",e),this._initializeUpsampleLevels()}readSize(e,t){return[t.cols,t.rows]}writeSize(e,t){t.cols=e[0],t.rows=e[1]}zoomToScale(e){const t=this.scales;if(e<=0)return t[0];if(e>=t.length-1)return t[t.length-1];const i=Math.floor(e),r=i+1;return t[i]/(t[i]/t[r])**(e-i)}scaleToZoom(e){const t=this.scales,i=t.length-1;let r=0;for(;r<i;r++){const i=t[r],o=t[r+1];if(i<=e)return r;if(o===e)return r+1;if(i>e&&o<e)return r+Math.log(i/e)/Math.log(i/o)}return r}tileAt(e,t,i,r){const o=this.lodAt(e);if(!o)return null;let n,s;if("number"==typeof t)n=t,s=i;else if(g.equals(t.spatialReference,this.spatialReference))n=t.x,s=t.y,r=i;else{const e=_.project(t,this.spatialReference);if(null==e)return null;n=e.x,s=e.y,r=i}const a=o.resolution*this.size[0],l=o.resolution*this.size[1];return r||(r=new y.TileKey(null,0,0,0,m.create())),r.level=e,r.row=Math.floor((this.origin.y-s)/l+.001),r.col=Math.floor((n-this.origin.x)/a+.001),this.updateTileInfo(r),r}updateTileInfo(e,t=w.ExtrapolateOptions.NONE){let i=this.lodAt(e.level);if(!i&&t===w.ExtrapolateOptions.POWER_OF_TWO){const t=this.lods[this.lods.length-1];t.level<e.level&&(i=t)}if(!i)return;const r=e.level-i.level,o=i.resolution*this.size[0]/2**r,n=i.resolution*this.size[1]/2**r;e.id=`${e.level}/${e.row}/${e.col}`,e.extent||(e.extent=m.create()),e.extent[0]=this.origin.x+e.col*o,e.extent[1]=this.origin.y-(e.row+1)*n,e.extent[2]=e.extent[0]+o,e.extent[3]=e.extent[1]+n}upsampleTile(e){const t=this._upsampleLevels[e.level];return!(!t||-1===t.parentLevel||(e.level=t.parentLevel,e.row=Math.floor(e.row/t.factor+.001),e.col=Math.floor(e.col/t.factor+.001),this.updateTileInfo(e),0))}getTileBounds(e,t){const i=this.lodAt(t.level);if(null==i)return null;const{resolution:r}=i,o=r*this.size[0],n=r*this.size[1];return e[0]=this.origin.x+t.col*o,e[1]=this.origin.y-(t.row+1)*n,e[2]=e[0]+o,e[3]=e[1]+n,e}lodAt(e){return this._levelToLOD?.[e]??null}clone(){return w.fromJSON(this.write({}))}getCompatibleForVTL(e){if(this.size[0]!==this.size[1]||256===this.size[0]&&512===e)return null;const t=(512===this.size[0]&&256===e?-1:0)+(this.spatialReference.isGeographic?1:0);if(this.size[0]===e&&0===t)return this;const i=[],r=this.lods.length-t;for(let e=0;e<r;e++){const r=e+t,{scale:o,resolution:n}=r>=0?this.lods[r]:{scale:2*this.lods[0].scale,resolution:2*this.lods[0].resolution};i.push(new f({level:e,scale:o,resolution:n}))}return new w({size:[e,e],dpi:this.dpi,format:this.format,compressionQuality:this.compressionQuality,origin:this.origin,spatialReference:this.spatialReference,lods:i})}_initializeUpsampleLevels(){const e=this.lods;this._upsampleLevels=[];let t=null;for(let i=0;i<e.length;i++){const r=e[i];this._upsampleLevels[r.level]={parentLevel:t?t.level:-1,factor:t?t.resolution/r.resolution:0},t=r}}},t.__decorate([n.property({type:Number,json:{write:!0}})],e.default.prototype,"compressionQuality",void 0),t.__decorate([n.property({type:Number,json:{write:!0}})],e.default.prototype,"dpi",void 0),t.__decorate([n.property({type:String,json:{read:v.read,write:v.write,origins:{"web-scene":{read:!1,write:!1}}}})],e.default.prototype,"format",void 0),t.__decorate([n.property({readOnly:!0})],e.default.prototype,"isWrappable",null),t.__decorate([n.property({type:d,json:{write:!0}})],e.default.prototype,"origin",void 0),t.__decorate([c.reader("origin")],e.default.prototype,"readOrigin",null),t.__decorate([n.property({type:[f],value:null,json:{write:!0}})],e.default.prototype,"lods",null),t.__decorate([n.property({readOnly:!0})],e.default.prototype,"scales",void 0),t.__decorate([n.property({cast:e=>Array.isArray(e)?e:"number"==typeof e?[e,e]:[256,256]})],e.default.prototype,"size",void 0),t.__decorate([c.reader("size",["rows","cols"])],e.default.prototype,"readSize",null),t.__decorate([h.writer("size",{cols:{type:s.Integer},rows:{type:s.Integer}})],e.default.prototype,"writeSize",null),t.__decorate([n.property({type:p,json:{write:!0}})],e.default.prototype,"spatialReference",void 0),e.default=w=t.__decorate([u.subclass("esri.layers.support.TileInfo")],e.default),(S=(T=e.default||(e.default={})).ExtrapolateOptions||(T.ExtrapolateOptions={}))[S.NONE=0]="NONE",S[S.POWER_OF_TWO=1]="POWER_OF_TWO",e.default}))},"esri/layers/support/LOD":function(){define(["exports","../../chunks/tslib.es6","../../core/JSONSupport","../../core/accessorSupport/decorators/property","../../core/accessorSupport/ensureType","../../core/has","../../core/RandomLCG","../../core/accessorSupport/decorators/subclass"],(function(e,t,i,r,o,n,s,a){"use strict";var l;return e.default=class extends i{static{l=this}constructor(e){super(e),this.cols=null,this.level=0,this.levelValue=null,this.origin=null,this.resolution=0,this.rows=null,this.scale=0}clone(){return new l({cols:this.cols,level:this.level,levelValue:this.levelValue,resolution:this.resolution,rows:this.rows,scale:this.scale})}},t.__decorate([r.property({json:{write:!0,origins:{"web-document":{read:!1,write:!1},"portal-item":{read:!1,write:!1}}}})],e.default.prototype,"cols",void 0),t.__decorate([r.property({type:o.Integer,json:{write:!0}})],e.default.prototype,"level",void 0),t.__decorate([r.property({type:String,json:{write:!0}})],e.default.prototype,"levelValue",void 0),t.__decorate([r.property({json:{write:!0,origins:{"web-document":{read:!1,write:!1},"portal-item":{read:!1,write:!1}}}})],e.default.prototype,"origin",void 0),t.__decorate([r.property({type:Number,json:{write:!0}})],e.default.prototype,"resolution",void 0),t.__decorate([r.property({json:{write:!0,origins:{"web-document":{read:!1,write:!1},"portal-item":{read:!1,write:!1}}}})],e.default.prototype,"rows",void 0),t.__decorate([r.property({type:Number,json:{write:!0}})],e.default.prototype,"scale",void 0),e.default=l=t.__decorate([a.subclass("esri.layers.support.LOD")],e.default),e.default}))},"esri/layers/support/TileKey":function(){define(["exports"],(function(e){"use strict";e.TileKey=class{constructor(e,t,i,r,o=void 0){this.id=e,this.level=t,this.row=i,this.col=r,this.extent=o}},Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})}))},"esri/views/BreakpointsOwner":function(){define(["exports","../chunks/tslib.es6","../core/ArrayPool","../core/reactiveUtils","../core/accessorSupport/decorators/property","../core/has","../core/Logger","../core/RandomLCG","../core/accessorSupport/decorators/subclass"],(function(e,t,i,r,o,n,s,a,l){"use strict";const c={widthBreakpoint:{getValue(e){const t=e.viewSize[0],i=e.breakpoints,r=this.values;return t<=i.xsmall?r.xsmall:t<=i.small?r.small:t<=i.medium?r.medium:t<=i.large?r.large:r.xlarge},values:{xsmall:"xsmall",small:"small",medium:"medium",large:"large",xlarge:"xlarge"},valueToClassName:{xsmall:"esri-view-width-xsmall esri-view-width-less-than-small esri-view-width-less-than-medium esri-view-width-less-than-large esri-view-width-less-than-xlarge",small:"esri-view-width-small esri-view-width-greater-than-xsmall esri-view-width-less-than-medium esri-view-width-less-than-large esri-view-width-less-than-xlarge",medium:"esri-view-width-medium esri-view-width-greater-than-xsmall esri-view-width-greater-than-small esri-view-width-less-than-large esri-view-width-less-than-xlarge",large:"esri-view-width-large esri-view-width-greater-than-xsmall esri-view-width-greater-than-small esri-view-width-greater-than-medium esri-view-width-less-than-xlarge",xlarge:"esri-view-width-xlarge esri-view-width-greater-than-xsmall esri-view-width-greater-than-small esri-view-width-greater-than-medium esri-view-width-greater-than-large"}},heightBreakpoint:{getValue(e){const t=e.viewSize[1],i=e.breakpoints,r=this.values;return t<=i.xsmall?r.xsmall:t<=i.small?r.small:t<=i.medium?r.medium:t<=i.large?r.large:r.xlarge},values:{xsmall:"xsmall",small:"small",medium:"medium",large:"large",xlarge:"xlarge"},valueToClassName:{xsmall:"esri-view-height-xsmall esri-view-height-less-than-small esri-view-height-less-than-medium esri-view-height-less-than-large esri-view-height-less-than-xlarge",small:"esri-view-height-small esri-view-height-greater-than-xsmall esri-view-height-less-than-medium esri-view-height-less-than-large esri-view-height-less-than-xlarge",medium:"esri-view-height-medium esri-view-height-greater-than-xsmall esri-view-height-greater-than-small esri-view-height-less-than-large esri-view-height-less-than-xlarge",large:"esri-view-height-large esri-view-height-greater-than-xsmall esri-view-height-greater-than-small esri-view-height-greater-than-medium esri-view-height-less-than-xlarge",xlarge:"esri-view-height-xlarge esri-view-height-greater-than-xsmall esri-view-height-greater-than-small esri-view-height-greater-than-medium esri-view-height-greater-than-large"}},orientation:{getValue(e){const t=e.viewSize,i=t[0],r=t[1],o=this.values;return r>=i?o.portrait:o.landscape},values:{portrait:"portrait",landscape:"landscape"},valueToClassName:{portrait:"esri-view-orientation-portrait",landscape:"esri-view-orientation-landscape"}}},u={xsmall:544,small:768,medium:992,large:1200};function h(e,t){return t?c[e].valueToClassName[t].split(" "):[]}e.BreakpointsOwner=e=>{let n=class extends e{constructor(...e){super(...e),this.orientation=null,this.widthBreakpoint=null,this.heightBreakpoint=null,this.breakpoints=u}initialize(){this.addHandles(r.watch((()=>[this.breakpoints,this.size]),(()=>this._updateClassNames()),r.initial))}destroy(){this.destroyed||this._removeActiveClassNames()}set breakpoints(e){if(e!==this._get("breakpoints")){if(!function(e){const t=e;return t&&t.xsmall<t.small&&t.small<t.medium&&t.medium<t.large}(e)){const t=JSON.stringify(u,null,2);console.warn("provided breakpoints are not valid, using defaults:"+t),e=u}this._set("breakpoints",{...e})}}_updateClassNames(){if(!this.container)return;const e=i.acquire(),t=i.acquire();let r,o=!1;for(r in c){const i=this[r],n=c[r].getValue({viewSize:this.size,breakpoints:this.breakpoints});i!==n&&(o=!0,this[r]=n,h(r,i).forEach((e=>t.push(e))),h(r,n).forEach((t=>e.push(t))))}o&&(this._applyClassNameChanges(e,t),i.release(e),i.release(t))}_applyClassNameChanges(e,t){const i=this.container;i&&(t.forEach((e=>i.classList.remove(e))),e.forEach((e=>i.classList.add(e))))}_removeActiveClassNames(){const e=this.container;if(!e)return;let t;for(t in c)h(t,this[t]).forEach((t=>e.classList.remove(t)))}};return t.__decorate([o.property()],n.prototype,"breakpoints",null),t.__decorate([o.property()],n.prototype,"orientation",void 0),t.__decorate([o.property()],n.prototype,"widthBreakpoint",void 0),t.__decorate([o.property()],n.prototype,"heightBreakpoint",void 0),n=t.__decorate([l.subclass("esri.views.BreakpointsOwner")],n),n},Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})}))},"esri/views/DOMContainer":function(){define(["exports","../chunks/tslib.es6","../core/domUtils","../core/events","../core/handleUtils","../core/Logger","../core/maybe","../core/reactiveUtils","../core/scheduling","../core/accessorSupport/decorators/property","../core/has","../core/RandomLCG","../core/accessorSupport/decorators/subclass","./overlay/ViewOverlay"],(function(e,t,i,r,o,n,s,a,l,c,u,h,d,p){"use strict";const m=[0,0];function g(e){const t=(e.ownerDocument||window.document).defaultView,i=e.getBoundingClientRect();return m[0]=i.left+(t?.pageXOffset??0),m[1]=i.top+(t?.pageYOffset??0),m}function _(e){e&&(e.textContent="",e.parentNode&&e.parentNode.removeChild(e))}const f=16,y=750;e.DOMContainer=e=>{let u=class extends e{constructor(...e){super(...e),this._freqInfo={freq:f,time:y},this._overlayRenderTaskHandle=null,this.height=0,this.messagesCommon=null,this.overlay=null,this.position=null,this.resizing=!1,this.root=null,this.surface=null,this.suspended=!0,this.userContent=null,this.width=0,this.widthBreakpoint=null,this.addHandles([a.watch((()=>this.cursor),(e=>{const{surface:t}=this;t&&t.setAttribute("data-cursor",e)})),a.watch((()=>this.navigating),(e=>{const{surface:t}=this;t&&t.setAttribute("data-navigating",e.toString())}))])}initialize(){this.addHandles([a.watch((()=>this.ui),((e,t)=>this._handleUIChange(e,t)),a.initial),this.on("focus",(()=>this.notifyChange("focused"))),this.on("blur",(()=>this.notifyChange("focused")))])}destroy(){this.destroyed||(this.ui?.destroy(),this.container=null)}get container(){return this._get("container")??null}set container(e){const t=this._get("container"),r=i.byId(e);if(r||"string"!=typeof e||n.getLogger(this).error("#container",`element with id '${e}' not found`),t===r)return;if(this._stopMeasuring(),t&&(t.classList.remove("esri-view"),this._overlayRenderTaskHandle&&(this._overlayRenderTaskHandle.remove(),this._overlayRenderTaskHandle=null),this.overlay&&(this.overlay.destroy(),this._set("overlay",null)),this.root&&(_(this.root),this._set("root",null)),this.userContent&&(i.reparent(this.userContent,t),_(this.userContent),this._set("userContent",null))),!r)return this._set("width",0),this._set("height",0),this._set("position",null),this._set("suspended",!0),this._set("surface",null),void this._set("container",null);r.classList.add("esri-view");const o=document.createElement("div");o.className="esri-view-user-storage",i.reparent(r,o),r.appendChild(o),this._set("userContent",o);const c=document.createElement("div");c.className="esri-view-root",r.insertBefore(c,r.firstChild),this._set("root",c);const u=document.createElement("div");u.className="esri-view-surface",u.setAttribute("role","application"),u.tabIndex=0,c.appendChild(u),this._set("surface",u);const h=new p;c.appendChild(h.surface),this._set("overlay",h),this.addHandles(a.watch((()=>h.needsRender),(e=>{e&&!this._overlayRenderTaskHandle?this._overlayRenderTaskHandle=l.addFrameTask({render:()=>this.overlay?.render()}):this._overlayRenderTaskHandle=s.removeMaybe(this._overlayRenderTaskHandle)}))),this.forceDOMReadyCycle(),this._set("container",r),this._startMeasuring()}get focused(){const e=document.activeElement===this.surface;return document.hasFocus()&&e}get size(){return[this.width,this.height]}set ui(e){const t=this._get("ui");t!==e&&t?.destroy(),this._set("ui",e)}blur(){this.surface?.blur()}focus(){this.surface?.focus()}pageToContainer(e,t,i){const r=this.position;return e-=r?r[0]:0,t-=r?r[1]:0,i?(i[0]=e,i[1]=t):i=[e,t],i}containerToPage(e,t,i){const r=this.position;return e+=r?r[0]:0,t+=r?r[1]:0,i?(i[0]=e,i[1]=t):i=[e,t],i}_handleUIChange(e,t){this.removeHandles("ui"),t&&t!==e&&t.destroy(),e&&(e.view=this,this.addHandles(a.watch((()=>this.root),(t=>{e.container=t?function(e){const t=document.createElement("div");return e.appendChild(t),t}(t):null}),a.initial),"ui")),this._set("ui",e)}_stopMeasuring(){this.removeHandles("measuring"),this._get("resizing")&&this._set("resizing",!1)}_startMeasuring(){const e=this._freqInfo;e.freq=f,e.time=y;const t=l.addFrameTask({prepare:e=>{const i=this._measure(),r=this._freqInfo;if(r.time+=e.deltaTime,i&&(r.freq=f,this._get("resizing")||this._set("resizing",!0)),r.time<r.freq)return;r.time=0;const o=this._position();r.freq=o||i?f:Math.min(y,2*r.freq),!i&&r.freq>=512&&(t.pause(),this._get("resizing")&&this._set("resizing",!1))}}),i=new ResizeObserver((i=>{e.freq=f,e.time=y,t.resume()}));null!=this.container&&i.observe(this.container);const n=o.makeHandle((()=>i.disconnect()));this.addHandles([r.on(window,"resize",(()=>{e.freq=f,e.time=y,t.resume()})),n,t],"measuring"),this._measure(),this._position()}_measure(){const e=this.container,t=e?e.clientWidth:0,i=e?e.clientHeight:0;if(0===t||0===i)return this.suspended||this._set("suspended",!0),!1;const r=this.width,o=this.height;return t===r&&i===o?(this.suspended&&this._set("suspended",!1),!1):(this._set("width",t),this._set("height",i),this.suspended&&this._set("suspended",!1),this.emit("resize",{oldWidth:r,oldHeight:o,width:t,height:i}),!0)}_position(){const e=this.container,t=this.position,i=e&&g(e);return!(!i||t&&i[0]===t[0]&&i[1]===t[1]||(this._set("position",[i[0],i[1]]),0))}forceDOMReadyCycle(){}};return t.__decorate([c.property()],u.prototype,"container",null),t.__decorate([c.property({readOnly:!0})],u.prototype,"focused",null),t.__decorate([c.property({readOnly:!0})],u.prototype,"height",void 0),t.__decorate([c.property()],u.prototype,"messagesCommon",void 0),t.__decorate([c.property({type:p})],u.prototype,"overlay",void 0),t.__decorate([c.property({readOnly:!0})],u.prototype,"position",void 0),t.__decorate([c.property({readOnly:!0})],u.prototype,"resizing",void 0),t.__decorate([c.property({readOnly:!0})],u.prototype,"root",void 0),t.__decorate([c.property({value:null,readOnly:!0})],u.prototype,"size",null),t.__decorate([c.property({readOnly:!0})],u.prototype,"surface",void 0),t.__decorate([c.property({readOnly:!0})],u.prototype,"suspended",void 0),t.__decorate([c.property({nonNullable:!0})],u.prototype,"ui",null),t.__decorate([c.property({readOnly:!0})],u.prototype,"userContent",void 0),t.__decorate([c.property({readOnly:!0})],u.prototype,"width",void 0),t.__decorate([c.property()],u.prototype,"widthBreakpoint",void 0),u=t.__decorate([d.subclass("esri.views.DOMContainer")],u),u},Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})}))},"esri/views/overlay/ViewOverlay":function(){define(["../../chunks/tslib.es6","../../core/Accessor","../../core/Collection","../../core/accessorSupport/decorators/property","../../core/has","../../core/Logger","../../core/RandomLCG","../../core/accessorSupport/decorators/subclass","../../core/support/UpdatingHandles","../../libs/maquette/projection","../../libs/maquette/projector"],(function(e,t,i,r,o,n,s,a,l,c,u){"use strict";let h=class extends t{constructor(){super(...arguments),this.items=new i,this._watchUpdatingTracking=new l.UpdatingHandles,this._callbacks=new Map,this._projector=u.createProjector(),this._hiddenProjector=u.createProjector()}get needsRender(){return this.items.length>0}get updating(){return this._watchUpdatingTracking?.updating??!1}initialize(){const e=document.createElement("div");e.className="esri-overlay-surface",this._set("surface",e),this._hiddenSurface=document.createElement("div"),this._hiddenSurface.setAttribute("style","visibility: hidden;"),e.appendChild(this._hiddenSurface),this._watchUpdatingTracking.addOnCollectionChange((()=>this.items),(e=>{for(const t of e.added){const e=()=>t.render();this._callbacks.set(t,e),this._projector.append(this.surface,e)}for(const t of e.removed){const e=this._projector.detach(this._callbacks.get(t));this.surface.removeChild(e.domNode),this._callbacks.delete(t)}}))}addItem(e){this.items.add(e)}removeItem(e){this.items.remove(e)}destroy(){this.items.removeAll(),this._callbacks.forEach((e=>this._projector.detach(e))),this._callbacks=null,this._projector=null,this._watchUpdatingTracking.destroy()}render(){this._projector.renderNow()}computeBoundingRect(e){const t=this._hiddenSurface,i=this._hiddenProjector;let r;const o=()=>(r=e.render(),r);i.append(t,o),i.renderNow();const n={left:0,top:0,right:0,bottom:0};if(r?.domNode){const e=r.domNode.getBoundingClientRect();n.left=e.left,n.top=e.top,n.right=e.right,n.bottom=e.bottom}for(i.detach(o);t.firstChild;)t.removeChild(t.firstChild);return n}overlaps(e,t){const i=this.computeBoundingRect(e),r=this.computeBoundingRect(t);return Math.max(i.left,r.left)<=Math.min(i.right,r.right)&&Math.max(i.top,r.top)<=Math.min(i.bottom,r.bottom)}get hasVisibleItems(){return this.items.some((e=>e.visible))}async prepare(){await document.fonts.load(this._fontString()).catch((()=>{}))}renderCanvas(e,t){const i=!!t?.disableDecorations;if(!this.items.some((e=>e.visible&&!(i&&e.isDecoration))))return;const r=e.getContext("2d");r.save(),r.font=this._fontString(),this.items.forEach((e=>{i&&e.isDecoration||(r.save(),e.renderCanvas(r),r.restore())})),r.restore()}_fontString(){return`10px ${getComputedStyle(this.surface).fontFamily}`}};return e.__decorate([r.property({readOnly:!0})],h.prototype,"surface",void 0),e.__decorate([r.property({readOnly:!0})],h.prototype,"items",void 0),e.__decorate([r.property({readOnly:!0})],h.prototype,"needsRender",null),e.__decorate([r.property({readOnly:!0})],h.prototype,"_watchUpdatingTracking",void 0),e.__decorate([r.property({readOnly:!0})],h.prototype,"updating",null),h=e.__decorate([a.subclass("esri.views.overlay.ViewOverlay")],h),h}))},"esri/views/PopupView":function(){define(["require","exports","../chunks/tslib.es6","../core/asyncUtils","../core/Error","../core/has","../core/Logger","../core/promiseUtils","../core/reactiveUtils","../core/accessorSupport/decorators/property","../core/RandomLCG","../core/accessorSupport/decorators/subclass","./input/InputManager"],(function(e,t,i,r,o,n,s,a,l,c,u,h,d){"use strict";const p=e=>Object.freeze(Object.defineProperty({__proto__:null,default:e},Symbol.toStringTag,{value:"Module"}));function m(e){return null!=e&&"open"in e&&"declaredClass"in e}function g(e){return null!=e&&"declaredClass"in e&&"dockOptions"in e}class _{constructor(e){this.layerView=e,this._resolver=a.createResolver(),this.graphics=[]}get promise(){return this._resolver.promise}resolve(e){const{layerView:t,graphics:i,_resolver:r}=this;if(!t)return r.resolve(i),r.promise;let o;return t.fetchPopupFeaturesFromGraphics(i,e).catch((e=>(o=e,null))).then((e=>{e?r.resolve(e):r.reject(o)})),r.promise}}t.PopupView=t=>{let u=class extends t{constructor(){super(...arguments),this._popupSetupTask=null,this.popup={},this.popupEnabled=!0}initialize(){this.addHandles([l.watch((()=>[this.ui,this.popup]),(([e,t],i)=>{const r="popup";if(i){const[e,o]=i;e&&m(o)&&(o.view=null,g(o)&&(e.remove(o,r),o!==t&&t&&o.destroy()))}e&&m(t)&&(t.view=this,g(t)&&e.add(t,{key:r,position:"manual",internal:!0}))}),l.syncAndInitial),this.on("click",(e=>{this.popup&&this.popupEnabled&&("mouse"!==e.pointerType||0===e.button)&&(m(this.popup)?this.popup.viewModel.handleViewClick(e):e.defer((async()=>{await this.setupPopup(),m(this.popup)&&!this.destroyed&&this.ready&&this.popupEnabled&&this.popup.viewModel.handleViewClick(e)})))}),d.ViewEventPriorities.WIDGET)]),l.whenOnce((()=>this.ready&&this.popupEnabled&&!this.updating)).then((()=>{new Promise(((t,i)=>e(["../widgets/Popup"],(e=>t(p(e))),i)))}))}destroy(){this.destroyed||this.closePopup()}async openPopup(e){if(m(this.popup))return this.popup.open(e);try{if(await this.setupPopup(),!this.popup)return void s.getLogger(this).error(new o("view:null-popup","Popup is null and can't be opened"));this.popup.open(e)}catch{}}closePopup(){this._popupSetupTask?.abort(),m(this.popup)&&this.popup.close()}async fetchPopupFeatures(e,t){return await this.when(),this._popupHitsToFeatures(await this._getPopupHits(e,t),t)}async setupPopup(){if(this._popupSetupTask?.abort(),this.popup&&!m(this.popup))return this._popupSetupTask=r.createTask((async t=>{const{default:i}=await new Promise(((t,i)=>e(["../widgets/Popup"],(e=>t(p(e))),i)));if(a.throwIfAborted(t),!this.popup||m(this.popup))return;const r=this.popup;delete r.open,delete r.close,this.popup=new i(r)})),this._popupSetupTask.promise}async _popupHitsToFeatures({location:e,hits:t},i){const r=[],o=[];let s=!1;const l=a.wrapAbortWithTimeout(i,n("popup-view-fetch-timeout")??5e3),c=e=>{const t=o.at(-1);return t&&t.layerView===e&&!s?t:(e=>{const t=new _(e);return o.push(t),r.push(t.promise),t})(e)};for(const e of t)"graphic"in e?(c(e.layerView).graphics.push(e.graphic),s=!1):(r.push(e.layerView.fetchPopupFeaturesAtLocation(e.mapPoint,l)),s=!0);o.map((e=>e.resolve(l)));const u=a.allSettledValues(r).then((e=>e.filter((e=>!!e)).flat()));return{pendingFeatures:r,allGraphicsPromise:u,location:e}}async _getPopupHits(e,t){const{hits:i,location:r}=await this.popupHitTest(e);a.throwIfAborted(t);const o=[];for(const e of i)if("graphic"in e){if(this._isValidPopupGraphic(e.graphic,t)){const t=this._isValidPopupGraphicsLayerView(e.layerView)?e.layerView:void 0;o.push({graphic:e.graphic,layerView:t})}}else this._isValidPopupLocationLayerView(e.layerView)&&o.push({mapPoint:e.mapPoint,layerView:e.layerView});return{hits:o,location:r}}_isValidPopupGraphic(e,t){return e&&!!e.getEffectivePopupTemplate(t?.defaultPopupTemplateEnabled)}_isValidPopupGraphicsLayerView(e){return!e||(!("layer"in e)||!e.suspended)&&"fetchPopupFeaturesFromGraphics"in e}_isValidPopupLocationLayerView(e){return(!("layer"in e)||!e.suspended)&&"fetchPopupFeaturesAtLocation"in e}};return i.__decorate([c.property()],u.prototype,"popup",void 0),i.__decorate([c.property()],u.prototype,"popupEnabled",void 0),u=i.__decorate([h.subclass("esri.views.PopupView")],u),u},Object.defineProperty(t,Symbol.toStringTag,{value:"Module"})}))},"esri/views/Viewport2DBaseMixin":function(){define(["exports","../chunks/tslib.es6","../Viewpoint","../core/reactiveUtils","../core/accessorSupport/decorators/property","../core/has","../core/Logger","../core/RandomLCG","../core/accessorSupport/decorators/subclass","./2d/FrameTask","./2d/MapViewConstraints","./2d/ViewStateManager","./2d/support/StationaryManager","./input/ViewEvents"],(function(e,t,i,r,o,n,s,a,l,c,u,h,d,p){"use strict";e.Viewport2DBaseMixin=e=>{let n=class extends e{constructor(...e){super(...e),this.fullOpacity=1,this.stateManager=new h.ViewStateManager({constraints:new u({view:this})}),this.stationaryManager=new d.StationaryManager,this.mapViewNavigation=null,this.renderingOptions={samplingMode:"dynamic",edgeLabelsVisible:!1,labelsAnimationTime:0,labelCollisionsEnabled:!1},this.frameTask=new c(this),this.viewEvents=new p.ViewEvents(this),this.padding={top:0,right:0,bottom:0,left:0},this.addHandles([r.watch((()=>this.viewpoint),(()=>this.stationaryManager.flip()),r.sync)])}get constraintsInfo(){return{lods:null,spatialReference:null}}get extent(){return this.stateManager?.extent??null}set extent(e){this.stateManager.extent=e}get state(){return this.stateManager.state}get interacting(){return!1}get stationary(){return!this.animation&&this.stationaryManager.stationary}set animation(e){const t=this._get("animation");if(e===t)return;if(t&&t.stop(),e!==this.animationManager.animation&&this.animationManager.stop(),!e||e.isFulfilled())return void this._set("animation",null);this._set("animation",e);const i=()=>{this.destroyed||e===this._get("animation")&&(this._set("animation",null),this.frameTask?.requestFrame())};e.when(i,i)}get constraints(){return this.stateManager?.constraints}set constraints(e){e.view=this;const t=this.stateManager.constraints;this.stateManager.constraints=e,t?.destroy()}get padding(){return this.stateManager?.padding}set padding(e){this.stateManager&&(this.stateManager.padding=e)}get resizeAlign(){return this.stateManager.resizeAlign}set resizeAlign(e){this.stateManager.resizeAlign=e}get rotation(){return this.stateManager.rotation??0}set rotation(e){const{rotationEnabled:t}=this.constraints;this.constraints.rotationEnabled=!0,this.stateManager.rotation=e,this.constraints.rotationEnabled=t}get viewpoint(){return this.stateManager.viewpoint??null}set viewpoint(e){this.stateManager.viewpoint=e,this.frameTask.requestFrame()}};return t.__decorate([o.property({readOnly:!0})],n.prototype,"animationManager",void 0),t.__decorate([o.property({readOnly:!0})],n.prototype,"fullOpacity",void 0),t.__decorate([o.property()],n.prototype,"stateManager",void 0),t.__decorate([o.property()],n.prototype,"constraintsInfo",null),t.__decorate([o.property()],n.prototype,"extent",null),t.__decorate([o.property({readOnly:!0})],n.prototype,"state",null),t.__decorate([o.property({readOnly:!0})],n.prototype,"mapViewNavigation",void 0),t.__decorate([o.property()],n.prototype,"renderingOptions",void 0),t.__decorate([o.property({readOnly:!0})],n.prototype,"interacting",null),t.__decorate([o.property()],n.prototype,"stationary",null),t.__decorate([o.property()],n.prototype,"animation",null),t.__decorate([o.property({type:u})],n.prototype,"constraints",null),t.__decorate([o.property()],n.prototype,"padding",null),t.__decorate([o.property()],n.prototype,"resizeAlign",null),t.__decorate([o.property()],n.prototype,"rotation",null),t.__decorate([o.property({readOnly:!0})],n.prototype,"viewEvents",void 0),t.__decorate([o.property({type:i})],n.prototype,"viewpoint",null),n=t.__decorate([l.subclass("esri.views.Viewport2DBaseMixin")],n),n},Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})}))},"esri/views/2d/FrameTask":function(){define(["../../core/promiseUtils","../../core/reactiveUtils","../../core/scheduling","./PaddedViewState","../support/RenderState","../support/Scheduler"],(function(e,t,i,r,o,n){"use strict";return class{constructor(i){this.view=i,this._stationaryHandle=null,this._frameTaskHandle=null,this._updateParameters=null,this._updateRequested=!1,this._scheduler=n.newScheduler(),this._schedulerHandle=t.when((()=>this._scheduler.updating),(()=>this.requestFrame())),this.stationary=!0,this.prepare=()=>{this._updateParameters&&(this._updateParameters.state=this.view.state,this._updateParameters.stationary=this.view.stationary,this._updateParameters.pixelRatio=window.devicePixelRatio,this._updateParameters.renderingOptions=this.view.renderingOptions,this._updateParameters.targetState.copy(this.view.state),null==this.view.animation?.target||e.isPromiseLike(this.view.animation.target)||(this._updateParameters.targetState.viewpoint=this.view.animation.target))},this.update=e=>{if(this._updateRequested=!1,this.view?.destroyed)return;const{allLayerViews:t,graphicsView:i,labelManager:r,state:{id:n}}=this.view;t?.forEach(this._updateLayerView,this),null!=r&&(r.lastUpdateId!==n&&(r.viewChange(),r.lastUpdateId=n),r.updateRequested&&r.processUpdate(this._updateParameters)),null!=i&&(i.lastUpdateId!==n&&(i.viewChange(),i.lastUpdateId=n),i.updateRequested&&i.processUpdate(this._updateParameters)),this.view.graphicsTileStore?.setViewState(this._updateParameters.state),this.view.animation?this._scheduler.state=o.RenderState.ANIMATING:this.view.interacting?this._scheduler.state=o.RenderState.INTERACTING:this._scheduler.state=o.RenderState.IDLE,this._scheduler.frame(e)||this._updateRequested||this._scheduler.state!==o.RenderState.IDLE||this._frameTaskHandle?.pause()}}destroy(){this.stop(),this._schedulerHandle.remove(),this._scheduler.destroy()}get scheduler(){return this._scheduler}start(){if(this._frameTaskHandle)return;const e=this.view;this.stationary=e.stationary,this._updateParameters={state:e.state,targetState:new r,pixelRatio:window.devicePixelRatio,stationary:this.stationary,renderingOptions:e.renderingOptions},this._stationaryHandle=t.watch((()=>e.stationary),(e=>{this.stationary=e,this.requestFrame()})),this._frameTaskHandle=i.addFrameTask(this),this.requestUpdate()}stop(){this._frameTaskHandle&&(this._updateRequested=!1,this._stationaryHandle?.remove(),this._frameTaskHandle.remove(),this._updateParameters=this._stationaryHandle=this._frameTaskHandle=null,this.stationary=!0)}requestUpdate(){this._updateRequested||(this._updateRequested=!0,this.requestFrame())}requestFrame(){this._frameTaskHandle&&this._frameTaskHandle.resume()}_updateLayerView(e){if(!e.attached)return void this.requestUpdate();const t=this.view.state,i=e.lastUpdateId;null!=i&&(this.stationary||e.moving)||(e.moving=!0),i!==t.id&&e.viewChange(),this.stationary&&e.moving&&(e.moving=!1,e.moveEnd()),e.lastUpdateId=t.id,e.updateRequested&&e.processUpdate(this._updateParameters),"layerViews"in e&&e.layerViews?.forEach(this._updateLayerView,this)}}}))},"esri/views/2d/PaddedViewState":function(){define(["../../chunks/tslib.es6","../../core/Accessor","../../core/reactiveUtils","../../core/accessorSupport/decorators/property","../../core/has","../../core/Logger","../../core/RandomLCG","../../core/accessorSupport/decorators/subclass","../../core/libs/gl-matrix-2/math/vec2","../../core/libs/gl-matrix-2/factories/vec2f64","./viewpointUtils","./ViewState"],(function(e,t,i,r,o,n,s,a,l,c,u,h){"use strict";var d,p;let m=d=class extends t{constructor(){super(...arguments),this.left=0,this.top=0,this.right=0,this.bottom=0}clone(){return new d({left:this.left,top:this.top,right:this.right,bottom:this.bottom})}};e.__decorate([r.property()],m.prototype,"left",void 0),e.__decorate([r.property()],m.prototype,"top",void 0),e.__decorate([r.property()],m.prototype,"right",void 0),e.__decorate([r.property()],m.prototype,"bottom",void 0),m=d=e.__decorate([a.subclass("esri.views.2d.PaddedViewState.Padding")],m);let g=p=class extends h{constructor(...e){super(...e),this.paddedViewState=new h,this._updateContent=(()=>{const e=c.create();return()=>{const t=this._get("size"),i=this._get("padding");if(!t||!i)return;const r=this.paddedViewState;l.set(e,i.left+i.right,i.top+i.bottom),l.subtract(e,t,e),l.copy(r.size,e);const o=r.viewpoint;o&&(this.viewpoint=o)}})(),this.addHandles(i.watch((()=>[this.size,this.padding]),(()=>this._updateContent()),i.sync)),this.padding=new m,this.size=[0,0]}set padding(e){this._set("padding",e||new m)}set viewpoint(e){if(e){this.paddedViewState.viewpoint=e;let t=e;const i=this._get("padding");i&&(t=u.addPadding(e.clone(),e,this._get("size"),i));const{targetGeometry:r,rotation:o,scale:n}=t,{x:s,y:a,spatialReference:l}=r,c=this._viewpoint2D;c.center[0]=s,c.center[1]=a,c.rotation=o,c.scale=n,c.spatialReference=l,this._update()}}clone(){return new p({padding:this.padding.clone(),size:this.size.slice(),viewpoint:this.paddedViewState.viewpoint.clone(),pixelRatio:this.pixelRatio})}};return e.__decorate([r.property()],g.prototype,"paddedViewState",void 0),e.__decorate([r.property({type:m})],g.prototype,"padding",null),e.__decorate([r.property()],g.prototype,"viewpoint",null),g=p=e.__decorate([a.subclass("esri.views.2d.PaddedViewState")],g),g}))},"esri/core/libs/gl-matrix-2/math/vec2":function(){define(["exports","./common"],(function(e,t){"use strict";function i(e,t){return e[0]=t[0],e[1]=t[1],e}function r(e,t,i){return e[0]=t,e[1]=i,e}function o(e,t,i){return e[0]=t[0]+i[0],e[1]=t[1]+i[1],e}function n(e,t,i){return e[0]=t[0]-i[0],e[1]=t[1]-i[1],e}function s(e,t,i){return e[0]=t[0]*i[0],e[1]=t[1]*i[1],e}function a(e,t,i){return e[0]=t[0]/i[0],e[1]=t[1]/i[1],e}function l(e,t){return e[0]=Math.ceil(t[0]),e[1]=Math.ceil(t[1]),e}function c(e,t){return e[0]=Math.floor(t[0]),e[1]=Math.floor(t[1]),e}function u(e,t,i){return e[0]=Math.min(t[0],i[0]),e[1]=Math.min(t[1],i[1]),e}function h(e,t,i){return e[0]=Math.max(t[0],i[0]),e[1]=Math.max(t[1],i[1]),e}function d(e,t){return e[0]=Math.round(t[0]),e[1]=Math.round(t[1]),e}function p(e,t,i){return e[0]=t[0]*i,e[1]=t[1]*i,e}function m(e,t,i,r){return e[0]=t[0]+i[0]*r,e[1]=t[1]+i[1]*r,e}function g(e,t){const i=t[0]-e[0],r=t[1]-e[1];return Math.sqrt(i*i+r*r)}function _(e,t){const i=t[0]-e[0],r=t[1]-e[1];return i*i+r*r}function f(e){const t=e[0],i=e[1];return Math.sqrt(t*t+i*i)}function y(e){const t=e[0],i=e[1];return t*t+i*i}function w(e,t){return e[0]=-t[0],e[1]=-t[1],e}function v(e,t){return e[0]=1/t[0],e[1]=1/t[1],e}function T(e,t){const i=t[0],r=t[1];let o=i*i+r*r;return o>0&&(o=1/Math.sqrt(o),e[0]=t[0]*o,e[1]=t[1]*o),e}function S(e,t){return e[0]*t[0]+e[1]*t[1]}function b(e,t,i){const r=t[0]*i[1]-t[1]*i[0];return e[0]=e[1]=0,e[2]=r,e}function E(e,t,i,r){const o=t[0],n=t[1];return e[0]=o+r*(i[0]-o),e[1]=n+r*(i[1]-n),e}function M(e,i=1){const r=2*t.RANDOM()*Math.PI;return e[0]=Math.cos(r)*i,e[1]=Math.sin(r)*i,e}function x(e,t,i){const r=t[0],o=t[1];return e[0]=i[0]*r+i[2]*o,e[1]=i[1]*r+i[3]*o,e}function P(e,t,i){const r=t[0],o=t[1];return e[0]=i[0]*r+i[2]*o+i[4],e[1]=i[1]*r+i[3]*o+i[5],e}function R(e,t,i){const r=t[0],o=t[1];return e[0]=i[0]*r+i[3]*o+i[6],e[1]=i[1]*r+i[4]*o+i[7],e}function A(e,t,i){const r=t[0],o=t[1];return e[0]=i[0]*r+i[4]*o+i[12],e[1]=i[1]*r+i[5]*o+i[13],e}function I(e,t,i,r){const o=t[0]-i[0],n=t[1]-i[1],s=Math.sin(r),a=Math.cos(r);return e[0]=o*a-n*s+i[0],e[1]=o*s+n*a+i[1],e}function C(e,t){const i=e[0],r=e[1],o=t[0],n=t[1];let s=i*i+r*r;s>0&&(s=1/Math.sqrt(s));let a=o*o+n*n;a>0&&(a=1/Math.sqrt(a));const l=(i*o+r*n)*s*a;return l>1?0:l<-1?Math.PI:Math.acos(l)}function D(e){return"vec2("+e[0]+", "+e[1]+")"}function O(e,t){return e[0]===t[0]&&e[1]===t[1]}function L(e,i){const r=e[0],o=e[1],n=i[0],s=i[1],a=t.getEpsilon();return Math.abs(r-n)<=a*Math.max(1,Math.abs(r),Math.abs(n))&&Math.abs(o-s)<=a*Math.max(1,Math.abs(o),Math.abs(s))}function N(e,t,i,r,o){let n=t[0]-i[0],s=t[1]-i[1];const a=(r[0]*n+r[1]*s)*(o-1);return n=r[0]*a,s=r[1]*a,e[0]=t[0]+n,e[1]=t[1]+s,e}const F=f,k=n,U=s,G=a,V=g,z=_,B=y,H=Object.freeze(Object.defineProperty({__proto__:null,add:o,angle:C,ceil:l,copy:i,cross:b,dist:V,distance:g,div:G,divide:a,dot:S,equals:L,exactEquals:O,floor:c,inverse:v,len:F,length:f,lerp:E,max:h,min:u,mul:U,multiply:s,negate:w,normalize:T,projectAndScale:N,random:M,rotate:I,round:d,scale:p,scaleAndAdd:m,set:r,sqrDist:z,sqrLen:B,squaredDistance:_,squaredLength:y,str:D,sub:k,subtract:n,transformMat2:x,transformMat2d:P,transformMat3:R,transformMat4:A},Symbol.toStringTag,{value:"Module"}));e.add=o,e.angle=C,e.ceil=l,e.copy=i,e.cross=b,e.dist=V,e.distance=g,e.div=G,e.divide=a,e.dot=S,e.equals=L,e.exactEquals=O,e.floor=c,e.inverse=v,e.len=F,e.length=f,e.lerp=E,e.max=h,e.min=u,e.mul=U,e.multiply=s,e.negate=w,e.normalize=T,e.projectAndScale=N,e.random=M,e.rotate=I,e.round=d,e.scale=p,e.scaleAndAdd=m,e.set=r,e.sqrDist=z,e.sqrLen=B,e.squaredDistance=_,e.squaredLength=y,e.str=D,e.sub=k,e.subtract=n,e.transformMat2=x,e.transformMat2d=P,e.transformMat3=R,e.transformMat4=A,e.vec2=H,Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})}))},"esri/core/libs/gl-matrix-2/factories/vec2f64":function(){define(["exports"],(function(e){"use strict";function t(){return[0,0]}function i(e){return[e[0],e[1]]}function r(e,t){return[e,t]}function o(e,t){return[e,t]}function n(e,t=[0,0]){const i=Math.min(2,e.length);for(let r=0;r<i;++r)t[r]=e[r];return t}function s(){return[0,0]}function a(){return r(1,1)}function l(){return r(1,0)}function c(){return r(0,1)}const u=[0,0],h=a(),d=l(),p=c(),m=Object.freeze(Object.defineProperty({__proto__:null,ONES:h,UNIT_X:d,UNIT_Y:p,ZEROS:u,clone:i,create:t,freeze:o,fromArray:n,fromValues:r,ones:a,unitX:l,unitY:c,zeros:s},Symbol.toStringTag,{value:"Module"}));e.ONES=h,e.UNIT_X=d,e.UNIT_Y=p,e.ZEROS=u,e.clone=i,e.create=t,e.freeze=o,e.fromArray=n,e.fromValues=r,e.ones=a,e.unitX=l,e.unitY=c,e.vec2f64=m,e.zeros=s,Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})}))},"esri/views/2d/viewpointUtils":function(){define(["exports","../../Viewpoint","../../core/Collection","../../core/mathUtils","../../core/unitUtils","../../core/libs/gl-matrix-2/math/common","../../core/libs/gl-matrix-2/math/mat2d","../../core/libs/gl-matrix-2/factories/mat2df64","../../core/libs/gl-matrix-2/math/vec2","../../core/libs/gl-matrix-2/factories/vec2f64","../../geometry/Extent","../../geometry/Geometry","../../geometry/Point","../../geometry/projectionUtils","../../geometry/SpatialReference","../../geometry/support/normalizeUtils","../../geometry/support/spatialReferenceUtils"],(function(e,t,i,r,o,n,s,a,l,c,u,h,d,p,m,g,_){"use strict";const f=180/Math.PI;function y(e){return e.wkid?e:e.spatialReference||m.WGS84}function w(e,t){return t.type?l.set(e,t.x,t.y):l.copy(e,t)}function v(e){return o.getMetersPerUnitForSR(e)}function T(e,t,i=0){let o=e.width,n=e.height;if(0!==i){const t=r.deg2rad(i),s=Math.abs(Math.cos(t)),a=Math.abs(Math.sin(t));o=e.width*s+e.height*a,n=e.width*a+e.height*s}const s=Math.max(1,t[0]),a=Math.max(1,t[1]);return Math.max(o/s,n/a)*D(e.spatialReference)}async function S(e,t,r,o){let n,s;if(!e)return null;if(Array.isArray(e)&&!e.length)return null;if(i.isCollection(e)&&(e=e.toArray()),Array.isArray(e)&&e.length&&"object"==typeof e[0]){const i=e.every((e=>"attributes"in e)),n=e.some((e=>!e.geometry));let s=e;if(i&&n&&t&&t.allLayerViews){const i=new Map;for(const t of e){const e=t.layer,r=i.get(e)||[],o=t.attributes[e.objectIdField];null!=o&&r.push(o),i.set(e,r)}const r=[];i.forEach(((e,i)=>{const o=t.allLayerViews?.find((e=>e.layer.id===i.id));if(o&&"queryFeatures"in o){const t=i.createQuery();t.objectIds=e,t.returnGeometry=!0,r.push(o.queryFeatures(t))}}));const o=await Promise.all(r),n=[];for(const e of o)if(e&&e.features&&e.features.length)for(const t of e.features)null!=t.geometry&&n.push(t.geometry);s=n}for(const e of s)o=await S(e,t,r,o);return o}if(Array.isArray(e)&&2===e.length&&"number"==typeof e[0]&&"number"==typeof e[1])n=new d(e);else if(e instanceof h)n=e;else if("geometry"in e)if(e.geometry)n=e.geometry;else if(e.layer){const i=e.layer,r=t.allLayerViews?.find((e=>e.layer.id===i.id));if(r&&"queryFeatures"in r){const t=i.createQuery();t.objectIds=[e.attributes[i.objectIdField]],t.returnGeometry=!0;const o=await r.queryFeatures(t);n=o?.features?.[0]?.geometry}}if(null==n)return null;switch(n.type){case"point":s=new u({xmin:n.x,ymin:n.y,xmax:n.x,ymax:n.y,spatialReference:n.spatialReference});break;case"extent":case"multipoint":case"polygon":case"polyline":s=g.getDenormalizedExtent(n);break;default:s=n.extent}if(!s)return null;p.isLoaded()||p.canProjectWithoutEngine(s.spatialReference,r)||await p.load();const a=p.project(s,r);if(!a)return null;if(o){const e=a.center,t=e.clone();t.x=g.getClosestDenormalizedXToReference(e.x,o.center.x,r),t.x!==e.x&&a.centerAt(t),o=o.union(a)}else o=a;return o}function b(e,t){const i=y(e);return _.equals(i,t)||i.imageCoordinateSystem||t.imageCoordinateSystem?e:p.project(e,t)}function E(e,t){const i=e.targetGeometry,r=t.targetGeometry;return i.x=r.x,i.y=r.y,i.spatialReference=r.spatialReference,e.scale=t.scale,e.rotation=t.rotation,e}function M(e,t,i){return i?l.set(e,.5*(t[0]-i.right+i.left),.5*(t[1]-i.bottom+i.top)):l.scale(e,t,.5)}const x=function(){const e=c.create();return function(t,i,r){const o=i.targetGeometry;w(e,o);const n=.5*A(i);return t.xmin=e[0]-n*r[0],t.ymin=e[1]-n*r[1],t.xmax=e[0]+n*r[0],t.ymax=e[1]+n*r[1],t.spatialReference=o.spatialReference,t}}(),P=function(){const e=c.create();return function(t,i,r){return l.sub(t,function(e,t){return l.scale(e,t,.5)}(t,i),M(e,i,r))}}(),R=function(){const e=a.create(),t=c.create();return function(i,r,o,n){const a=A(r),c=C(r);return l.set(t,a,a),s.fromScaling(e,t),s.rotate(e,e,c),s.translate(e,e,P(t,o,n)),s.translate(e,e,[0,n.top-n.bottom]),l.set(i,e[4],e[5])}}();function A(e){return e.scale*I(e.targetGeometry?.spatialReference)}function I(e){return _.isValid(e)?1/(39.37*v(e)*96):1}function C(e){return n.toRadian(e.rotation)||0}function D(e){return _.isValid(e)?39.37*v(e)*96:1}const O=function(){const e=c.create(),t=c.create(),i=c.create();return function(r,o,n,a,c,u){return l.negate(e,o),l.scale(t,n,.5*u),l.set(i,1/a*u,-1/a*u),s.fromTranslation(r,t),c&&s.rotate(r,r,c),s.scale(r,r,i),s.translate(r,r,e),r}}(),L=function(){const e=c.create();return function(t,i,r,o){const n=A(i),s=C(i);return w(e,i.targetGeometry),O(t,e,r,n,s,o)}}(),N=function(){const e=c.create();return function(t,i,r,o){const n=A(i);return w(e,i.targetGeometry),O(t,e,r,n,0,o)}}();function F(e){const t=_.getInfo(e);return t?t.valid[1]-t.valid[0]:0}const k=function(){const e=c.create(),t=c.create(),i=[0,0,0];return function(r,o,n){l.subtract(e,r,o),l.normalize(e,e),l.subtract(t,r,n),l.normalize(t,t),l.cross(i,e,t);let s=Math.acos(l.dot(e,t)/(l.length(e)*l.length(t)))*f;return i[2]<0&&(s=-s),isNaN(s)&&(s=0),s}}(),U=function(){const e=c.create();return function(t,i,r,o){const n=t.targetGeometry;return E(t,i),R(e,i,r,o),n.x+=e[0],n.y+=e[1],t}}(),G=function(e,t,i){E(e,t);const r=e.targetGeometry;return r.x=i.x,r.y=i.y,r.spatialReference=i.spatialReference,e},V=function(){const e=c.create();return function(t,i,r,o,n){n||(n="center"),l.sub(e,r,o),l.scale(e,e,.5);const s=e[0],a=e[1];switch(n){case"center":l.set(e,0,0);break;case"left":l.set(e,-s,0);break;case"top":l.set(e,0,a);break;case"right":l.set(e,s,0);break;case"bottom":l.set(e,0,-a);break;case"top-left":l.set(e,-s,a);break;case"bottom-left":l.set(e,-s,-a);break;case"top-right":l.set(e,s,a);break;case"bottom-right":l.set(e,s,-a)}return Z(t,i,e),t}}(),z=function(){const e=c.create();return function(t,i,r,o,n){return E(t,i),isNaN(r)||0===r||(W(e,o,i,n),t.scale=i.scale*r,j(e,e,t,n),Z(t,t,l.set(e,e[0]-o[0],o[1]-e[1]))),t}}(),B=function(){const e=c.create();return function(t,i,r,o,n,s){return E(t,i),isNaN(r)||0===r||(W(e,n,i,s),t.scale=i.scale*r,t.rotation+=o,j(e,e,t,s),Z(t,t,l.set(e,e[0]-n[0],n[1]-e[1]))),t}}(),H=function(){const e=c.create(),t=c.create();return function(i,r,o,n,s,a,c){return P(t,a,c),l.add(e,s,t),n?B(i,r,o,n,e,a):z(i,r,o,e,a)}}(),W=function(){const e=a.create();return function(t,i,r,o){return l.transformMat2d(t,i,function(e,t,i){return L(e,t,i,1),s.invert(e,e)}(e,r,o))}}(),j=function(){const e=a.create();return function(t,i,r,o){return l.transformMat2d(t,i,L(e,r,o,1))}}(),Z=function(){const e=c.create(),t=a.create();return function(i,r,o){E(i,r);const n=A(r),a=i.targetGeometry;return s.fromRotation(t,C(r)),s.scale(t,t,c.fromValues(n,n)),l.transformMat2d(e,o,t),a.x+=e[0],a.y+=e[1],i}}();e.addPadding=U,e.angleBetween=k,e.centerAt=G,e.copy=E,e.create=async function(e,i){if(!e||!i)return new t({targetGeometry:new d,scale:0,rotation:0});let r=i.spatialReference;const{constraints:o,padding:n,viewpoint:s,size:a}=i,l=[n?a[0]-n.left-n.right:a[0],n?a[1]-n.top-n.bottom:a[1]];let c=null;e instanceof t?c=e:e.viewpoint?c=e.viewpoint:e.target&&"esri.Viewpoint"===e.target.declaredClass&&(c=e.target);let m=null;c?.targetGeometry?m=c.targetGeometry:e instanceof u?m=e:e instanceof h?m=await S(e,i,r):e&&(m=await S(e.center,i,r)||await S(e.target,i,r)||await S(e,i,r)),!m&&s?.targetGeometry?m=s.targetGeometry:!m&&i.extent&&(m=i.extent),r||(r=y(i.spatialReference||i.extent||m)),p.isLoaded()||_.equals(m.spatialReference,r)||p.canProjectWithoutEngine(m.spatialReference,r)||await p.load();const f=b(m,r),w="center"in f?f.center:f;!1!==i.pickClosestTarget&&"point"===w.type&&"point"===s.targetGeometry?.type&&(w.x=g.getClosestDenormalizedXToReference(w.x,s.targetGeometry.x,w.spatialReference));let v=0;c?v=c.rotation:e.hasOwnProperty("rotation")?v=e.rotation:s&&(v=s.rotation);let E=0;E=null!=c?.targetGeometry&&"point"===c.targetGeometry.type?c.scale:"scale"in e&&e.scale?e.scale:"zoom"in e&&-1!==e.zoom&&o&&o.effectiveLODs?o.zoomToScale(e.zoom):Array.isArray(m)||"point"===m.type||"extent"===m.type&&0===m.width&&0===m.height?s.scale:T(b(m.extent,r),l,v);const M=function(e){if(e&&(!Array.isArray(e)||"number"!=typeof e[0])&&("object"==typeof e||Array.isArray(e)&&"object"==typeof e[0])){if("layer"in e&&null!=e.layer?.minScale&&null!=e.layer.maxScale){const t=e.layer;return{min:t.minScale,max:t.maxScale}}if(Array.isArray(e)&&e.length&&e.every((e=>"layer"in e))){let t=0,i=0;for(const r of e){const e=r.layer;e?.minScale&&e.maxScale&&(t=e.minScale<t?e.minScale:t,i=e.maxScale>i?e.maxScale:i)}return t&&i?{min:t,max:i}:null}}}(e.target??e);M&&(M.min&&M.min<E?E=M.min:M.max&&M.max>E&&(E=M.max));let x=new t({targetGeometry:w,scale:E,rotation:v});return o&&(x=o.fit(x),o.constrainByGeometry(x),o.rotationEnabled||(x.rotation=s.rotation)),x},e.extentToScale=T,e.getAnchor=M,e.getExtent=x,e.getMatrix=O,e.getPaddingMapTranslation=R,e.getPaddingScreenTranslation=P,e.getResolution=A,e.getResolutionToScaleFactor=D,e.getScaleToResolutionFactor=I,e.getTransform=L,e.getTransformNoRotation=N,e.getWorldScreenWidth=function(e,t){return Math.round(F(e)/t)},e.getWorldWidth=F,e.padAndScaleAndRotateBy=H,e.resize=V,e.rotateBy=function(e,t,i){return E(e,t),e.rotation+=i,e},e.rotateTo=function(e,t,i){return E(e,t),e.rotation=i,e},e.scaleAndRotateBy=B,e.scaleTo=function(e,t,i){return E(e,t),e.scale=i,e},e.setExtent=function(e,t,i,r,o){return G(e,t,i.center),e.scale=T(i,r),o?.constraints?.constrain(e),e},e.toMap=W,e.toScreen=j,e.translateBy=Z,Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})}))},"esri/core/libs/gl-matrix-2/math/mat2d":function(){define(["exports","./common"],(function(e,t){"use strict";function i(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e}function r(e){return e[0]=1,e[1]=0,e[2]=0,e[3]=1,e[4]=0,e[5]=0,e}function o(e,t,i,r,o,n,s){return e[0]=t,e[1]=i,e[2]=r,e[3]=o,e[4]=n,e[5]=s,e}function n(e,t){const i=t[0],r=t[1],o=t[2],n=t[3],s=t[4],a=t[5];let l=i*n-r*o;return l?(l=1/l,e[0]=n*l,e[1]=-r*l,e[2]=-o*l,e[3]=i*l,e[4]=(o*a-n*s)*l,e[5]=(r*s-i*a)*l,e):null}function s(e){return e[0]*e[3]-e[1]*e[2]}function a(e,t,i){const r=t[0],o=t[1],n=t[2],s=t[3],a=t[4],l=t[5],c=i[0],u=i[1],h=i[2],d=i[3],p=i[4],m=i[5];return e[0]=r*c+n*u,e[1]=o*c+s*u,e[2]=r*h+n*d,e[3]=o*h+s*d,e[4]=r*p+n*m+a,e[5]=o*p+s*m+l,e}function l(e,t,i){const r=t[0],o=t[1],n=t[2],s=t[3],a=t[4],l=t[5],c=Math.sin(i),u=Math.cos(i);return e[0]=r*u+n*c,e[1]=o*u+s*c,e[2]=r*-c+n*u,e[3]=o*-c+s*u,e[4]=a,e[5]=l,e}function c(e,t,i){const r=t[0],o=t[1],n=t[2],s=t[3],a=t[4],l=t[5],c=i[0],u=i[1];return e[0]=r*c,e[1]=o*c,e[2]=n*u,e[3]=s*u,e[4]=a,e[5]=l,e}function u(e,t,i){const r=t[0],o=t[1],n=t[2],s=t[3],a=t[4],l=t[5],c=i[0],u=i[1];return e[0]=r,e[1]=o,e[2]=n,e[3]=s,e[4]=r*c+n*u+a,e[5]=o*c+s*u+l,e}function h(e,t){const i=Math.sin(t),r=Math.cos(t);return e[0]=r,e[1]=i,e[2]=-i,e[3]=r,e[4]=0,e[5]=0,e}function d(e,t){return e[0]=t[0],e[1]=0,e[2]=0,e[3]=t[1],e[4]=0,e[5]=0,e}function p(e,t){return e[0]=1,e[1]=0,e[2]=0,e[3]=1,e[4]=t[0],e[5]=t[1],e}function m(e){return"mat2d("+e[0]+", "+e[1]+", "+e[2]+", "+e[3]+", "+e[4]+", "+e[5]+")"}function g(e){return Math.sqrt(e[0]**2+e[1]**2+e[2]**2+e[3]**2+e[4]**2+e[5]**2+1)}function _(e,t,i){return e[0]=t[0]+i[0],e[1]=t[1]+i[1],e[2]=t[2]+i[2],e[3]=t[3]+i[3],e[4]=t[4]+i[4],e[5]=t[5]+i[5],e}function f(e,t,i){return e[0]=t[0]-i[0],e[1]=t[1]-i[1],e[2]=t[2]-i[2],e[3]=t[3]-i[3],e[4]=t[4]-i[4],e[5]=t[5]-i[5],e}function y(e,t,i){return e[0]=t[0]*i,e[1]=t[1]*i,e[2]=t[2]*i,e[3]=t[3]*i,e[4]=t[4]*i,e[5]=t[5]*i,e}function w(e,t,i,r){return e[0]=t[0]+i[0]*r,e[1]=t[1]+i[1]*r,e[2]=t[2]+i[2]*r,e[3]=t[3]+i[3]*r,e[4]=t[4]+i[4]*r,e[5]=t[5]+i[5]*r,e}function v(e,t){return e[0]===t[0]&&e[1]===t[1]&&e[2]===t[2]&&e[3]===t[3]&&e[4]===t[4]&&e[5]===t[5]}function T(e,i){const r=e[0],o=e[1],n=e[2],s=e[3],a=e[4],l=e[5],c=i[0],u=i[1],h=i[2],d=i[3],p=i[4],m=i[5],g=t.getEpsilon();return Math.abs(r-c)<=g*Math.max(1,Math.abs(r),Math.abs(c))&&Math.abs(o-u)<=g*Math.max(1,Math.abs(o),Math.abs(u))&&Math.abs(n-h)<=g*Math.max(1,Math.abs(n),Math.abs(h))&&Math.abs(s-d)<=g*Math.max(1,Math.abs(s),Math.abs(d))&&Math.abs(a-p)<=g*Math.max(1,Math.abs(a),Math.abs(p))&&Math.abs(l-m)<=g*Math.max(1,Math.abs(l),Math.abs(m))}const S=a,b=f,E=Object.freeze(Object.defineProperty({__proto__:null,add:_,copy:i,determinant:s,equals:T,exactEquals:v,frob:g,fromRotation:h,fromScaling:d,fromTranslation:p,identity:r,invert:n,mul:S,multiply:a,multiplyScalar:y,multiplyScalarAndAdd:w,rotate:l,scale:c,set:o,str:m,sub:b,subtract:f,translate:u},Symbol.toStringTag,{value:"Module"}));e.add=_,e.copy=i,e.determinant=s,e.equals=T,e.exactEquals=v,e.frob=g,e.fromRotation=h,e.fromScaling=d,e.fromTranslation=p,e.identity=r,e.invert=n,e.mat2d=E,e.mul=S,e.multiply=a,e.multiplyScalar=y,e.multiplyScalarAndAdd=w,e.rotate=l,e.scale=c,e.set=o,e.str=m,e.sub=b,e.subtract=f,e.translate=u,Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})}))},"esri/core/libs/gl-matrix-2/factories/mat2df64":function(){define(["exports"],(function(e){"use strict";function t(){return[1,0,0,1,0,0]}function i(e){return[e[0],e[1],e[2],e[3],e[4],e[5]]}function r(e,t,i,r,o,n){return[e,t,i,r,o,n]}const o=[1,0,0,1,0,0],n=Object.freeze(Object.defineProperty({__proto__:null,IDENTITY:o,clone:i,create:t,fromValues:r},Symbol.toStringTag,{value:"Module"}));e.IDENTITY=o,e.clone=i,e.create=t,e.fromValues=r,e.mat2df64=n,Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})}))},"esri/views/2d/ViewState":function(){define(["../../chunks/tslib.es6","../../Viewpoint","../../core/JSONSupport","../../core/accessorSupport/decorators/property","../../core/has","../../core/Logger","../../core/RandomLCG","../../core/accessorSupport/decorators/subclass","../../core/libs/gl-matrix-2/math/common","../../core/libs/gl-matrix-2/math/mat2d","../../core/libs/gl-matrix-2/factories/mat2df32","../../core/libs/gl-matrix-2/factories/mat2df64","../../core/libs/gl-matrix-2/math/mat3","../../core/libs/gl-matrix-2/factories/mat3f32","../../core/libs/gl-matrix-2/math/vec2","../../core/libs/gl-matrix-2/factories/vec2f32","../../core/libs/gl-matrix-2/factories/vec2f64","../../core/libs/gl-matrix-2/types/vec2","../../geometry/Extent","../../geometry/Point","../../geometry/support/normalizeUtils","./viewpointUtils"],(function(e,t,i,r,o,n,s,a,l,c,u,h,d,p,m,g,_,f,y,w,v,T){"use strict";var S;const b=[0,0];let E=S=class extends i{constructor(e){super(e),this._viewpoint2D={center:_.create(),rotation:0,scale:0,spatialReference:void 0},this.center=[0,0],this.extent=new y,this.id=0,this.inverseTransform=h.create(),this.resolution=0,this.rotation=0,this.scale=0,this.transform=h.create(),this.transformNoRotation=h.create(),this.displayMat3=p.create(),this.displayViewMat3=p.create(),this.viewMat3=p.create(),this.viewMat2d=u.create(),this.worldScreenWidth=0,this.size=[0,0]}set pixelRatio(e){this._set("pixelRatio",e),this._update()}set size(e){this._set("size",e),this._update()}set viewpoint(e){if(e){const t=this._viewpoint2D,i=e.targetGeometry;t.center[0]=i.x,t.center[1]=i.y,t.rotation=e.rotation,t.scale=e.scale,t.spatialReference=i.spatialReference}this._update()}get visibleArea(){const[e,t]=this.size;return[this.toMap([0,0],0,0),this.toMap([0,0],0,t),this.toMap([0,0],e,t),this.toMap([0,0],e,0)]}copy(e){const t=this.size,i=this.viewpoint;return i&&t?(this.viewpoint=T.copy(i,e.viewpoint),this._set("size",m.copy(t,e.size))):(this.viewpoint=e.viewpoint.clone(),this._set("size",[e.size[0],e.size[1]])),this._set("pixelRatio",e.pixelRatio),this}clone(){return new S({size:this.size,viewpoint:this.viewpoint.clone(),pixelRatio:this.pixelRatio})}toMap(e,t,i){return f.isVec2(t)?m.transformMat2d(e,t,this.inverseTransform):(b[0]=t,b[1]=i,m.transformMat2d(e,b,this.inverseTransform))}toScreen(e,t,i){return f.isVec2(t)?m.transformMat2d(e,t,this.transform):(b[0]=t,b[1]=i,m.transformMat2d(e,b,this.transform))}toScreenNoRotation(e,t,i){return f.isVec2(t)?m.transformMat2d(e,t,this.transformNoRotation):(b[0]=t,b[1]=i,m.transformMat2d(e,b,this.transformNoRotation))}wrapMapCoordinate(e,t){m.copy(e,t);const[i]=t,[r]=this.center,{extent:o,spatialReference:n}=this;let{xmin:s,xmax:a}=o;if(n.isWrappable){const e=T.getWorldWidth(n)/2;s=Math.max(s,r-e),a=Math.min(a,r+e)}return(i<s||i>a)&&(e[0]=v.getClosestDenormalizedXToReference(i,r,n)),e}getScreenTransform(e,t){const{center:i}=this._viewpoint2D,r=this._get("pixelRatio")||1,o=this._get("size");return T.getMatrix(e,i,o,t,0,r),e}_update(){const{center:e,spatialReference:i,scale:r,rotation:o}=this._viewpoint2D,n=this._get("pixelRatio")||1,s=this._get("size"),a=new t({targetGeometry:new w(e[0],e[1],i),scale:r,rotation:o});if(this._set("viewpoint",a),!s||!i||!r)return;this.resolution=T.getResolution(a),this.rotation=o,this.scale=r,this.spatialReference=i,m.copy(this.center,e);const u=0!==s[0]?2/s[0]:0,h=0!==s[1]?-2/s[1]:0;d.set(this.displayMat3,u,0,0,0,h,0,-1,1,1);const p=d.identity(this.viewMat3),_=g.fromValues(s[0]/2,s[1]/2),f=g.fromValues(-s[0]/2,-s[1]/2),y=l.toRadian(o);d.translate(p,p,_),d.rotate(p,p,y),d.translate(p,p,f),d.multiply(this.displayViewMat3,this.displayMat3,p);const v=c.fromTranslation(this.viewMat2d,_);return c.rotate(v,v,y),c.translate(v,v,f),T.getExtent(this.extent,a,s),T.getTransform(this.transform,a,s,n),c.invert(this.inverseTransform,this.transform),T.getTransformNoRotation(this.transformNoRotation,a,s,n),this.worldScreenWidth=T.getWorldScreenWidth(this.spatialReference,this.resolution),this._set("id",this.id+1),this.notifyChange("visibleArea"),this}};return e.__decorate([r.property({readOnly:!0})],E.prototype,"id",void 0),e.__decorate([r.property({value:1,json:{write:!0}})],E.prototype,"pixelRatio",null),e.__decorate([r.property({json:{write:!0}})],E.prototype,"size",null),e.__decorate([r.property()],E.prototype,"spatialReference",void 0),e.__decorate([r.property({type:t,json:{write:!0}})],E.prototype,"viewpoint",null),e.__decorate([r.property({readOnly:!0})],E.prototype,"visibleArea",null),E=S=e.__decorate([a.subclass("esri.views.2d.ViewState")],E),E}))},"esri/core/libs/gl-matrix-2/factories/mat2df32":function(){define(["exports"],(function(e){"use strict";function t(){const e=new Float32Array(6);return e[0]=1,e[3]=1,e}function i(e){const t=new Float32Array(6);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t}function r(e,t,i,r,o,n){const s=new Float32Array(6);return s[0]=e,s[1]=t,s[2]=i,s[3]=r,s[4]=o,s[5]=n,s}function o(e,t,i,r){const o=t[r],n=t[r+1];e[r]=i[0]*o+i[2]*n+i[4],e[r+1]=i[1]*o+i[3]*n+i[5]}function n(e,t,i,r=0,n=0,s=2){const a=n||t.length/s;for(let n=r;n<a;n++)o(e,t,i,n*s)}const s=Object.freeze(Object.defineProperty({__proto__:null,clone:i,create:t,fromValues:r,transform:o,transformMany:n},Symbol.toStringTag,{value:"Module"}));e.clone=i,e.create=t,e.fromValues=r,e.mat2df32=s,e.transform=o,e.transformMany=n,Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})}))},"esri/core/libs/gl-matrix-2/math/mat3":function(){define(["exports","./common"],(function(e,t){"use strict";function i(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[4],e[4]=t[5],e[5]=t[6],e[6]=t[8],e[7]=t[9],e[8]=t[10],e}function r(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e}function o(e,t,i,r,o,n,s,a,l,c){return e[0]=t,e[1]=i,e[2]=r,e[3]=o,e[4]=n,e[5]=s,e[6]=a,e[7]=l,e[8]=c,e}function n(e){return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=1,e[5]=0,e[6]=0,e[7]=0,e[8]=1,e}function s(e,t){if(e===t){const i=t[1],r=t[2],o=t[5];e[1]=t[3],e[2]=t[6],e[3]=i,e[5]=t[7],e[6]=r,e[7]=o}else e[0]=t[0],e[1]=t[3],e[2]=t[6],e[3]=t[1],e[4]=t[4],e[5]=t[7],e[6]=t[2],e[7]=t[5],e[8]=t[8];return e}function a(e,t){const i=t[0],r=t[1],o=t[2],n=t[3],s=t[4],a=t[5],l=t[6],c=t[7],u=t[8],h=u*s-a*c,d=-u*n+a*l,p=c*n-s*l;let m=i*h+r*d+o*p;return m?(m=1/m,e[0]=h*m,e[1]=(-u*r+o*c)*m,e[2]=(a*r-o*s)*m,e[3]=d*m,e[4]=(u*i-o*l)*m,e[5]=(-a*i+o*n)*m,e[6]=p*m,e[7]=(-c*i+r*l)*m,e[8]=(s*i-r*n)*m,e):null}function l(e,t){const i=t[0],r=t[1],o=t[2],n=t[3],s=t[4],a=t[5],l=t[6],c=t[7],u=t[8];return e[0]=s*u-a*c,e[1]=o*c-r*u,e[2]=r*a-o*s,e[3]=a*l-n*u,e[4]=i*u-o*l,e[5]=o*n-i*a,e[6]=n*c-s*l,e[7]=r*l-i*c,e[8]=i*s-r*n,e}function c(e){const t=e[0],i=e[1],r=e[2],o=e[3],n=e[4],s=e[5],a=e[6],l=e[7],c=e[8];return t*(c*n-s*l)+i*(-c*o+s*a)+r*(l*o-n*a)}function u(e,t,i){const r=t[0],o=t[1],n=t[2],s=t[3],a=t[4],l=t[5],c=t[6],u=t[7],h=t[8],d=i[0],p=i[1],m=i[2],g=i[3],_=i[4],f=i[5],y=i[6],w=i[7],v=i[8];return e[0]=d*r+p*s+m*c,e[1]=d*o+p*a+m*u,e[2]=d*n+p*l+m*h,e[3]=g*r+_*s+f*c,e[4]=g*o+_*a+f*u,e[5]=g*n+_*l+f*h,e[6]=y*r+w*s+v*c,e[7]=y*o+w*a+v*u,e[8]=y*n+w*l+v*h,e}function h(e,t,i){const r=t[0],o=t[1],n=t[2],s=t[3],a=t[4],l=t[5],c=t[6],u=t[7],h=t[8],d=i[0],p=i[1];return e[0]=r,e[1]=o,e[2]=n,e[3]=s,e[4]=a,e[5]=l,e[6]=d*r+p*s+c,e[7]=d*o+p*a+u,e[8]=d*n+p*l+h,e}function d(e,t,i){const r=t[0],o=t[1],n=t[2],s=t[3],a=t[4],l=t[5],c=t[6],u=t[7],h=t[8],d=Math.sin(i),p=Math.cos(i);return e[0]=p*r+d*s,e[1]=p*o+d*a,e[2]=p*n+d*l,e[3]=p*s-d*r,e[4]=p*a-d*o,e[5]=p*l-d*n,e[6]=c,e[7]=u,e[8]=h,e}function p(e,t,i){const r=i[0],o=i[1],n=i[2];return e[0]=r*t[0],e[1]=r*t[1],e[2]=r*t[2],e[3]=o*t[3],e[4]=o*t[4],e[5]=o*t[5],e[6]=n*t[6],e[7]=n*t[7],e[8]=n*t[8],e}function m(e,t,i){const r=i[0],o=i[1];return e[0]=r*t[0],e[1]=r*t[1],e[2]=r*t[2],e[3]=o*t[3],e[4]=o*t[4],e[5]=o*t[5],e}function g(e,t){return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=1,e[5]=0,e[6]=t[0],e[7]=t[1],e[8]=1,e}function _(e,t){const i=Math.sin(t),r=Math.cos(t);return e[0]=r,e[1]=i,e[2]=0,e[3]=-i,e[4]=r,e[5]=0,e[6]=0,e[7]=0,e[8]=1,e}function f(e,t){return e[0]=t[0],e[1]=0,e[2]=0,e[3]=0,e[4]=t[1],e[5]=0,e[6]=0,e[7]=0,e[8]=1,e}function y(e,t){return e[0]=t[0],e[1]=t[1],e[2]=0,e[3]=t[2],e[4]=t[3],e[5]=0,e[6]=t[4],e[7]=t[5],e[8]=1,e}function w(e,t){const i=t[0],r=t[1],o=t[2],n=t[3],s=i+i,a=r+r,l=o+o,c=i*s,u=r*s,h=r*a,d=o*s,p=o*a,m=o*l,g=n*s,_=n*a,f=n*l;return e[0]=1-h-m,e[3]=u-f,e[6]=d+_,e[1]=u+f,e[4]=1-c-m,e[7]=p-g,e[2]=d-_,e[5]=p+g,e[8]=1-c-h,e}function v(e,t){const i=t[0],r=t[1],o=t[2],n=t[4],s=t[5],a=t[6],l=t[8],c=t[9],u=t[10],h=u*s-a*c,d=-u*n+a*l,p=c*n-s*l,m=i*h+r*d+o*p;if(!m)return null;const g=1/m;return e[0]=h*g,e[1]=(-u*r+o*c)*g,e[2]=(a*r-o*s)*g,e[3]=d*g,e[4]=(u*i-o*l)*g,e[5]=(-a*i+o*n)*g,e[6]=p*g,e[7]=(-c*i+r*l)*g,e[8]=(s*i-r*n)*g,e}function T(e,t){const i=t[0],r=t[1],o=t[2],n=t[3],s=t[4],a=t[5],l=t[6],c=t[7],u=t[8],h=t[9],d=t[10],p=t[11],m=t[12],g=t[13],_=t[14],f=t[15],y=i*a-r*s,w=i*l-o*s,v=i*c-n*s,T=r*l-o*a,S=r*c-n*a,b=o*c-n*l,E=u*g-h*m,M=u*_-d*m,x=u*f-p*m,P=h*_-d*g,R=h*f-p*g,A=d*f-p*_;let I=y*A-w*R+v*P+T*x-S*M+b*E;return I?(I=1/I,e[0]=(a*A-l*R+c*P)*I,e[1]=(l*x-s*A-c*M)*I,e[2]=(s*R-a*x+c*E)*I,e[3]=(o*R-r*A-n*P)*I,e[4]=(i*A-o*x+n*M)*I,e[5]=(r*x-i*R-n*E)*I,e[6]=(g*b-_*S+f*T)*I,e[7]=(_*v-m*b-f*w)*I,e[8]=(m*S-g*v+f*y)*I,e):null}function S(e,t,i){return e[0]=2/t,e[1]=0,e[2]=0,e[3]=0,e[4]=-2/i,e[5]=0,e[6]=-1,e[7]=1,e[8]=1,e}function b(e){return"mat3("+e[0]+", "+e[1]+", "+e[2]+", "+e[3]+", "+e[4]+", "+e[5]+", "+e[6]+", "+e[7]+", "+e[8]+")"}function E(e){return Math.sqrt(e[0]**2+e[1]**2+e[2]**2+e[3]**2+e[4]**2+e[5]**2+e[6]**2+e[7]**2+e[8]**2)}function M(e,t,i){return e[0]=t[0]+i[0],e[1]=t[1]+i[1],e[2]=t[2]+i[2],e[3]=t[3]+i[3],e[4]=t[4]+i[4],e[5]=t[5]+i[5],e[6]=t[6]+i[6],e[7]=t[7]+i[7],e[8]=t[8]+i[8],e}function x(e,t,i){return e[0]=t[0]-i[0],e[1]=t[1]-i[1],e[2]=t[2]-i[2],e[3]=t[3]-i[3],e[4]=t[4]-i[4],e[5]=t[5]-i[5],e[6]=t[6]-i[6],e[7]=t[7]-i[7],e[8]=t[8]-i[8],e}function P(e,t,i){return e[0]=t[0]*i,e[1]=t[1]*i,e[2]=t[2]*i,e[3]=t[3]*i,e[4]=t[4]*i,e[5]=t[5]*i,e[6]=t[6]*i,e[7]=t[7]*i,e[8]=t[8]*i,e}function R(e,t,i,r){return e[0]=t[0]+i[0]*r,e[1]=t[1]+i[1]*r,e[2]=t[2]+i[2]*r,e[3]=t[3]+i[3]*r,e[4]=t[4]+i[4]*r,e[5]=t[5]+i[5]*r,e[6]=t[6]+i[6]*r,e[7]=t[7]+i[7]*r,e[8]=t[8]+i[8]*r,e}function A(e,t){return e[0]===t[0]&&e[1]===t[1]&&e[2]===t[2]&&e[3]===t[3]&&e[4]===t[4]&&e[5]===t[5]&&e[6]===t[6]&&e[7]===t[7]&&e[8]===t[8]}function I(e,i){const r=e[0],o=e[1],n=e[2],s=e[3],a=e[4],l=e[5],c=e[6],u=e[7],h=e[8],d=i[0],p=i[1],m=i[2],g=i[3],_=i[4],f=i[5],y=i[6],w=i[7],v=i[8],T=t.getEpsilon();return Math.abs(r-d)<=T*Math.max(1,Math.abs(r),Math.abs(d))&&Math.abs(o-p)<=T*Math.max(1,Math.abs(o),Math.abs(p))&&Math.abs(n-m)<=T*Math.max(1,Math.abs(n),Math.abs(m))&&Math.abs(s-g)<=T*Math.max(1,Math.abs(s),Math.abs(g))&&Math.abs(a-_)<=T*Math.max(1,Math.abs(a),Math.abs(_))&&Math.abs(l-f)<=T*Math.max(1,Math.abs(l),Math.abs(f))&&Math.abs(c-y)<=T*Math.max(1,Math.abs(c),Math.abs(y))&&Math.abs(u-w)<=T*Math.max(1,Math.abs(u),Math.abs(w))&&Math.abs(h-v)<=T*Math.max(1,Math.abs(h),Math.abs(v))}function C(e){const i=t.getEpsilon(),r=e[0],o=e[1],n=e[2],s=e[3],a=e[4],l=e[5],c=e[6],u=e[7],h=e[8];return Math.abs(1-(r*r+s*s+c*c))<=i&&Math.abs(1-(o*o+a*a+u*u))<=i&&Math.abs(1-(n*n+l*l+h*h))<=i}const D=u,O=x,L=Object.freeze(Object.defineProperty({__proto__:null,add:M,adjoint:l,copy:r,determinant:c,equals:I,exactEquals:A,frob:E,fromMat2d:y,fromMat4:i,fromQuat:w,fromRotation:_,fromScaling:f,fromTranslation:g,identity:n,invert:a,isOrthoNormal:C,mul:D,multiply:u,multiplyScalar:P,multiplyScalarAndAdd:R,normalFromMat4:T,normalFromMat4Legacy:v,projection:S,rotate:d,scale:p,scaleByVec2:m,set:o,str:b,sub:O,subtract:x,translate:h,transpose:s},Symbol.toStringTag,{value:"Module"}));e.add=M,e.adjoint=l,e.copy=r,e.determinant=c,e.equals=I,e.exactEquals=A,e.frob=E,e.fromMat2d=y,e.fromMat4=i,e.fromQuat=w,e.fromRotation=_,e.fromScaling=f,e.fromTranslation=g,e.identity=n,e.invert=a,e.isOrthoNormal=C,e.mat3=L,e.mul=D,e.multiply=u,e.multiplyScalar=P,e.multiplyScalarAndAdd=R,e.normalFromMat4=T,e.normalFromMat4Legacy=v,e.projection=S,e.rotate=d,e.scale=p,e.scaleByVec2=m,e.set=o,e.str=b,e.sub=O,e.subtract=x,e.translate=h,e.transpose=s,Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})}))},"esri/core/libs/gl-matrix-2/factories/mat3f32":function(){define(["exports"],(function(e){"use strict";function t(){const e=new Float32Array(9);return e[0]=1,e[4]=1,e[8]=1,e}function i(e){const t=new Float32Array(9);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t}function r(e,t,i,r,o,n,s,a,l){const c=new Float32Array(9);return c[0]=e,c[1]=t,c[2]=i,c[3]=r,c[4]=o,c[5]=n,c[6]=s,c[7]=a,c[8]=l,c}const o=Object.freeze(Object.defineProperty({__proto__:null,clone:i,create:t,fromValues:r},Symbol.toStringTag,{value:"Module"}));e.clone=i,e.create=t,e.fromValues=r,e.mat3f32=o,Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})}))},"esri/core/libs/gl-matrix-2/factories/vec2f32":function(){define(["exports"],(function(e){"use strict";function t(){return new Float32Array(2)}function i(e){const t=new Float32Array(2);return t[0]=e[0],t[1]=e[1],t}function r(e,t){const i=new Float32Array(2);return i[0]=e,i[1]=t,i}function o(){return t()}function n(){return r(1,1)}function s(){return r(1,0)}function a(){return r(0,1)}const l=o(),c=n(),u=s(),h=a(),d=Object.freeze(Object.defineProperty({__proto__:null,ONES:c,UNIT_X:u,UNIT_Y:h,ZEROS:l,clone:i,create:t,fromValues:r,ones:n,unitX:s,unitY:a,zeros:o},Symbol.toStringTag,{value:"Module"}));e.ONES=c,e.UNIT_X=u,e.UNIT_Y=h,e.ZEROS=l,e.clone=i,e.create=t,e.fromValues=r,e.ones=n,e.unitX=s,e.unitY=a,e.vec2f32=d,e.zeros=o,Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})}))},"esri/core/libs/gl-matrix-2/types/vec2":function(){define(["exports"],(function(e){"use strict";function t(e){return e instanceof Float32Array&&e.length>=2}function i(e){return Array.isArray(e)&&e.length>=2}e.isVec2=function(e){return t(e)||i(e)},e.isVec2f32=t,e.isVec2f64=i,Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})}))},"esri/views/support/RenderState":function(){define(["exports"],(function(e){"use strict";var t;e.RenderState=void 0,(t=e.RenderState||(e.RenderState={}))[t.ANIMATING=0]="ANIMATING",t[t.INTERACTING=1]="INTERACTING",t[t.IDLE=2]="IDLE",Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})}))},"esri/views/support/Scheduler":function(){define(["exports","../../core/Handles","../../core/has","../../core/Logger","../../core/maybe","../../core/PerformanceSampler","../../core/PooledArray","../../core/promiseUtils","../../core/reactiveUtils","../../core/signal","../../core/time","../../layers/support/PromiseQueue","./debugFlags","./RenderState","./Yield"],(function(e,t,i,r,o,n,s,a,l,c,u,h,d,p,m){"use strict";var g;e.TaskPriority=void 0,(g=e.TaskPriority||(e.TaskPriority={})).RESOURCE_CONTROLLER_IMMEDIATE="immediate",g.RESOURCE_CONTROLLER="schedule",g.SLIDE="slide",g.STREAM_DATA_LOADER="stream loader",g.ELEVATION_QUERY="elevation query",g.TERRAIN_SURFACE="terrain",g.SURFACE_GEOMETRY_UPDATES="surface geometry updates",g.LOD_RENDERER="LoD renderer",g.GRAPHICS_CORE="Graphics3D",g.I3S_CONTROLLER="I3S",g.POINT_CLOUD_LAYER="point cloud",g.FEATURE_TILE_FETCHER="feature fetcher",g.OVERLAY="overlay",g.OVERLAY_RENDERER="overlay renderer",g.STAGE="stage",g.GRAPHICS_DECONFLICTOR="graphics deconflictor",g.FILTER_VISIBILITY="Graphics3D filter visibility",g.SCALE_VISIBILITY="Graphics3D scale visibility",g.FRUSTUM_VISIBILITY="Graphics3D frustum visibility",g.POINT_OF_INTEREST_FREQUENT="POI frequent",g.POINT_OF_INTEREST_INFREQUENT="POI infrequent",g.LABELER="labeler",g.FEATURE_QUERY_ENGINE="feature query",g.FEATURE_TILE_TREE="feature tile tree",g.FEATURE_TILE_TREE_ACTIVE="fast feature tile tree",g.ELEVATION_ALIGNMENT="elevation alignment",g.ELEVATION_ALIGNMENT_SCENE="elevation alignment scene",g.TEXT_TEXTURE_ATLAS="text texture atlas",g.TEXTURE_UNLOAD="texture unload",g.LINE_OF_SIGHT_TOOL="line of sight tool",g.LINE_OF_SIGHT_TOOL_INTERACTIVE="interactive line of sight tool",g.ELEVATION_PROFILE="elevation profile",g.SNAPPING="snapping",g.SHADOW_ACCUMULATOR="shadow accumulator",g.CLOUDS_GENERATOR="clouds generator",g.MAPVIEW_FETCH_QUEUE="mapview fetch queue",g.MAPVIEW_LAYERVIEW_UPDATE="mapview layerview update",g.MAPVIEW_VECTOR_TILE_PARSING_QUEUE="mapview vector tile parsing queue",g[g.NONE=0]="NONE",g[g.TEST_PRIO=1]="TEST_PRIO";const _=new Map([[e.TaskPriority.RESOURCE_CONTROLLER_IMMEDIATE,0],[e.TaskPriority.RESOURCE_CONTROLLER,4],[e.TaskPriority.SLIDE,0],[e.TaskPriority.STREAM_DATA_LOADER,0],[e.TaskPriority.ELEVATION_QUERY,0],[e.TaskPriority.TERRAIN_SURFACE,1],[e.TaskPriority.SURFACE_GEOMETRY_UPDATES,1],[e.TaskPriority.LOD_RENDERER,2],[e.TaskPriority.GRAPHICS_CORE,2],[e.TaskPriority.I3S_CONTROLLER,2],[e.TaskPriority.POINT_CLOUD_LAYER,2],[e.TaskPriority.FEATURE_TILE_FETCHER,2],[e.TaskPriority.CLOUDS_GENERATOR,2],[e.TaskPriority.OVERLAY,4],[e.TaskPriority.OVERLAY_RENDERER,4],[e.TaskPriority.STAGE,4],[e.TaskPriority.GRAPHICS_DECONFLICTOR,4],[e.TaskPriority.FILTER_VISIBILITY,4],[e.TaskPriority.SCALE_VISIBILITY,4],[e.TaskPriority.FRUSTUM_VISIBILITY,4],[e.TaskPriority.POINT_OF_INTEREST_FREQUENT,6],[e.TaskPriority.POINT_OF_INTEREST_INFREQUENT,30],[e.TaskPriority.LABELER,8],[e.TaskPriority.FEATURE_QUERY_ENGINE,8],[e.TaskPriority.FEATURE_TILE_TREE,16],[e.TaskPriority.FEATURE_TILE_TREE_ACTIVE,0],[e.TaskPriority.ELEVATION_ALIGNMENT,12],[e.TaskPriority.ELEVATION_ALIGNMENT_SCENE,14],[e.TaskPriority.TEXT_TEXTURE_ATLAS,12],[e.TaskPriority.TEXTURE_UNLOAD,12],[e.TaskPriority.LINE_OF_SIGHT_TOOL,16],[e.TaskPriority.LINE_OF_SIGHT_TOOL_INTERACTIVE,0],[e.TaskPriority.SNAPPING,0],[e.TaskPriority.SHADOW_ACCUMULATOR,30],[e.TaskPriority.MAPVIEW_FETCH_QUEUE,0],[e.TaskPriority.MAPVIEW_LAYERVIEW_UPDATE,2],[e.TaskPriority.MAPVIEW_VECTOR_TILE_PARSING_QUEUE,0]]);function f(e){return _.has(e)?_.get(e):"number"==typeof e?e:1}const y=u.Milliseconds(6.5),w=u.Milliseconds(1),v=u.Milliseconds(30),T=u.Milliseconds(1e3/30),S=u.Milliseconds(100);var b,E;!function(i){i.Scheduler=class{get updating(){return this._updating.value}_updatingChanged(){this._updating.value=this._tasks.some((e=>e.needsUpdate))}constructor(){this._updating=c.signal(!0),this._microTaskQueued=!1,this._frameNumber=0,this.performanceInfo={total:new n("total"),tasks:new Map},this._frameTaskTimes=new Map,this._budget=new g,this._state=p.RenderState.INTERACTING,this._tasks=new s,this._runQueue=new s,this._load=0,this._idleStateCallbacks=new s,this._idleUpdatesStartFired=!1,this._forceTask=!1,this._debug=!1,this._debugHandle=l.watch((()=>d.SCHEDULER_LOG_SLOW_TASKS),(e=>this._debug=e),l.initial);for(const t of Object.keys(e.TaskPriority))this.performanceInfo.tasks.set(e.TaskPriority[t],new n(e.TaskPriority[t]))}destroy(){this._tasks.toArray().forEach((e=>e.remove())),this._tasks.clear(),o.removeMaybe(this._debugHandle),this._microTaskQueued=!1,this._updatingChanged()}taskRunningChanged(e){this._updatingChanged(),e&&this._budget.remaining>0&&!this._microTaskQueued&&(this._microTaskQueued=!0,queueMicrotask((()=>{this._microTaskQueued&&(this._microTaskQueued=!1,this._budget.remaining>0&&this._schedule()&&this._runFrame())})))}registerTask(e,t){const i=new a(this,e,t);return this._tasks.push(i),this._updatingChanged(),this.performanceInfo.tasks.has(e)||this.performanceInfo.tasks.set(e,new n(e)),i}registerIdleStateCallbacks(e,t){const i={idleBegin:e,idleEnd:t};this._idleStateCallbacks.push(i),this.state===p.RenderState.IDLE&&this._idleUpdatesStartFired&&i.idleBegin();const r=this;return{remove:()=>this._removeIdleStateCallbacks(i),set idleBegin(e){r._idleUpdatesStartFired&&(i.idleEnd(),r._state===p.RenderState.IDLE&&e()),i.idleBegin=e},set idleEnd(e){i.idleEnd=e}}}get load(){return this._load}set state(e){this._state!==e&&(this._state=e,this.state!==p.RenderState.IDLE&&this._idleUpdatesStartFired&&(this._idleUpdatesStartFired=!1,this._idleStateCallbacks.forAll((e=>e.idleEnd()))))}get state(){return this._state}frame(e){this._startFrameTaskTimes();const t=this._updateBudget(e);if(t){const e=this._budget.now();this._runFrame(),this._recordFrameTaskTimes(this._budget.now()-e)}else this._recordFrameTaskTimes(0);return t}_updateBudget(e){this._test&&(this._test.usedBudget=0),++this._frameNumber;let t=y,i=e.frameDuration,r=w;switch(this.state){case p.RenderState.IDLE:t=u.Milliseconds(0),i=u.Milliseconds(Math.max(S,e.frameDuration)),r=v;break;case p.RenderState.INTERACTING:i=u.Milliseconds(Math.max(T,e.frameDuration));case p.RenderState.ANIMATING:}return i=u.Milliseconds(i-e.elapsedFrameTime-t),this.state!==p.RenderState.IDLE&&i<w&&!this._forceTask?(this._forceTask=!0,!1):(i=u.Milliseconds(Math.max(i,r)),this._budget.reset(i),this._updateLoad(),this._schedule())}_runFrame(){switch(this._forceTask=!1,this._microTaskQueued=!1,this.state){case p.RenderState.IDLE:this._idleUpdatesStartFired||(this._idleUpdatesStartFired=!0,this._idleStateCallbacks.forAll((e=>e.idleBegin()))),this._runIdle();break;case p.RenderState.INTERACTING:this._runInteracting();break;default:this._runAnimating()}this._test&&(this._test.usedBudget=this._budget.elapsed)}stopFrame(){this._budget.reset(u.Milliseconds(0)),this._budget.madeProgress()}_removeIdleStateCallbacks(e){this._idleUpdatesStartFired&&e.idleEnd(),this._idleStateCallbacks.removeUnordered(e)}removeTask(e){this._tasks.removeUnordered(e),this._runQueue.removeUnordered(e),this._updatingChanged()}_updateTask(e){this._tasks.forAll((t=>{t.name===e&&t.setPriority(e)}))}_getState(t){if(this._runQueue.some((e=>e.name===t)))return e.TaskState.SCHEDULED;let i=e.TaskState.IDLE;return this._tasks.forAll((r=>{r.name===t&&r.needsUpdate&&(r.schedulePriority<=1?i=e.TaskState.READY:i!==e.TaskState.READY&&(i=e.TaskState.WAITING))})),i}_getRuntime(e){let t=0;return this._tasks.forAll((i=>{i.name===e&&(t+=i.runtime)})),t}_resetRuntimes(){this._tasks.forAll((e=>e.runtime=0))}_getRunning(){const e=new Map;if(this._tasks.forAll((t=>{t.needsUpdate&&e.set(t.name,(e.get(t.name)||0)+1)})),0===e.size)return null;let t="";return e.forEach(((e,i)=>{t+=e>1?` ${e}x ${i}`:` ${i}`})),t}_runIdle(){this._run()}_runInteracting(){this._run()}_runAnimating(){this._run()}_updateLoad(){const e=this._tasks.reduce(((e,t)=>t.needsUpdate?++e:e),0);this._load=.9*this._load+e*(1-.9)}_schedule(){for(this._runQueue.filterInPlace((e=>!!e.needsUpdate||(e.schedulePriority=e.basePriority,!1))),this._tasks.forAll((e=>{0===e.basePriority&&e.needsUpdate&&!this._runQueue.includes(e)&&e.blockFrame!==this._frameNumber&&this._runQueue.unshift(e)}));0===this._runQueue.length;){let e=!1,t=0;if(this._tasks.forAll((i=>{i.needsUpdate&&0!==i.schedulePriority&&0!==i.basePriority&&i.blockFrame!==this._frameNumber&&(e=!0,t=Math.max(t,i.basePriority),1===i.schedulePriority?(i.schedulePriority=0,this._runQueue.push(i)):--i.schedulePriority)})),!e)return this._updatingChanged(),!1}return this._updatingChanged(),!0}_run(){do{for(;this._runQueue.length>0;){const t=this._budget.now(),i=this._runQueue.pop();this._budget.resetProgress();try{i.task.runTask(this._budget)===m.Yield&&(i.blockFrame=this._frameNumber)}catch(e){r.getLogger("esri.views.support.Scheduler").error(`Exception in task "${i.name}"`,e),i.blockFrame=this._frameNumber}!this._budget.hasProgressed&&i.blockFrame!==this._frameNumber&&i.needsUpdate&&(i.name,e.TaskPriority.I3S_CONTROLLER,i.blockFrame=this._frameNumber),i.schedulePriority=i.basePriority;const o=this._budget.now()-t;if(i.runtime+=o,this._frameTaskTimes.set(i.priority,this._frameTaskTimes.get(i.priority)+o),this._budget.remaining<=0)return void this._updatingChanged()}}while(this._schedule());this._updatingChanged()}_startFrameTaskTimes(){for(const t of Object.keys(e.TaskPriority))this._frameTaskTimes.set(e.TaskPriority[t],0)}_recordFrameTaskTimes(e){this._frameTaskTimes.forEach(((e,t)=>this.performanceInfo.tasks.get(t).push(e))),this.performanceInfo.total.push(e)}get test(){return this._test}};class a{get task(){return this._task.value}get updating(){return this._queue.running}constructor(e,i,r){this._scheduler=e,this.name=i,this.blockFrame=0,this.runtime=0,this._queue=new h.PromiseQueue,this._handles=new t,this._basePriority=f(i),this.schedulePriority=this._basePriority,this._task=c.signal(null!=r?r:this._queue),this._handles.add(l.when((()=>this.task.running),(t=>e.taskRunningChanged(t))))}remove(){this.processQueue(M),this._scheduler.removeTask(this),this.schedule=x.schedule,this.reschedule=x.reschedule,this._handles.destroy()}get basePriority(){return this._basePriority}setPriority(e){if(this.name===e)return;this.name=e;const t=f(e);0!==this._basePriority&&0===this.schedulePriority||(this.schedulePriority=t),this._basePriority=t}get priority(){return this.name}set priority(e){this.setPriority(e)}get needsUpdate(){return this.updating||this.task.running}schedule(e,t,i){return this._queue.push(e,t,i)}reschedule(e,t,i){return this._queue.unshift(e,t,i)}processQueue(e){return this._queue.runTask(e)}}class g{constructor(){this._begin=performance?.now()??0,this._budget=0,this._done=!1,this._progressed=!1,this._enabled=!0}run(e){return!this.done&&(!0===e()&&this.madeProgress(),!0)}get done(){return this._done}get budget(){return this._budget}madeProgress(){return this._progressed=!0,this._done=this.elapsed>=this._budget&&this._enabled,this._done}get enabled(){return this._enabled}set enabled(e){this._enabled=e}reset(e){this._begin=this.now(),this._budget=e,this.resetProgress()}get remaining(){return Math.max(this._budget-this.elapsed,0)}now(){return performance.now()}get elapsed(){return this.now()-this._begin}resetProgress(){this._progressed=!1,this._done=!1}get hasProgressed(){return this._progressed}}i.Budget=g}(b||(b={})),e.TaskState=void 0,(E=e.TaskState||(e.TaskState={})).SCHEDULED="s",E.READY="r",E.WAITING="w",E.IDLE="i";const M=new b.Budget;M.enabled=!1;const x=new class{remove(){}processQueue(){}schedule(e,t,i){try{if(a.isAborted(t)){const e=a.createAbortError();return i?Promise.resolve(i(e)):Promise.reject(e)}return a.when(e(M))}catch(e){return Promise.reject(e)}}reschedule(e,t,i){return this.schedule(e,t,i)}};e.ImmediateTask=x,e.getTaskPriority=f,e.makeBudget=function(e){const t=new b.Budget;return t.reset(e),t},e.newScheduler=function(){return new b.Scheduler},e.noBudget=M,e.taskPriorities=_,Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})}))},"esri/layers/support/PromiseQueue":function(){define(["exports","../../core/promiseUtils","../../core/signal","../../views/support/Yield"],(function(e,t,i,r){"use strict";class o{constructor(e,t,i,r=void 0,o=void 0){this.resolve=e,this.reject=t,this.callback=i,this.signal=r,this.abortCallback=o}}e.PromiseQueue=class{constructor(){this._tasks=new Array,this._numPendingTasks=i.signal(0),this._running=i.signal(!1)}get length(){return this._tasks.length}get updating(){return this._numPendingTasks.value>0}get running(){return this._running.value}_updateRunning(){this._running.value=this._tasks.length>0}destroy(){this.cancelAll()}runTask(e){if(0===this.length)return r.Yield;for(;!e.done&&this._process(e);)e.madeProgress()}push(e,t,i){return new Promise(((r,n)=>{this._tasks.push(new o(r,n,e,t,i)),++this._numPendingTasks.value,this._updateRunning()})).finally((()=>--this._numPendingTasks.value))}unshift(e,t,i){return new Promise(((r,n)=>{this._tasks.unshift(new o(r,n,e,t,i)),++this._numPendingTasks.value,this._updateRunning()})).finally((()=>--this._numPendingTasks.value))}_process(e){if(0===this._tasks.length)return!1;const i=this._tasks.shift();this._updateRunning();try{const r=t.isAborted(i.signal);if(r&&!i.abortCallback)i.reject(t.createAbortError());else{const o=r?i.abortCallback?.(t.createAbortError()):i.callback(e);t.isPromiseLike(o)?o.then(i.resolve,i.reject):i.resolve(o)}}catch(e){i.reject(e)}return!0}cancelAll(){const e=t.createAbortError();for(const t of this._tasks)if(t.abortCallback){const i=t.abortCallback(e);t.resolve(i)}else t.reject(e);this._tasks.length=0,this._updateRunning()}},Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})}))},"esri/views/support/Yield":function(){define(["exports"],(function(e){"use strict";const t=Symbol("Yield");e.Yield=t,Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})}))},"esri/views/support/debugFlags":function(){define(["../../chunks/tslib.es6","../../core/Accessor","../../core/accessorSupport/decorators/property","../../core/has","../../core/Logger","../../core/RandomLCG","../../core/accessorSupport/decorators/subclass"],(function(e,t,i,r,o,n,s){"use strict";let a=class extends t{constructor(){super(...arguments),this.SCHEDULER_LOG_SLOW_TASKS=!1,this.FEATURE_SERVICE_SNAPPING_SOURCE_TILE_TREE_SHOW_TILES=!1}};return e.__decorate([i.property()],a.prototype,"SCHEDULER_LOG_SLOW_TASKS",void 0),e.__decorate([i.property()],a.prototype,"FEATURE_SERVICE_SNAPPING_SOURCE_TILE_TREE_SHOW_TILES",void 0),a=e.__decorate([s.subclass("esri.views.support.debugFlags")],a),new a}))},"esri/views/2d/MapViewConstraints":function(){define(["../../chunks/tslib.es6","../../core/Accessor","../../core/Collection","../../core/accessorSupport/decorators/property","../../core/has","../../core/Logger","../../core/RandomLCG","../../core/accessorSupport/decorators/subclass","../../geometry/Extent","../../geometry/Polygon","../../layers/support/LOD","./constraints/GeometryConstraint","./constraints/RotationConstraint","./constraints/ZoomConstraint"],(function(e,t,i,r,o,n,s,a,l,c,u,h,d,p){"use strict";const m={base:null,key:"type",typeMap:{extent:l,polygon:c}};let g=class extends t{constructor(e){super(e),this.lods=null,this.minScale=0,this.maxScale=0,this.minZoom=-1,this.maxZoom=-1,this.rotationEnabled=!0,this.snapToZoom=!0,this.customConstraints=new i}destroy(){this.view=null}get effectiveLODs(){return this._zoom.effectiveLODs}get effectiveMinScale(){return this._zoom.effectiveMinScale}get effectiveMaxScale(){return this._zoom.effectiveMaxScale}get effectiveMinZoom(){return this._zoom.effectiveMinZoom}get effectiveMaxZoom(){return this._zoom.effectiveMaxZoom}set geometry(e){e?this._set("geometry",e):this._set("geometry",null)}get version(){return`${this._zoom?.uid}/${this._rotation?.uid}/${this._geometry?.uid}`}get _geometry(){const e=this._get("_geometry");return e&&this.geometry===e.geometry&&this.view?.constraintsInfo.spatialReference===e.spatialReference?e:new h.GeometryConstraint({geometry:this.geometry,spatialReference:this.view?.constraintsInfo.spatialReference})}get _rotation(){return new d({rotationEnabled:this.rotationEnabled})}get _zoom(){const e=this._get("_zoom"),t=this.lods||this.view?.constraintsInfo.lods,i=this.minZoom,r=this.maxZoom,o=this.minScale,n=this.maxScale,s=this.snapToZoom;return e&&e.lods===t&&e.minZoom===i&&e.maxZoom===r&&e.minScale===o&&e.maxScale===n&&e.snapToZoom===s?e:new p({lods:t,minZoom:i,maxZoom:r,minScale:o,maxScale:n,snapToZoom:s})}canZoomInTo(e){const t=this.effectiveMaxScale;return 0===t||e>=t}canZoomOutTo(e){const t=this.effectiveMinScale;return 0===t||e<=t}constrain(e,t){return this._zoom.constrain(e,t),this._rotation.constrain(e,t),this._geometry.constrain(e,t),this.customConstraints.forEach((i=>i.constrain(e,t))),e}constrainByGeometry(e){return this._geometry.constrain(e),this.customConstraints.forEach((t=>t.applyPanConstraint?.(e))),e}fit(e){return this._zoom.fit(e)}zoomToScale(e){return this._zoom.zoomToScale(e)}scaleToZoom(e){return this._zoom.scaleToZoom(e)}snapScale(e){return this._zoom.snapToClosestScale(e)}snapToNextScale(e){return this._zoom.snapToNextScale(e)}snapToPreviousScale(e){return this._zoom.snapToPreviousScale(e)}};return e.__decorate([r.property({readOnly:!0})],g.prototype,"effectiveLODs",null),e.__decorate([r.property({readOnly:!0})],g.prototype,"effectiveMinScale",null),e.__decorate([r.property({readOnly:!0})],g.prototype,"effectiveMaxScale",null),e.__decorate([r.property({readOnly:!0})],g.prototype,"effectiveMinZoom",null),e.__decorate([r.property({readOnly:!0})],g.prototype,"effectiveMaxZoom",null),e.__decorate([r.property({types:m,value:null})],g.prototype,"geometry",null),e.__decorate([r.property({type:[u]})],g.prototype,"lods",void 0),e.__decorate([r.property()],g.prototype,"minScale",void 0),e.__decorate([r.property()],g.prototype,"maxScale",void 0),e.__decorate([r.property()],g.prototype,"minZoom",void 0),e.__decorate([r.property()],g.prototype,"maxZoom",void 0),e.__decorate([r.property()],g.prototype,"rotationEnabled",void 0),e.__decorate([r.property()],g.prototype,"snapToZoom",void 0),e.__decorate([r.property({type:i})],g.prototype,"customConstraints",void 0),e.__decorate([r.property()],g.prototype,"view",void 0),e.__decorate([r.property({readOnly:!0})],g.prototype,"version",null),e.__decorate([r.property({type:h.GeometryConstraint,readOnly:!0})],g.prototype,"_geometry",null),e.__decorate([r.property({type:d})],g.prototype,"_rotation",null),e.__decorate([r.property({readOnly:!0,type:p})],g.prototype,"_zoom",null),g=e.__decorate([a.subclass("esri.views.2d.MapViewConstraints")],g),g}))},"esri/views/2d/constraints/GeometryConstraint":function(){define(["exports","../../../chunks/tslib.es6","../../../core/Accessor","../../../core/Identifiable","../../../core/Logger","../../../core/accessorSupport/decorators/property","../../../core/has","../../../core/RandomLCG","../../../core/accessorSupport/decorators/subclass","../../../geometry/projectionUtils","../../../geometry/support/contains","../../../geometry/support/near"],(function(e,t,i,r,o,n,s,a,l,c,u,h){"use strict";var d;e.GeometryConstraint=d=class extends(r.NumericIdentifiableMixin(i)){constructor(e){super(e),this.geometry=null,this.spatialReference=null}get normalizedGeometry(){if(null==this.geometry||!this.spatialReference)return null;if(!this.spatialReference.equals(this.geometry.spatialReference))try{return c.project(this.geometry,this.spatialReference)}catch(e){return o.getLogger(this).error("#constraints.geometry","could not project the geometry to the view's spatial reference",{geometry:this.geometry,spatialReference:this.spatialReference,error:e}),null}return this.geometry}constrain(e,t){if(null==this.normalizedGeometry)return e;const i=e.targetGeometry;if("extent"===this.normalizedGeometry.type?u.extentContainsPoint(this.normalizedGeometry,i):u.polygonContainsPoint(this.normalizedGeometry,i))return e;const{coordinate:r}=h.nearestCoordinate(this.normalizedGeometry,i);return r?(e.targetGeometry=r,e):e}clone(){return new d({geometry:this.geometry?.clone(),spatialReference:this.spatialReference?.clone()})}},t.__decorate([n.property({constructOnly:!0})],e.GeometryConstraint.prototype,"geometry",void 0),t.__decorate([n.property({readOnly:!0})],e.GeometryConstraint.prototype,"normalizedGeometry",null),t.__decorate([n.property({constructOnly:!0})],e.GeometryConstraint.prototype,"spatialReference",void 0),e.GeometryConstraint=d=t.__decorate([l.subclass("esri.views.2d.constraints.GeometryConstraint")],e.GeometryConstraint),Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})}))},"esri/geometry/support/near":function(){define(["exports","../../core/Error","../../core/libs/gl-matrix-2/math/vec2","../Point","./coordsUtils"],(function(e,t,i,r,o){"use strict";e.nearestCoordinate=function(e,n){const{spatialReference:s}=n,a=[n.x,n.y];let l,c,u,h;const d=[0,0],p=function(e){switch(e.type){case"extent":return[[[e.xmin,e.ymin],[e.xmin,e.ymax],[e.xmax,e.ymax],[e.xmax,e.ymin],[e.xmin,e.ymin]]];case"polygon":return e.rings;case"polyline":return e.paths}}(e);for(let e=0;e<p.length;e++){const t=p[e];for(let r=0;r<t.length-1;r++){o.projectPointOnLine(d,a,t,r);const n=i.distance(a,d);(null==l||n<l)&&(l=n,c=[...d],u=e,h=r)}}if(null==l||!c||null==u||null==h)throw new t("nearest-coordinate:failed","Failed to find the nearest coordinate");const[m,g]=c;return{coordinate:new r({x:m,y:g,spatialReference:s}),distance:l}},Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})}))},"esri/views/2d/constraints/RotationConstraint":function(){define(["../../../chunks/tslib.es6","../../../core/Accessor","../../../core/Identifiable","../../../core/accessorSupport/decorators/property","../../../core/has","../../../core/Logger","../../../core/RandomLCG","../../../core/accessorSupport/decorators/subclass"],(function(e,t,i,r,o,n,s,a){"use strict";var l;let c=l=class extends(i.NumericIdentifiableMixin(t)){constructor(){super(...arguments),this.enabled=!0,this.rotationEnabled=!0}constrain(e,t){return this.enabled&&t?(this.rotationEnabled||(e.rotation=t.rotation),e):e}clone(){return new l({enabled:this.enabled,rotationEnabled:this.rotationEnabled})}};return e.__decorate([r.property()],c.prototype,"enabled",void 0),e.__decorate([r.property()],c.prototype,"rotationEnabled",void 0),c=l=e.__decorate([a.subclass("esri.views.2d.constraints.RotationConstraint")],c),c}))},"esri/views/2d/constraints/ZoomConstraint":function(){define(["../../../chunks/tslib.es6","../../../core/Accessor","../../../core/Identifiable","../../../core/accessorSupport/decorators/property","../../../core/has","../../../core/Logger","../../../core/RandomLCG","../../../core/accessorSupport/decorators/subclass"],(function(e,t,i,r,o,n,s,a){"use strict";var l;let c=l=class extends(i.NumericIdentifiableMixin(t)){constructor(e){super(e),this._lodByScale={},this._scales=[],this.effectiveLODs=null,this.effectiveMinZoom=-1,this.effectiveMaxZoom=-1,this.effectiveMinScale=0,this.effectiveMaxScale=0,this.lods=null,this.minZoom=-1,this.maxZoom=-1,this.minScale=0,this.maxScale=0,this.snapToZoom=!0}initialize(){let e,{lods:t,minScale:i,maxScale:r,minZoom:o,maxZoom:n}=this,s=-1,a=-1,l=!1,c=!1;if(0!==i&&0!==r&&i<r&&([i,r]=[r,i]),!t?.length)return this._set("effectiveMinScale",i),void this._set("effectiveMaxScale",r);t=t.map((e=>e.clone())),t.sort(((e,t)=>t.scale-e.scale)),t.forEach(((e,t)=>e.level=t));for(const o of t)!l&&i>0&&i>=o.scale&&(s=o.level,l=!0),!c&&r>0&&r>=o.scale&&(a=e?e.level:-1,c=!0),e=o;-1===o&&(o=0===i?0:s),-1===n&&(n=0===r?t.length-1:a),o=Math.max(o,0),o=Math.min(o,t.length-1),n=Math.max(n,0),n=Math.min(n,t.length-1),o>n&&([o,n]=[n,o]),i=t[o].scale,r=t[n].scale,t.splice(0,o),t.splice(n-o+1),t.forEach(((e,t)=>{this._lodByScale[e.scale]=e,this._scales[t]=e.scale})),this._set("effectiveLODs",t),this._set("effectiveMinZoom",o),this._set("effectiveMaxZoom",n),this._set("effectiveMinScale",i),this._set("effectiveMaxScale",r)}constrain(e,t){if(t&&e.scale===t.scale)return e;const i=this.effectiveMinScale,r=this.effectiveMaxScale,o=e.targetGeometry,n=t&&t.targetGeometry,s=0!==r&&e.scale<r,a=0!==i&&e.scale>i;if(s||a){const s=a?i:r;if(t&&n){const i=(s-t.scale)/(e.scale-t.scale);o.x=n.x+(o.x-n.x)*i,o.y=n.y+(o.y-n.y)*i}e.scale=s}return this.snapToZoom&&this.effectiveLODs&&(e.scale=this._getClosestScale(e.scale)),e}fit(e){if(!this.effectiveLODs||!this.snapToZoom)return this.constrain(e,null);const t=this.scaleToZoom(e.scale),i=Math.abs(t-Math.floor(t));return e.scale=this.zoomToScale(i>.99?Math.round(t):Math.floor(t)),e}zoomToScale(e){if(!this.effectiveLODs)return 0;e-=this.effectiveMinZoom,e=Math.max(0,e);const t=this._scales;if(e<=0)return t[0];if(e>=t.length)return t[t.length-1];const i=Math.floor(e),r=Math.ceil(e);return t[i]+(e-i)*(t[r]-t[i])}scaleToZoom(e){if(!this.effectiveLODs)return-1;const t=this._scales;let i,r;if(e>=t[0])return this.effectiveMinZoom;if(e<=t[t.length-1])return this.effectiveMaxZoom;for(let o=0;o<t.length-1;o++){if(i=t[o],r=t[o+1],r===e)return o+this.effectiveMinZoom+1;if(i>e&&r<e)return o+this.effectiveMinZoom+1-(e-r)/(i-r)}return-1}snapToClosestScale(e){if(!this.effectiveLODs)return e;const t=this.scaleToZoom(e);return this.zoomToScale(Math.round(t))}snapToNextScale(e,t=.5){if(!this.effectiveLODs)return e*t;const i=Math.round(this.scaleToZoom(e));return this.zoomToScale(i+1)}snapToPreviousScale(e,t=2){if(!this.effectiveLODs)return e*t;const i=Math.round(this.scaleToZoom(e));return this.zoomToScale(i-1)}clone(){return new l({lods:this.lods,minZoom:this.minZoom,maxZoom:this.maxZoom,minScale:this.minScale,maxScale:this.maxScale})}_getClosestScale(e){return this._lodByScale[e]||(e=this._scales.reduce(((t,i)=>Math.abs(i-e)<=Math.abs(t-e)?i:t),this._scales[0])),this._lodByScale[e].scale}};return e.__decorate([r.property({readOnly:!0})],c.prototype,"effectiveLODs",void 0),e.__decorate([r.property({readOnly:!0})],c.prototype,"effectiveMinZoom",void 0),e.__decorate([r.property({readOnly:!0})],c.prototype,"effectiveMaxZoom",void 0),e.__decorate([r.property({readOnly:!0})],c.prototype,"effectiveMinScale",void 0),e.__decorate([r.property({readOnly:!0})],c.prototype,"effectiveMaxScale",void 0),e.__decorate([r.property()],c.prototype,"lods",void 0),e.__decorate([r.property()],c.prototype,"minZoom",void 0),e.__decorate([r.property()],c.prototype,"maxZoom",void 0),e.__decorate([r.property()],c.prototype,"minScale",void 0),e.__decorate([r.property()],c.prototype,"maxScale",void 0),e.__decorate([r.property()],c.prototype,"snapToZoom",void 0),c=l=e.__decorate([a.subclass("esri.views.2d.constraints.ZoomConstraint")],c),c}))},"esri/views/2d/ViewStateManager":function(){define(["exports","../../chunks/tslib.es6","../../Viewpoint","../../core/Accessor","../../core/Error","../../core/has","../../core/Logger","../../core/reactiveUtils","../../core/screenUtils","../../core/Warning","../../core/accessorSupport/decorators/property","../../core/RandomLCG","../../core/accessorSupport/decorators/subclass","../../geometry/Extent","../../chunks/pe","../../geometry/Point","../../geometry/projectionUtils","../../geometry/support/spatialReferenceUtils","./PaddedViewState","./viewpointUtils"],(function(e,t,i,r,o,n,s,a,l,c,u,h,d,p,m,g,_,f,y,w){"use strict";e.ViewStateManager=class extends r{constructor(e){super(e),this.constraints=null,this.ready=!1,this.resizeAlign="center",this.addHandles([a.watch((()=>this.constraints?.version),(e=>{this.constraints&&e&&this.ready&&(this.state.viewpoint=this.constraints.fit(this.state.paddedViewState.viewpoint))}),a.sync)])}get center(){if(!this.ready)return this._get("center");const{center:e,spatialReference:t}=this.state.paddedViewState;return this.state.commitProperty("id"),new g({x:e[0],y:e[1],spatialReference:t})}set center(e){if(null==e)return;if(!this.ready)return void this._set("center",e);let t;try{t=this._project(e,this.state.spatialReference)}catch(t){return void s.getLogger(this).error(new o("mapview:invalid-center","could not project the value in the view's spatial reference",{input:e,error:t}))}const i=this.viewpoint;w.centerAt(i,i,t),this.viewpoint=i}get extent(){return this.ready?(this.state.commitProperty("id"),this.state.paddedViewState.extent.clone()):this._get("extent")}set extent(e){if(null==e)return;if(!e.width||!e.height)return void s.getLogger(this).error(new o("mapview:invalid-extent","invalid extent size"));if(!this.ready)return this._set("extent",e),this._set("center",void 0),this._set("viewpoint",void 0),this._set("scale",void 0),void this._set("zoom",void 0);let t;try{t=this._project(e,this.state.spatialReference)}catch(e){return void s.getLogger(this).error(new o("mapview:invalid-extent","could not project the value in the view's spatial reference",{error:e}))}const i=this.viewpoint;w.setExtent(i,i,t,this.state.size,{constraints:this.constraints}),this.viewpoint=i}get padding(){return this.ready?this.state.padding:this._get("padding")}set padding(e){this.ready?(this.state.padding=e,this._set("padding",this.state.padding)):this._set("padding",e)}get resolution(){return this.ready?(this.state.commitProperty("id"),this.state.resolution):0}get rotation(){return this.ready?(this.state.commitProperty("id"),this.state.rotation):this._get("rotation")}set rotation(e){if(isNaN(e))return;if(!this.ready)return void this._set("rotation",e);const t=this.viewpoint;w.rotateTo(t,t,e),this.viewpoint=t}get scale(){return this.ready?(this.state.commitProperty("id"),this.state.scale):this._get("scale")}set scale(e){if(!e||isNaN(e))return;if(!this.ready){this._set("scale",e),this._set("zoom",void 0);const t=this._get("extent");return void(t&&(this._set("extent",void 0),this._set("center",t.center)))}const t=this.viewpoint;w.scaleTo(t,t,e),this.viewpoint=t}get viewpoint(){return this.ready?this.state.paddedViewState.viewpoint.clone():this._get("viewpoint")}set viewpoint(e){if(null==e)return;if(!this.ready)return this._set("viewpoint",e),this._set("extent",void 0),this._set("center",void 0),this._set("zoom",void 0),void this._set("scale",void 0);let t,r;try{t=this._project(e,this.state.spatialReference),!e.scale||isNaN(e.scale)?r=new o("mapview:invalid-viewpoint",`invalid scale value of ${e.scale}`):null==e.targetGeometry&&(r=new o("mapview:invalid-viewpoint","geometry not defined"))}catch(e){r=new o("mapview:invalid-viewpoint","could not project the value in the view's spatial reference",{error:e})}if(r)return void s.getLogger(this).error(r);this._scaleBeforeChangingSpatialReference=null;const n=new i({targetGeometry:new g,scale:0,rotation:0});w.copy(n,t),this.constraints?.constrain(n,this.state.paddedViewState.viewpoint),this.state.viewpoint=n,this._set("viewpoint",n)}get visibleArea(){return this.ready?this.state.visibleArea:null}get zoom(){return this.ready?this.constraints?.scaleToZoom(this.scale)??-1:this._get("zoom")}set zoom(e){if(!(e>=0))return;if(!this.ready){this._set("zoom",e),this._set("scale",void 0);const t=this._get("extent");return void(t&&(this._set("extent",void 0),this._set("center",t.center)))}const t=this.constraints?.zoomToScale(e)??0;if(!t)return void this._set("zoom",-1);const i=this.viewpoint;w.scaleTo(i,i,t),this.viewpoint=i,this._set("zoom",this.constraints?.scaleToZoom(this.scale)??-1)}getUserStartupOptions(e){if(!e[0]&&!e[1])return{center:void 0,rotation:void 0,scale:void 0};const{padding:t,constraints:i}=this,r=this._get("center"),o=this._get("extent"),n=this._get("scale"),s=this._get("rotation"),a=this._get("viewpoint"),l=this._get("zoom"),c=null!=l&&null!=i&&i.zoomToScale(l)||void 0;let u,h,d;const p=a?.rotation,m=a?.targetGeometry;"extent"===m?.type?u=m:"point"===m?.type&&(h=m,d=a?.scale);const g=o??u;return{center:r??h??g?.center,rotation:s??p,scale:(n??c??d??(g&&w.extentToScale(g,[e[0]-t.left-t.right,e[1]-t.top-t.bottom])))||void 0}}startup(e,t,i,r){const o=e.targetGeometry;try{this._project(e,i)}catch(t){s.getLogger(this).warn(new c("mapview:startup-projection-error","projection of initial viewpoint to the view's spatial reference, defaulting to the initial viewpoint.",{center:o.toJSON(),spatialReference:i,error:t})),e.targetGeometry=r||new g({x:0,y:0,spatialReference:i})}this.constraints?.fit(e),this._set("state",new y({padding:this.padding,size:t,viewpoint:e})),this._set("ready",!0)}teardown(){this._set("ready",!1);const{center:[e,t],spatialReference:i,rotation:r,scale:o}=this.state.paddedViewState,n=new g({x:e,y:t,spatialReference:i});this._set("viewpoint",null),this._set("extent",null),this._set("center",n),this._set("zoom",-1),this._set("rotation",r),this._set("scale",o),this._set("state",null)}changeSpatialReference(e){const t=this.state.paddedViewState.clone();if(null==this._scaleBeforeChangingSpatialReference)this._scaleBeforeChangingSpatialReference=t.scale;else{const e=t.viewpoint.clone();e.scale=this._scaleBeforeChangingSpatialReference,t.viewpoint=e}const r=t.clone(),[o,a]=t.center;let l=null;try{l=this._project(new g({x:o,y:a,spatialReference:t.spatialReference}),e)}catch(t){m.isLoaded()||s.getLogger(this).warn(new c("mapview:spatial-reference-change","could not project the view's center to the new spatial reference",{center:l?.toJSON(),spatialReference:e,error:t}))}l||(l=new g({x:0,y:0,spatialReference:e}));const u=w.centerAt(new i({targetGeometry:new g,scale:0,rotation:0}),t.viewpoint,l);r.viewpoint=u;try{const i=20,o=[t.size[0]/2,t.size[1]/2],s=[o[0]+i,o[1]],a=t.toMap([0,0],s),{x:l,y:c}=this._project(new g({x:a[0],y:a[1],spatialReference:t.spatialReference}),e);a[0]=l,a[1]=c,r.toScreen(a,a);const h=w.angleBetween(o,a,s),d=Math.hypot(a[0]-o[0],a[1]-o[1])/i;!Number.isFinite(d)||Math.abs(d)>4?(u.rotation=0,u.targetGeometry=new g({x:0,y:0,spatialReference:e})):(u.scale*=d,u.scale>n("mapview-srswitch-adjust-rotation-scale-threshold")?u.rotation=0:u.rotation+=Number.isFinite(h)?h:0)}catch{}this._get("constraints")?.constrain(u,void 0),this._get("state").viewpoint=u}resize(e,t){if(!this.ready)return;const i=this.state;let r=this.state.paddedViewState.viewpoint;const o=this.state.paddedViewState.size.slice();i.size=[e,t],w.resize(r,r,o,this.state.paddedViewState.size,this.resizeAlign),r=this.constraints?.constrain(r,void 0)??r,this.state.viewpoint=r}toMap(e){if(!this.ready)return null;const[t,i]=this.state.toMap([0,0],[e.x,e.y]),r=this.state.spatialReference;return new g({x:t,y:i,spatialReference:r})}toScreen(e,t){if(!this.ready)return null;const i=this._project(e,this.state.spatialReference),r=[i.x,i.y];return!1===t?.pickClosestTarget||this.state.paddedViewState.wrapMapCoordinate(r,r),this.state.toScreen(r,r),l.createScreenPoint(r[0],r[1])}_project(e,t){const i=e?.targetGeometry||e;if(!t)return e;if(!i)return null;if(t.imageCoordinateSystem||i.spatialReference?.imageCoordinateSystem)return e;if(f.equals(t,i.spatialReference))return e;const r=_.project(i,t);if(!r)throw new o("mapview:projection-not-possible","projecting input geometry to target spatial reference returned a null value",{geometry:i,spatialReference:t});return function(e){return"esri.Viewpoint"===e?.declaredClass}(e)?(e.targetGeometry=r,e):r}},t.__decorate([u.property({type:g})],e.ViewStateManager.prototype,"center",null),t.__decorate([u.property()],e.ViewStateManager.prototype,"constraints",void 0),t.__decorate([u.property({type:p})],e.ViewStateManager.prototype,"extent",null),t.__decorate([u.property({value:{top:0,right:0,bottom:0,left:0},cast:e=>({top:0,right:0,bottom:0,left:0,...e})})],e.ViewStateManager.prototype,"padding",null),t.__decorate([u.property()],e.ViewStateManager.prototype,"ready",void 0),t.__decorate([u.property()],e.ViewStateManager.prototype,"resizeAlign",void 0),t.__decorate([u.property({readOnly:!0})],e.ViewStateManager.prototype,"resolution",null),t.__decorate([u.property({type:Number})],e.ViewStateManager.prototype,"rotation",null),t.__decorate([u.property({type:Number})],e.ViewStateManager.prototype,"scale",null),t.__decorate([u.property({readOnly:!0})],e.ViewStateManager.prototype,"state",void 0),t.__decorate([u.property({type:i})],e.ViewStateManager.prototype,"viewpoint",null),t.__decorate([u.property({readOnly:!0})],e.ViewStateManager.prototype,"visibleArea",null),t.__decorate([u.property()],e.ViewStateManager.prototype,"zoom",null),e.ViewStateManager=t.__decorate([d.subclass("esri.views.2d.ViewStateManager")],e.ViewStateManager),Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})}))},"esri/views/2d/support/StationaryManager":function(){define(["exports","../../../chunks/tslib.es6","../../../core/Accessor","../../../core/accessorSupport/decorators/property","../../../core/has","../../../core/Logger","../../../core/RandomLCG","../../../core/accessorSupport/decorators/subclass"],(function(e,t,i,r,o,n,s,a){"use strict";e.StationaryManager=class extends i{constructor(){super(...arguments),this._timer=void 0}get stationary(){return!this._timer}flip(){this._timestamp=performance.now(),null==this._timer&&(this._timer=setInterval((()=>{performance.now()-this._timestamp>=160&&this.clear()}),160))}clear(){this._timer&&(clearInterval(this._timer),this._timer=void 0)}},t.__decorate([r.property()],e.StationaryManager.prototype,"_timer",void 0),t.__decorate([r.property()],e.StationaryManager.prototype,"stationary",null),e.StationaryManager=t.__decorate([a.subclass("esri.views.2d.support.StationaryManager")],e.StationaryManager),Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})}))},"esri/views/Viewport2DMixin":function(){define(["exports","../chunks/tslib.es6","../core/accessorSupport/decorators/property","../core/has","../core/Logger","../core/RandomLCG","../core/accessorSupport/decorators/subclass","./2d/GoToManager","./2d/input/MapViewInputManager","./support/screenUtils"],(function(e,t,i,r,o,n,s,a,l,c){"use strict";e.Viewport2DMixin=e=>{let r=class extends e{constructor(...e){super(...e),this.goToManager=new a.GoToManager({view:this}),this.inputManager=new l({view:this}),this.addHandles([this.on("resize",(e=>this.stateManager.resize(e.width,e.height)))])}get interacting(){return this.navigating}get stationary(){return!this.animation&&!this.navigating&&!this.resizing&&this.stationaryManager.stationary}on(e,t,i,r){return this.inputManager&&this.viewEvents.on(e,t,i,r)||super.on(e,t)}hasEventListener(e){return super.hasEventListener(e)||this.viewEvents.hasHandler(e)}goTo(e,t){return this.goToManager.goTo(e,t)}toMap(e){if(!this.ready)return null;const t=c.isSupportedScreenPointEvent(e)?c.createScreenPointFromSupportedEvent(this,e):e;return this.stateManager.toMap(t)}};return t.__decorate([i.property()],r.prototype,"goToManager",void 0),t.__decorate([i.property({readOnly:!0})],r.prototype,"interacting",null),t.__decorate([i.property()],r.prototype,"stationary",null),t.__decorate([i.property({readOnly:!0})],r.prototype,"inputManager",void 0),r=t.__decorate([s.subclass("esri.views.Viewport2DMixin")],r),r},Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})}))},"esri/views/2d/GoToManager":function(){define(["exports","../../chunks/tslib.es6","../../core/a11yUtils","../../core/Accessor","../../core/Error","../../core/Logger","../../core/promiseUtils","../../core/reactiveUtils","../../core/accessorSupport/decorators/property","../../core/has","../../core/RandomLCG","../../core/accessorSupport/decorators/subclass","../ViewAnimation","./viewpointUtils"],(function(e,t,i,r,o,n,s,a,l,c,u,h,d,p){"use strict";e.GoToManager=class extends r{constructor(e){super(e),this._gotoTask=null}destroy(){this._gotoTask=null}async goTo(e,t){if(!e)return void n.getLogger(this).error("#goTo()","target cannot be null or undefined");const r=new d;this.view.animation=r,await a.whenOnce((()=>this.view.ready),t);const o={...t,animate:t?.animate??!i.prefersReducedMotion(),animationMode:t?.animationMode??"auto"},{extent:s,spatialReference:l,size:c,viewpoint:u,constraints:h,padding:m,allLayerViews:g}=this.view,_=p.create(e,{extent:s,spatialReference:l,size:c,viewpoint:u,constraints:h,padding:m,allLayerViews:g,pickClosestTarget:t?.pickClosestTarget??!0});return r?.update(_),this._gotoTask={},o.animate?this._gotoAnimated(_,o):this._gotoImmediate(_,o)}_gotoImmediate(e,t){const i=this._gotoTask,r=this.view.animation,n=e.then((e=>{if(s.throwIfAborted(t),i!==this._gotoTask)throw new o("view:goto-interrupted","Goto was interrupted");this.view.viewpoint=r.target=e,r.finish()}));return this._cancellableGoTo(i,r,n,t)}_gotoAnimated(e,t){const i=this._gotoTask,r=this.view.animation;if(!r)return Promise.resolve();const n=e.then((e=>{if(s.throwIfAborted(t),i!==this._gotoTask)throw new o("view:goto-interrupted","Goto was interrupted");return r.update(e),this.view.animationManager.animate(r,this.view.viewpoint,t),r.when().then((()=>{}),(()=>{}))}));return this._cancellableGoTo(i,r,n,t)}_cancellableGoTo(e,t,i,r){const o=()=>e===this._gotoTask;return s.whenOrAbort(i,r).finally((()=>{o()&&(t.done||t.stop())}))}},t.__decorate([l.property({constructOnly:!0})],e.GoToManager.prototype,"view",void 0),e.GoToManager=t.__decorate([h.subclass("esri.views.2d.GoToManager")],e.GoToManager),Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})}))},"esri/views/2d/input/MapViewInputManager":function(){define(["../../../chunks/tslib.es6","../../../core/Accessor","../../../core/has","../../../core/maybe","../../../core/reactiveUtils","../../../core/accessorSupport/decorators/property","../../../core/Logger","../../../core/RandomLCG","../../../core/accessorSupport/decorators/subclass","./handlers/DoubleClickZoom","./handlers/DoubleTapDragZoom","./handlers/DragPan","./handlers/DragRotate","./handlers/GamepadNavigation","./handlers/KeyPan","./handlers/KeyRotate","./handlers/KeyZoom","./handlers/MouseWheelZoom","./handlers/PinchAction","../../input/BrowserEventSource","../../input/InputManager","../../input/handlers/PreventContextMenu","../../input/handlers/support","../../input/recognizers/DoubleTapDrag","../../input/recognizers/Drag","../../input/recognizers/ImmediateDoubleClick","../../input/recognizers/PointerClickHoldAndDrag","../../input/recognizers/SingleAndDoubleClick"],(function(e,t,i,r,o,n,s,a,l,c,u,h,d,p,m,g,_,f,y,w,v,T,S,b,E,M,x,P){"use strict";const R={left:"ArrowLeft",right:"ArrowRight",up:"ArrowUp",down:"ArrowDown"},A={zoomIn:["=","+"],zoomOut:["-","_"]},I={clockwise:["a","A"],counterClockwise:["d","D"],reset:["n","N"]},C=Symbol("handles");let D=class extends t{initialize(){const e=()=>this.view?.ready;this.addHandles([o.when((()=>!e()),(()=>this._disconnect())),o.when(e,(()=>this._connect()))])}destroy(){this._disconnect()}get latestPointerType(){return this._inputManager?.latestPointerType}get latestPointerLocation(){return this._inputManager?.latestPointerLocation}get multiTouchActive(){return this._inputManager?.multiTouchActive??!1}isModifierKeyDown(e){return this._inputManager?.isModifierKeyDown(e)??!1}_disconnect(){this.view.viewEvents.disconnect(),this.removeHandles(C),this._inputManager=r.destroyMaybe(this._inputManager)}_connect(){const e=this.view.surface,t=new w.BrowserEventSource(e,this.view.input),i=[new M.ImmediateDoubleClick,new x.PointerClickHoldAndDrag,new P.SingleAndDoubleClick,new E.Drag(this.view.navigation),new b.DoubleTapDrag],r=new v.InputManager({eventSource:t,recognizers:i}),n=new h.DragPan(this.view,["primary"]),s=new d.DragRotate(this.view,["secondary"]);r.installHandlers("prevent-context-menu",[new T.PreventContextMenu],v.ViewEventPriorities.INTERNAL),r.installHandlers("navigation",[new y.PinchRotateAndZoom(this.view),new p.GamepadNavigation(this.view),new f.MouseWheelZoom(this.view),new c.DoubleClickZoom(this.view),new c.DoubleClickZoom(this.view,["Control"]),n,new m.KeyPan(this.view,R),new _.KeyZoom(this.view,A),new g.KeyRotate(this.view,I),s,new u.DoubleTapDragZoom(this.view,"touch")],v.ViewEventPriorities.INTERNAL),this.view.viewEvents.connect(r),this._source=t,this._inputManager=r,this.addHandles([o.watch((()=>this.view?.navigation?.browserTouchPanEnabled),(e=>{this._source&&(this._source.browserTouchPanningEnabled=!e)}),o.initial),o.watch((()=>{const{actionMap:e}=this.view.navigation;return{panActions:S.getPointerActions("pan",e),rotateActions:S.getPointerActions("rotate",e)}}),(({panActions:e,rotateActions:t})=>{n.pointerActions=e,s.pointerActions=t}),o.syncAndInitial)],C)}get test(){}};return e.__decorate([n.property()],D.prototype,"view",void 0),e.__decorate([n.property()],D.prototype,"latestPointerType",null),e.__decorate([n.property()],D.prototype,"latestPointerLocation",null),e.__decorate([n.property()],D.prototype,"multiTouchActive",null),D=e.__decorate([l.subclass("esri.views.2d.input.MapViewInputManager")],D),D}))},"esri/views/2d/input/handlers/DoubleClickZoom":function(){define(["exports","../../../input/InputHandler","../../../input/handlers/support"],(function(e,t,i){"use strict";class r extends t.InputHandler{constructor(e,t){super(!0),this._view=e,this.registerIncoming("double-click",t,(e=>this._handleDoubleClick(e,t)))}_handleDoubleClick(e,t){i.eventMatchesPointerAction(e.data,"primary")&&(e.stopPropagation(),t?this._view.mapViewNavigation.zoomOut([e.data.x,e.data.y]):this._view.mapViewNavigation.zoomIn([e.data.x,e.data.y]))}}e.DoubleClickZoom=r,Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})}))},"esri/views/input/handlers/support":function(){define(["exports"],(function(e){"use strict";function t(e,t){switch(t){case"primary":return"touch"===e.pointerType||0===e.button;case"secondary":return"touch"!==e.pointerType&&2===e.button;case"tertiary":return"touch"!==e.pointerType&&1===e.button}}e.eventMatchesMousePointerActions=function(e,t){const{button:i,pointerType:r}=e;return"touch"!==r&&t.some((e=>"primary"===e&&0===i||"secondary"===e&&2===i||"tertiary"===e&&1===i))},e.eventMatchesPointerAction=t,e.eventMatchesPointerActions=function(e,i){return i.some((i=>t(e,i)))},e.getPointerActions=function(e,{dragPrimary:t,dragSecondary:i,dragTertiary:r}){return[{key:"primary",value:t},{key:"secondary",value:i},{key:"tertiary",value:r}].filter((t=>t.value===e)).map((e=>e.key))},Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})}))},"esri/views/2d/input/handlers/DoubleTapDragZoom":function(){define(["exports","../../../../core/has","../../../input/InputHandler"],(function(e,t,i){"use strict";class r extends i.InputHandler{constructor(e,t,i){super(!0),this.view=e,this.pointerType=t,this.registerIncoming("double-tap-drag",i,(e=>this._handleDoubleTapDrag(e)))}_handleDoubleTapDrag(e){const{data:t}=e,{pointerType:i}=t;if(i!==this.pointerType)return;e.stopPropagation();const{action:r,delta:o}=t,{view:n}=this,{mapViewNavigation:s}=n;switch(r){case"begin":{const{scale:e}=n;this._startScale=e,this._currentScale=e,this._previousDelta=o,s.begin();break}case"update":{if(this._previousDelta.y===o.y)return;this._previousDelta=o;const e=1.015**o.y,t=this._startScale*e,i=t/this._currentScale;s.setViewpointImmediate(i),this._currentScale=t;break}case"end":{const{constraints:e}=n,{effectiveLODs:t,snapToZoom:i}=e;if(!i||!t)return void s.end();const r=e.snapScale(this._currentScale),a=(o.y>0?Math.max(r,e.snapToPreviousScale(this._startScale)):Math.min(r,e.snapToNextScale(this._startScale)))/this._currentScale;s.zoom(a).then((()=>{s.end()}));break}}}}e.DoubleTapDragZoom=r,Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})}))},"esri/views/2d/input/handlers/DragPan":function(){define(["exports","../../../input/DragEventSeparator","../../../input/InputHandler","../../../input/handlers/support"],(function(e,t,i,r){"use strict";class o extends i.InputHandler{constructor(e,t,i){super(!0),this.view=e,this.pointerActions=t,this.registerIncoming("drag",i,(e=>this._handleDrag(e))),this.registerIncoming("pointer-down",(()=>this.stopMomentumNavigation()))}onInstall(e){super.onInstall(e),this._dragEventSeparator=new t.DragEventSeparator({start:(e,t)=>{this.view.mapViewNavigation.pan.begin(this.view,t.data),t.stopPropagation()},update:(e,t)=>{this.view.mapViewNavigation.pan.update(this.view,t.data),t.stopPropagation()},end:(e,t)=>{this.view.mapViewNavigation.pan.end(this.view,t.data),t.stopPropagation()},condition:(e,t)=>1===e&&r.eventMatchesPointerActions(t.data,this.pointerActions)})}_handleDrag(e){const t=this.view.mapViewNavigation;t.pinch.zoomMomentum||t.pinch.rotateMomentum?this.stopMomentumNavigation():this._dragEventSeparator.handle(e)}stopMomentumNavigation(){this.view.mapViewNavigation.pan.stopMomentumNavigation()}}e.DragPan=o,Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})}))},"esri/views/input/DragEventSeparator":function(){define(["exports"],(function(e){"use strict";e.DragEventSeparator=class{constructor(e){this._callbacks=e,this._currentCount=0,this._callbacks.condition||(this._callbacks.condition=()=>!0)}handle(e){const t=e.data,i=t.pointers.size;switch(t.action){case"start":this._currentCount=i,this._emitStart(e);break;case"added":this._emitEnd(this._previousEvent),this._currentCount=i,this._emitStart(e);break;case"update":this._emitUpdate(e);break;case"removed":this._startEvent&&this._emitEnd(this._previousEvent),this._currentCount=i,this._emitStart(e);break;case"end":this._emitEnd(e),this._currentCount=0}this._previousEvent=e}_emitStart(e){this._startEvent=e,this._callbacks.condition?.(this._currentCount,e)&&this._callbacks.start(this._currentCount,e,this._startEvent)}_emitUpdate(e){this._callbacks.condition?.(this._currentCount,e)&&this._callbacks.update(this._currentCount,e,this._startEvent)}_emitEnd(e){this._callbacks.condition?.(this._currentCount,e)&&this._callbacks.end(this._currentCount,e,this._startEvent),this._startEvent=null}},Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})}))},"esri/views/2d/input/handlers/DragRotate":function(){define(["exports","../../../input/DragEventSeparator","../../../input/InputHandler","../../../input/handlers/support"],(function(e,t,i,r){"use strict";class o extends i.InputHandler{constructor(e,i,o){super(!0),this._view=e,this.pointerActions=i;const n=this._view.mapViewNavigation;this._dragEventSeparator=new t.DragEventSeparator({start:(e,t)=>{n.rotate.begin(this._view,t.data),t.stopPropagation()},update:(e,t)=>{n.rotate.update(this._view,t.data),t.stopPropagation()},end:(e,t)=>{n.rotate.end(),t.stopPropagation()},condition:(e,t)=>1===e&&r.eventMatchesPointerActions(t.data,this.pointerActions)}),this.registerIncoming("drag",o,(e=>this._dragEventSeparator.handle(e)))}}e.DragRotate=o,Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})}))},"esri/views/2d/input/handlers/GamepadNavigation":function(){define(["exports","../../../../core/Handles","../../../../core/reactiveUtils","../../../../core/scheduling","../../viewpointUtils","../../../input/InputHandler","../../../navigation/gamepadAndKeyboardUtils"],(function(e,t,i,r,o,n,s){"use strict";class a extends n.InputHandler{constructor(e){super(!0),this._view=e,this._frameTask=null,this._watchHandles=new t,this._currentDevice=null,this._transformation={translation:[0,0,0],heading:0,tilt:0,zoom:0},this._handle=this.registerIncoming("gamepad",(e=>this._handleGamePadEvent(e))),this._handle.pause()}onInstall(e){super.onInstall(e),this._watchHandles.add([i.watch((()=>this._view.navigation.gamepad?.enabled),(e=>{e?(this._handle.resume(),this._frameTask||(this._frameTask=r.addFrameTask({update:e=>this._frameUpdate(e.deltaTime)}))):(this._handle.pause(),this._frameTask&&(this._frameTask.remove(),this._frameTask=null))}),i.initial)])}onUninstall(){this._watchHandles.removeAll(),this._frameTask&&(this._frameTask.remove(),this._frameTask=null),super.onUninstall()}_handleGamePadEvent(e){const t=this._view.navigation.gamepad.device;t&&e.data.device!==t||this._currentDevice&&this._currentDevice!==e.data.device||("end"===e.data.action?(this._currentDevice=null,s.resetTransformation(this._transformation)):(this._currentDevice=e.data.device,s.extractTransformation(e.data,this._view.navigation.gamepad,this._transformation)),this._frameTask?.resume())}_frameUpdate(e){const t=this._transformation;if(s.isZeroTransformation(t))return void this._frameTask?.pause();const i=this._view.viewpoint.clone(),r=this._view.navigation.gamepad.velocityFactor,n=c*r*e;o.translateBy(i,i,[t.translation[0]*n,-t.translation[1]*n]);const a=1+t.translation[2]*u*e,h=this._view.constraints.rotationEnabled?-t.heading*l*e:0,d=this._view.size,p=[d[0]/2,d[1]];o.scaleAndRotateBy(i,i,a,h,p,d);const m=this._view.constraints.constrain(i,this._view.viewpoint);this._view.viewpoint=m}}const l=.06,c=.7,u=6e-4;e.GamepadNavigation=a,Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})}))},"esri/views/navigation/gamepadAndKeyboardUtils":function(){define(["exports","../../chunks/vec32"],(function(e,t){"use strict";function i(e){let t=e*e;return e<0&&(t*=-1),t}e.extractTransformation=function(e,r,o){const n=o,s=e.state,a=e.device,l="forward-down"===r.tiltDirection?1:-1;return"standard"===a.deviceType?(n.translation[0]=i(s.axes[0]),n.translation[1]=i(s.axes[1]),n.translation[2]=i(s.buttons[7])-i(s.buttons[6]),n.heading=i(s.axes[2]),n.tilt=i(s.axes[3])):"spacemouse"===a.deviceType&&(n.translation[0]=1.2*i(s.axes[0]),n.translation[1]=1.2*i(s.axes[1]),n.translation[2]=2*-i(s.axes[2]),n.heading=1.2*i(s.axes[5]),n.tilt=1.2*i(s.axes[3])),n.tilt*=l,t.scale(n.translation,n.translation,1),n},e.extractTransformationKeyboard=function(e,t){const i=t;return i.translation[0]=e[1]-e[0],i.translation[1]=e[3]-e[2],i.translation[2]=e[4]-e[5],i.heading=e[7]-e[6],i.tilt=e[8]-e[9],i.zoom=e[10]-e[11],i},e.isZeroTransformation=function(e){return 0===e.translation[0]&&0===e.translation[1]&&0===e.translation[2]&&0===e.heading&&0===e.tilt&&0===e.zoom},e.resetTransformation=function(e){return e.translation[0]=0,e.translation[1]=0,e.translation[2]=0,e.heading=0,e.tilt=0,e},Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})}))},"esri/views/2d/input/handlers/KeyPan":function(){define(["exports","../../../input/InputHandler","../../../input/VisibilityChange"],(function(e,t,i){"use strict";class r extends t.InputHandler{constructor(e,t,r){super(!0),this.view=e,this.keys=t,this._isSticky=!1,this._pressedKeys=new Set,this._timeout=void 0,this._currentDirection=void 0,this._stickyKeyDuration=200,this._handleKey=e=>{const t=this._keyMap[e.data.key];if(e.modifiers.has("Meta")||e.modifiers.has("Control"))return void this._stopMovement();if(null==t)return;e.stopPropagation(),e.preventDefault();const i="key-down"===e.type;if(this._pressedKeys[i?"add":"delete"](t),i){if(this._direction===t)return;this._direction=t,this._isSticky=!1,this._setTimeout((()=>{this._isSticky&&this._handlePopKey()}))}else{const e=void 0===this._timeout,t=this._pressedKeys.size>0;e||t?this._handlePopKey():this._isSticky=!0}},this._handlePopKey=()=>{this._direction=Array.from(this._pressedKeys).pop(),null==this._direction&&this._stopMovement()},this._stopMovement=()=>{this._isSticky=!1,this._direction=void 0,this._pressedKeys.clear(),this._setTimeout(void 0)},this._keyMap={[t.left]:"left",[t.right]:"right",[t.up]:"up",[t.down]:"down"},this.registerIncoming("key-down",r,this._handleKey),this.registerIncoming("key-up",r,this._handleKey),this.registerIncoming("blur",r,this._stopMovement),this._visibilityHandle=i.onVisibilityChange((e=>e?null:this._stopMovement()))}onUninstall(){this._stopMovement(),this._visibilityHandle?.remove()}get _direction(){return this._currentDirection}set _direction(e){const t=null!=this._currentDirection;if(null!=e){if(t||this.view.mapViewNavigation.begin(),this._currentDirection!==e)switch(e){case"left":this.view.mapViewNavigation.continuousPanLeft();break;case"right":this.view.mapViewNavigation.continuousPanRight();break;case"up":this.view.mapViewNavigation.continuousPanUp();break;case"down":this.view.mapViewNavigation.continuousPanDown()}}else t&&this.view.mapViewNavigation.stop();this._currentDirection=e}_setTimeout(e){clearTimeout(this._timeout),this._timeout=void 0===e?void 0:setTimeout((()=>{this._timeout=void 0,e()}),this._stickyKeyDuration)}}e.KeyPan=r,Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})}))},"esri/views/input/VisibilityChange":function(){define(["exports","../../core/handleUtils"],(function(e,t){"use strict";e.onVisibilityChange=function(e){const i=()=>e("visible"===document.visibilityState);return document.addEventListener("visibilitychange",i),t.makeHandle((()=>document.removeEventListener("visibilitychange",i)))},Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})}))},"esri/views/2d/input/handlers/KeyRotate":function(){define(["exports","../../../input/InputHandler","../../../input/VisibilityChange"],(function(e,t,i){"use strict";class r extends t.InputHandler{constructor(e,t,r){super(!0),this.view=e,this.keys=t,this._keyToDirection=new Map,this._pressed=!1,this._addKeysMapping(t),this.registerIncoming("key-down",r,(e=>this._handleKeyDown(e))),this.registerIncoming("key-up",r,(e=>this._handleKeyUp(e))),this.registerIncoming("blur",r,(()=>this._handleStop())),this._visibilityHandle=i.onVisibilityChange((e=>e?null:this._handleStop()))}onUninstall(){this._visibilityHandle?.remove(),this._handleStop()}_addKeysMapping(e){this._addKeyMapping(e.clockwise,"clockwise"),this._addKeyMapping(e.counterClockwise,"counterClockwise"),this._addKeyMapping(e.reset,"reset")}_addKeyMapping(e,t){for(const i of e)this._keyToDirection.set(i,t)}_handleKeyDown(e){e.data.repeat||this._handleKey(e,!0)}_handleKeyUp(e){this._handleKey(e,!1)}_handleStop(){this._pressed&&(this._pressed=!1,this.view.mapViewNavigation.stop())}_handleKey(e,t){const i=e.modifiers;if(i.size>0&&!i.has("Shift")||!this.view.constraints.rotationEnabled)return;const r=this._keyToDirection.get(e.data.key);if(this._pressed=null!=r,this._pressed){if(e.preventDefault(),t)switch(this.view.mapViewNavigation.begin(),r){case"clockwise":this.view.mapViewNavigation.continuousRotateClockwise();break;case"counterClockwise":this.view.mapViewNavigation.continuousRotateCounterclockwise();break;case"reset":this.view.mapViewNavigation.resetRotation()}else this._pressed=!1,this.view.mapViewNavigation.stop();e.stopPropagation()}}}e.KeyRotate=r,Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})}))},"esri/views/2d/input/handlers/KeyZoom":function(){define(["exports","../../../../core/has","../../../input/InputHandler"],(function(e,t,i){"use strict";var r;!function(e){e[e.IN=0]="IN",e[e.OUT=1]="OUT"}(r||(r={}));class o extends i.InputHandler{constructor(e,t,i){super(!0),this.view=e,this.keys=t,this._keysToZoomAction={},this.registerIncoming("key-down",i,(e=>this._handleKeyDown(e))),t.zoomIn.forEach((e=>this._keysToZoomAction[e]=r.IN)),t.zoomOut.forEach((e=>this._keysToZoomAction[e]=r.OUT))}_handleKeyDown(e){this._handleKey(e)}_handleKey(e){const t=e.modifiers;if(t.size>0&&!t.has("Shift"))return;const{key:i}=e.data;if(!(i in this._keysToZoomAction))return;const o=this._keysToZoomAction[i],{mapViewNavigation:n}=this.view;let s=null;switch(o){case r.IN:s=n.zoomIn();break;case r.OUT:s=n.zoomOut();break;default:return}n.begin(),s.then((()=>n.end())),e.stopPropagation()}}e.KeyZoom=o,Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})}))},"esri/views/2d/input/handlers/MouseWheelZoom":function(){define(["exports","../../../input/InputHandler"],(function(e,t){"use strict";class i extends t.InputHandler{constructor(e,t){super(!0),this._view=e,this._canZoom=!0,this.registerIncoming("mouse-wheel",t,(e=>this._handleMouseWheel(e)))}_handleMouseWheel(e){if("zoom"!==this._view.navigation.actionMap.mouseWheel)return;if(e.preventDefault(),e.stopPropagation(),!this._canZoom)return;const t=this._view.mapViewNavigation,{x:i,y:r,deltaY:o}=e.data,n=1/.6**(1/60*o),s=t.zoom(n,[i,r]);s&&(this._canZoom=!1,s.catch((()=>{})).then((()=>{this._canZoom=!0,t.end()})))}}e.MouseWheelZoom=i,Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})}))},"esri/views/2d/input/handlers/PinchAction":function(){define(["exports","../../../input/DragEventSeparator","../../../input/InputHandler"],(function(e,t,i){"use strict";class r extends i.InputHandler{constructor(e){super(!0),this.view=e,this.registerIncoming("drag",(e=>this._handleDrag(e))),this.registerIncoming("pointer-down",(()=>this._stopMomentumNavigation()));const i=this.view.mapViewNavigation;this._dragEventSeparator=new t.DragEventSeparator({start:(e,t)=>{i.pinch.begin(this.view,t.data),t.stopPropagation()},update:(e,t)=>{i.pinch.update(this.view,t.data),t.stopPropagation()},end:(e,t)=>{i.pinch.end(this.view),t.stopPropagation()},condition:e=>e>=2})}_handleDrag(e){this._dragEventSeparator.handle(e)}_stopMomentumNavigation(){this.view.mapViewNavigation.pinch.stopMomentumNavigation()}}e.PinchRotateAndZoom=r,Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})}))},"esri/views/input/BrowserEventSource":function(){define(["exports","../../core/has","../../core/maybe","./gamepad/GamepadSource","../support/screenUtils"],(function(e,t,i,r,o){"use strict";const n=t("edge"),s=t("chrome"),a=t("ff"),l=t("safari"),c="esri-view-surface",u={touchNone:`${c}--touch-none`,touchPan:`${c}--touch-pan`};class h{static{this.test={disableSubpixelCoordinates:!1}}constructor(e,t){this._active={},this._callback=()=>{},this._activePointerCaptures=new Set,this._keyDownState=new Set,this._eventId=1,this._browserTouchPanningEnabled=!1,this._element=e,e.getAttribute("tabindex")||e.setAttribute("tabindex","0"),this._eventHandlers={"key-down":this._handleKey,"key-up":this._handleKey,"pointer-down":this._handlePointer,"pointer-move":this._handlePointerPreventDefault,"pointer-up":this._handlePointerPreventDefault,"pointer-enter":this._handlePointer,"pointer-leave":this._handlePointer,"pointer-cancel":this._handlePointer,"mouse-wheel":this._handleMouseWheel,"pointer-capture-lost":this._handlePointerCaptureLost},this._updateTouchAction(),this._element.addEventListener("keydown",this._preventAltKeyDefault),this._gamepadSource=new r.GamepadSource(e,t),this._gamepadSource.onEvent=e=>this._callback("gamepad",e)}destroy(){this._callback=()=>{},this.activeEvents=null,this._activePointerCaptures.forEach((e=>this._releasePointerCaptureSafe(e))),this._activePointerCaptures.clear(),this._gamepadSource=i.destroyMaybe(this._gamepadSource),this._removeTouchAction(),this._element.removeEventListener("keydown",this._preventAltKeyDefault)}get browserTouchPanningEnabled(){return this._browserTouchPanningEnabled}set browserTouchPanningEnabled(e){this._browserTouchPanningEnabled=e,this._updateTouchAction(),this._updateTouchEventHandling()}set onEventReceived(e){this._callback=e}set activeEvents(e){for(const t in this._active)if(!e||!e.has(t)){const e=this._active[t];this._element.removeEventListener(d[t],e),delete this._active[t]}e&&e.forEach((e=>{if(!this._active[e]&&d[e]){const t=(this._eventHandlers[e]||this._handleDefault).bind(this,e);this._element.addEventListener(d[e],t),this._active[e]=t}})),this._gamepadSource&&(this._gamepadSource.hasEventListeners=e?.has("gamepad")??!1)}setPointerCapture(e,t){t?this._setPointerCaptureSafe(e.pointerId):(this._releasePointerCaptureSafe(e.pointerId),this._activePointerCaptures.delete(e.pointerId))}_updateTouchAction(){this._element.classList.remove(this._browserTouchPanningEnabled?u.touchNone:u.touchPan),this._element.classList.add(this._browserTouchPanningEnabled?u.touchPan:u.touchNone)}_updateTouchEventHandling(){this._browserTouchPanningEnabled?this._element.addEventListener("touchmove",this._preventMultiTouchPanning):this._element.removeEventListener("touchmove",this._preventMultiTouchPanning)}_removeTouchAction(){this._element.classList.remove(u.touchNone),this._element.classList.remove(u.touchPan),this._element.removeEventListener("touchmove",this._preventMultiTouchPanning)}_setPointerCaptureSafe(e){try{this._element.setPointerCapture(e),this._activePointerCaptures.add(e)}catch{}}_releasePointerCaptureSafe(e){try{if(this._element.hasPointerCapture&&!this._element.hasPointerCapture(e))return;this._element.releasePointerCapture(e)}catch(e){}}_updateNormalizedPointerLikeEvent(e,t){const i=o.createScreenPointFromNativeEvent(this._element,e);return h.test.disableSubpixelCoordinates&&(i.x=Math.round(i.x),i.y=Math.round(i.y)),t.x=i.x,t.y=i.y,t}_handleKey(e,t){const{key:i}=t;i&&"key-up"===e&&this._keyDownState.delete(i);const r={native:t,key:i,repeat:!!i&&this._keyDownState.has(i)};i&&"key-down"===e&&this._keyDownState.add(r.key),this._callback(e,r)}_handlePointer(e,t){const i=this._updateNormalizedPointerLikeEvent(t,{native:t,x:0,y:0,pointerType:t.pointerType,button:t.button,buttons:t.buttons,eventId:this._eventId++});this._callback(e,i)}_handlePointerPreventDefault(e,t){const i=this._updateNormalizedPointerLikeEvent(t,{native:t,x:0,y:0,pointerType:t.pointerType,button:t.button,buttons:t.buttons,eventId:this._eventId++});t.preventDefault(),this._callback(e,i)}_getDeltaFromTrackpadOrMouseWheel(e){return e.shiftKey&&t("mac")&&0===e.deltaY?e.deltaX:e.deltaY}_handleMouseWheel(e,t){let i=this._getDeltaFromTrackpadOrMouseWheel(t);switch(t.deltaMode){case 0:n&&(i=i/document.documentElement.clientHeight*600);break;case 1:i*=30;break;case 2:i*=900}n?i*=.7:s||l?i*=.6:a&&(i*=1.375);const r=Math.abs(i);r>100&&(i=i/r*200/(1+Math.exp(-.02*(r-100))));const o=this._updateNormalizedPointerLikeEvent(t,{native:t,x:0,y:0,deltaY:i});this._callback(e,o)}_handlePointerCaptureLost(e,t){this._activePointerCaptures.delete(t.pointerId),this._handleDefault(e,t)}_handleDefault(e,t){const i={native:t};t.preventDefault(),this._callback(e,i)}_preventAltKeyDefault(e){"Alt"===e.key&&e.preventDefault()}_preventMultiTouchPanning(e){e.touches.length>1&&e.preventDefault()}}const d={"key-down":"keydown","key-up":"keyup","pointer-down":"pointerdown","pointer-up":"pointerup","pointer-move":"pointermove","mouse-wheel":"wheel","pointer-capture-got":"gotpointercapture","pointer-capture-lost":"lostpointercapture","context-menu":"contextmenu","pointer-enter":"pointerenter","pointer-leave":"pointerleave","pointer-cancel":"pointercancel",focus:"focus",blur:"blur"};e.BrowserEventSource=h,Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})}))},"esri/views/input/gamepad/GamepadSource":function(){define(["exports","../../../core/scheduling","./GamepadInputDevice","./GamepadState"],(function(e,t,i,r){"use strict";function o(e){if(!e)return!1;if(!e.connected)return!1;for(let t=0;t<e.axes.length;t++)if(isNaN(e.axes[t]))return!1;return!0}function n(e){for(const t of navigator.getGamepads())o(t)&&e(t)}e.GamepadSource=class{constructor(e,t){this._element=e,this._input=t,this._hasEventListeners=!1,this._onConnectGamepad=e=>{this._connectGamepad(e.gamepad)},this._onDisconnectGamepad=e=>{const t=e.gamepad,i=t.index,o=this._inputDevices[i];o&&(this._emitGamepadEvent(t,r.extractState(o),!1),this._inputDevices.splice(i,1),this._latestUpdate.splice(i,1),this._input.gamepad.devices.remove(o),this.ensurePollingState())},this._frameTask=null,this._latestUpdate=new Array,this._inputDevices=new Array,this._callback=null;const i="getGamepads"in window.navigator,o=window.isSecureContext;this.supported=i&&o,this.supported&&(n((e=>this._connectGamepad(e))),window.addEventListener("gamepadconnected",this._onConnectGamepad),window.addEventListener("gamepaddisconnected",this._onDisconnectGamepad),this.ensurePollingState())}destroy(){this.hasEventListeners=!1,this.supported&&(window.removeEventListener("gamepadconnected",this._onConnectGamepad),window.removeEventListener("gamepaddisconnected",this._onDisconnectGamepad))}set hasEventListeners(e){this._hasEventListeners!==e&&(this._hasEventListeners=e,this.ensurePollingState())}get _eventsEnabled(){return this.supported&&this._inputDevices.length>0&&this._hasEventListeners}set onEvent(e){this._callback=e}_connectGamepad(e){const t=new i(e);"unknown"!==t.deviceType&&(this._inputDevices[e.index]=t,this._input.gamepad.devices.add(t)),this.ensurePollingState()}ensurePollingState(){this._eventsEnabled?this._startPolling():this._stopPolling()}_startPolling(){null==this._frameTask&&(this._frameTask=t.addFrameTask({update:()=>this._readGamepadState()}))}_stopPolling(){null!=this._frameTask&&(this._frameTask.remove(),this._frameTask=null,this._latestUpdate=new Array)}_readGamepadState(){const e=document.hasFocus(),t=this._element.contains(document.activeElement),i="document"===this._input.gamepad.enabledFocusMode&&!e||"view"===this._input.gamepad.enabledFocusMode&&!t;n((e=>{const t=this._inputDevices[e.index];if(!t)return;const o=this._latestUpdate[e.index],n=r.extractState(t),s=i||r.stateIdle(n);if(o){if(o.timestamp===e.timestamp)return;if(!o.active&&s)return;if(r.stateEqual(o.state,n))return}this._emitGamepadEvent(e,n,!s)}))}_emitGamepadEvent(e,t,i){const r=this._latestUpdate[e.index],o=r&&r.active;if(!o&&!i)return;const n=!o&&i?"start":o&&i?"update":"end";this._latestUpdate[e.index]={timestamp:e.timestamp,state:t,active:i},this._callback&&this._callback({device:this._inputDevices[e.index],state:t,action:n})}},Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})}))},"esri/views/input/gamepad/GamepadState":function(){define(["exports"],(function(e){"use strict";e.extractState=function(e){const t=e.native;return t?{buttons:t.buttons.map((e=>e.pressed?e.value||1:0)),axes:t.axes.map((t=>function(e,t){const i=Math.abs(e);return i<t?0:Math.sign(e)*(i-t)/(1-t)}(t,e.axisThreshold)))}:{buttons:[],axes:[]}},e.stateEqual=function(e,t){if(e.axes.length!==t.axes.length)return!1;if(e.buttons.length!==t.buttons.length)return!1;for(let i=0;i<e.axes.length;i++)if(e.axes[i]!==t.axes[i])return!1;for(let i=0;i<e.buttons.length;i++)if(e.buttons[i]!==t.buttons[i])return!1;return!0},e.stateIdle=function(e){for(let t=0;t<e.axes.length;t++)if(0!==e.axes[t])return!1;for(let t=0;t<e.buttons.length;t++)if(0!==e.buttons[t])return!1;return!0},Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})}))},"esri/views/input/handlers/PreventContextMenu":function(){define(["exports","../InputHandler"],(function(e,t){"use strict";class i extends t.InputHandler{constructor(){super(!0),this.registerIncoming("context-menu",(e=>e.data.native.preventDefault()))}}e.PreventContextMenu=i,Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})}))},"esri/views/input/recognizers/DoubleTapDrag":function(){define(["exports","../../../core/clock","../../../core/maybe","../../../core/screenUtils","../DragEventSeparator","../InputHandler","./support"],(function(e,t,i,r,o,n,s){"use strict";class a extends n.InputHandler{constructor(e={},i=t.clock){super(!1),this._clock=i,this._doubleTapDragReady=!1,this._doubleTapDragActive=!1,this._dragStartCenter=r.createScreenPoint(0,0),this._pointerState=new Map,this._parameters=s.getDoubleClickParameters(e),this._doubleTapDrag=this.registerOutgoing("double-tap-drag"),this._dragEventSeparator=new o.DragEventSeparator({start:(e,t)=>this._dragStart(e,t),update:(e,t)=>this._dragUpdate(t),end:(e,t)=>this._dragEnd(t)}),this.registerIncoming("drag",(e=>this._dragEventSeparator.handle(e))),this.registerIncoming("pointer-down",(e=>this._handlePointerDown(e))),this.registerIncoming("pointer-up",(()=>this._handlePointerUp()))}onUninstall(){this._pointerState.forEach((e=>{e.doubleTapTimeout=i.removeMaybe(e.doubleTapTimeout)}))}get hasPendingInputs(){for(const e of this._pointerState.values())if(null!=e.doubleTapTimeout)return!0;return!1}_clearPointerDown(e){const t=this._pointerState.get(e);t&&(t.doubleTapTimeout=i.removeMaybe(t.doubleTapTimeout),this._pointerState.delete(e),this.refreshHasPendingInputs())}_dragStart(e,t){if(!this._doubleTapDragReady||1!==e)return;this._doubleTapDragReady=!1,this._doubleTapDragActive=!0;const{data:i,modifiers:o}=t,{center:n}=i;this._dragStartCenter=n;const s=l("begin",r.createScreenPoint(0,0),i);this._doubleTapDrag.emit(s,void 0,o),t.stopPropagation()}_dragUpdate(e){if(!this._doubleTapDragActive)return;const{data:t,modifiers:i}=e,{center:o}=t,n=l("update",r.createScreenPoint(o.x-this._dragStartCenter.x,o.y-this._dragStartCenter.y),t);this._doubleTapDrag.emit(n,void 0,i),e.stopPropagation()}_dragEnd(e){if(!this._doubleTapDragActive)return;const{data:t,modifiers:i}=e,{center:o}=t,n=l("end",r.createScreenPoint(o.x-this._dragStartCenter.x,o.y-this._dragStartCenter.y),t);this._doubleTapDrag.emit(n,void 0,i),this._doubleTapDragActive=!1,e.stopPropagation()}_handlePointerDown(e){const{data:t}=e,i=s.getPointerId(t),r=this._pointerState.get(i),{pointerType:o}=t.native;if(r){const n="touch"===o?this._parameters.maximumDoubleTouchDistance:this._parameters.maximumDoubleClickDistance;this._clearPointerDown(i),s.manhattanDistance(r.event.data,t)>n?this._storePointerDown(e):this._doubleTapDragReady=!0}else this._storePointerDown(e)}_handlePointerUp(){this._doubleTapDragReady=!1}_storePointerDown(e){const{data:t}=e,{pointerType:i}=t.native,r=s.getPointerId(t),o="touch"===i?this._parameters.maximumDoubleTouchDelay:this._parameters.maximumDoubleClickDelay,n=this._clock.setTimeout((()=>this._clearPointerDown(r)),o);this._pointerState.set(r,{event:e,doubleTapTimeout:n}),this.refreshHasPendingInputs()}}function l(e,t,i){const{button:r,buttons:o,pointer:n,pointers:s,pointerType:a,timestamp:l}=i;return{action:e,delta:t,button:r,buttons:o,pointer:n,pointers:s,pointerType:a,timestamp:l}}e.DoubleTapDrag=a,Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})}))},"esri/views/input/recognizers/support":function(){define(["exports","../../../core/has","../../../core/screenUtils"],(function(e,t,i){"use strict";e.euclideanDistance=function(e,t){const i=t.x-e.x,r=t.y-e.y;return Math.sqrt(i*i+r*r)},e.fitCircleLSQ=function(e,t){if(t?(t.radius=0,t.center.x=0,t.center.y=0):t={radius:0,center:i.createScreenPoint()},0===e.length)return t;if(1===e.length)return t.center.x=e[0].x,t.center.y=e[0].y,t;if(2===e.length){const[i,r]=e,[o,n]=[r.x-i.x,r.y-i.y];return t.radius=Math.sqrt(o*o+n*n)/2,t.center.x=(i.x+r.x)/2,t.center.y=(i.y+r.y)/2,t}let r=0,o=0;for(let t=0;t<e.length;t++)r+=e[t].x,o+=e[t].y;r/=e.length,o/=e.length;const n=e.map((e=>e.x-r)),s=e.map((e=>e.y-o));let a=0,l=0,c=0,u=0,h=0,d=0,p=0;for(let e=0;e<n.length;e++){const t=n[e],i=s[e],r=t*t,o=i*i;a+=r,l+=o,c+=t*i,u+=r*t,h+=o*i,d+=t*o,p+=i*r}const m=.5*(u+d),g=.5*(h+p),_=a*l-c*c,f=(m*l-g*c)/_,y=(a*g-c*m)/_,w=i.createScreenPoint(f+r,y+o);return{radius:Math.sqrt(f*f+y*y+(a+l)/e.length),center:w}},e.getDoubleClickParameters=(e={})=>({maximumClickDelay:300,maximumDoubleClickDistance:10,maximumDoubleTouchDistance:35,maximumDoubleClickDelay:250,maximumDoubleTouchDelay:350,...e}),e.getHoldAndDragParameters=(e={})=>({maximumClickDelay:300,movementUntilMouseDrag:1.5,movementUntilPenDrag:6,movementUntilTouchDrag:6,holdDelay:500,...e}),e.getPointerId=function(e){const{native:t}=e,{pointerId:i,button:r,pointerType:o}=t;return"mouse"===o?`${i}:${r}`:`${o}`},e.manhattanDistance=function(e,t){return Math.abs(t.x-e.x)+Math.abs(t.y-e.y)},Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})}))},"esri/views/input/recognizers/Drag":function(){define(["exports","../../../core/screenUtils","../../../core/time","../InputHandler","./support"],(function(e,t,i,r,o){"use strict";class n extends r.InputHandler{constructor(e){super(!1),this._navigationTouch=e,this._startStateModifiers=new Set,this._activePointerMap=new Map,this._isDragging=!1,this._isCurrentDragSuppressed=!1,this._drag=this.registerOutgoing("drag"),this.registerIncoming("pointer-drag",this._handlePointerDrag.bind(this)),this.registerIncoming("pointer-up",this._handlePointerUpAndPointerLost.bind(this)),this.registerIncoming("pointer-capture-lost",this._handlePointerUpAndPointerLost.bind(this)),this.registerIncoming("pointer-cancel",this._handlePointerUpAndPointerLost.bind(this))}_createPayload(e,t,i,r){return{action:e,pointerType:this._pointerType,button:this._mouseButton,buttons:t.buttons,timestamp:r,pointers:l(this._activePointerMap),pointer:t,angle:i.angle,radius:i.radius,center:i.center}}_addPointer(e){const t=e.native.pointerId,i=a(this._activePointerMap).angle,r={event:e,initialAngle:0,lastAngle:0};this._activePointerMap.set(t,r);const o=c(r,s(this._activePointerMap));r.initialAngle=o,r.lastAngle=o,this._updatePointerAngles(i)}_updatePointer(e){if(e&&null==e.x&&null==e.y)return;const t=e.native.pointerId,i=this._activePointerMap.get(t);i?i.event=e:this._addPointer(e)}_removePointer(e){const t=a(this._activePointerMap).angle;this._activePointerMap.delete(e),this._updatePointerAngles(t)}_updatePointerAngles(e){const t=a(this._activePointerMap);this._activePointerMap.forEach((i=>{i.initialAngle=c(i,t)-e,i.lastAngle=c(i,t)-e}))}_emitEvent(e,t,i){const r=a(this._activePointerMap);this._drag.emit(this._createPayload(e,t,r,i),void 0,this._startStateModifiers)}_handlePointerUpAndPointerLost(e){const t=e.data.native.pointerId,r=i.Milliseconds(e.timestamp);this._activePointerMap.get(t)&&(1===this._activePointerMap.size?(this._updatePointer(e.data),!this._isCurrentDragSuppressed&&this._emitEvent("end",e.data,r),this._isDragging=!1,this._isCurrentDragSuppressed=!1,this._removePointer(t)):(this._removePointer(t),this._emitEvent("removed",e.data,i.Milliseconds(e.timestamp))))}_handlePointerDrag(e){const t=e.data,r=t.currentEvent,o=i.Milliseconds(e.timestamp);switch(t.action){case"start":case"update":this._isDragging?this._activePointerMap.has(r.native.pointerId)?(this._updatePointer(r),!this._isCurrentDragSuppressed&&this._emitEvent("update",r,o)):(this._addPointer(r),this._emitEvent("added",r,o),this._isCurrentDragSuppressed=this._isSuppressed):(this._updatePointer(r),this._pointerType=e.data.startEvent.pointerType,this._mouseButton=e.data.startEvent.button,this._startStateModifiers=e.modifiers,this._isDragging=!0,this._isCurrentDragSuppressed=this._isSuppressed,!this._isCurrentDragSuppressed&&this._emitEvent("start",r,o))}}get _isSuppressed(){return!!this._navigationTouch&&!this._navigationTouch.browserTouchPanEnabled&&"touch"===this._pointerType&&1===this._activePointerMap.size}}function s(e){const i=[];return e.forEach((e=>{i.push(t.createScreenPoint(e.event.x,e.event.y))})),o.fitCircleLSQ(i)}function a(e){const t=s(e);let i=0;return e.forEach((e=>{let r=c(e,t),o=r-e.lastAngle;for(;o>Math.PI;)o-=2*Math.PI;for(;o<-Math.PI;)o+=2*Math.PI;r=e.lastAngle+o,e.lastAngle=r;const n=r-e.initialAngle;i+=n})),i/=e.size||1,{angle:i,radius:t.radius,center:t.center}}function l(e){const t=new Map;return e.forEach(((e,i)=>t.set(i,e.event))),t}function c(e,t){const i=e.event,r=i.x-t.center.x,o=i.y-t.center.y;return Math.atan2(o,r)}var u;e.Button=void 0,(u=e.Button||(e.Button={}))[u.Left=0]="Left",u[u.Middle=1]="Middle",u[u.Right=2]="Right",u[u.Back=3]="Back",u[u.Forward=4]="Forward",u[u.Undefined=-1]="Undefined",e.Drag=n,Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})}))},"esri/views/input/recognizers/ImmediateDoubleClick":function(){define(["exports","../../../core/clock","../InputHandler","./support"],(function(e,t,i,r){"use strict";class o extends i.InputHandler{constructor(e={},i=t.clock){super(!1),this._clock=i,this._pointerState=new Map,this._parameters=r.getDoubleClickParameters(e),this._immediateDoubleClick=this.registerOutgoing("immediate-double-click"),this.registerIncoming("pointer-down",this._handlePointerDown.bind(this)),this.registerIncoming("pointer-up",this._handlePointerUp.bind(this))}onUninstall(){this._pointerState.forEach((e=>{e.immediateDoubleClick&&e.immediateDoubleClick.timeoutHandle.remove()})),super.onUninstall()}_handlePointerDown(e){const t=e.data,i=r.getPointerId(t);if(!this._pointerState.has(i)){const e={downButton:t.native.button,x:t.x,y:t.y,immediateDoubleClick:null};this._pointerState.set(i,e),this.startCapturingPointer(t.native)}}_handlePointerUp(e){const t=e.data,i=r.getPointerId(t),o=this._pointerState.get(i);if(o&&o.downButton===t.native.button){const i=o.immediateDoubleClick,n="touch"===e.data.native.pointerType?this._parameters.maximumDoubleTouchDistance:this._parameters.maximumDoubleClickDistance;i?(i.timeoutHandle.remove(),r.manhattanDistance(i,e.data)>n?this._startImmediateDoubleClick(e,o):(this._immediateDoubleClick.emit(e.data,void 0,i.modifiers),this._removeState(t))):r.manhattanDistance(o,e.data)>n?this._removeState(t):this._startImmediateDoubleClick(e,o)}}_startImmediateDoubleClick(e,t){const i="touch"===e.data.native.pointerType?this._parameters.maximumDoubleTouchDelay:this._parameters.maximumDoubleClickDelay;t.immediateDoubleClick={x:e.data.x,y:e.data.y,modifiers:e.modifiers,timeoutHandle:this._clock.setTimeout((()=>this._removeState(e.data)),i)}}_removeState(e){const t=r.getPointerId(e);this._pointerState.delete(t),this.stopCapturingPointer(e.native),this.refreshHasPendingInputs()}}e.ImmediateDoubleClick=o,Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})}))},"esri/views/input/recognizers/PointerClickHoldAndDrag":function(){define(["exports","../../../core/clock","../../../core/maybe","../InputHandler","./support"],(function(e,t,i,r,o){"use strict";class n extends r.InputHandler{constructor(e={},i=t.clock){super(!1),this._clock=i,this._pointerState=new Map,this._parameters=o.getHoldAndDragParameters(e),this._pointerDrag=this.registerOutgoing("pointer-drag"),this._immediateClick=this.registerOutgoing("immediate-click"),this._pointerHold=this.registerOutgoing("hold"),this.registerIncoming("pointer-down",(e=>this._handlePointerDown(e))),this.registerIncoming("pointer-up",(e=>this._handlePointerLoss(e,"pointer-up"))),this.registerIncoming("pointer-capture-lost",(e=>this._handlePointerLoss(e,"pointer-capture-lost"))),this.registerIncoming("pointer-cancel",(e=>this._handlePointerLoss(e,"pointer-cancel"))),this._moveHandle=this.registerIncoming("pointer-move",(e=>this._handlePointerMove(e))),this._moveHandle.pause()}onUninstall(){this._pointerState.forEach((e=>{e.holdTimeout=i.removeMaybe(e.holdTimeout)})),super.onUninstall()}_handlePointerDown(e){const t=e.data,i=t.native.pointerId;let r=null;0===this._pointerState.size&&(r=this._clock.setTimeout((()=>{const t=this._pointerState.get(i);if(t){if(!t.isDragging){const i=t.previousEvent;this._pointerHold.emit(i,void 0,e.modifiers),t.holdEmitted=!0}t.holdTimeout=null}}),this._parameters.holdDelay));const o={startEvent:t,previousEvent:t,startTimestamp:e.timestamp,isDragging:!1,downButton:t.native.button,holdTimeout:r,modifiers:new Set};this._pointerState.set(i,o),this.startCapturingPointer(t.native),this._moveHandle.resume(),this._pointerState.size>1&&this._startDragging(e)}_handlePointerMove(e){const t=e.data,i=t.native.pointerId,r=this._pointerState.get(i);r&&(r.isDragging?this._pointerDrag.emit(s("update",r,t),void 0,r.modifiers):o.euclideanDistance(t,r.startEvent)>this._getDragThreshold(t.native.pointerType)&&this._startDragging(e),r.previousEvent=t)}_getDragThreshold(e){switch(e){case"touch":return this._parameters.movementUntilTouchDrag;case"pen":return this._parameters.movementUntilPenDrag;default:return this._parameters.movementUntilMouseDrag}}_startDragging(e){const t=e.data,i=t.native.pointerId;this._pointerState.forEach((r=>{null!=r.holdTimeout&&(r.holdTimeout.remove(),r.holdTimeout=null),r.isDragging||(r.modifiers=e.modifiers,r.isDragging=!0,i===r.startEvent.native.pointerId?this._pointerDrag.emit(s("start",r,t)):this._pointerDrag.emit(s("start",r,r.previousEvent),e.timestamp))}))}_handlePointerLoss(e,t){const i=e.data,r=i.native.pointerId,o=this._pointerState.get(r);o&&(null!=o.holdTimeout&&(o.holdTimeout.remove(),o.holdTimeout=null),o.isDragging?this._pointerDrag.emit(s("end",o,"pointer-up"===t?i:o.previousEvent),void 0,o.modifiers):"pointer-up"===t&&o.downButton===i.native.button&&e.timestamp-o.startTimestamp<=this._parameters.maximumClickDelay&&!o.holdEmitted&&this._immediateClick.emit(i),this._pointerState.delete(r),this.stopCapturingPointer(i.native),0===this._pointerState.size&&this._moveHandle.pause())}}function s(e,t,i){return{action:e,startEvent:t.startEvent,previousEvent:t.previousEvent,currentEvent:i}}e.PointerClickHoldAndDrag=n,Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})}))},"esri/views/input/recognizers/SingleAndDoubleClick":function(){define(["exports","../../../core/clock","../../../core/maybe","../InputHandler","./support"],(function(e,t,i,r,o){"use strict";class n extends r.InputHandler{constructor(e={},i=t.clock){super(!1),this._clock=i,this._pointerState=new Map,this._parameters=o.getDoubleClickParameters(e),this._click=this.registerOutgoing("click"),this._doubleClick=this.registerOutgoing("double-click"),this.registerIncoming("immediate-click",(e=>this._handleImmediateClick(e))),this.registerIncoming("pointer-down",(e=>this._handlePointerDown(e)))}onUninstall(){this._pointerState.forEach((e=>e.doubleClickTimer=i.removeMaybe(e.doubleClickTimer)))}get hasPendingInputs(){for(const e of this._pointerState.values())if(null!=e.doubleClickTimer)return!0;return!1}_clearDoubleClickTimer(e,t){const r=this._pointerState.get(e);r&&(r.doubleClickTimer=i.removeMaybe(r.doubleClickTimer),t&&this._click.emit(r.event.data,void 0,r.event.modifiers),this._pointerState.delete(e),this.refreshHasPendingInputs())}_doubleClickTimeoutExceeded(e){const t=this._pointerState.get(e);1===t.pointerDownCount&&this._click.emit(t.event.data,void 0,t.event.modifiers),t.doubleClickTimer=null,this._pointerState.delete(e),this.refreshHasPendingInputs()}_handleImmediateClick(e){const t=e.data,{pointerType:i}=t.native,r=function(e){const{pointerId:t,pointerType:i,button:r}=e.native;return"mouse"===i?`${t}:${r}`:`${i}`}(t);if(!this._pointerState.has(r))return void this._startClick(e);const n=this._pointerState.get(r),{data:s,modifiers:a}=n.event,l="touch"===i?this._parameters.maximumDoubleTouchDistance:this._parameters.maximumDoubleClickDistance;o.manhattanDistance(s,t)>l?(this._clearDoubleClickTimer(r,!0),this._startClick(e)):(this._clearDoubleClickTimer(r,!1),2===n.pointerDownCount&&this._doubleClick.emit(s,void 0,a))}_handlePointerDown(e){const t=o.getPointerId(e.data),i=this._pointerState.get(t);i&&(i.pointerDownCount+=1)}_startClick(e){const{data:t}=e,{native:{pointerType:i}}=t,r=o.getPointerId(t),n="touch"===i?this._parameters.maximumDoubleTouchDelay:this._parameters.maximumDoubleClickDelay,s=this._clock.setTimeout((()=>this._doubleClickTimeoutExceeded(r)),n);this._pointerState.set(r,{event:e,doubleClickTimer:s,pointerDownCount:1}),this.refreshHasPendingInputs()}}e.SingleAndDoubleClick=n,Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})}))},"esri/views/2d/AnimationManager":function(){define(["../../chunks/tslib.es6","../../Viewpoint","../../core/Accessor","../../core/has","../../core/maybe","../../core/scheduling","../../core/screenUtils","../../core/time","../../core/accessorSupport/decorators/property","../../core/Logger","../../core/RandomLCG","../../core/accessorSupport/decorators/subclass","../../core/libs/gl-matrix-2/factories/vec2f64","../../geometry/Point","../ViewAnimation","./PaddedViewState","./viewpointUtils","./pointToPoint/Camera","../animation/easing","../animation/pointToPoint/Animation","../animation/pointToPoint/Settings"],(function(e,t,i,r,o,n,s,a,l,c,u,h,d,p,m,g,_,f,y,w,v){"use strict";class T{constructor(e){this._view=e,this._animation=new w.Animation((()=>new f.Camera(this._view))),this._current=new f.Camera(this._view)}get _source(){return this._animation.definition.source}get _target(){return this._animation.definition.target}get duration(){return this._animation.time}get animation(){return this._animation}update(e,t,i={}){_.copy(this._current.viewpoint,e),_.copy(this._source.viewpoint,e),_.copy(this._target.viewpoint,t),this._animation.update(this._source,this._target,i)}applyRatio(e,t){this._animation.cameraAt(t,this._current),_.copy(e,this._current.viewpoint)}}let S=class extends i{constructor(e){super(e),this._animation=null,this._destinationViewState=new g,this.updateFunction=null,this.easing=y.EasingFunctions.ease,this.viewpoint=new t({targetGeometry:new p,scale:0,rotation:0}),this._updateTask=n.addFrameTask({postRender:this._postRender.bind(this)}),this._updateTask.pause(),this._transition=new T(e.view)}destroy(){this._updateTask=o.removeMaybe(this._updateTask)}get animation(){return this._animation}set animation(e){this._animation=e,this.view.animation=e}animate(e,t,i){this.stop();const r=this.viewpoint;_.copy(r,t);const o=e.target;this._transition.update(this.viewpoint,o,{apex:{maximumDistance:Math.min(64*Math.min(t.scale,o.scale),this.view.constraints.effectiveMinScale),desiredSlope:5e-8},duration:i?.duration,maxDuration:"auto"===i?.animationMode?a.Milliseconds(1/0):i?.maxDuration??v.defaultSettings2D.maxDuration,speedFactor:i?.speedFactor,easing:("string"==typeof i?.easing?y.EasingFunctions[i.easing]:i?.easing)||this.easing}),"auto"===i?.animationMode&&(this._destinationViewState.copy(this.view.state),this._destinationViewState.viewpoint=o,function(e,t,i,r){if(null!=t?.duration)return!0;const{time:o,isLinear:n}=e,a=t?.speedFactor||1;if(o>(t?.maxDuration??v.defaultSettings2D.maxDuration/a))return!1;if(n){const e=1.5,t=d.create(),n=s.createScreenPoint(...r.toScreen(t,...i.center)),l=s.createScreenPoint(...i.toScreen(t,...r.center)),c=null!=l&&l.x>-1*i.size[0]&&l.x<(e+.5)*i.size[0]&&l.y>-1*i.size[1]&&l.y<(e+.5)*i.size[1],u=null!=n&&n.x>-1*r.size[0]&&n.x<(e+.5)*r.size[0]&&n.y>-1*r.size[1]&&n.y<(e+.5)*r.size[1];if(o>2e3/a&&!c&&!u)return!1}return!0}(this._transition.animation,i,this.view.state,this._destinationViewState)||this._transition.update(this.viewpoint,o,{duration:a.Milliseconds(0)}));const n=()=>{this.animation===e&&this._updateTask&&("finished"===e.state&&(this._transition.applyRatio(this.viewpoint,1),this.view.state&&(this.view.state.viewpoint=this.viewpoint.clone())),this.animation=null,this.updateFunction=null)};return e.when(n,n),this._startTime=performance.now(),this._updateTask.resume(),this.animation=e,e}animateContinuous(e,t){this.stop(),this.updateFunction=t,this.viewpoint=e;const i=new m({target:e.clone()}),r=()=>{this.animation===i&&this._updateTask&&(this.animation=null,this.updateFunction=null)};return i.when(r,r),this._startTime=performance.now(),this._updateTask.resume(),this.animation=i,i}stop(){this.animation&&(this.animation.stop(),this.animation=null,this.updateFunction=null)}_postRender(e){const t=this.animation;if(t&&t.state!==m.State.STOPPED){if(this.updateFunction)this.updateFunction(this.viewpoint,e.deltaTime),this.animation?.update(this.viewpoint);else{const e=performance.now()-this._startTime,t=this._transition.duration,i=t>0?e/t:1,r=i>=1;this._transition.applyRatio(this.viewpoint,i),r&&this.animation?.finish()}this.view.state&&(this.view.state.viewpoint=this.viewpoint.clone())}else this._updateTask.pause()}};return e.__decorate([l.property()],S.prototype,"easing",void 0),e.__decorate([l.property()],S.prototype,"view",void 0),e.__decorate([l.property()],S.prototype,"viewpoint",void 0),S=e.__decorate([h.subclass("esri.views.2d.AnimationManager")],S),S}))},"esri/views/2d/pointToPoint/Camera":function(){define(["exports","../../../Viewpoint","../../../core/mathUtils","../../../geometry/Point","../../../geometry/support/pointUtils","../viewpointUtils"],(function(e,t,i,r,o,n){"use strict";e.Camera=class{constructor(e){this._view=e,this.viewpoint=new t({targetGeometry:new r,scale:0,rotation:0})}get view(){return this._view}get size(){const[e,t]=this._view.size;return Math.sqrt(e*e+t*t)}get scale(){return this.viewpoint.scale}get rotation(){return this.viewpoint.rotation}get center(){return this.viewpoint.targetGeometry}get scaleToResolutionFactor(){return n.getScaleToResolutionFactor(this.center.spatialReference)}pixelsPerPanAtZoom(e){return 1/(e*this.scaleToResolutionFactor)}zoomAtPixelsPerPan(e){return 1/(e*this.scaleToResolutionFactor)}pixelsPerRotate(){return this.size/2}compareTo(e,t){t.pan=o.distance(this.center,e.center);let r=Math.abs(e.rotation-this.rotation);r=r>=180?360-r:r,t.rotate=i.deg2rad(r),t.sourceZoom=this.scale,t.targetZoom=e.scale}interpolate(e,t,r){const{pan:o,rotate:n,zoom:s,zoomOffset:a}=r,{center:l}=this;l.spatialReference=e.center.spatialReference,l.x=i.lerp(e.center.x,t.center.x,o),l.y=i.lerp(e.center.y,t.center.y,o),this.viewpoint.scale=i.lerp(e.scale,t.scale+a,s);let c=e.rotation;const u=t.rotation;Math.abs(u-c)>=180&&(c+=360*(c<u?1:-1)),this.viewpoint.rotation=i.lerp(c,u,n)}copyFrom(e){n.copy(this.viewpoint,e.viewpoint),this._view=e.view}},Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})}))},"esri/views/animation/easing":function(){define(["exports","../2d/unitBezier"],(function(e,t){"use strict";const i=e=>e,r=e=>e*e,o=e=>1-r(1-e),n=e=>e<.5?r(2*e)/2:(o(2*(e-.5))+1)/2,s=e=>e*e*e,a=e=>1-s(1-e),l=e=>e<.5?s(2*e)/2:(a(2*(e-.5))+1)/2,c=e=>e*e*e*e,u=e=>1-c(1-e),h=e=>e<.5?c(2*e)/2:(u(2*(e-.5))+1)/2,d=e=>e*e*e*e*e,p=e=>1-d(1-e),m=e=>e<.5?d(2*e)/2:(p(2*(e-.5))+1)/2,g=e=>1-Math.cos(e*Math.PI/2),_=e=>1-g(1-e),f=e=>e<.5?g(2*e)/2:(_(2*(e-.5))+1)/2,y=e=>2**(10*(e-1)),w=e=>1-y(1-e),v=e=>e<.5?y(2*e)/2:(w(2*(e-.5))+1)/2,T=e=>-(Math.sqrt(1-e*e)-1),S=e=>1-T(1-e),b=e=>e<.5?T(2*e)/2:(S(2*(e-.5))+1)/2;function E(e){const t=2*(e-Math.sqrt((e-1)*e)),i=t/2/e;return r=>r<i?e*r*r:t*r-t+1}function M(e,t){return(i,r)=>i<t?t*e(i/t,r):1-e((1-i)/(1-t),r)*(1-t)}const x=M(E(1),1),P=M(E(1),0),R=M(E(1),.5),A=M(E(2),1),I=M(E(2),0),C=M(E(2),.5),D=M(E(3),1),O=M(E(3),0),L=M(E(3),.5),N=M(E(4),1),F=M(E(4),0),k=M(E(4),.5),U={linear:i,"in-quad":r,"out-quad":o,"in-out-quad":n,"in-coast-quad":x,"out-coast-quad":P,"in-out-coast-quad":R,"in-cubic":s,"out-cubic":a,"in-out-cubic":l,"in-coast-cubic":A,"out-coast-cubic":I,"in-out-coast-cubic":C,"in-quart":c,"out-quart":u,"in-out-quart":h,"in-coast-quart":D,"out-coast-quart":O,"in-out-coast-quart":L,"in-quint":d,"out-quint":p,"in-out-quint":m,"in-coast-quint":N,"out-coast-quint":F,"in-out-coast-quint":k,"in-sine":g,"out-sine":_,"in-out-sine":f,"in-expo":y,"out-expo":w,"in-out-expo":v,"in-circ":T,"out-circ":S,"in-out-circ":b,"quad-in":r,"quad-out":o,"quad-in-out":n,"quad-in-coast":x,"quad-out-coast":P,"quad-in-out-coast":R,"cubic-in":s,"cubic-out":a,"cubic-in-out":l,"cubic-in-coast":A,"cubic-out-coast":I,"cubic-in-out-coast":C,"quart-in":c,"quart-out":u,"quart-in-out":h,"quart-in-coast":D,"quart-out-coast":O,"quart-in-out-coast":L,"quint-in":d,"quint-out":p,"quint-in-out":m,"quint-in-coast":N,"quint-out-coast":F,"quint-in-out-coast":k,"sine-in":g,"sine-out":_,"sine-in-out":f,"expo-in":y,"expo-out":w,"expo-in-out":v,"circ-in":T,"circ-out":S,"circ-in-out":b,ease:e=>t.easingFunctions.ease(e),"ease-in":e=>t.easingFunctions.easeIn(e),"ease-out":e=>t.easingFunctions.easeOut(e),"ease-in-out":e=>t.easingFunctions.easeInOut(e)};e.EasingFunctions=U,e.inCirc=T,e.inCoastCubic=A,e.inCoastQuad=x,e.inCoastQuart=D,e.inCoastQuint=N,e.inCubic=s,e.inExpo=y,e.inOutCirc=b,e.inOutCoastCubic=C,e.inOutCoastQuad=R,e.inOutCoastQuart=L,e.inOutCoastQuint=k,e.inOutCubic=l,e.inOutExpo=v,e.inOutQuad=n,e.inOutQuart=h,e.inOutQuint=m,e.inOutSine=f,e.inQuad=r,e.inQuart=c,e.inQuint=d,e.inSine=g,e.linear=i,e.outCirc=S,e.outCoastCubic=I,e.outCoastQuad=P,e.outCoastQuart=O,e.outCoastQuint=F,e.outCubic=a,e.outExpo=w,e.outQuad=o,e.outQuart=u,e.outQuint=p,e.outSine=_,Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})}))},"esri/views/2d/unitBezier":function(){define(["exports"],(function(e){"use strict";function t(e,t,i,r){const o=3*e,n=3*(i-e)-o,s=1-o-n,a=3*t,l=3*(r-t)-a,c=1-a-l;function u(e){return((s*e+n)*e+o)*e}return function(e,t=1e-6){return i=function(e,t){let i,r,a,l,c,h;for(a=e,h=0;h<8;h++){if(l=u(a)-e,Math.abs(l)<t)return a;if(c=(3*s*(d=a)+2*n)*d+o,Math.abs(c)<1e-6)break;a-=l/c}var d;if(i=0,r=1,a=e,a<i)return i;if(a>r)return r;for(;i<r;){if(l=u(a),Math.abs(l-e)<t)return a;e>l?i=a:r=a,a=.5*(r-i)+i}return a}(e,t),((c*i+l)*i+a)*i;var i}}const i=/^cubic-bezier\((.*)\)/,r={};r.ease=t(.25,.1,.25,1),r.linear=t(0,0,1,1),r.easeIn=r["ease-in"]=t(.42,0,1,1),r.easeOut=r["ease-out"]=t(0,0,.58,1),r.easeInOut=r["ease-in-out"]=t(.42,0,.58,1),e.easingFunctions=r,e.parse=function(e){let o=r[e]||null;if(!o){const r=i.exec(e);if(r){const e=r[1].split(",").map((e=>parseFloat(e.trim())));4!==e.length||e.some((e=>isNaN(e)))||(o=t.apply(t,e))}}return o},e.unitBezier=t,Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})}))},"esri/views/animation/pointToPoint/Animation":function(){define(["exports","../../../core/time","../easing","./Definition","./InterpolateComponents","./Settings","./apex/Path"],(function(e,t,i,r,o,n,s){"use strict";const a=new o.InterpolateComponents;e.Animation=class{get time(){return this._time}get isLinear(){return 1===this.path.segments.length}constructor(e){this._time=t.Milliseconds(0),this._easing=i.inOutCoastQuad,this.definition=new r.Definition(e),this.path=new s.Path}update(e,r,o){this.definition.update(e,r,o),this.path.update(this.definition,o),this._time=this._applyTimeSettings(t.millisecondsFromSeconds(isFinite(this.path.time)?this.path.time:t.Seconds(0)),o),this._easing=o.easing??(this._time>=1e3?i.inOutCoastQuad:i.outExpo)}cameraAt(e,t){e=Math.min(Math.max(0,e),1),e=this._normalizedEasing(e);const i=this.path.interpolateComponentsAt(e,a);t.interpolate(this.definition.source,this.definition.target,i)}_normalizedEasing(e){const t=this._easing(0,this._time),i=this._easing(1,this._time);return(this._easing(e,this._time)-t)/(i-t)}_applyTimeSettings(e,i){const r=null!=i.speedFactor?i.speedFactor:1,o=i.minDuration??n.defaultSettings.minDuration/r,s=i.maxDuration??n.defaultSettings.maxDuration/r;return null!=i.duration?t.Milliseconds(i.duration):t.Milliseconds(Math.min(Math.max(e/r,o),s))}},Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})}))},"esri/views/animation/pointToPoint/Definition":function(){define(["exports","../../../core/libs/gl-matrix-2/math/common","./Camera","./Settings"],(function(e,t,i,r){"use strict";class o{constructor(e){this._createCamera=e,this.compared=new i.CompareResult,this.segmentStart=0,this.segmentEnd=1,this.settings={desiredScreenFlow:r.defaultSettings.desiredScreenFlow},this.source=e(),this.target=e()}clone(){const e=new o(this._createCamera);return e.copyFrom(this),e}copyFrom(e){this.update(e.source,e.target,e.settings)}update(e,t,i){this.source!==e&&this.source.copyFrom(e),this.target!==t&&this.target.copyFrom(t),this.source.compareTo(this.target,this.compared),this.settings.desiredScreenFlow=i.desiredScreenFlow??r.defaultSettings.desiredScreenFlow,this.desiredPixelFlow=this.settings.desiredScreenFlow*this.target.size,this.halfWindowSize=this.target.size/2}halfWindowPanAtZoom(e){const t=this.target.pixelsPerPanAtZoom(e);return this.halfWindowSize/t}get hasZoom(){return Math.abs(this.compared.sourceZoom-this.compared.targetZoom)>1e-5}get hasPan(){return this.compared.pan>t.getEpsilon()}get hasFov(){return Math.abs(this.compared.fov)>t.getEpsilon()}get hasRotate(){return this.compared.rotate>t.getEpsilon()}}e.Definition=o,Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})}))},"esri/views/animation/pointToPoint/Camera":function(){define(["exports"],(function(e){"use strict";e.CompareResult=class{constructor(){this.pan=0,this.rotate=0,this.fov=0,this.sourceZoom=0,this.targetZoom=0}},Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})}))},"esri/views/animation/pointToPoint/Settings":function(){define(["exports","../../../core/time"],(function(e,t){"use strict";const i={desiredScreenFlow:2,minDuration:t.Milliseconds(500),maxDuration:t.Milliseconds(8e3)},r={...i,maxDuration:t.Milliseconds(4e3)};e.defaultSettings=i,e.defaultSettings2D=r,Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})}))},"esri/views/animation/pointToPoint/InterpolateComponents":function(){define(["exports"],(function(e){"use strict";e.InterpolateComponents=class{constructor(){this.pan=0,this.rotate=0,this.zoom=0,this.fov=0,this.zoomOffset=0}},Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})}))},"esri/views/animation/pointToPoint/apex/Path":function(){define(["exports","../../easing","../Path","../Segment","./planning"],(function(e,t,i,r,o){"use strict";class n extends i.Path{constructor(e,t){super(),this._preallocSegments=[new r.Segment,new r.Segment,new r.Segment],this._ascensionSegment=null,this._descensionSegment=null,this.update(e,t)}update(e,t){if(!e)return;this.definition?this.definition.copyFrom(e):this.definition=e.clone();const i=t?.apex?o.optimalDistance(e,t.apex):null;this.segments.length=0,this._ascensionSegment=null,this._descensionSegment=null,i?this._updateWithApex(i,t?.apex):this._updateWithoutApex()}segmentInterpolateComponentsAt(e,i,r){e.interpolateComponentsAt(i,r),e===this._ascensionSegment?r.zoom=t.outQuad(r.zoom):e===this._descensionSegment&&(r.zoom=t.inQuad(r.zoom))}_updateWithApex(e,t){const[i,r,o]=this._preallocSegments,n=t?.ascensionFactor??.5,s=Math.min(1-n,null!=t?.ascensionFactor&&null!=t.descensionFactor?t.descensionFactor:.5),a=1-n-s;i.definition?i.definition.copyFrom(this.definition):i.definition=this.definition.clone(),i.definition.compared.targetZoom=e,i.definition.compared.pan=this.definition.compared.pan*n,i.definition.compared.rotate=this.definition.compared.rotate*n,i.definition.segmentEnd=n,i.update(),this._ascensionSegment=i,this.segments.push(i),a>0&&(r.definition?r.definition.copyFrom(this.definition):r.definition=this.definition.clone(),r.definition.copyFrom(this.definition),r.definition.compared.sourceZoom=e,r.definition.compared.targetZoom=e,r.definition.compared.pan=this.definition.compared.pan*a,r.definition.compared.rotate=this.definition.compared.rotate*a,r.definition.segmentStart=i.definition.segmentEnd,r.definition.segmentEnd=i.definition.segmentEnd+a,r.update(),this.segments.push(r)),o.definition?o.definition.copyFrom(this.definition):o.definition=this.definition.clone(),o.definition.compared.sourceZoom=e,o.definition.compared.pan=this.definition.compared.pan*s,o.definition.compared.rotate=this.definition.compared.rotate*s,o.definition.segmentStart=n+a,o.update(),this._descensionSegment=o,this.segments.push(o)}_updateWithoutApex(){const[e]=this._preallocSegments;e.update(this.definition),this.segments.push(e)}}e.Path=n,Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})}))},"esri/views/animation/pointToPoint/Path":function(){define(["exports","../../../core/time"],(function(e,t){"use strict";e.Path=class{constructor(){this.segments=new Array}get time(){return this.segments.reduce(((e,i)=>t.Seconds(e+i.time)),t.Seconds(0))}interpolateComponentsAt(e,t){e=Math.min(Math.max(e,0),1),e*=this.time;let i=0,r=0;const o=this.definition,n=this.segments.reduce(((e,t)=>e||t.definition.hasZoom),!1);for(let s=0;s<this.segments.length;s++){const a=this.segments[s],l=a.definition;if(e<=a.time||s===this.segments.length-1){if(this.segmentInterpolateComponentsAt(a,0===a.time?0:e/a.time,t),o.hasPan&&!isNaN(t.pan)&&isFinite(o.compared.pan)?t.pan=(i+l.compared.pan*t.pan)/o.compared.pan:t.pan=1,o.hasRotate&&!isNaN(t.rotate)&&isFinite(o.compared.rotate)?t.rotate=(r+l.compared.rotate*t.rotate)/o.compared.rotate:t.rotate=1,n&&!isNaN(t.zoom)&&isFinite(l.compared.targetZoom)){const{sourceZoom:e,targetZoom:i}=l.compared,r=t.zoom*(i-e)+e,o=this.segments[0].definition.compared.sourceZoom,n=this.segments[this.segments.length-1].definition.compared.targetZoom,s=Math.abs(i-o)>Math.abs(e-o)?i:e;t.zoomOffset=s-n,t.zoom=(r-o)/(s-o)}else t.zoom=1;return t}e-=a.time,i+=l.compared.pan,r+=l.compared.rotate}}segmentInterpolateComponentsAt(e,t,i){e.interpolateComponentsAt(t,i)}},Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})}))},"esri/views/animation/pointToPoint/Segment":function(){define(["exports","../../../core/mathUtils","../../../core/time"],(function(e,t,i){"use strict";const r=t.deg2rad(45);e.Segment=class{get time(){return this._time}constructor(e){e&&this.update(e)}update(e){e&&(this.definition?this.definition.copyFrom(e):this.definition=e.clone()),this._updatePrecomputedVariables(),this._updatePixelFlow()}_updatePrecomputedVariables(){const e=this.definition,t=e.compared,i=t.sourceZoom,r=t.targetZoom;this._zoomSign=i>r?1:-1,this._panPixelsAtSource=t.pan*e.source.pixelsPerPanAtZoom(i);const o=(e.source.pixelsPerRotate()+e.target.pixelsPerRotate())/2;this._rotatePixels=t.rotate*o}_updatePixelFlow(){const e=this.definition.compared.sourceZoom,t=this.definition.compared.targetZoom,{hasZoom:r,hasPan:o,hasRotate:n}=this.definition;let s=0,a=0;r&&(o&&(s=(t/e-1)/(-1/(this._zoomSign*this.definition.halfWindowSize)*Math.LN2*this._panPixelsAtSource)),n&&(a=this._zoomSign*(Math.log(e/t)/Math.LN2)*this.definition.halfWindowSize/this._rotatePixels)),this._zoomPixelFlow=0,this._panPixelFlow=0,this._rotatePixelFlow=0;const l=this.definition.desiredPixelFlow;if(r&&o&&n){const e=s+a+s*a;this._zoomPixelFlow=s*a/e*l,this._panPixelFlow=a/e*l,this._rotatePixelFlow=s/e*l}else if(r&&o){const e=1+s;this._zoomPixelFlow=s/e*l,this._panPixelFlow=1/e*l}else if(r&&n){const e=1+a;this._zoomPixelFlow=a/e*l,this._rotatePixelFlow=1/e*l}else if(o&&n){const e=this._panPixelsAtSource/this._rotatePixels,t=1+e;this._panPixelFlow=e/t*l,this._rotatePixelFlow=1/t*l}else o?this._panPixelFlow=l:r?this._zoomPixelFlow=l:n&&(this._rotatePixelFlow=l);if(this._time=i.Seconds(Math.max(this.rotateTime,this.zoomTime,this.panTime)),this.fovTime>this._time){const e=this.fovTime/this._time;this._time=this.fovTime,this._zoomPixelFlow/=e,this._panPixelFlow/=e,this._rotatePixelFlow/=e}}get rotateTime(){return this.definition.hasRotate?i.Seconds(this._rotatePixels/this._rotatePixelFlow):i.Seconds(0)}get zoomTime(){return this.definition.hasZoom?i.Seconds(this._zoomSign*(Math.log(this.definition.compared.sourceZoom/this.definition.compared.targetZoom)/Math.LN2)*this.definition.halfWindowSize/this._zoomPixelFlow):i.Seconds(0)}get fovTime(){return this.definition.hasFov?i.Seconds(Math.abs(this.definition.compared.fov)/r):i.Seconds(0)}get panTime(){if(!this.definition.hasPan)return i.Seconds(0);if(this.definition.hasZoom){const e=-1/(this._zoomSign*this.definition.halfWindowSize)*Math.LN2,t=e*this._panPixelsAtSource;return i.Seconds(Math.log(t*(this._zoomPixelFlow/this._panPixelFlow)+1)/(e*this._zoomPixelFlow))}return i.Seconds(this._panPixelsAtSource/this._panPixelFlow)}_interpolateComponentsZoom(e){if(0===e||1===e)return e;if(this.definition.hasZoom){const t=this.definition.compared.sourceZoom,i=this.definition.compared.targetZoom;return(t*(t/i)**-e-t)/(i-t)}return e}_interpolateComponentsFov(e){if(0===e)return this.definition.segmentStart;if(1===e)return this.definition.segmentEnd;if(this.definition.hasFov){const{segmentStart:t,segmentEnd:i}=this.definition;return t+e*(i-t)}return this.definition.segmentStart}_interpolateComponentsPan(e){if(0===e||1===e)return e;if(this.definition.hasPan&&this.definition.hasZoom){const t=-1/(this._zoomSign*this.definition.halfWindowSize)*this._zoomPixelFlow;return 1/this._panPixelsAtSource*(this._panPixelFlow*(2**(t*e*this._time)-1))/(t*Math.LN2)}return e}_interpolateComponentsRotate(e){return e}interpolateComponentsAt(e,t){e=Math.min(Math.max(e,0),1),t.zoom=this._interpolateComponentsZoom(e),t.pan=this._interpolateComponentsPan(e),t.rotate=this._interpolateComponentsRotate(e),t.zoomOffset=0,t.fov=this._interpolateComponentsFov(e)}},Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})}))},"esri/views/animation/pointToPoint/apex/planning":function(){define(["exports","./functions"],(function(e,t){"use strict";e.optimalDistance=function(e,i){let r=function(e,t){const i=Math.max(e.compared.sourceZoom,e.compared.targetZoom),r=e.source.zoomAtPixelsPerPan(e.desiredPixelFlow/e.compared.pan)/2;return r<i?null!=t.maximumDistance?i+(t.maximumDistance-i)/2:1.5*i:t.maximumDistance?Math.min(t.maximumDistance,r):r}(e,i);const o={ascensionFactor:null!=i.ascensionFactor?i.ascensionFactor:.5,descensionFactor:null!=i.descensionFactor?i.descensionFactor:.5},n=0===o.ascensionFactor,s=0===o.descensionFactor,a=n?t.tAscensionZoomOnly:t.tAscensionZoomPan,l=n?t.dtAscensionZoomOnly:t.dtAscensionZoomPan,c=n?t.ddtAscensionZoomOnly:t.ddtAscensionZoomPan,u=s?t.tDescensionZoomOnly:t.tDescensionZoomPan,h=s?t.dtDescensionZoomOnly:t.dtDescensionZoomPan,d=s?t.ddtDescensionZoomOnly:t.ddtDescensionZoomPan,p=i=>a(e,i,o)+t.tPanion(e,i,o)+u(e,i,o),m=i=>l(e,i,o)+t.dtPanion(e,i,o)+h(e,i,o),g=i=>c(e,i,o)+t.ddtPanion(e,i,o)+d(e,i,o);let _=p(r);const f=t.tBaseLine(e);let y;const w=i.maximumIterations||20,v=null!=i.maximumDistance?i.maximumDistance:1/0;for(y=0;y<w;y++){const t=i.desiredSlope??1e-6;let o=m(r);Math.abs(o)>t&&(o+=t);const n=o/g(r);if(isNaN(n)||r>=v&&n<0){if(!isFinite(v))return null;r=v,_=p(r);break}if(r-=n,r<=e.compared.sourceZoom||r<=e.compared.targetZoom)return null;const s=p(r);if(Math.abs(s-_)/_<=.005)break;_=s}return isNaN(_)||_>.7*f||r<=e.compared.sourceZoom||r<=e.compared.targetZoom?null:r},Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})}))},"esri/views/animation/pointToPoint/apex/functions":function(){define(["exports"],(function(e){"use strict";e.ddtAscensionZoomOnly=function(e,t){return-e.halfWindowSize/(t*t*e.desiredPixelFlow*Math.LN2)},e.ddtAscensionZoomPan=function(e,t,i){const r=t-e.compared.sourceZoom,o=1/r,n=1/t,s=Math.log(e.compared.sourceZoom*n),a=(i.ascensionFactor*Math.LN2*e.compared.pan+e.halfWindowPanAtZoom(r))/e.halfWindowPanAtZoom(1);return e.halfWindowSize*o*(-2*o*n*a+2*o*s+2*n-2*s*a/(r*r)-a/(t*t))/(e.desiredPixelFlow*Math.LN2)},e.ddtDescensionZoomOnly=function(e,t){return-e.halfWindowSize/(t*t*e.desiredPixelFlow*Math.LN2)},e.ddtDescensionZoomPan=function(e,t,i){const r=t-e.compared.targetZoom,o=1/r,n=1/t,s=Math.log(t/e.compared.targetZoom),a=(e.halfWindowPanAtZoom(t)+i.descensionFactor*Math.LN2*e.compared.pan-e.halfWindowPanAtZoom(e.compared.targetZoom))/e.halfWindowPanAtZoom(1);return e.halfWindowSize*o*(-2*o*n*a-2*o*s+2*n+2*s*a/(r*r)-a/(t*t))/(e.desiredPixelFlow*Math.LN2)},e.ddtPanion=function(e,t,i){return-2*e.compared.pan*e.halfWindowSize*(i.ascensionFactor+i.descensionFactor-1)/(e.desiredPixelFlow*e.halfWindowPanAtZoom(t*t*t))},e.dtAscensionZoomOnly=function(e,t){return e.halfWindowSize/(t*e.desiredPixelFlow*Math.LN2)},e.dtAscensionZoomPan=function(e,t,i){const r=1/t,o=Math.log(e.compared.sourceZoom*r),n=1/e.desiredPixelFlow,s=1/Math.LN2,a=t-e.compared.sourceZoom,l=1/a,c=(i.ascensionFactor*Math.LN2*e.compared.pan+e.halfWindowPanAtZoom(a))/e.halfWindowPanAtZoom(1);return e.halfWindowSize*r*n*s*l*c-e.halfWindowSize*o*n*s*l+e.halfWindowSize*o*n*s*c/(a*a)},e.dtDescensionZoomOnly=function(e,t){return e.halfWindowSize/(t*e.desiredPixelFlow*Math.LN2)},e.dtDescensionZoomPan=function(e,t,i){const r=Math.log(t/e.compared.targetZoom),o=1/e.desiredPixelFlow,n=1/Math.LN2,s=-t+e.compared.targetZoom,a=1/s,l=(-e.halfWindowPanAtZoom(t)-i.descensionFactor*Math.LN2*e.compared.pan+e.halfWindowPanAtZoom(e.compared.targetZoom))/e.halfWindowPanAtZoom(1);return-e.halfWindowSize*r*o*n*a+e.halfWindowSize*r*o*n*l/(s*s)+e.halfWindowSize*o*n*a*l/t},e.dtPanion=function(e,t,i){return e.compared.pan*e.halfWindowSize*(i.ascensionFactor+i.descensionFactor-1)/(e.desiredPixelFlow*e.halfWindowPanAtZoom(t*t))},e.tAscensionZoomOnly=function(e,t){return-e.halfWindowSize*Math.log(e.compared.sourceZoom/t)/(e.desiredPixelFlow*Math.LN2)},e.tAscensionZoomPan=function(e,t,i){const r=t-e.compared.sourceZoom,o=e.halfWindowPanAtZoom(r);return-e.halfWindowSize*(i.ascensionFactor*Math.LN2*e.compared.pan+o)*Math.log(e.compared.sourceZoom/t)/(e.desiredPixelFlow*Math.LN2*o)},e.tBaseLine=function(e){const t=e.compared.sourceZoom-e.compared.targetZoom;if(0===t)return e.compared.pan*e.halfWindowSize/(e.desiredPixelFlow*e.halfWindowPanAtZoom(e.compared.sourceZoom));const i=Math.LN2*e.compared.pan,r=t,o=e.halfWindowPanAtZoom(r),n=e.halfWindowSize*Math.log(e.compared.sourceZoom/e.compared.targetZoom)/(e.desiredPixelFlow*Math.LN2*o);return e.compared.sourceZoom<=e.compared.targetZoom?n*(i-o):n*(i+o)},e.tDescensionZoomOnly=function(e,t){return e.halfWindowSize*Math.log(t/e.compared.targetZoom)/(e.desiredPixelFlow*Math.LN2)},e.tDescensionZoomPan=function(e,t,i){return e.halfWindowSize*(-e.halfWindowPanAtZoom(t)-i.descensionFactor*Math.LN2*e.compared.pan+e.halfWindowPanAtZoom(e.compared.targetZoom))*Math.log(t/e.compared.targetZoom)/(e.desiredPixelFlow*Math.LN2*e.halfWindowPanAtZoom(-t+e.compared.targetZoom))},e.tPanion=function(e,t,i){return-e.compared.pan*e.halfWindowSize*(i.ascensionFactor+i.descensionFactor-1)/(e.desiredPixelFlow*e.halfWindowPanAtZoom(t))},Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})}))},"esri/views/2d/layerViewModuleImportUtils":function(){define(["require","exports","../../core/Error"],(function(e,t,i){"use strict";const r=e=>Object.freeze(Object.defineProperty({__proto__:null,default:e},Symbol.toStringTag,{value:"Module"}));function o(){return Promise.all([new Promise(((t,i)=>e(["./webglDeps"],t,i))),new Promise(((t,i)=>e(["./mapViewDeps"],t,i)))])}const n=()=>o().then((()=>new Promise(((t,i)=>e(["./layers/TileLayerView2D"],(e=>t(r(e))),i))))),s=()=>o().then((()=>new Promise(((t,i)=>e(["./layers/FeatureLayerView2D"],(e=>t(r(e))),i))))),a={"base-dynamic":()=>o().then((()=>new Promise(((t,i)=>e(["./layers/BaseDynamicLayerView2D"],(e=>t(r(e))),i))))),"base-tile":n,"bing-maps":n,catalog:()=>o().then((()=>new Promise(((t,i)=>e(["./layers/CatalogLayerView2D"],(e=>t(r(e))),i))))),"catalog-dynamic-group":()=>o().then((()=>new Promise(((t,i)=>e(["./layers/CatalogDynamicGroupLayerView2D"],(e=>t(r(e))),i))))),"catalog-footprint":()=>o().then((()=>new Promise(((t,i)=>e(["./layers/CatalogFootprintLayerView2D"],(e=>t(r(e))),i))))),csv:s,"geo-rss":()=>o().then((()=>new Promise(((t,i)=>e(["./layers/GeoRSSLayerView2D"],(e=>t(r(e))),i))))),feature:s,geojson:s,parquet:s,graphics:()=>o().then((()=>new Promise(((t,i)=>e(["./layers/GraphicsLayerView2D"],(e=>t(r(e))),i))))),group:()=>o().then((()=>new Promise(((t,i)=>e(["./layers/GroupLayerView2D"],(e=>t(r(e))),i))))),imagery:()=>o().then((()=>new Promise(((t,i)=>e(["./layers/ImageryLayerView2D"],(e=>t(r(e))),i))))),"imagery-tile":()=>o().then((()=>new Promise(((t,i)=>e(["./layers/ImageryTileLayerView2D"],(e=>t(r(e))),i))))),kml:()=>o().then((()=>new Promise(((t,i)=>e(["./layers/KMLLayerView2D"],(e=>t(r(e))),i))))),"knowledge-graph":()=>o().then((()=>new Promise(((t,i)=>e(["./layers/KnowledgeGraphLayerView2D"],(e=>t(r(e))),i))))),"link-chart":()=>o().then((()=>new Promise(((t,i)=>e(["./layers/KnowledgeGraphLayerView2D"],(e=>t(r(e))),i))))),"knowledge-graph-sublayer":s,"map-image":()=>o().then((()=>new Promise(((t,i)=>e(["./layers/MapImageLayerView2D"],(e=>t(r(e))),i))))),"map-notes":()=>o().then((()=>new Promise(((t,i)=>e(["./layers/MapNotesLayerView2D"],(e=>t(r(e))),i))))),media:()=>o().then((()=>new Promise(((t,i)=>e(["./layers/MediaLayerView2D"],(e=>t(r(e))),i))))),"ogc-feature":()=>o().then((()=>new Promise(((t,i)=>e(["./layers/OGCFeatureLayerView2D"],(e=>t(r(e))),i))))),"open-street-map":n,"oriented-imagery":s,route:()=>o().then((()=>new Promise(((t,i)=>e(["./layers/RouteLayerView2D"],(e=>t(r(e))),i))))),stream:()=>o().then((()=>new Promise(((t,i)=>e(["./layers/StreamLayerView2D"],(e=>t(r(e))),i))))),"subtype-group":()=>o().then((()=>new Promise(((t,i)=>e(["./layers/SubtypeGroupLayerView2D"],(e=>t(r(e))),i))))),tile:n,"vector-tile":()=>o().then((()=>new Promise(((t,i)=>e(["./layers/VectorTileLayerView2D"],(e=>t(r(e))),i))))),video:()=>o().then((()=>new Promise(((t,i)=>e(["./layers/VideoLayerView2D"],(e=>t(r(e))),i))))),wcs:()=>o().then((()=>new Promise(((t,i)=>e(["./layers/ImageryTileLayerView2D"],(e=>t(r(e))),i))))),"web-tile":n,wfs:s,wms:()=>o().then((()=>new Promise(((t,i)=>e(["./layers/WMSLayerView2D"],(e=>t(r(e))),i))))),wmts:()=>o().then((()=>new Promise(((t,i)=>e(["./layers/WMTSLayerView2D"],(e=>t(r(e))),i))))),"line-of-sight":null,"base-elevation":null,"building-scene":null,dimension:null,elevation:null,"integrated-mesh":null,"integrated-mesh-3dtiles":null,"point-cloud":null,viewshed:null,voxel:null,scene:null,unknown:null,unsupported:null},l={hasLayerViewModule:e=>null!=a[e.type],importLayerView:e=>{const t=a[e.type];if(null==t)throw function(e){const t=e.declaredClass?e.declaredClass.slice(e.declaredClass.lastIndexOf(".")+1):"Unknown",r=t.replaceAll(/([a-z])([A-Z])/g,"$1-$2").toLowerCase();return new i(`${r}:view-not-supported`,`${t} is not supported in 2D`)}(e);return t(e)}};t.layerView2DImporter=l,Object.defineProperty(t,Symbol.toStringTag,{value:"Module"})}))},"esri/views/2d/tiling/TileInfoView":function(){define(["../../../geometry/support/spatialReferenceUtils","./LODInfo","./TileCoverage","./TileKey","./TileSpan"],(function(e,t,i,r,o){"use strict";const n=new r("0/0/0/0");class s{static create(e,t){e[1]>t[1]&&([e,t]=[t,e]);const[i,r]=e,[o,n]=t,a=o-i,l=n-r,c=0!==l?a/l:0,u=(Math.ceil(r)-r)*c,h=(Math.floor(r)-r)*c;return new s(i,Math.floor(r),Math.ceil(n),c,a<0?u:h,a<0?h:u,a<0?o:i,a<0?i:o)}constructor(e,t,i,r,o,n,s,a){this.x=e,this.ymin=t,this.ymax=i,this.invM=r,this.leftAdjust=o,this.rightAdjust=n,this.leftBound=s,this.rightBound=a}incrRow(){this.x+=this.invM}getLeftCol(){return Math.max(this.x+this.leftAdjust,this.leftBound)}getRightCol(){return Math.min(this.x+this.rightAdjust,this.rightBound)}}const a=[[0,0],[0,0],[0,0],[0,0]];return class{constructor(e,i=null,r=e.lods[0].level,o=e.lods[e.lods.length-1].level){this.tileInfo=e,this.fullExtent=i,this.scales=[],this._infoByScale={},this._infoByLevel={};const n=e.lods.filter((e=>e.level>=r&&e.level<=o));this.minScale=n[0].scale,this.maxScale=n[n.length-1].scale;const s=this._lodInfos=n.map((r=>t.create(e,r,i)));n.forEach(((e,t)=>{this._infoByLevel[e.level]=s[t],this._infoByScale[e.scale]=s[t],this.scales[t]=e.scale}),this),this._wrap=e.isWrappable}get spatialReference(){return this.tileInfo.spatialReference}getLODInfoAt(e){return this._infoByLevel["number"==typeof e?e:e.level]}getTileBounds(e,t,i=!1){n.set(t);const r=this._infoByLevel[n.level];return r?r.getTileBounds(e,n,i):e}getTileCoords(e,t,i=!1){n.set(t);const r=this._infoByLevel[n.level];return r?r.getTileCoords(e,n,i):e}getTileCoverage(e,t=192,r=!0,n="closest"){if(!r&&(e.scale>this.minScale||e.scale<this.maxScale))return null;const l="closest"===n?this.getClosestInfoForScale(e.scale):this.getSmallestInfoForScale(e.scale),c=i.pool.acquire(l),u=this._wrap;let h,d,p,m=1/0,g=-1/0;const _=c.spans;a[0][0]=a[0][1]=a[1][1]=a[3][0]=-t,a[1][0]=a[2][0]=e.size[0]+t,a[2][1]=a[3][1]=e.size[1]+t;for(const t of a)e.toMap(t,t),t[0]=l.getColumnForX(t[0]),t[1]=l.getRowForY(t[1]);const f=[];let y=3;for(let e=0;e<4;e++){if(a[e][1]===a[y][1]){y=e;continue}const t=s.create(a[e],a[y]);m=Math.min(t.ymin,m),g=Math.max(t.ymax,g),void 0===f[t.ymin]&&(f[t.ymin]=[]),f[t.ymin].push(t),y=e}if(null==m||null==g||g-m>100)return null;let w=[];for(h=m;h<g;){null!=f[h]&&(w=w.concat(f[h])),d=1/0,p=-1/0;for(let e=w.length-1;e>=0;e--){const t=w[e];d=Math.min(d,t.getLeftCol()),p=Math.max(p,t.getRightCol())}if(d=Math.floor(d),p=Math.floor(p),h>=l.first[1]&&h<=l.last[1])if(u)if(l.size[0]<l.worldSize[0]){const e=Math.floor(p/l.worldSize[0]);for(let t=Math.floor(d/l.worldSize[0]);t<=e;t++)_.push(new o(h,Math.max(l.getFirstColumnForWorld(t),d),Math.min(l.getLastColumnForWorld(t),p)))}else _.push(new o(h,d,p));else d>l.last[0]||p<l.first[0]||(d=Math.max(d,l.first[0]),p=Math.min(p,l.last[0]),_.push(new o(h,d,p)));h+=1;for(let e=w.length-1;e>=0;e--){const t=w[e];t.ymax>=h?t.incrRow():w.splice(e,1)}}return c}getTileParentId(e){n.set(e);const t=this._infoByLevel[n.level],i=this._lodInfos.indexOf(t)-1;return i<0?null:(this._getTileIdAtLOD(n,this._lodInfos[i],n),n.id)}getTileResolution(e){const t=this._infoByLevel["object"==typeof e?e.level:e];return t?t.resolution:-1}getTileScale(e){const t=this._infoByLevel[e.level];return t?t.scale:-1}intersects(e,t){n.set(t);const i=this._infoByLevel[n.level],r=e.lodInfo;if(r.resolution>i.resolution){this._getTileIdAtLOD(n,r,n);const t=r.denormalizeCol(n.col,n.world);for(const i of e.spans)if(i.row===n.row&&i.colFrom<=t&&i.colTo>=t)return!0}if(r.resolution<i.resolution){const[t,o,s,a]=e.spans.reduce(((e,t)=>(e[0]=Math.min(e[0],t.row),e[1]=Math.max(e[1],t.row),e[2]=Math.min(e[2],t.colFrom),e[3]=Math.max(e[3],t.colTo),e)),[1/0,-1/0,1/0,-1/0]),l=i.denormalizeCol(n.col,n.world),c=r.getColumnForX(i.getXForColumn(l)),u=r.getRowForY(i.getYForRow(n.row)),h=r.getColumnForX(i.getXForColumn(l+1))-1,d=r.getRowForY(i.getYForRow(n.row+1))-1;return!(c>a||h<s||u>o||d<t)}const o=r.denormalizeCol(n.col,n.world);return e.spans.some((e=>e.row===n.row&&e.colFrom<=o&&e.colTo>=o))}normalizeBounds(t,i,r){if(t[0]=i[0],t[1]=i[1],t[2]=i[2],t[3]=i[3],this._wrap){const i=e.getInfo(this.tileInfo.spatialReference),o=-r*(i.valid[1]-i.valid[0]);t[0]+=o,t[2]+=o}return t}getSmallestInfoForScale(e){const t=this.scales;if(this._infoByScale[e])return this._infoByScale[e];if(e>t[0])return this._infoByScale[t[0]];for(let i=1;i<t.length-1;i++)if(e>t[i]+1e-6)return this._infoByScale[t[i-1]];return this._infoByScale[t[t.length-1]]}getClosestInfoForScale(e){const t=this.scales;return this._infoByScale[e]||(e=t.reduce(((t,i)=>Math.abs(i-e)<Math.abs(t-e)?i:t),t[0])),this._infoByScale[e]}scaleToLevel(e){const t=this.scales;if(this._infoByScale[e])return this._infoByScale[e].level;for(let i=t.length-1;i>=0;i--)if(e<t[i])return i===t.length-1?this._infoByScale[t[t.length-1]].level:this._infoByScale[t[i]].level+(t[i]-e)/(t[i]-t[i+1]);return this._infoByScale[t[0]].level}scaleToZoom(e){return this.tileInfo.scaleToZoom(e)}zoomToScale(e){return this.tileInfo.zoomToScale(e)}_getTileIdAtLOD(e,t,i){const r=this._infoByLevel[i.level];return e.set(i),t.resolution<r.resolution?null:(t.resolution===r.resolution||(e.level=t.level,e.col=Math.floor(i.col*r.resolution/t.resolution+.01),e.row=Math.floor(i.row*r.resolution/t.resolution+.01)),e)}}}))},"esri/views/2d/tiling/LODInfo":function(){define(["../../../geometry/support/spatialReferenceUtils","./TileKey"],(function(e,t){"use strict";function i(e,t){return[e,t]}function r(e,t,i){return e[0]=t,e[1]=i,e}const o=new t("0/0/0/0");class n{static create(t,o,s=null){const a=e.getInfo(t.spatialReference),l=o.origin||i(t.origin.x,t.origin.y),c=i(t.size[0]*o.resolution,t.size[1]*o.resolution),u=i(-1/0,-1/0),h=i(1/0,1/0),d=i(1/0,1/0);null!=s&&(r(u,Math.max(0,Math.floor((s.xmin-l[0])/c[0])),Math.max(0,Math.floor((l[1]-s.ymax)/c[1]))),r(h,Math.max(0,Math.floor((s.xmax-l[0])/c[0])),Math.max(0,Math.floor((l[1]-s.ymin)/c[1]))),r(d,h[0]-u[0]+1,h[1]-u[1]+1));const{cols:p,rows:m}=o;let g,_,f,y;return!s&&p&&m&&(r(u,p[0],m[0]),r(h,p[1],m[1]),r(d,p[1]-p[0]+1,m[1]-m[0]+1)),t.isWrappable?(g=i(Math.ceil(Math.round((a.valid[1]-a.valid[0])/o.resolution)/t.size[0]),d[1]),_=!0,f=a.origin,y=a.valid):(g=d,_=!1),new n(o.level,o.resolution,o.scale,l,u,h,d,c,g,_,f,y)}constructor(e,t,i,r,o,n,s,a,l,c,u,h){this.level=e,this.resolution=t,this.scale=i,this.origin=r,this.first=o,this.last=n,this.size=s,this.norm=a,this.worldSize=l,this.wrap=c,this._spatialReferenceOrigin=u,this._spatialReferenceValid=h}normalizeCol(e){if(!this.wrap)return e;const t=this.worldSize[0];return e<0?t-1-Math.abs((e+1)%t):e%t}normalizeKey(e){if(!this.wrap)return;const t=this.worldSize[0],i=e.col;i<0?(e.col=i+t,e.world-=1):i>=t&&(e.col=i-t,e.world+=1)}denormalizeCol(e,t){return this.wrap?this.worldSize[0]*t+e:e}getWorldForColumn(e){return this.wrap?Math.floor(e/this.worldSize[0]):0}getFirstColumnForWorld(e){return e*this.worldSize[0]+this.first[0]}getLastColumnForWorld(e){return e*this.worldSize[0]+this.first[0]+this.size[0]-1}getColumnForX(e){return(e-this.origin[0])/this.norm[0]}getXForColumn(e){const t=this.origin[0]+e*this.norm[0],i=this._spatialReferenceOrigin,r=this._spatialReferenceValid;return this.wrap&&i&&r?t===i[0]?r[0]:this.origin[0]===i[0]&&e===this.worldSize[0]?r[1]:t:t}getRowForY(e){return(this.origin[1]-e)/this.norm[1]}getYForRow(e){return this.origin[1]-e*this.norm[1]}getTileBounds(e,t,i=!1){o.set(t);const r=i?o.col:this.denormalizeCol(o.col,o.world),n=o.row;return function(e,t,i,r,o){e[0]=t,e[1]=i,e[2]=r,e[3]=o}(e,this.getXForColumn(r),this.getYForRow(n+1),this.getXForColumn(r+1),this.getYForRow(n)),e}getTileCoords(e,t,i=!1){o.set(t);const n=i?o.col:this.denormalizeCol(o.col,o.world);return Array.isArray(e)?r(e,this.getXForColumn(n),this.getYForRow(o.row)):(e.x=this.getXForColumn(n),e.y=this.getYForRow(o.row)),e}}return n}))},"esri/views/2d/tiling/TileKey":function(){define(["../../../core/ObjectPool"],(function(e){"use strict";class t{static{this.pool=new e(t,null,null,25,50)}static getId(e,t,i,r){return"object"==typeof e?`${e.level}/${e.row}/${e.col}/${e.world}`:`${e}/${t}/${i}/${r}`}constructor(e,t,i,r){this.set(e,t,i,r)}get key(){return this}get id(){return this.toString()}get normalizedId(){return`${this.level}/${this.row}/${this.col}`}set id(e){this.set(e)}get hash(){const e=4095&this.row,t=4095&this.col,i=63&this.level;return(3&this.world)<<30|t<<22|e<<8|i}acquire(e,t,i,r){this.set(e,t,i,r)}contains(e){const t=e.level-this.level;return t>=0&&this.row===e.row>>t&&this.col===e.col>>t&&this.world===e.world}containsChild(e){const t=e.level-this.level;return t>0&&this.row===e.row>>t&&this.col===e.col>>t&&this.world===e.world}equals(e){return this.level===e.level&&this.row===e.row&&this.col===e.col&&this.world===e.world}clone(){return new t(this)}release(){this.level=0,this.row=0,this.col=0,this.world=0}set(e,t,i,r){if(null==e)this.level=0,this.row=0,this.col=0,this.world=0;else if("object"==typeof e)this.level=e.level||0,this.row=e.row||0,this.col=e.col||0,this.world=e.world||0;else if("string"==typeof e){const[t,i,r,o]=e.split("/");this.level=parseFloat(t),this.row=parseFloat(i),this.col=parseFloat(r),this.world=parseFloat(o)}else this.level=+e,this.row=+t,this.col=+i,this.world=+r||0;return this}toString(){return`${this.level}/${this.row}/${this.col}/${this.world}`}getParentKey(){return this.level<=0?null:new t(this.level-1,this.row>>1,this.col>>1,this.world)}getNormalizedNeighbor(e,t,i){const r=this.clone();return r.col+=e,r.row+=t,i.normalizeKey(r),r}getChildKeys(){const e=this.level+1,i=this.row<<1,r=this.col<<1,o=this.world;return[new t(e,i,r,o),new t(e,i,r+1,o),new t(e,i+1,r,o),new t(e,i+1,r+1,o)]}compareRowMajor(e){return this.row<e.row?-1:this.row>e.row?1:this.col<e.col?-1:this.col>e.col?1:0}}return t}))},"esri/views/2d/tiling/TileCoverage":function(){define(["../../../core/ObjectPool","./TileKey"],(function(e,t){"use strict";class i{constructor(){this.spans=[]}static{this.pool=new e(i)}acquire(e){this.lodInfo=e}release(){this.lodInfo=null,this.spans.length=0}*keys(){const e=this.lodInfo;for(const{row:i,colFrom:r,colTo:o}of this.spans)for(let n=r;n<=o;n++){const r=e.getWorldForColumn(n);yield new t(e.level,i,e.normalizeCol(n),r)}}forEach(e,t){const{spans:i,lodInfo:r}=this,{level:o}=r;if(0!==i.length)for(const{row:n,colFrom:s,colTo:a}of i)for(let i=s;i<=a;i++)e.call(t,o,n,r.normalizeCol(i),r.getWorldForColumn(i))}}return i}))},"esri/views/2d/tiling/TileSpan":function(){define((function(){"use strict";return class{constructor(e,t,i){this.row=e,this.colFrom=t,this.colTo=i}}}))},"esri/views/2d/tiling/TileQueue":function(){define(["../../../chunks/tslib.es6","../../../core/Accessor","../../../core/MapUtils","../../../core/maybe","../../../core/SetUtils","../../../core/accessorSupport/decorators/property","../../../core/has","../../../core/Logger","../../../core/RandomLCG","../../../core/accessorSupport/decorators/subclass","../../../core/libs/gl-matrix-2/math/vec2","../../support/ScheduledQueueProcessor"],(function(e,t,i,r,o,n,s,a,l,c,u,h){"use strict";const d=[0,0];let p=class extends t{constructor(e){super(e),this._keyToItem=new Map,this._tilesByScale=new Map,this.concurrency=6}initialize(){const{concurrency:e,process:t,scheduler:i,priority:r}=this;this._queue=new h.ScheduledQueueProcessor({concurrency:e,scheduler:i,priority:r,process:(e,i)=>{const r=this._keyToItem.get(e);return t(r,{signal:i})},peeker:e=>this._peek(e)})}destroy(){this.clear(),this._queue=r.destroyMaybe(this._queue)}get length(){return this._queue?this._queue.length:0}abort(e){const t="string"==typeof e?e:e.id;this._queue.abort(t)}clear(){this._queue.clear(),this._keyToItem.clear(),this._tilesByScale.clear()}has(e){return"string"==typeof e?this._keyToItem.has(e):this._keyToItem.has(e.id)}pause(){this._queue.pause()}push(e){const t=e.key.id;if(this._queue.has(t))return this._queue.get(t);const r=this._queue.push(t),o=this.tileInfoView.getTileScale(e.key),n=i.getOrCreateMapValue(this._tilesByScale,o,(()=>new Set)),s=()=>{n.delete(e.key),0===n.size&&this._tilesByScale.delete(o),this._keyToItem.delete(t)};return n.add(e.key),this._keyToItem.set(t,e),r.then(s,s),r}reset(){this._queue.reset()}resume(){this._queue.resume()}_peek(e){if(!this.state)return e.values().next().value;const t=new Set;for(const i of e)t.add(this._keyToItem.get(i).key);const i=this.state.scale;let r,n=Number.POSITIVE_INFINITY;for(const[e,s]of this._tilesByScale)if(o.someSet(s,(e=>t.has(e)))){const t=Math.abs(e-i);t<n&&(r=s,n=t)}return this._getClosestTileKey(r,e).id}_getClosestTileKey(e,t){const i=this.tileInfoView,r=this.state.center;let o,n=Number.POSITIVE_INFINITY;for(const s of e)if(t.has(s.id)){i.getTileCoords(d,s);const e=u.distance(d,r);e<n&&(n=e,o=s)}return o}};return e.__decorate([n.property({constructOnly:!0})],p.prototype,"concurrency",void 0),e.__decorate([n.property({constructOnly:!0})],p.prototype,"priority",void 0),e.__decorate([n.property({constructOnly:!0})],p.prototype,"process",void 0),e.__decorate([n.property({constructOnly:!0})],p.prototype,"scheduler",void 0),e.__decorate([n.property()],p.prototype,"state",void 0),e.__decorate([n.property({constructOnly:!0})],p.prototype,"tileInfoView",void 0),p=e.__decorate([c.subclass("esri.views.2d.tiling.TileQueue")],p),p}))},"esri/views/support/ScheduledQueueProcessor":function(){define(["exports","../../core/has","../../core/maybe","../../core/promiseUtils","../../core/Queue","../../core/ReactiveMap","../../core/scheduling","../../core/signal"],(function(e,t,i,r,o,n,s,a){"use strict";class l{constructor(e,t){this.item=e,this.controller=t,this.promise=null}}e.ScheduledQueueProcessor=class{constructor(e){this._schedule=null,this._task=null,this._deferreds=new n,this._controllers=new n,this._processingItems=new n,this._pausedSignal=a.signal(!1),this.concurrency=1,e.concurrency&&(this.concurrency=e.concurrency),this._queue=new o(e.peeker),this.process=e.process;const t=e.scheduler;e.priority&&t&&(this._task=t.registerTask(e.priority,this))}destroy(){this.clear(),this._schedule=i.removeMaybe(this._schedule),this._task=i.removeMaybe(this._task)}get updating(){return!!this._task?.updating||this.running}get length(){return this._processingItems.size+this._queue.length}abort(e){const t=this._controllers.get(e);t&&t.abort()}clear(){this._queue.clear();const e=[];this._controllers.forEach((t=>e.push(t))),this._controllers.clear(),e.forEach((e=>e.abort())),this._processingItems.clear(),this._cancelNext()}forEach(e){this._deferreds.forEach(((t,i)=>e(i)))}get(e){const t=this._deferreds.get(e);return t?t.promise:void 0}isOngoing(e){return this._processingItems.has(e)}has(e){return this._deferreds.has(e)}pause(){this._pausedSignal.value||(this._pausedSignal.value=!0,this._cancelNext())}push(e,t){const i=this.get(e);if(i)return i;const o=new AbortController;let n=null;t&&(n=r.onAbort(t,(()=>o.abort())));const s=()=>{a.remove(),null!=n&&n.remove(),this._removeItem(e),this._queue.remove(e),this._scheduleNext()},a=r.onAbortOrThrow(o.signal,(()=>{const t=this._processingItems.get(e);t&&t.controller.abort(),s(),l.reject(r.createAbortError())})),l=r.createResolver();return this._deferreds.set(e,l),this._controllers.set(e,o),l.promise.then(s,s),this._queue.push(e),this._scheduleNext(),l.promise}last(){return this._queue.last()}lastPromise(){const e=this.last();return e?this.get(e):null}peek(){return this._queue.peek()}popLast(){const e=this._queue.popLast();return e&&(this._deferreds.get(e)?.reject(r.createAbortError()),this._removeItem(e)),e}reset(){const e=Array.from(this._processingItems.values());this._processingItems.clear();for(const t of e)this._queue.push(t.item),t.controller.abort();this._scheduleNext()}resume(){this._pausedSignal.value&&(this._pausedSignal.value=!1,this._scheduleNext())}takeAll(){const e=[];for(;this._queue.length;)e.push(this._queue.pop());return this.clear(),e}get running(){return!this._pausedSignal.value&&this._queue.length>0&&this._processingItems.size<this.concurrency}runTask(e){for(;!e.done&&this._queue.length>0&&this._processingItems.size<this.concurrency;)this._process(this._queue.pop()),e.madeProgress()}_removeItem(e){this._deferreds.delete(e),this._controllers.delete(e),this._processingItems.delete(e)}_scheduleNext(){this._task||this._pausedSignal.value||this._schedule||(this._schedule=s.schedule((()=>{this._schedule=null,this._next()})))}_next(){for(;this._queue.length>0&&this._processingItems.size<this.concurrency;)this._process(this._queue.pop())}_cancelNext(){this._schedule&&(this._schedule.remove(),this._schedule=null)}_processResult(e,t){this._canProcessFulfillment(e)&&(this._scheduleNext(),this._deferreds.get(e.item).resolve(t))}_processError(e,t){this._canProcessFulfillment(e)&&(this._scheduleNext(),this._deferreds.get(e.item).reject(t))}_canProcessFulfillment(e){return!!this._deferreds.get(e.item)&&this._processingItems.get(e.item)===e}_process(e){if(null==e)return;let t;const i=new AbortController,o=new l(e,i);this._processingItems.set(e,o);try{t=this.process(e,i.signal)}catch(e){this._processError(o,e)}r.isPromiseLike(t)?(o.promise=t,t.then((e=>this._processResult(o,e)),(e=>this._processError(o,e)))):this._processResult(o,t)}get test(){}},Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})}))},"esri/views/2d/tiling/TileStrategy":function(){define(["../../../geometry/support/aaBoundingRect","./TileCache","./TileCoverage","./TileKey"],(function(e,t,i,r){"use strict";const o=new r(0,0,0,0),n=new Map,s=[],a=[];return class{constructor(e){this._previousScale=Number.POSITIVE_INFINITY,this.cachePolicy="keep",this.coveragePolicy="closest",this.resampling=!0,this.tileIndex=new Map,this.tiles=[],this.buffer=192,this.acquireTile=e.acquireTile,this.releaseTile=e.releaseTile,this.tileInfoView=e.tileInfoView,null!=e.resampling&&(this.resampling=e.resampling),e.cachePolicy&&(this.cachePolicy=e.cachePolicy),e.coveragePolicy&&(this.coveragePolicy=e.coveragePolicy),null!=e.buffer&&(this.buffer=e.buffer),e.cacheSize&&(this._tileCache=new t(e.cacheSize,this.tileInfoView,(e=>{this.releaseTile(e)})))}destroy(){this.tileIndex.clear()}update(e){const{resampling:t,tileIndex:r}=this,{scale:l,center:c,resolution:u}=e.state,{minScale:h,maxScale:d}=this.tileInfoView,p=!e.stationary&&l>this._previousScale;if(this._previousScale=l,!t&&(l>h||l<d))return this.tiles.length=0,void this.clear();const m=this.tileInfoView.getTileCoverage(e.state,this.buffer,this.resampling,this.coveragePolicy);if(!m)return this.tiles.length=0,void this.clear();const{spans:g,lodInfo:_}=m,{level:f}=_;this.tiles.length=0,r.forEach((e=>e.visible=!0));let y=0,w=0;if(g.length>0)for(const{row:e,colFrom:t,colTo:i}of g)for(let s=t;s<=i;s++){y++;const t=o.set(f,e,_.normalizeCol(s),_.getWorldForColumn(s)).id;let i=r.get(t);if(i)i.isReady?(n.set(t,i),w++):p||this._addParentTile(t,n);else{if(this._tileCache?.has(t)){if(i=this._tileCache.pop(t),this.tileIndex.set(t,i),i.isReady){n.set(t,i),w++;continue}}else i=this.acquireTile(o),this.tileIndex.set(t,i);p||this._addParentTile(t,n)}}const v=w===y;for(const[e,t]of r){if(n.has(e))continue;o.set(e);const i=this.tileInfoView.intersects(m,o),r="purge"===this.cachePolicy?o.level!==f:o.level>f;!i||!p&&v?!r&&i||s.push(t):t.isReady?r&&"purge"===this.cachePolicy&&this._hasReadyAncestor(o,f)?s.push(t):a.push(t):r&&s.push(t)}for(const e of a)e.isReady&&n.set(e.key.id,e);for(const e of s)this._tileCache?this._tileCache.add(e):this.releaseTile(e),r.delete(e.key.id);for(const e of n.values())this.tiles.push(e);for(const e of r.values())n.has(e.key.id)||(e.visible=!1);this._tileCache?.prune(f,c,u),i.pool.release(m),a.length=0,s.length=0,n.clear()}clear(){const{tileIndex:e}=this;for(const t of e.values())this.releaseTile(t);e.clear()}refresh(e){for(const t of this.tileIndex.values())e(t);this._tileCache?.clear()}updateCacheSize(e){this._tileCache&&(this._tileCache.maxSize=e)}_addParentTile(e,t){let i=e,r=null;for(;i=this.tileInfoView.getTileParentId(i),i;)if(this.tileIndex.has(i)){if(r=this.tileIndex.get(i),r?.isReady){t.has(r.key.id)||t.set(r.key.id,r);break}}else if(this._tileCache?.has(i)&&(r=this._tileCache.pop(i),this.tileIndex.set(i,r),r?.isReady)){t.has(r.key.id)||t.set(r.key.id,r);break}}_hasReadyAncestor(t,i){const r=e.create();this.tileInfoView.getTileBounds(r,t,!0);for(const o of this.tileIndex.values())if(o.isReady&&o.key.level>=i&&o.key.level<t.level){const t=e.create();if(this.tileInfoView.getTileBounds(t,o.key,!0),e.contains(t,r))return!0}return!1}}}))},"esri/views/2d/tiling/TileCache":function(){define(["../../../core/libs/gl-matrix-2/math/vec2"],(function(e){"use strict";function t(e,t){e.delete(t)}return class{constructor(e,t,i){this.maxSize=e,this._tileInfoView=t,this._removedFunc=i,this._tilePerId=new Map,this._tileKeysPerLevel=[]}clear(){this._tilePerId.clear(),this._tileKeysPerLevel=[]}has(e){return this._tilePerId.has(e)}get(e){return this._tilePerId.get(e)}pop(e){const i=this._tilePerId.get(e);if(!i)return;const r=i.key.level,o=this._tileKeysPerLevel[r];t(this._tilePerId,e);for(let t=0;t<o.length;t++)if(o[t].id===e){o.splice(t,1);break}return i.visible=!0,i}add(e){e.visible=!1;const t=e.key,i=t.id;if(this._tilePerId.has(i))return;this._tilePerId.set(i,e);const r=t.level;this._tileKeysPerLevel[r]||(this._tileKeysPerLevel[r]=[]),this._tileKeysPerLevel[r].push(t)}prune(e,t,i){let r=this._tilePerId.size;if(r<=this.maxSize)return;let o=this._tileKeysPerLevel.length-1;for(;r>this.maxSize&&o>=0;)o!==e&&(r=this._pruneAroundCenterTile(r,t,i,o)),o--;r>this.maxSize&&(r=this._pruneAroundCenterTile(r,t,i,e))}_pruneAroundCenterTile(t,i,r,o){const n=this._tileKeysPerLevel[o];if(!n||0===n.length)return t;const{size:s,origin:a}=this._tileInfoView.tileInfo,l=r*s[0],c=r*s[1],u=[0,0],h=[0,0];for(n.sort(((t,r)=>(u[0]=a.x+l*(t.col+.5),u[1]=a.y-c*(t.row+.5),h[0]=a.x+l*(r.col+.5),h[1]=a.y-c*(r.row+.5),e.squaredDistance(u,i)-e.squaredDistance(h,i))));n.length>0;){const e=n.pop();if(this._removeTile(e.id),--t===this.maxSize)break}return t}_removeTile(e){const i=this._tilePerId.get(e);this._removedFunc&&i&&this._removedFunc(i),t(this._tilePerId,e)}}}))},"esri/views/2d/engine/ManagedCanvas":function(){define(["exports","../../../core/Evented","../../../core/events","../../../core/handleUtils","../../../core/has","../../../core/mathUtils","../../../core/libs/gl-matrix-2/math/mat2d","../../../core/libs/gl-matrix-2/factories/mat2df64"],(function(e,t,i,r,o,n,s,a){"use strict";e.ManagedCanvas=class{constructor(e,o={}){this.events=new t,this._hasMajorPerformanceCaveat=!1,this._lastRenderFrameCounter=0,null!=e?(this._canvas=document.createElement("canvas"),this._canvas.setAttribute("style","width: 100%; height:100%; display:block; willChange:transform"),e.contains(this._canvas)||e.appendChild(this._canvas)):null!=o.canvas&&(this._canvas=o.canvas);const n={failIfMajorPerformanceCaveat:!0,alpha:!0,antialias:!1,depth:!0,stencil:!0,powerPreference:"high-performance"};let s=this._canvas.getContext("webgl2",n);s||(s=this._canvas.getContext("webgl2",{...n,failIfMajorPerformanceCaveat:!1}),this._hasMajorPerformanceCaveat=!0),this._gl=s,this._handles=r.handlesGroup([i.on(this._canvas,"webglcontextlost",(e=>this.events.emit("webgl-context-lost",e)))])}destroy(){this._canvas.remove(),this._canvas=null,this._handles.remove(),this._gl=null}get gl(){return this._gl}get canvas(){return this._canvas}render(e,t){if(this._hasMajorPerformanceCaveat||o("esri-force-performance-mode")){if(++this._lastRenderFrameCounter>=o("esri-performance-mode-frames-between-render")&&(t(),this._lastRenderViewState=e.state.clone(),this._lastRenderFrameCounter=0),this._lastRenderViewState){const[t,i,r,o,n,s]=this._computeViewTransform(this._lastRenderViewState,e.state);this._canvas.style.transform=`matrix(${t}, ${i}, ${r}, ${o}, ${n}, ${s})`}}else t()}resize(e){const t=this._canvas,i=t.style,{state:{size:r},pixelRatio:o}=e,n=r[0],s=r[1],a=Math.round(n*o),l=Math.round(s*o);t.width===a&&t.height===l||(t.width=a,t.height=l),i.width=n+"px",i.height=s+"px"}_computeViewTransform(e,t){const[i,r]=e.center,[o,l]=t.center,[c,u]=e.toScreen([0,0],o,l),[h,d]=e.toScreen([0,0],i,r),p=h-c,m=d-u,g=e.scale/t.scale,_=t.rotation-e.rotation,f=a.create();return s.identity(f),s.scale(f,f,[g,g]),s.rotate(f,f,n.deg2rad(_)),s.translate(f,f,[p,m]),f}},Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})}))},"esri/views/2d/layers/features/support/TileStore":function(){define(["../../../../../core/Evented","../../../../../core/has","../../../../../chunks/rbush","../../../../../geometry/support/aaBoundingRect","../../../../../geometry/support/spatialReferenceUtils","./Tile","../../../tiling/TileCoverage","../../../tiling/TileKey"],(function(e,t,i,r,o,n,s,a){"use strict";const l={added:[],removed:[]},c=new Set,u=new a(0,0,0,0);return class extends e{constructor(e){super(),this._tiles=new Map,this._index=i.rbush(9,t("esri-csp-restrictions")?e=>({minX:e.bounds[0],minY:e.bounds[1],maxX:e.bounds[2],maxY:e.bounds[3]}):[".bounds[0]",".bounds[1]",".bounds[2]",".bounds[3]"]),this.tiles=[],this.tileScheme=e}destroy(){this.clear()}clear(){this.tiles.length=0,this._tiles.clear(),this._index.clear()}has(e){return this._tiles.has(e)}get(e){return this._tiles.get(e)}getIntersectingTiles(e){if(!e||0===r.width(e)||0===r.height(e))return[];const t=function(e,t){const i=o.getInfo(t);if(!i)return null;const[n,s]=i.valid;return e[2]>s?[r.create([e[0],e[1],s,e[3]]),r.create([n,e[1],n+e[2]-s,e[3]])]:e[0]<n?[r.create([n,e[1],e[2],e[3]]),r.create([s-(n-e[0]),e[1],s,e[3]])]:null}(e,this.tileScheme.spatialReference);return null!=t?[...new Set([...this.boundsIntersections(t[0]),...this.boundsIntersections(t[1])])]:this.boundsIntersections(e)}boundsIntersections(e){return this._index.search({minX:e[0],minY:e[1],maxX:e[2],maxY:e[3]})}updateTiles(e){const t={added:[],removed:[]};for(const i of e.added)if(!this.has(i)){const e=new n.Tile(this.tileScheme,i);this._tiles.set(i,e),this._index.insert(e),t.added.push(e)}for(const i of e.removed)if(this.has(i)){const e=this.get(i);this._tiles.delete(i),this._index.remove(e),t.removed.push(e)}this.tiles.length=0,this._tiles.forEach((e=>this.tiles.push(e))),(t.added.length||t.removed.length)&&this.emit("update",t)}setViewState(e){const t=this.tileScheme.getTileCoverage(e,0);if(!t)return;const{spans:i,lodInfo:r}=t,{level:o}=r;if(i.length>0)for(const{row:e,colFrom:t,colTo:s}of i)for(let i=t;i<=s;i++){const t=u.set(o,e,r.normalizeCol(i),r.getWorldForColumn(i)).id;if(c.add(t),!this.has(t)){const e=new n.Tile(this.tileScheme,t);this._tiles.set(t,e),this._index.insert(e),this.tiles.push(e),l.added.push(e)}}for(let e=this.tiles.length-1;e>=0;e--){const t=this.tiles[e];c.has(t.id)||(this._tiles.delete(t.id),this.tiles.splice(e,1),this._index.remove(t),l.removed.push(t))}(l.added.length||l.removed.length)&&this.emit("update",l),s.pool.release(t),c.clear(),l.added.length=0,l.removed.length=0}}}))},"esri/chunks/rbush":function(){define(["exports","./quickselect"],(function(e,t){"use strict";function i(e,t){if(!(this instanceof i))return new i(e,t);this._maxEntries=Math.max(4,e||9),this._minEntries=Math.max(2,Math.ceil(.4*this._maxEntries)),t&&("function"==typeof t?this.toBBox=t:this._initFormat(t)),this.clear()}function r(e,t,i){if(!i)return t.indexOf(e);for(var r=0;r<t.length;r++)if(i(e,t[r]))return r;return-1}function o(e,t){n(e,0,e.children.length,t,e)}function n(e,t,i,r,o){o||(o=p(null)),o.minX=1/0,o.minY=1/0,o.maxX=-1/0,o.maxY=-1/0;for(var n,a=t;a<i;a++)n=e.children[a],s(o,e.leaf?r(n):n);return o}function s(e,t){return e.minX=Math.min(e.minX,t.minX),e.minY=Math.min(e.minY,t.minY),e.maxX=Math.max(e.maxX,t.maxX),e.maxY=Math.max(e.maxY,t.maxY),e}function a(e,t){return e.minX-t.minX}function l(e,t){return e.minY-t.minY}function c(e){return(e.maxX-e.minX)*(e.maxY-e.minY)}function u(e){return e.maxX-e.minX+(e.maxY-e.minY)}function h(e,t){return e.minX<=t.minX&&e.minY<=t.minY&&t.maxX<=e.maxX&&t.maxY<=e.maxY}function d(e,t){return t.minX<=e.maxX&&t.minY<=e.maxY&&t.maxX>=e.minX&&t.maxY>=e.minY}function p(e){return{children:e,height:1,leaf:!0,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0}}function m(e,i,r,o,n){for(var s,a=[i,r];a.length;)(r=a.pop())-(i=a.pop())<=o||(s=i+Math.ceil((r-i)/o/2)*o,t.quickselect(e,s,i,r,n),a.push(i,s,s,r))}i.prototype={all:function(){return this._all(this.data,[])},search:function(e){var t=this.data,i=[],r=this.toBBox;if(!d(e,t))return i;for(var o,n,s,a,l=[];t;){for(o=0,n=t.children.length;o<n;o++)s=t.children[o],d(e,a=t.leaf?r(s):s)&&(t.leaf?i.push(s):h(e,a)?this._all(s,i):l.push(s));t=l.pop()}return i},collides:function(e){var t=this.data,i=this.toBBox;if(!d(e,t))return!1;for(var r,o,n,s,a=[];t;){for(r=0,o=t.children.length;r<o;r++)if(n=t.children[r],d(e,s=t.leaf?i(n):n)){if(t.leaf||h(e,s))return!0;a.push(n)}t=a.pop()}return!1},load:function(e){if(!e||!e.length)return this;if(e.length<this._minEntries){for(var t=0,i=e.length;t<i;t++)this.insert(e[t]);return this}var r=this._build(e.slice(),0,e.length-1,0);if(this.data.children.length)if(this.data.height===r.height)this._splitRoot(this.data,r);else{if(this.data.height<r.height){var o=this.data;this.data=r,r=o}this._insert(r,this.data.height-r.height-1,!0)}else this.data=r;return this},insert:function(e){return null!=e&&this._insert(e,this.data.height-1),this},clear:function(){return this.data=p([]),this},remove:function(e,t){if(null==e)return this;for(var i,o,n,s,a=this.data,l=this.toBBox(e),c=[],u=[];a||c.length;){if(a||(a=c.pop(),o=c[c.length-1],i=u.pop(),s=!0),a.leaf&&-1!==(n=r(e,a.children,t)))return a.children.splice(n,1),c.push(a),this._condense(c),this;s||a.leaf||!h(a,l)?o?(i++,a=o.children[i],s=!1):a=null:(c.push(a),u.push(i),i=0,o=a,a=a.children[0])}return this},toBBox:function(e){return e},compareMinX:a,compareMinY:l,toJSON:function(){return this.data},fromJSON:function(e){return this.data=e,this},_all:function(e,t){for(var i=[];e;)e.leaf?t.push.apply(t,e.children):i.push.apply(i,e.children),e=i.pop();return t},_build:function(e,t,i,r){var n,s=i-t+1,a=this._maxEntries;if(s<=a)return o(n=p(e.slice(t,i+1)),this.toBBox),n;r||(r=Math.ceil(Math.log(s)/Math.log(a)),a=Math.ceil(s/Math.pow(a,r-1))),(n=p([])).leaf=!1,n.height=r;var l,c,u,h,d=Math.ceil(s/a),g=d*Math.ceil(Math.sqrt(a));for(m(e,t,i,g,this.compareMinX),l=t;l<=i;l+=g)for(m(e,l,u=Math.min(l+g-1,i),d,this.compareMinY),c=l;c<=u;c+=d)h=Math.min(c+d-1,u),n.children.push(this._build(e,c,h,r-1));return o(n,this.toBBox),n},_chooseSubtree:function(e,t,i,r){for(var o,n,s,a,l,u,h,d,p,m;r.push(t),!t.leaf&&r.length-1!==i;){for(h=d=1/0,o=0,n=t.children.length;o<n;o++)l=c(s=t.children[o]),p=e,m=s,(u=(Math.max(m.maxX,p.maxX)-Math.min(m.minX,p.minX))*(Math.max(m.maxY,p.maxY)-Math.min(m.minY,p.minY))-l)<d?(d=u,h=l<h?l:h,a=s):u===d&&l<h&&(h=l,a=s);t=a||t.children[0]}return t},_insert:function(e,t,i){var r=this.toBBox,o=i?e:r(e),n=[],a=this._chooseSubtree(o,this.data,t,n);for(a.children.push(e),s(a,o);t>=0&&n[t].children.length>this._maxEntries;)this._split(n,t),t--;this._adjustParentBBoxes(o,n,t)},_split:function(e,t){var i=e[t],r=i.children.length,n=this._minEntries;this._chooseSplitAxis(i,n,r);var s=this._chooseSplitIndex(i,n,r),a=p(i.children.splice(s,i.children.length-s));a.height=i.height,a.leaf=i.leaf,o(i,this.toBBox),o(a,this.toBBox),t?e[t-1].children.push(a):this._splitRoot(i,a)},_splitRoot:function(e,t){this.data=p([e,t]),this.data.height=e.height+1,this.data.leaf=!1,o(this.data,this.toBBox)},_chooseSplitIndex:function(e,t,i){var r,o,s,a,l,u,h,d,p,m,g,_,f,y;for(u=h=1/0,r=t;r<=i-t;r++)p=o=n(e,0,r,this.toBBox),m=s=n(e,r,i,this.toBBox),g=Math.max(p.minX,m.minX),_=Math.max(p.minY,m.minY),f=Math.min(p.maxX,m.maxX),y=Math.min(p.maxY,m.maxY),a=Math.max(0,f-g)*Math.max(0,y-_),l=c(o)+c(s),a<u?(u=a,d=r,h=l<h?l:h):a===u&&l<h&&(h=l,d=r);return d},_chooseSplitAxis:function(e,t,i){var r=e.leaf?this.compareMinX:a,o=e.leaf?this.compareMinY:l;this._allDistMargin(e,t,i,r)<this._allDistMargin(e,t,i,o)&&e.children.sort(r)},_allDistMargin:function(e,t,i,r){e.children.sort(r);var o,a,l=this.toBBox,c=n(e,0,t,l),h=n(e,i-t,i,l),d=u(c)+u(h);for(o=t;o<i-t;o++)a=e.children[o],s(c,e.leaf?l(a):a),d+=u(c);for(o=i-t-1;o>=t;o--)a=e.children[o],s(h,e.leaf?l(a):a),d+=u(h);return d},_adjustParentBBoxes:function(e,t,i){for(var r=i;r>=0;r--)s(t[r],e)},_condense:function(e){for(var t,i=e.length-1;i>=0;i--)0===e[i].children.length?i>0?(t=e[i-1].children).splice(t.indexOf(e[i]),1):this.clear():o(e[i],this.toBBox)},_initFormat:function(e){var t=["return a"," - b",";"];this.compareMinX=new Function("a","b",t.join(e[0])),this.compareMinY=new Function("a","b",t.join(e[1])),this.toBBox=new Function("a","return {minX: a"+e[0]+", minY: a"+e[1]+", maxX: a"+e[2]+", maxY: a"+e[3]+"};")}},e.rbush=i}))},"esri/chunks/quickselect":function(){define(["exports"],(function(e){"use strict";function t(e,r,o,n,s){for(;n>o;){if(n-o>600){var a=n-o+1,l=r-o+1,c=Math.log(a),u=.5*Math.exp(2*c/3),h=.5*Math.sqrt(c*u*(a-u)/a)*(l-a/2<0?-1:1);t(e,r,Math.max(o,Math.floor(r-l*u/a+h)),Math.min(n,Math.floor(r+(a-l)*u/a+h)),s)}var d=e[r],p=o,m=n;for(i(e,o,r),s(e[n],d)>0&&i(e,o,n);p<m;){for(i(e,p,m),p++,m--;s(e[p],d)<0;)p++;for(;s(e[m],d)>0;)m--}0===s(e[o],d)?i(e,o,m):i(e,++m,n),m<=r&&(o=m+1),r<=m&&(n=m-1)}}function i(e,t,i){var r=e[t];e[t]=e[i],e[i]=r}function r(e,t){return e<t?-1:e>t?1:0}e.quickselect=function(e,i,o,n,s){t(e,i,o||0,n||e.length-1,s||r)}}))},"esri/views/2d/layers/features/support/Tile":function(){define(["exports","../../../../../core/ArrayPool","../../../../../geometry/support/aaBoundingRect","../../../../../rest/support/QuantizationParameters","./arcadeUtils","../../../tiling/TileKey"],(function(e,t,i,r,o,n){"use strict";class s{constructor(e,t){this.key=new n(0,0,0,0),this.bounds=i.create(),this.objectIds=new Set,this.key.set(t);const r=e.getLODInfoAt(this.key);this.tileInfoView=e,this.tileInfoView.getTileBounds(this.bounds,this.key,!0),this.resolution=r.resolution,this.level=r.level,this.scale=r.scale,this.minScale=e.zoomToScale(r.level-1),this.maxScale=e.zoomToScale(r.level+1)}get lod(){return this.tileInfoView.getLODInfoAt(this.key)}get id(){return this.key.id}get extent(){return i.toExtent(this.bounds,this.tileInfoView.tileInfo.spatialReference)}get transform(){return{originPosition:"upperLeft",scale:[this.resolution,this.resolution],translate:[this.bounds[0],this.bounds[3]]}}createArcadeEvaluationOptions(e){return o.createArcadeEvaluationOptions(this.scale,e)}createChildTiles(){const e=this.key.getChildKeys(),i=t.acquire();for(let t=0;t<e.length;t++)i[t]=new s(this.tileInfoView,e[t]);return i}getQuantizationParameters(){return r.fromJSON({mode:"view",originPosition:"upperLeft",tolerance:this.resolution,extent:{xmin:this.bounds[0],ymin:this.bounds[1],xmax:this.bounds[2],ymax:this.bounds[3],spatialReference:this.tileInfoView.tileInfo.spatialReference}})}}e.Tile=s,Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})}))},"esri/views/2d/layers/features/support/arcadeUtils":function(){define(["exports"],(function(e){"use strict";e.createArcadeEvaluationOptions=function(e,{timeZone:t,timeExtent:i}){return{$view:{scale:e,timeZone:t,timeProperties:{currentStart:i?.start,currentEnd:i?.end}}}},Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})}))},"esri/views/2d/layers/support/util":function(){define(["exports","../../../../core/jsonMap","../../engine/webgl/effects/highlight/HighlightGradient","../../engine/webgl/effects/highlight/MultiHighlightGradient","../../engine/webgl/shaderGraph/techniques/featureTechniqueUtils"],(function(e,t,i,r,o){"use strict";const n=new t.JSONMap({esriGeometryPoint:"point",esriGeometryMultipoint:"multipoint",esriGeometryPolyline:"polyline",esriGeometryPolygon:"polygon",esriGeometryMultiPatch:"multipatch",mesh:"mesh"});e.analyzeRings=function(e,t,i){const r=[],o=[];let n=0,s=0;for(const a of e){const e=s;let l=a[0][0],c=a[0][1];r[s++]=l,r[s++]=c;let u=0;for(let e=1;e<a.length;++e){const t=l,i=c;l=a[e][0],c=a[e][1],u+=c*t-l*i,r[s++]=l,r[s++]=c}t(u/2),u>0?(e-n>0&&(i(n,e,r,o),n=e),o.length=0):u<0&&e-n>0?o.push(.5*(e-n)):s=e}s-n>0&&i(n,s,r,o)},e.canUseMajorityInterpolationOnDataSource=function(e){const{bandCount:t,attributeTable:i,colormap:r,pixelType:o}=e.raster.rasterInfo;return 1===t&&(null!=i||null!=r||"u8"===o||"s8"===o)},e.createOrReuseHighlightGradient=function(e,t){return null==t?(e?.destroy(),null):("single"===e?.type&&Array.isArray(t)&&(e.destroy(),e=null),"multi"!==e?.type||Array.isArray(t)||(e.destroy(),e=null),e||(e=Array.isArray(t)?new r.MultiHighlightGradient:new i),Array.isArray(t)?"multi"===e.type&&e.setHighlightOptions(t):"single"===e.type&&e.setHighlightOptions(t),e)},e.renderHighlight=function(e,t,i,r){const{painter:n,highlightGradient:s}=e,{highlight:a}=n.effects;if(!s)return;const l=e.passOptions,c=s.getReasonsWithGradients();for(let s=0;s<c.length;s++){const l={...e,passOptions:{type:"highlight",activeGradient:null!=r?c[r].activeGradient:c[s].activeGradient,activeReasons:c[s].activeReasons,stepType:"burn",highlightAll:t}};if(a.bind(l),i(l),s<c.length-1){let o=0;for(let e=s+1;e<c.length;e++)o|=c[e].activeReasons;i({...e,passOptions:{type:"highlight",activeGradient:null!=r?c[r].activeGradient:c[s].activeGradient,activeReasons:o,stepType:"clear",highlightAll:t}})}const u={...e,passOptions:{type:"highlight",activeGradient:null!=r?c[r].activeGradient:c[s].activeGradient,activeReasons:c[s].activeReasons,stepType:"draw",highlightAll:t}};n.setPipelineState(o.getFeaturePipelineState(e)),n.updatePipelineState(e.context),a.draw(u),a.unbind()}e.passOptions=l},e.toJSONGeometryType=function(e){return n.toJSON(e)},Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})}))},"esri/views/2d/engine/webgl/effects/highlight/HighlightGradient":function(){define(["../../../../../../core/Logger","../../definitions","./parameters","../../../../../support/HighlightOptions","../../../../../webgl/enums","../../../../../webgl/Texture","../../../../../webgl/TextureDescriptor"],(function(e,t,i,r,o,n,s){"use strict";const a=()=>e.getLogger("esri.views.2d.engine.webgl.painter.highlight.HighlightGradient"),l=[0,0,0,0];return class{constructor(){this.type="single",this._highlightOptions=new r,this._convertedHighlightOptions={fillColor:[0,0,0,0],outlineColor:[0,0,0,0],outlinePosition:0,outlineWidth:0,innerHaloWidth:0,outerHaloWidth:0},this._optionsShadeTexKey="",this._texelData=new Uint8Array(4*i.shadeTextureSize),this._minMaxDistance=[0,0]}setHighlightOptions(e){this._highlightOptions=e}applyHighlightOptions(e,i){this._updateGradientTexture(e),e.bindTexture(this._shadeTex,t.textureBindingHighlight1),i.setUniform2fv("u_minMaxDistance",this._minMaxDistance)}destroy(){this._shadeTex?.dispose(),this._shadeTex=null}getReasonsWithGradients(){return[{activeReasons:(1<<t.maxHighlightReasons)-1,activeGradient:this}]}_updateGradientTexture(e){const t=`${(r=this._highlightOptions).color};${r.haloColor};${r.haloOpacity};${r.fillOpacity};${r.haloWidth};${r.haloBlur}`;var r;if(t===this._optionsShadeTexKey)return;this._optionsShadeTexKey=t,function(e,t){t.fillColor[0]=e.color.r/255,t.fillColor[1]=e.color.g/255,t.fillColor[2]=e.color.b/255,t.fillColor[3]=e.color.a,e.haloColor?(t.outlineColor[0]=e.haloColor.r/255,t.outlineColor[1]=e.haloColor.g/255,t.outlineColor[2]=e.haloColor.b/255,t.outlineColor[3]=e.haloColor.a):(t.outlineColor[0]=t.fillColor[0],t.outlineColor[1]=t.fillColor[1],t.outlineColor[2]=t.fillColor[2],t.outlineColor[3]=t.fillColor[3]),t.fillColor[3]*=e.fillOpacity,t.outlineColor[3]*=e.haloOpacity,t.fillColor[0]*=t.fillColor[3],t.fillColor[1]*=t.fillColor[3],t.fillColor[2]*=t.fillColor[3],t.outlineColor[0]*=t.outlineColor[3],t.outlineColor[1]*=t.outlineColor[3],t.outlineColor[2]*=t.outlineColor[3],t.outlineWidth=(1-e.haloBlur)*e.haloWidth,t.outerHaloWidth=e.haloBlur*e.haloWidth/2,t.innerHaloWidth=e.haloBlur*e.haloWidth/2,t.outlinePosition=0}(this._highlightOptions,this._convertedHighlightOptions);const c=this._convertedHighlightOptions,u=c.outlinePosition-c.outlineWidth/2-c.outerHaloWidth,h=c.outlinePosition-c.outlineWidth/2,d=c.outlinePosition+c.outlineWidth/2,p=c.outlinePosition+c.outlineWidth/2+c.innerHaloWidth,m=Math.sqrt(Math.PI/2)*i.sigma,g=Math.abs(u)>m?Math.round(10*(Math.abs(u)-m))/10:0,_=Math.abs(p)>m?Math.round(10*(Math.abs(p)-m))/10:0;let f;g&&!_?a().error("The outer rim of the highlight is "+g+"px away from the edge of the feature; consider reducing some width values or shifting the outline position towards positive values (inwards)."):!g&&_?a().error("The inner rim of the highlight is "+_+"px away from the edge of the feature; consider reducing some width values or shifting the outline position towards negative values (outwards)."):g&&_&&a().error("The highlight is "+Math.max(g,_)+"px away from the edge of the feature; consider reducing some width values.");const y=[void 0,void 0,void 0,void 0];function w(e,t,i){y[0]=(1-i)*e[0]+i*t[0],y[1]=(1-i)*e[1]+i*t[1],y[2]=(1-i)*e[2]+i*t[2],y[3]=(1-i)*e[3]+i*t[3]}const{_texelData:v}=this;for(let e=0;e<i.shadeTextureSize;++e)f=u+e/(i.shadeTextureSize-1)*(p-u),f<u?(y[0]=0,y[1]=0,y[2]=0,y[3]=0):f<h?w(l,c.outlineColor,(f-u)/(h-u)):f<d?[y[0],y[1],y[2],y[3]]=c.outlineColor:f<p?w(c.outlineColor,c.fillColor,(f-d)/(p-d)):[y[0],y[1],y[2],y[3]]=c.fillColor,v[4*e]=255*y[0],v[4*e+1]=255*y[1],v[4*e+2]=255*y[2],v[4*e+3]=255*y[3];if(this._minMaxDistance[0]=u,this._minMaxDistance[1]=p,!this._shadeTex){const t=new s.TextureDescriptor;t.wrapMode=o.TextureWrapMode.CLAMP_TO_EDGE,t.width=i.shadeTextureSize,t.height=1,this._shadeTex=new n.Texture(e,t)}this._shadeTex.updateData(0,0,0,i.shadeTextureSize,1,this._texelData)}}}))},"esri/views/2d/engine/webgl/definitions":function(){define(["exports"],(function(e){"use strict";var t;e.AttributeDataType=void 0,(t=e.AttributeDataType||(e.AttributeDataType={}))[t.FilterFlags=0]="FilterFlags",t[t.Animation=1]="Animation",t[t.GPGPU=2]="GPGPU",t[t.VV=3]="VV",t[t.DD0=4]="DD0",t[t.DD1=5]="DD1",t[t.DD2=6]="DD2",t[t.LocalTimeOrigin=7]="LocalTimeOrigin",e.MAX_TILE_RESHUFFLES_PER_FRAME=1,e.RESHUFFLING_EXEMPT_DRAW_CALLS=10,e.RESHUFFLING_EXEMPT_MEMORY_BYTES=1<<20,e.RESHUFFLING_TARGET_DRAW_EFFICIENCY=.75,e.RESHUFFLING_TARGET_MEMORY_EFFICIENCY=.75,e.angleFactor256=256/360,e.animationUnit=2,e.attributeStoreInitialSize=256,e.attributeStoreTextureSize=1024,e.averageGlyphMosaicItem={metrics:{width:15,height:17,left:0,top:-7,advance:14}},e.backbufferStencilClipped=1,e.backbufferStencilVisible=0,e.bitsetFillHasPatternHeightPrecisionFactor=32,e.bitsetFillHasPatternWidthPrecisionFactor=64,e.bitsetFillHasUnresolvedReplacementColor=8,e.bitsetFillRandomPatternOffset=4,e.bitsetGenericConsiderAlphaOnly=16,e.bitsetGenericLockColor=2,e.bitsetLineScaleDash=4,e.bitsetMarkerAlignmentMap=1,e.bitsetMarkerAlignmentScreen=0,e.bitsetMarkerOutlineAllowColorOverride=4,e.bitsetMarkerScaleSymbolsProportionally=8,e.bitsetTypeFillOutline=1,e.bufferDataMinimumSize=128,e.bufferDataPoolSize=4,e.chartMaxFields=10,e.collisionBoxPadding=16,e.collisionBucketSize=128,e.collisionEarlyRejectBucketSize=16,e.collisionMaxZoomDelta=1,e.collisionPlacementPadding=8,e.collisionTileBoxSize=4,e.compressionFactorForU16=128,e.dataDrivenUnit0=4,e.dataDrivenUnit1=5,e.dataDrivenUnit2=6,e.debugLabels=!1,e.defaultSdfTextureSize=128,e.displayRecordIntPerElement=8,e.dotDensityMaxFields=8,e.effectFlag0=128,e.enableEarlyLabelDiscard=!1,e.extrudeScale=64,e.filterFlag0=64,e.filterFlagsUnit=1,e.glyphSize=24,e.gpgpuUnit=12,e.gradientTextureExternalPadding=1,e.heuristicGlyphsPerFeature=10,e.heuristicGlyphsPerLine=50,e.hittestSmallSymbolThreshold=3,e.hittestToleranceDesktop=1,e.hittestToleranceMobile=3,e.hittestToleranceSmallSymbol=3,e.labelPlacementOffsetPadding=4,e.localTimeOriginUnit=13,e.magicLabelLineHeight=29,e.maxGeohashLevel=12,e.maxGpuUploadsPerFrame=2,e.maxHighlightReasons=6,e.maxRepresentableInt=16777216,e.maxTextLineWidth=512,e.minMaxZoomPrecisionFactor=10,e.minTextLineWidth=32,e.nanMagicNumber=1e-30,e.patchPixelBufferAllocSize=500,e.patternFillRasterizationScale=2,e.pictureFillColor=4294967295,e.randomInsidePolygonTextureSize=1024,e.rasterTileSize=256,e.rasterizedVectorMarkerMinSize=128,e.spritePadding=4,e.svgSdfTextureInnerSize=248,e.svgSdfTextureSize=256,e.textureBindingBitmap=0,e.textureBindingGlyphAtlas=0,e.textureBindingHighlight0=5,e.textureBindingHighlight1=6,e.textureBindingRenderer0=5,e.textureBindingRenderer1=6,e.textureBindingSpriteAtlas=0,e.textureUploadManagerBudget=4,e.textureUploadManagerChunkSize=128,e.thinLineHalfWidthThreshold=1.05,e.tileSize=512,e.visualVariableUnit=3,e.vtlHighResCutoff=1.15,e.vtlTextureBindingUnitGlyphs=6,e.vtlTextureBindingUnitSprites=5,e.webglMaxInnerStops=6,e.webglMaxStops=8,Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})}))},"esri/views/2d/engine/webgl/effects/highlight/parameters":function(){define(["exports"],(function(e){"use strict";e.alphaToRgbaChannelSelectorMatrix=[0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1],e.rgbaToRgbaChannelSelectorMatrix=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],e.shadeTextureSize=256,e.sigma=1,Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})}))},"esri/views/webgl/enums":function(){define(["exports"],(function(e){"use strict";var t,i,r,o,n,s,a,l,c,u,h,d,p,m,g,_,f,y,w,v,T,S,b,E,M,x,P,R,A,I,C,D,O,L,N,F;e.FramebufferBit=void 0,(t=e.FramebufferBit||(e.FramebufferBit={}))[t.DEPTH=256]="DEPTH",t[t.STENCIL=1024]="STENCIL",t[t.COLOR=16384]="COLOR",e.BufferContent=void 0,(i=e.BufferContent||(e.BufferContent={}))[i.COLOR=6144]="COLOR",i[i.DEPTH=6145]="DEPTH",i[i.STENCIL=6146]="STENCIL",i[i.DEPTH_STENCIL=34041]="DEPTH_STENCIL",e.PrimitiveType=void 0,(r=e.PrimitiveType||(e.PrimitiveType={}))[r.POINTS=0]="POINTS",r[r.LINES=1]="LINES",r[r.LINE_LOOP=2]="LINE_LOOP",r[r.LINE_STRIP=3]="LINE_STRIP",r[r.TRIANGLES=4]="TRIANGLES",r[r.TRIANGLE_STRIP=5]="TRIANGLE_STRIP",r[r.TRIANGLE_FAN=6]="TRIANGLE_FAN",e.BlendFactor=void 0,(o=e.BlendFactor||(e.BlendFactor={}))[o.ZERO=0]="ZERO",o[o.ONE=1]="ONE",o[o.SRC_COLOR=768]="SRC_COLOR",o[o.ONE_MINUS_SRC_COLOR=769]="ONE_MINUS_SRC_COLOR",o[o.SRC_ALPHA=770]="SRC_ALPHA",o[o.ONE_MINUS_SRC_ALPHA=771]="ONE_MINUS_SRC_ALPHA",o[o.DST_ALPHA=772]="DST_ALPHA",o[o.ONE_MINUS_DST_ALPHA=773]="ONE_MINUS_DST_ALPHA",o[o.DST_COLOR=774]="DST_COLOR",o[o.ONE_MINUS_DST_COLOR=775]="ONE_MINUS_DST_COLOR",o[o.SRC_ALPHA_SATURATE=776]="SRC_ALPHA_SATURATE",o[o.CONSTANT_COLOR=32769]="CONSTANT_COLOR",o[o.ONE_MINUS_CONSTANT_COLOR=32770]="ONE_MINUS_CONSTANT_COLOR",o[o.CONSTANT_ALPHA=32771]="CONSTANT_ALPHA",o[o.ONE_MINUS_CONSTANT_ALPHA=32772]="ONE_MINUS_CONSTANT_ALPHA",e.BlendOperation=void 0,(n=e.BlendOperation||(e.BlendOperation={}))[n.ADD=32774]="ADD",n[n.MIN=32775]="MIN",n[n.MAX=32776]="MAX",n[n.SUBTRACT=32778]="SUBTRACT",n[n.REVERSE_SUBTRACT=32779]="REVERSE_SUBTRACT",e.BufferType=void 0,(s=e.BufferType||(e.BufferType={}))[s.ARRAY_BUFFER=34962]="ARRAY_BUFFER",s[s.ELEMENT_ARRAY_BUFFER=34963]="ELEMENT_ARRAY_BUFFER",s[s.UNIFORM_BUFFER=35345]="UNIFORM_BUFFER",s[s.PIXEL_PACK_BUFFER=35051]="PIXEL_PACK_BUFFER",s[s.PIXEL_UNPACK_BUFFER=35052]="PIXEL_UNPACK_BUFFER",s[s.COPY_READ_BUFFER=36662]="COPY_READ_BUFFER",s[s.COPY_WRITE_BUFFER=36663]="COPY_WRITE_BUFFER",s[s.TRANSFORM_FEEDBACK_BUFFER=35982]="TRANSFORM_FEEDBACK_BUFFER",e.Face=void 0,(a=e.Face||(e.Face={}))[a.FRONT=1028]="FRONT",a[a.BACK=1029]="BACK",a[a.FRONT_AND_BACK=1032]="FRONT_AND_BACK",e.CullMode=void 0,(l=e.CullMode||(e.CullMode={}))[l.CW=2304]="CW",l[l.CCW=2305]="CCW",e.DataType=void 0,(c=e.DataType||(e.DataType={}))[c.BYTE=5120]="BYTE",c[c.UNSIGNED_BYTE=5121]="UNSIGNED_BYTE",c[c.SHORT=5122]="SHORT",c[c.UNSIGNED_SHORT=5123]="UNSIGNED_SHORT",c[c.INT=5124]="INT",c[c.UNSIGNED_INT=5125]="UNSIGNED_INT",c[c.FLOAT=5126]="FLOAT",c[c.HALF_FLOAT=5131]="HALF_FLOAT",e.CompareFunction=void 0,(u=e.CompareFunction||(e.CompareFunction={}))[u.NEVER=512]="NEVER",u[u.LESS=513]="LESS",u[u.EQUAL=514]="EQUAL",u[u.LEQUAL=515]="LEQUAL",u[u.GREATER=516]="GREATER",u[u.NOTEQUAL=517]="NOTEQUAL",u[u.GEQUAL=518]="GEQUAL",u[u.ALWAYS=519]="ALWAYS",e.StencilOperation=void 0,(h=e.StencilOperation||(e.StencilOperation={}))[h.ZERO=0]="ZERO",h[h.KEEP=7680]="KEEP",h[h.REPLACE=7681]="REPLACE",h[h.INCR=7682]="INCR",h[h.DECR=7683]="DECR",h[h.INVERT=5386]="INVERT",h[h.INCR_WRAP=34055]="INCR_WRAP",h[h.DECR_WRAP=34056]="DECR_WRAP",e.TextureSamplingMode=void 0,(d=e.TextureSamplingMode||(e.TextureSamplingMode={}))[d.NEAREST=9728]="NEAREST",d[d.LINEAR=9729]="LINEAR",d[d.NEAREST_MIPMAP_NEAREST=9984]="NEAREST_MIPMAP_NEAREST",d[d.LINEAR_MIPMAP_NEAREST=9985]="LINEAR_MIPMAP_NEAREST",d[d.NEAREST_MIPMAP_LINEAR=9986]="NEAREST_MIPMAP_LINEAR",d[d.LINEAR_MIPMAP_LINEAR=9987]="LINEAR_MIPMAP_LINEAR",e.TextureWrapMode=void 0,(p=e.TextureWrapMode||(e.TextureWrapMode={}))[p.CLAMP_TO_EDGE=33071]="CLAMP_TO_EDGE",p[p.REPEAT=10497]="REPEAT",p[p.MIRRORED_REPEAT=33648]="MIRRORED_REPEAT",e.TextureType=void 0,(m=e.TextureType||(e.TextureType={}))[m.TEXTURE_2D=3553]="TEXTURE_2D",m[m.TEXTURE_CUBE_MAP=34067]="TEXTURE_CUBE_MAP",m[m.TEXTURE_3D=32879]="TEXTURE_3D",m[m.TEXTURE_CUBE_MAP_POSITIVE_X=34069]="TEXTURE_CUBE_MAP_POSITIVE_X",m[m.TEXTURE_CUBE_MAP_NEGATIVE_X=34070]="TEXTURE_CUBE_MAP_NEGATIVE_X",m[m.TEXTURE_CUBE_MAP_POSITIVE_Y=34071]="TEXTURE_CUBE_MAP_POSITIVE_Y",m[m.TEXTURE_CUBE_MAP_NEGATIVE_Y=34072]="TEXTURE_CUBE_MAP_NEGATIVE_Y",m[m.TEXTURE_CUBE_MAP_POSITIVE_Z=34073]="TEXTURE_CUBE_MAP_POSITIVE_Z",m[m.TEXTURE_CUBE_MAP_NEGATIVE_Z=34074]="TEXTURE_CUBE_MAP_NEGATIVE_Z",m[m.TEXTURE_2D_ARRAY=35866]="TEXTURE_2D_ARRAY",e.TextureConstants=void 0,(g=e.TextureConstants||(e.TextureConstants={}))[g.MIN_LOD=33082]="MIN_LOD",g[g.MAX_LOD=33083]="MAX_LOD",g[g.BASE_LEVEL=33084]="BASE_LEVEL",g[g.MAX_LEVEL=33085]="MAX_LEVEL",g[g.MAX_TEXTURE_SIZE=3379]="MAX_TEXTURE_SIZE",e.PixelFormat=void 0,(_=e.PixelFormat||(e.PixelFormat={}))[_.ALPHA=6406]="ALPHA",_[_.RGB=6407]="RGB",_[_.RGBA=6408]="RGBA",_[_.LUMINANCE=6409]="LUMINANCE",_[_.LUMINANCE_ALPHA=6410]="LUMINANCE_ALPHA",_[_.RED=6403]="RED",_[_.RG=33319]="RG",_[_.RED_INTEGER=36244]="RED_INTEGER",_[_.RG_INTEGER=33320]="RG_INTEGER",_[_.RGB_INTEGER=36248]="RGB_INTEGER",_[_.RGBA_INTEGER=36249]="RGBA_INTEGER",e.SizedPixelFormat=void 0,(f=e.SizedPixelFormat||(e.SizedPixelFormat={}))[f.RGBA4=32854]="RGBA4",f[f.R16F=33325]="R16F",f[f.RG16F=33327]="RG16F",f[f.RGB32F=34837]="RGB32F",f[f.RGBA16F=34842]="RGBA16F",f[f.R32F=33326]="R32F",f[f.RG32F=33328]="RG32F",f[f.RGBA32F=34836]="RGBA32F",f[f.R11F_G11F_B10F=35898]="R11F_G11F_B10F",f[f.RGB8=32849]="RGB8",f[f.RGBA8=32856]="RGBA8",f[f.RGB5_A1=32855]="RGB5_A1",f[f.R8=33321]="R8",f[f.RG8=33323]="RG8",f[f.R8I=33329]="R8I",f[f.R8UI=33330]="R8UI",f[f.R16I=33331]="R16I",f[f.R16UI=33332]="R16UI",f[f.R32I=33333]="R32I",f[f.R32UI=33334]="R32UI",f[f.RG8I=33335]="RG8I",f[f.RG8UI=33336]="RG8UI",f[f.RG16I=33337]="RG16I",f[f.RG16UI=33338]="RG16UI",f[f.RG32I=33339]="RG32I",f[f.RG32UI=33340]="RG32UI",f[f.RGB16F=34843]="RGB16F",f[f.RGB9_E5=35901]="RGB9_E5",f[f.SRGB8=35905]="SRGB8",f[f.SRGB8_ALPHA8=35907]="SRGB8_ALPHA8",f[f.RGB565=36194]="RGB565",f[f.RGBA32UI=36208]="RGBA32UI",f[f.RGB32UI=36209]="RGB32UI",f[f.RGBA16UI=36214]="RGBA16UI",f[f.RGB16UI=36215]="RGB16UI",f[f.RGBA8UI=36220]="RGBA8UI",f[f.RGB8UI=36221]="RGB8UI",f[f.RGBA32I=36226]="RGBA32I",f[f.RGB32I=36227]="RGB32I",f[f.RGBA16I=36232]="RGBA16I",f[f.RGB16I=36233]="RGB16I",f[f.RGBA8I=36238]="RGBA8I",f[f.RGB8I=36239]="RGB8I",f[f.R8_SNORM=36756]="R8_SNORM",f[f.RG8_SNORM=36757]="RG8_SNORM",f[f.RGB8_SNORM=36758]="RGB8_SNORM",f[f.RGBA8_SNORM=36759]="RGBA8_SNORM",f[f.RGB10_A2=32857]="RGB10_A2",f[f.RGB10_A2UI=36975]="RGB10_A2UI",e.UnsizedDepthFormat=void 0,(y=e.UnsizedDepthFormat||(e.UnsizedDepthFormat={}))[y.DEPTH_COMPONENT=6402]="DEPTH_COMPONENT",y[y.DEPTH_STENCIL=34041]="DEPTH_STENCIL",e.SizedDepthStencilFormat=void 0,(w=e.SizedDepthStencilFormat||(e.SizedDepthStencilFormat={}))[w.DEPTH24_STENCIL8=35056]="DEPTH24_STENCIL8",w[w.DEPTH32F_STENCIL8=36013]="DEPTH32F_STENCIL8",e.SizedDepthFormat=void 0,(v=e.SizedDepthFormat||(e.SizedDepthFormat={}))[v.DEPTH_COMPONENT16=33189]="DEPTH_COMPONENT16",v[v.DEPTH_COMPONENT24=33190]="DEPTH_COMPONENT24",v[v.DEPTH_COMPONENT32F=36012]="DEPTH_COMPONENT32F",e.SizedStencilFormat=void 0,(T=e.SizedStencilFormat||(e.SizedStencilFormat={}))[T.STENCIL_INDEX8=36168]="STENCIL_INDEX8",e.PixelType=void 0,(S=e.PixelType||(e.PixelType={}))[S.FLOAT=5126]="FLOAT",S[S.UNSIGNED_BYTE=5121]="UNSIGNED_BYTE",S[S.UNSIGNED_INT_24_8=34042]="UNSIGNED_INT_24_8",S[S.UNSIGNED_SHORT_4_4_4_4=32819]="UNSIGNED_SHORT_4_4_4_4",S[S.UNSIGNED_SHORT_5_5_5_1=32820]="UNSIGNED_SHORT_5_5_5_1",S[S.UNSIGNED_SHORT_5_6_5=33635]="UNSIGNED_SHORT_5_6_5",S[S.BYTE=5120]="BYTE",S[S.UNSIGNED_SHORT=5123]="UNSIGNED_SHORT",S[S.SHORT=5122]="SHORT",S[S.UNSIGNED_INT=5125]="UNSIGNED_INT",S[S.INT=5124]="INT",S[S.HALF_FLOAT=5131]="HALF_FLOAT",S[S.UNSIGNED_INT_2_10_10_10_REV=33640]="UNSIGNED_INT_2_10_10_10_REV",S[S.UNSIGNED_INT_10F_11F_11F_REV=35899]="UNSIGNED_INT_10F_11F_11F_REV",S[S.UNSIGNED_INT_5_9_9_9_REV=35902]="UNSIGNED_INT_5_9_9_9_REV",S[S.FLOAT_32_UNSIGNED_INT_24_8_REV=36269]="FLOAT_32_UNSIGNED_INT_24_8_REV",e.Usage=void 0,(b=e.Usage||(e.Usage={}))[b.STATIC_DRAW=35044]="STATIC_DRAW",b[b.DYNAMIC_DRAW=35048]="DYNAMIC_DRAW",b[b.STREAM_DRAW=35040]="STREAM_DRAW",b[b.STATIC_READ=35045]="STATIC_READ",b[b.DYNAMIC_READ=35049]="DYNAMIC_READ",b[b.STREAM_READ=35041]="STREAM_READ",b[b.STATIC_COPY=35046]="STATIC_COPY",b[b.DYNAMIC_COPY=35050]="DYNAMIC_COPY",b[b.STREAM_COPY=35042]="STREAM_COPY",e.ShaderType=void 0,(E=e.ShaderType||(e.ShaderType={}))[E.FRAGMENT_SHADER=35632]="FRAGMENT_SHADER",E[E.VERTEX_SHADER=35633]="VERTEX_SHADER",e.FramebufferTarget=void 0,(M=e.FramebufferTarget||(e.FramebufferTarget={}))[M.FRAMEBUFFER=36160]="FRAMEBUFFER",M[M.READ_FRAMEBUFFER=36008]="READ_FRAMEBUFFER",M[M.DRAW_FRAMEBUFFER=36009]="DRAW_FRAMEBUFFER",e.ResourceType=void 0,(x=e.ResourceType||(e.ResourceType={}))[x.Texture=0]="Texture",x[x.TileTexture=1]="TileTexture",x[x.BufferObject=2]="BufferObject",x[x.VertexArrayObject=3]="VertexArrayObject",x[x.Shader=4]="Shader",x[x.Program=5]="Program",x[x.FramebufferObject=6]="FramebufferObject",x[x.Renderbuffer=7]="Renderbuffer",x[x.TransformFeedback=8]="TransformFeedback",x[x.Sync=9]="Sync",x[x.UNCOUNTED=10]="UNCOUNTED",x[x.LinesOfCode=10]="LinesOfCode",x[x.Uniform=11]="Uniform",x[x.COUNT=12]="COUNT",e.SpecialDrawBuffers=void 0,(P=e.SpecialDrawBuffers||(e.SpecialDrawBuffers={}))[P.NONE=0]="NONE",P[P.BACK=1029]="BACK",e.CompressedTextureFormat=void 0,(R=e.CompressedTextureFormat||(e.CompressedTextureFormat={}))[R.COMPRESSED_RGB_S3TC_DXT1_EXT=33776]="COMPRESSED_RGB_S3TC_DXT1_EXT",R[R.COMPRESSED_RGBA_S3TC_DXT1_EXT=33777]="COMPRESSED_RGBA_S3TC_DXT1_EXT",R[R.COMPRESSED_RGBA_S3TC_DXT3_EXT=33778]="COMPRESSED_RGBA_S3TC_DXT3_EXT",R[R.COMPRESSED_RGBA_S3TC_DXT5_EXT=33779]="COMPRESSED_RGBA_S3TC_DXT5_EXT",R[R.COMPRESSED_R11_EAC=37488]="COMPRESSED_R11_EAC",R[R.COMPRESSED_SIGNED_R11_EAC=37489]="COMPRESSED_SIGNED_R11_EAC",R[R.COMPRESSED_RG11_EAC=37490]="COMPRESSED_RG11_EAC",R[R.COMPRESSED_SIGNED_RG11_EAC=37491]="COMPRESSED_SIGNED_RG11_EAC",R[R.COMPRESSED_RGB8_ETC2=37492]="COMPRESSED_RGB8_ETC2",R[R.COMPRESSED_SRGB8_ETC2=37493]="COMPRESSED_SRGB8_ETC2",R[R.COMPRESSED_RGB8_PUNCHTHROUGH_ALPHA1_ETC2=37494]="COMPRESSED_RGB8_PUNCHTHROUGH_ALPHA1_ETC2",R[R.COMPRESSED_SRGB8_PUNCHTHROUGH_ALPHA1_ETC2=37495]="COMPRESSED_SRGB8_PUNCHTHROUGH_ALPHA1_ETC2",R[R.COMPRESSED_RGBA8_ETC2_EAC=37496]="COMPRESSED_RGBA8_ETC2_EAC",R[R.COMPRESSED_SRGB8_ALPHA8_ETC2_EAC=37497]="COMPRESSED_SRGB8_ALPHA8_ETC2_EAC",e.UniformType=void 0,(A=e.UniformType||(e.UniformType={}))[A.FLOAT=5126]="FLOAT",A[A.FLOAT_VEC2=35664]="FLOAT_VEC2",A[A.FLOAT_VEC3=35665]="FLOAT_VEC3",A[A.FLOAT_VEC4=35666]="FLOAT_VEC4",A[A.INT=5124]="INT",A[A.INT_VEC2=35667]="INT_VEC2",A[A.INT_VEC3=35668]="INT_VEC3",A[A.INT_VEC4=35669]="INT_VEC4",A[A.BOOL=35670]="BOOL",A[A.BOOL_VEC2=35671]="BOOL_VEC2",A[A.BOOL_VEC3=35672]="BOOL_VEC3",A[A.BOOL_VEC4=35673]="BOOL_VEC4",A[A.FLOAT_MAT2=35674]="FLOAT_MAT2",A[A.FLOAT_MAT3=35675]="FLOAT_MAT3",A[A.FLOAT_MAT4=35676]="FLOAT_MAT4",A[A.SAMPLER_2D=35678]="SAMPLER_2D",A[A.SAMPLER_CUBE=35680]="SAMPLER_CUBE",A[A.UNSIGNED_INT=5125]="UNSIGNED_INT",A[A.UNSIGNED_INT_VEC2=36294]="UNSIGNED_INT_VEC2",A[A.UNSIGNED_INT_VEC3=36295]="UNSIGNED_INT_VEC3",A[A.UNSIGNED_INT_VEC4=36296]="UNSIGNED_INT_VEC4",A[A.FLOAT_MAT2x3=35685]="FLOAT_MAT2x3",A[A.FLOAT_MAT2x4=35686]="FLOAT_MAT2x4",A[A.FLOAT_MAT3x2=35687]="FLOAT_MAT3x2",A[A.FLOAT_MAT3x4=35688]="FLOAT_MAT3x4",A[A.FLOAT_MAT4x2=35689]="FLOAT_MAT4x2",A[A.FLOAT_MAT4x3=35690]="FLOAT_MAT4x3",A[A.SAMPLER_3D=35679]="SAMPLER_3D",A[A.SAMPLER_2D_SHADOW=35682]="SAMPLER_2D_SHADOW",A[A.SAMPLER_2D_ARRAY=36289]="SAMPLER_2D_ARRAY",A[A.SAMPLER_2D_ARRAY_SHADOW=36292]="SAMPLER_2D_ARRAY_SHADOW",A[A.SAMPLER_CUBE_SHADOW=36293]="SAMPLER_CUBE_SHADOW",A[A.INT_SAMPLER_2D=36298]="INT_SAMPLER_2D",A[A.INT_SAMPLER_3D=36299]="INT_SAMPLER_3D",A[A.INT_SAMPLER_CUBE=36300]="INT_SAMPLER_CUBE",A[A.INT_SAMPLER_2D_ARRAY=36303]="INT_SAMPLER_2D_ARRAY",A[A.UNSIGNED_INT_SAMPLER_2D=36306]="UNSIGNED_INT_SAMPLER_2D",A[A.UNSIGNED_INT_SAMPLER_3D=36307]="UNSIGNED_INT_SAMPLER_3D",A[A.UNSIGNED_INT_SAMPLER_CUBE=36308]="UNSIGNED_INT_SAMPLER_CUBE",A[A.UNSIGNED_INT_SAMPLER_2D_ARRAY=36311]="UNSIGNED_INT_SAMPLER_2D_ARRAY",e.SyncParameter=void 0,(I=e.SyncParameter||(e.SyncParameter={}))[I.OBJECT_TYPE=37138]="OBJECT_TYPE",I[I.SYNC_CONDITION=37139]="SYNC_CONDITION",I[I.SYNC_STATUS=37140]="SYNC_STATUS",I[I.SYNC_FLAGS=37141]="SYNC_FLAGS",e.SyncStatus=void 0,(C=e.SyncStatus||(e.SyncStatus={}))[C.UNSIGNALED=37144]="UNSIGNALED",C[C.SIGNALED=37145]="SIGNALED",e.ClientWaitSyncStatus=void 0,(D=e.ClientWaitSyncStatus||(e.ClientWaitSyncStatus={}))[D.ALREADY_SIGNALED=37146]="ALREADY_SIGNALED",D[D.TIMEOUT_EXPIRED=37147]="TIMEOUT_EXPIRED",D[D.CONDITION_SATISFIED=37148]="CONDITION_SATISFIED",D[D.WAIT_FAILED=37149]="WAIT_FAILED",e.SyncCondition=void 0,(O=e.SyncCondition||(e.SyncCondition={}))[O.SYNC_GPU_COMMANDS_COMPLETE=37143]="SYNC_GPU_COMMANDS_COMPLETE",e.SyncFlag=void 0,(L=e.SyncFlag||(e.SyncFlag={}))[L.SYNC_FLUSH_COMMANDS_BIT=1]="SYNC_FLUSH_COMMANDS_BIT",e.ErrorConstant=void 0,(N=e.ErrorConstant||(e.ErrorConstant={}))[N.INVALID_ENUM=1280]="INVALID_ENUM",N[N.INVALID_VALUE=1281]="INVALID_VALUE",N[N.INVALID_OPERATION=1282]="INVALID_OPERATION",N[N.OUT_OF_MEMORY=1285]="OUT_OF_MEMORY",N[N.INVALID_FRAMEBUFFER_OPERATION=1286]="INVALID_FRAMEBUFFER_OPERATION",N[N.CONTEXT_LOST_WEBGL=37442]="CONTEXT_LOST_WEBGL",e.Extension=void 0,(F=e.Extension||(e.Extension={}))[F.COMPLETION_STATUS_KHR=37297]="COMPLETION_STATUS_KHR",e.ColorAttachment0=36064,e.ColorAttachment1=36065,e.ColorAttachment10=36074,e.ColorAttachment11=36075,e.ColorAttachment12=36076,e.ColorAttachment13=36077,e.ColorAttachment14=36078,e.ColorAttachment15=36079,e.ColorAttachment2=36066,e.ColorAttachment3=36067,e.ColorAttachment4=36068,e.ColorAttachment5=36069,e.ColorAttachment6=36070,e.ColorAttachment7=36071,e.ColorAttachment8=36072,e.ColorAttachment9=36073,e.DepthAttachment=36096,e.DepthStencilAttachment=33306,e.StencilAttachment=36128,e.baseTextureUnit=33984,Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})}))},"esri/views/webgl/Texture":function(){define(["exports","../../core/Error","../../core/has","../../core/Logger","../../core/maybe","../../core/promiseUtils","./checkWebGLError","./enums","./FBOAttachmentType","./TextureDescriptor","./textureUtils","./ValidatedTextureDescriptor"],(function(e,t,i,r,o,n,s,a,l,c,u,h){"use strict";const d=()=>r.getLogger("esri/views/webgl/Texture");let p=class e{static{this.TEXTURE_UNIT_FOR_UPDATES=0}static{this.compressionWorkerHandle=null}constructor(e,i=null,r=null){if(this.type=l.FBOAttachmentType.Texture,this._glName=null,this._samplingModeDirty=!1,this._wrapModeDirty=!1,this._shadowFilterDirty=!1,this._wasImmutablyAllocated=!1,"context"in e)this._descriptor=e,r=i;else{const r=h.ValidatedTextureDescriptor.validate(e,i);if(!r)throw new t("texture:invalid-descriptor","Texture descriptor invalid");this._descriptor=r}this._descriptor.target===a.TextureType.TEXTURE_CUBE_MAP?this._setDataCubeMap(r):this.setData(r)}get glName(){return this._glName}get descriptor(){return this._descriptor}get usedMemory(){return c.estimateMemory(this._descriptor)}get cachedMemory(){return this.usedMemory}get isDirty(){return this._samplingModeDirty||this._wrapModeDirty||this._shadowFilterDirty}get hasWebGLTextureObject(){return!!this._glName}dispose(){this.abortCompression(),this._descriptor.context.gl&&this.hasWebGLTextureObject&&(this._descriptor.context.instanceCounter.decrement(a.ResourceType.Texture,this),this._descriptor.context.unbindTexture(this),this._descriptor.context.gl.deleteTexture(this._glName),this._glName=null)}release(){this.dispose()}resize(e,i){const r=this._descriptor;if(r.width!==e||r.height!==i){if(this._wasImmutablyAllocated)throw new t("texture:immutable-resize","Immutable textures can't be resized!");r.width=e,r.height=i,this._descriptor.target===a.TextureType.TEXTURE_CUBE_MAP?this._setDataCubeMap(null):this.setData(null)}}enableCompression(e){this._descriptor.compress=e}disableCompression(){this._descriptor.compress=void 0}setData(e){this.abortCompression(),!u.isCompressedData(e)&&this._descriptor.internalFormat&&this._descriptor.internalFormat in a.CompressedTextureFormat&&(this._descriptor.internalFormat=void 0),this._setData(e),!u.isCompressedData(e)&&this._descriptor.compress&&this._compressOnWorker(e)}updateData(i,r,o,n,s,a,l=0){a||d().error("An attempt to use uninitialized data!"),this.hasWebGLTextureObject||d().error("An attempt to update uninitialized texture!");const c=this._descriptor;c.internalFormat=u.deriveInternalFormat(c);const{context:h,pixelFormat:p,dataType:m,target:g,isImmutable:_}=c;if(_&&!this._wasImmutablyAllocated)throw new t("texture:uninitialized","Cannot update immutable texture before allocation!");const f=h.bindTexture(this,e.TEXTURE_UNIT_FOR_UPDATES,!0);(r<0||o<0||r+n>c.width||o+s>c.height)&&d().error("An attempt to update out of bounds of the texture!"),this._configurePixelStorage();const{gl:y}=h;l&&(n&&s||d().warn("Must pass width and height if `UNPACK_SKIP_ROWS` is used"),y.pixelStorei(y.UNPACK_SKIP_ROWS,l)),u.isTexImageSource(a)?y.texSubImage2D(g,i,r,o,n,s,p,m,a):u.isCompressedData(a)?y.compressedTexSubImage2D(g,i,r,o,n,s,c.internalFormat,a.levels[i]):y.texSubImage2D(g,i,r,o,n,s,p,m,a),l&&y.pixelStorei(y.UNPACK_SKIP_ROWS,0),h.bindTexture(f,e.TEXTURE_UNIT_FOR_UPDATES)}updateData3D(i,r,o,n,s,a,l,c){c||d().error("An attempt to use uninitialized data!"),this.hasWebGLTextureObject||d().error("An attempt to update an uninitialized texture!");const h=this._descriptor;h.internalFormat=u.deriveInternalFormat(h);const{context:p,pixelFormat:m,dataType:g,isImmutable:_,target:f}=h;if(_&&!this._wasImmutablyAllocated)throw new t("texture:uninitialized","Cannot update immutable texture before allocation!");u.is3DTarget(f)||d().warn("Attempting to set 3D texture data on a non-3D texture");const y=p.bindTexture(this,e.TEXTURE_UNIT_FOR_UPDATES);p.setActiveTexture(e.TEXTURE_UNIT_FOR_UPDATES),(r<0||o<0||n<0||r+s>h.width||o+a>h.height||n+l>h.depth)&&d().error("An attempt to update out of bounds of the texture!"),this._configurePixelStorage();const{gl:w}=p;if(u.isCompressedData(c))c=c.levels[i],w.compressedTexSubImage3D(f,i,r,o,n,s,a,l,h.internalFormat,c);else{const e=c;w.texSubImage3D(f,i,r,o,n,s,a,l,m,g,e)}p.bindTexture(y,e.TEXTURE_UNIT_FOR_UPDATES)}generateMipmap(){const i=this._descriptor;if(0===i.width||0===i.height)return;if(!i.hasMipmap){if(this._wasImmutablyAllocated)throw new t("texture:immutable-change","Cannot add mipmaps to immutable texture after allocation");i.hasMipmap=!0,this._samplingModeDirty=!0,u.validateTexture(i)}i.samplingMode===a.TextureSamplingMode.LINEAR?(this._samplingModeDirty=!0,i.samplingMode=a.TextureSamplingMode.LINEAR_MIPMAP_NEAREST):i.samplingMode===a.TextureSamplingMode.NEAREST&&(this._samplingModeDirty=!0,i.samplingMode=a.TextureSamplingMode.NEAREST_MIPMAP_NEAREST);const r=this._descriptor.context.bindTexture(this,e.TEXTURE_UNIT_FOR_UPDATES);this._descriptor.context.setActiveTexture(e.TEXTURE_UNIT_FOR_UPDATES),this._descriptor.context.gl.generateMipmap(i.target),this._descriptor.context.bindTexture(r,e.TEXTURE_UNIT_FOR_UPDATES)}clearMipmap(){const e=this._descriptor;if(e.hasMipmap){if(this._wasImmutablyAllocated)throw new t("texture:immutable-change","Cannot delete mipmaps to immutable texture after allocation");e.hasMipmap=!1,this._samplingModeDirty=!0,u.validateTexture(e)}e.samplingMode===a.TextureSamplingMode.LINEAR_MIPMAP_NEAREST?(this._samplingModeDirty=!0,e.samplingMode=a.TextureSamplingMode.LINEAR):e.samplingMode===a.TextureSamplingMode.NEAREST_MIPMAP_NEAREST&&(this._samplingModeDirty=!0,e.samplingMode=a.TextureSamplingMode.NEAREST)}setSamplingMode(e){e!==this._descriptor.samplingMode&&(this._descriptor.samplingMode=e,this._samplingModeDirty=!0)}setWrapMode(e){e!==this._descriptor.wrapMode&&(this._descriptor.wrapMode=e,u.validateTexture(this._descriptor),this._wrapModeDirty=!0)}setShadowFiltering(e){e!==this._descriptor.linearFilterDepth&&(this._descriptor.linearFilterDepth=this._descriptor.compareEnabled=e,this.setSamplingMode(e?a.TextureSamplingMode.LINEAR:a.TextureSamplingMode.NEAREST),u.validateTexture(this._descriptor),this._shadowFilterDirty=!0)}applyChanges(){this._samplingModeDirty&&(this._applySamplingMode(),this._samplingModeDirty=!1),this._wrapModeDirty&&(this._applyWrapMode(),this._wrapModeDirty=!1),this._shadowFilterDirty&&(this._applyShadowMode(),this._shadowFilterDirty=!1)}abortCompression(){this._compressionAbortController=o.abortMaybe(this._compressionAbortController)}_setData(i,r){const o=this._descriptor,n=o.context?.gl;if(!n)return;s.checkWebGLError(n),this.hasWebGLTextureObject||(this._glName=n.createTexture(),o.context.instanceCounter.increment(a.ResourceType.Texture,this)),u.validateTexture(o);const l=o.context.bindTexture(this,e.TEXTURE_UNIT_FOR_UPDATES);o.context.setActiveTexture(e.TEXTURE_UNIT_FOR_UPDATES),this._configurePixelStorage(),s.checkWebGLError(n);const c=r??o.target,h=u.is3DTarget(c);if(u.isTexImageSource(i))this._setDataFromTexImageSource(i,c);else{const{width:e,height:r,depth:a}=o;if(null==e||null==r)throw new t("texture:missing-size","Width and height must be specified!");if(h&&null==a)throw new t("texture:missing-depth","Depth must be specified!");if(o.internalFormat=u.deriveInternalFormat(o),o.isImmutable&&!this._wasImmutablyAllocated&&this._texStorage(c,o.internalFormat,o.hasMipmap,e,r,a),u.isCompressedData(i)){if(!u.isCompressedFormat(o.internalFormat))throw new t("texture:format-mismatch","Attempting to use compressed data with an uncompressed format!");this._setDataFromCompressedSource(i,o.internalFormat,c)}else this._texImage(c,0,o.internalFormat,e,r,a,i),s.checkWebGLError(n),o.hasMipmap&&this.generateMipmap()}this._applySamplingMode(),this._applyWrapMode(),this._applyAnisotropicFilteringParameters(),this._applyShadowMode(),s.checkWebGLError(n),o.context.bindTexture(l,e.TEXTURE_UNIT_FOR_UPDATES)}_setDataCubeMap(e=null){for(let t=a.TextureType.TEXTURE_CUBE_MAP_POSITIVE_X;t<=a.TextureType.TEXTURE_CUBE_MAP_NEGATIVE_Z;t++)this._setData(e,t)}_configurePixelStorage(){const e=this._descriptor.context.gl,{unpackAlignment:t,flipped:i,preMultiplyAlpha:r}=this._descriptor;e.pixelStorei(e.UNPACK_ALIGNMENT,t),e.pixelStorei(e.UNPACK_FLIP_Y_WEBGL,i?1:0),e.pixelStorei(e.UNPACK_PREMULTIPLY_ALPHA_WEBGL,r?1:0)}_setDataFromTexImageSource(e,t){const{gl:i}=this._descriptor.context,r=this._descriptor;r.internalFormat=u.deriveInternalFormat(r);const o=u.is3DTarget(t),{width:n,height:a,depth:l}=u.getDimensions(e);r.width&&r.height,r.width||(r.width=n),r.height||(r.height=a),o&&r.depth,o&&(r.depth=l),r.isImmutable&&!this._wasImmutablyAllocated&&this._texStorage(t,r.internalFormat,r.hasMipmap,n,a,l),this._texImage(t,0,r.internalFormat,n,a,l,e),s.checkWebGLError(i),r.hasMipmap&&(this.generateMipmap(),s.checkWebGLError(i))}_setDataFromCompressedSource(e,t,i){const r=this._descriptor,{width:o,height:n,depth:s}=r,l=e.levels,c=u.calcMipmapLevels(i,o,n,s),h=Math.min(c,l.length)-1;this._descriptor.context.gl.texParameteri(r.target,a.TextureConstants.MAX_LEVEL,h),this._forEachMipmapLevel(((e,r,o,n)=>{const s=l[Math.min(e,l.length-1)];this._compressedTexImage(i,e,t,r,o,n,s)}),h)}_texStorage(e,i,r,o,n,s){const{gl:a}=this._descriptor.context;if(!u.isSizedPixelFormat(i)&&!u.isSizedDepthFormat(i)&&!u.isSizedDepthStencilFormat(i))throw new t("texture:missing-format","Immutable textures must have a sized internal format");if(!this._descriptor.isImmutable)return;const l=r?u.calcMipmapLevels(e,o,n,s):1;if(u.is3DTarget(e)){if(null==s)throw new t("texture:missing-depth","Missing depth dimension for 3D texture upload");a.texStorage3D(e,l,i,o,n,s)}else a.texStorage2D(e,l,i,o,n);this._wasImmutablyAllocated=!0}_texImage(e,i,r,o,n,s,a){const l=this._descriptor.context.gl,c=u.is3DTarget(e),{isImmutable:h,pixelFormat:d,dataType:p}=this._descriptor;if(h){if(null!=a){const r=a;if(c){if(null==s)throw new t("texture:missing-depth","Missing depth dimension for 3D texture upload");l.texSubImage3D(e,i,0,0,0,o,n,s,d,p,r)}else l.texSubImage2D(e,i,0,0,o,n,d,p,r)}}else{const u=a;if(c){if(null==s)throw new t("texture:missing-depth","Missing depth dimension for 3D texture upload");l.texImage3D(e,i,r,o,n,s,0,d,p,u)}else l.texImage2D(e,i,r,o,n,0,d,p,u)}}_compressedTexImage(e,i,r,o,n,s,a){const l=this._descriptor.context.gl,c=u.is3DTarget(e);if(this._descriptor.isImmutable){if(null!=a)if(c){if(null==s)throw new t("texture:missing-depth","Missing depth dimension for 3D texture upload");l.compressedTexSubImage3D(e,i,0,0,0,o,n,s,r,a)}else l.compressedTexSubImage2D(e,i,0,0,o,n,r,a)}else if(c){if(null==s)throw new t("texture:missing-depth","Missing depth dimension for 3D texture upload");l.compressedTexImage3D(e,i,r,o,n,s,0,a)}else l.compressedTexImage2D(e,i,r,o,n,0,a)}async _compressOnWorker(t){const{width:i,height:r,context:o,flipped:s,preMultiplyAlpha:l,hasMipmap:c}=this._descriptor,u=this._descriptor.compress?.compressionTracker,h=this._descriptor.compress?.compressionCallback,{compressedTextureETC:p,compressedTextureS3TC:m}=o.capabilities;if(!e.compressionWorkerHandle?.isCompressible(t,this._descriptor)||!p&&!m)return;this.abortCompression();const g=new AbortController;this._compressionAbortController=g,u?.increment();try{let o;t instanceof Uint8Array?o=t.buffer:(o=await createImageBitmap(t,{imageOrientation:s?"flipY":"none"}),n.throwIfAborted(g));const u={data:o,width:i,height:r,needsFlip:t instanceof Uint8Array&&this.descriptor.flipped,components:this._descriptor.pixelFormat===a.PixelFormat.RGBA?4:3,preMultiplyAlpha:l,hasMipmap:c,hasETC:!!p,hasS3TC:!!m},d=await e.compressionWorkerHandle.invoke(u,g.signal,"low");if(n.throwIfAborted(g),d.compressedTexture&&this.hasWebGLTextureObject){const e=this.usedMemory;this._descriptor.internalFormat=d.internalFormat,this._setData(d.compressedTexture),h?.(e-this.usedMemory)}}catch(e){n.isAbortError(e)||d().error("Texture compression failed!")}finally{u?.decrement(),this._compressionAbortController?.signal.aborted&&(this._compressionAbortController=null)}}_forEachMipmapLevel(e,i=1/0){let{width:r,height:o,depth:n,hasMipmap:s,target:l}=this._descriptor;const c=l===a.TextureType.TEXTURE_3D;if(null==r||null==o||c&&null==n)throw new t("texture:missing-size","Missing texture dimensions for mipmap calculation");for(let t=0;e(t,r,o,n),s&&(1!==r||1!==o||c&&1!==n)&&!(t>=i);++t)r=Math.max(1,r>>1),o=Math.max(1,o>>1),c&&(n=Math.max(1,n>>1))}_applySamplingMode(){const e=this._descriptor,t=e.context?.gl;let i=e.samplingMode,r=e.samplingMode;i===a.TextureSamplingMode.LINEAR_MIPMAP_NEAREST||i===a.TextureSamplingMode.LINEAR_MIPMAP_LINEAR?(i=a.TextureSamplingMode.LINEAR,e.hasMipmap||(r=a.TextureSamplingMode.LINEAR)):i!==a.TextureSamplingMode.NEAREST_MIPMAP_NEAREST&&i!==a.TextureSamplingMode.NEAREST_MIPMAP_LINEAR||(i=a.TextureSamplingMode.NEAREST,e.hasMipmap||(r=a.TextureSamplingMode.NEAREST)),t.texParameteri(e.target,t.TEXTURE_MAG_FILTER,i),t.texParameteri(e.target,t.TEXTURE_MIN_FILTER,r)}_applyWrapMode(){const e=this._descriptor,t=e.context?.gl;"number"==typeof e.wrapMode?(t.texParameteri(e.target,t.TEXTURE_WRAP_S,e.wrapMode),t.texParameteri(e.target,t.TEXTURE_WRAP_T,e.wrapMode)):(t.texParameteri(e.target,t.TEXTURE_WRAP_S,e.wrapMode.s),t.texParameteri(e.target,t.TEXTURE_WRAP_T,e.wrapMode.t))}_applyShadowMode(){const e=this._descriptor,t=e.context?.gl,i=e.compareEnabled?t.COMPARE_REF_TO_TEXTURE:t.NONE;t.texParameteri(e.target,t.TEXTURE_COMPARE_MODE,i),e.compareEnabled&&t.texParameteri(e.target,t.TEXTURE_COMPARE_FUNC,t.GREATER),s.checkWebGLError(t)}_applyAnisotropicFilteringParameters(){const e=this._descriptor,t=e.context.capabilities.textureFilterAnisotropic;t&&e.context.gl.texParameterf(e.target,t.TEXTURE_MAX_ANISOTROPY,e.maxAnisotropy??1)}};e.Texture=p,e.tracer=null,Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})}))},"esri/views/webgl/checkWebGLError":function(){define(["exports","../../core/Error","../../core/has","../../core/Logger","./enums"],(function(e,t,i,r,o){"use strict";function n(e){switch(e){case o.ErrorConstant.INVALID_ENUM:return"Invalid Enum. An unacceptable value has been specified for an enumerated argument.";case o.ErrorConstant.INVALID_VALUE:return"Invalid Value. A numeric argument is out of range.";case o.ErrorConstant.INVALID_OPERATION:return"Invalid Operation. The specified command is not allowed for the current state.";case o.ErrorConstant.INVALID_FRAMEBUFFER_OPERATION:return"Invalid Framebuffer operation. The currently bound framebuffer is not framebuffer complete when trying to render to or to read from it.";case o.ErrorConstant.OUT_OF_MEMORY:return"Out of memory. Not enough memory is left to execute the command.";case o.ErrorConstant.CONTEXT_LOST_WEBGL:return"WebGL context has been lost";default:return"Unknown error"}}const s=!!i("enable-feature:webgl-debug");function a(){return s}e.checkWebGLError=function(e,i=a()){if(i){const i=e.getError();if(i){const e=n(i),o=(new Error).stack;r.getLogger("esri.views.webgl.checkWebGLError").error(new t("webgl-error","WebGL error occurred",{message:e,stack:o}))}}},e.getErrorMessage=n,e.hasFeatureFlagWebGLDebug=s,e.webglDebugEnabled=a,e.webglValidateShadersEnabled=function(){return s},Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})}))},"esri/views/webgl/FBOAttachmentType":function(){define(["exports"],(function(e){"use strict";var t;e.FBOAttachmentType=void 0,(t=e.FBOAttachmentType||(e.FBOAttachmentType={}))[t.TextureDescriptor=0]="TextureDescriptor",t[t.Texture=1]="Texture",t[t.Renderbuffer=2]="Renderbuffer",Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})}))},"esri/views/webgl/TextureDescriptor":function(){define(["exports","./enums","./FBOAttachmentType","./Util"],(function(e,t,i,r){"use strict";e.TextureDescriptor=class{constructor(e=0,r=e){this.width=e,this.height=r,this.type=i.FBOAttachmentType.TextureDescriptor,this.target=t.TextureType.TEXTURE_2D,this.pixelFormat=t.PixelFormat.RGBA,this.dataType=t.PixelType.UNSIGNED_BYTE,this.samplingMode=t.TextureSamplingMode.LINEAR,this.wrapMode=t.TextureWrapMode.REPEAT,this.maxAnisotropy=1,this.flipped=!1,this.hasMipmap=!1,this.isOpaque=!1,this.unpackAlignment=4,this.preMultiplyAlpha=!1,this.compareEnabled=!1,this.linearFilterDepth=!1,this.depth=1,this.isImmutable=!1}},e.estimateMemory=function(e){return e.width<=0||e.height<=0||e.depth<=0?0:Math.round(e.width*e.height*e.depth*(e.hasMipmap?4/3:1)*(null==e.internalFormat?4:r.getBytesPerElementFormat(e.internalFormat))*(e.target===t.TextureType.TEXTURE_CUBE_MAP?6:1))},Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})}))},"esri/views/webgl/Util":function(){define(["exports","../../core/has","./checkWebGLError","./enums","./getDataTypeBytes"],(function(e,t,i,r,o){"use strict";function n(e){const t=e.gl;switch(t.getError()){case t.NO_ERROR:return null;case t.INVALID_ENUM:return"An unacceptable value has been specified for an enumerated argument";case t.INVALID_VALUE:return"An unacceptable value has been specified for an argument";case t.INVALID_OPERATION:return"The specified command is not allowed for the current state";case t.INVALID_FRAMEBUFFER_OPERATION:return"The currently bound framebuffer is not framebuffer complete";case t.OUT_OF_MEMORY:return"Not enough memory is left to execute the command";case t.CONTEXT_LOST_WEBGL:return"WebGL context is lost"}return"Unknown error"}function s(e){return e[0].stride}e.bindVertexBufferLayout=function(e,t,r,s,a=0){const l=e.gl;e.bindBuffer(r);for(const r of s){const s=t.get(r.name);if(null==s){console.warn(`There is no location for vertex attribute '${r.name}' defined.`);continue}const c=a*r.stride;if(r.count<=4)l.vertexAttribPointer(s,r.count,r.type,r.normalized,r.stride,r.offset+c),l.enableVertexAttribArray(s),r.divisor>0&&e.gl.vertexAttribDivisor(s,r.divisor);else if(9===r.count)for(let t=0;t<3;t++)l.vertexAttribPointer(s+t,3,r.type,r.normalized,r.stride,r.offset+12*t+c),l.enableVertexAttribArray(s+t),r.divisor>0&&e.gl.vertexAttribDivisor(s+t,r.divisor);else if(16===r.count)for(let t=0;t<4;t++)l.vertexAttribPointer(s+t,4,r.type,r.normalized,r.stride,r.offset+16*t+c),l.enableVertexAttribArray(s+t),r.divisor>0&&e.gl?.vertexAttribDivisor(s+t,r.divisor);else console.error("Unsupported vertex attribute element count: "+r.count);if(i.webglDebugEnabled()){const t=n(e),i=o.getDataTypeBytes(r.type),s=r.offset,a=Math.round(i/s)!==i/s?`. Offset not a multiple of stride. DataType requires ${i} bytes, but descriptor has an offset of ${s}`:"";t&&console.error(`Unable to bind vertex attribute "${r.name}" with baseInstanceOffset ${c}${a}:`,t,r)}}},e.getBytesPerElementFormat=function(e){switch(e){case r.PixelFormat.ALPHA:case r.PixelFormat.LUMINANCE:case r.PixelFormat.RED:case r.PixelFormat.RED_INTEGER:case r.SizedPixelFormat.R8:case r.SizedPixelFormat.R8I:case r.SizedPixelFormat.R8UI:case r.SizedPixelFormat.R8_SNORM:case r.SizedStencilFormat.STENCIL_INDEX8:return 1;case r.PixelFormat.LUMINANCE_ALPHA:case r.PixelFormat.RG:case r.PixelFormat.RG_INTEGER:case r.SizedPixelFormat.RGBA4:case r.SizedPixelFormat.R16F:case r.SizedPixelFormat.R16I:case r.SizedPixelFormat.R16UI:case r.SizedPixelFormat.RG8:case r.SizedPixelFormat.RG8I:case r.SizedPixelFormat.RG8UI:case r.SizedPixelFormat.RG8_SNORM:case r.SizedPixelFormat.RGB565:case r.SizedPixelFormat.RGB5_A1:case r.SizedDepthFormat.DEPTH_COMPONENT16:return 2;case r.PixelFormat.RGB:case r.PixelFormat.RGB_INTEGER:case r.SizedPixelFormat.RGB8:case r.SizedPixelFormat.RGB8I:case r.SizedPixelFormat.RGB8UI:case r.SizedPixelFormat.RGB8_SNORM:case r.SizedPixelFormat.SRGB8:case r.SizedDepthFormat.DEPTH_COMPONENT24:return 3;case r.PixelFormat.RGBA:case r.PixelFormat.RGBA_INTEGER:case r.SizedPixelFormat.RGBA8:case r.SizedPixelFormat.R32F:case r.SizedPixelFormat.R11F_G11F_B10F:case r.SizedPixelFormat.RG16F:case r.SizedPixelFormat.R32I:case r.SizedPixelFormat.R32UI:case r.SizedPixelFormat.RG16I:case r.SizedPixelFormat.RG16UI:case r.SizedPixelFormat.RGBA8I:case r.SizedPixelFormat.RGBA8UI:case r.SizedPixelFormat.RGBA8_SNORM:case r.SizedPixelFormat.SRGB8_ALPHA8:case r.SizedPixelFormat.RGB9_E5:case r.SizedPixelFormat.RGB10_A2UI:case r.SizedPixelFormat.RGB10_A2:case r.SizedDepthFormat.DEPTH_COMPONENT32F:case r.SizedDepthStencilFormat.DEPTH24_STENCIL8:return 4;case r.SizedDepthStencilFormat.DEPTH32F_STENCIL8:return 5;case r.SizedPixelFormat.RGB16F:case r.SizedPixelFormat.RGB16I:case r.SizedPixelFormat.RGB16UI:return 6;case r.SizedPixelFormat.RG32F:case r.SizedPixelFormat.RG32I:case r.SizedPixelFormat.RG32UI:case r.SizedPixelFormat.RGBA16F:case r.SizedPixelFormat.RGBA16I:case r.SizedPixelFormat.RGBA16UI:return 8;case r.SizedPixelFormat.RGB32F:case r.SizedPixelFormat.RGB32I:case r.SizedPixelFormat.RGB32UI:return 12;case r.SizedPixelFormat.RGBA32F:case r.SizedPixelFormat.RGBA32I:case r.SizedPixelFormat.RGBA32UI:return 16;case r.CompressedTextureFormat.COMPRESSED_RGB_S3TC_DXT1_EXT:case r.CompressedTextureFormat.COMPRESSED_RGBA_S3TC_DXT1_EXT:return.5;case r.CompressedTextureFormat.COMPRESSED_RGBA_S3TC_DXT3_EXT:case r.CompressedTextureFormat.COMPRESSED_RGBA_S3TC_DXT5_EXT:return 1;case r.CompressedTextureFormat.COMPRESSED_R11_EAC:case r.CompressedTextureFormat.COMPRESSED_SIGNED_R11_EAC:case r.CompressedTextureFormat.COMPRESSED_RGB8_ETC2:case r.CompressedTextureFormat.COMPRESSED_SRGB8_ETC2:case r.CompressedTextureFormat.COMPRESSED_RGB8_PUNCHTHROUGH_ALPHA1_ETC2:case r.CompressedTextureFormat.COMPRESSED_SRGB8_PUNCHTHROUGH_ALPHA1_ETC2:return.5;case r.CompressedTextureFormat.COMPRESSED_RG11_EAC:case r.CompressedTextureFormat.COMPRESSED_SIGNED_RG11_EAC:case r.CompressedTextureFormat.COMPRESSED_RGBA8_ETC2_EAC:case r.CompressedTextureFormat.COMPRESSED_SRGB8_ALPHA8_ETC2_EAC:return 1}return 0},e.getErrorString=n,e.getStride=s,e.unbindVertexBufferLayout=function(e,t,i,o){const n=e.gl;e.bindBuffer(i);for(const i of o){const r=t.get(i.name);if(i.count<=4)n.disableVertexAttribArray(r),i.divisor&&i.divisor>0&&e.gl?.vertexAttribDivisor(r,0);else if(9===i.count)for(let t=0;t<3;t++)n.disableVertexAttribArray(r+t),i.divisor&&i.divisor>0&&e.gl?.vertexAttribDivisor(r+t,0);else if(16===i.count)for(let t=0;t<4;t++)n.disableVertexAttribArray(r+t),i.divisor&&i.divisor>0&&e.gl?.vertexAttribDivisor(r+t,0);else console.error("Unsupported vertex attribute element count: "+i.count)}e.unbindBuffer(r.BufferType.ARRAY_BUFFER)},e.vertexCount=function(e,t){return(e.vertexBuffers.get(t)?.usedMemory??0)/s(e.layout.get(t))},Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})}))},"esri/views/webgl/getDataTypeBytes":function(){define(["exports","./enums"],(function(e,t){"use strict";e.getDataTypeBytes=function(e){switch(e){case t.DataType.BYTE:case t.DataType.UNSIGNED_BYTE:return 1;case t.DataType.SHORT:case t.DataType.UNSIGNED_SHORT:case t.DataType.HALF_FLOAT:return 2;case t.DataType.FLOAT:case t.DataType.INT:case t.DataType.UNSIGNED_INT:return 4}},Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})}))},"esri/views/webgl/textureUtils":function(){define(["exports","../../core/Error","../../core/Logger","./enums"],(function(e,t,i,r){"use strict";const o=()=>i.getLogger("esri/views/webgl/textureUtils");function n(e){return e in r.SizedDepthFormat}function s(e){return e in r.SizedDepthStencilFormat}function a(e){return null!=e&&e in r.CompressedTextureFormat}function l(e){return null!=e&&"type"in e&&"compressed"===e.type}function c(e){return null!=e&&"byteLength"in e}e.calcMipmapLevels=function(e,t,i,o=1){let n=Math.max(t,i);return e===r.TextureType.TEXTURE_3D&&(n=Math.max(n,o)),Math.floor(Math.log2(n))+1},e.deriveInternalFormat=function(e){if(null!=e.internalFormat)return e.internalFormat;switch(e.dataType){case r.PixelType.FLOAT:switch(e.pixelFormat){case r.PixelFormat.RGBA:return r.SizedPixelFormat.RGBA32F;case r.PixelFormat.RGB:return r.SizedPixelFormat.RGB32F;default:throw new t("texture:unknown-format","Unable to derive format")}case r.PixelType.UNSIGNED_BYTE:switch(e.pixelFormat){case r.PixelFormat.RGBA:return r.SizedPixelFormat.RGBA8;case r.PixelFormat.RGB:return r.SizedPixelFormat.RGB8}}const{pixelFormat:i}=e;return e.internalFormat=i===r.UnsizedDepthFormat.DEPTH_STENCIL?r.SizedDepthStencilFormat.DEPTH24_STENCIL8:i===r.UnsizedDepthFormat.DEPTH_COMPONENT?r.SizedDepthFormat.DEPTH_COMPONENT24:i,e.internalFormat},e.getDimensions=function(e){let t="width"in e?e.width:e.codedWidth,i="height"in e?e.height:e.codedHeight;return e instanceof HTMLVideoElement&&(t=e.videoWidth,i=e.videoHeight),{width:t,height:i,depth:1}},e.is3DTarget=function(e){return e===r.TextureType.TEXTURE_3D||e===r.TextureType.TEXTURE_2D_ARRAY},e.isArrayBufferView=c,e.isCompressedData=l,e.isCompressedFormat=a,e.isCompressedTexture=function(e){return a(e.descriptor.internalFormat)},e.isSizedDepthFormat=n,e.isSizedDepthStencilFormat=s,e.isSizedPixelFormat=function(e){return e in r.SizedPixelFormat},e.isTexImageSource=function(e){return null!=e&&!l(e)&&!c(e)},e.validateTexture=function(e){const{width:t,height:i,depth:a}=e;(null!=t&&t<0||null!=i&&i<0||null!=a&&a<0)&&o().error("Negative dimension parameters are not allowed!");const{internalFormat:l}=e;if(l&&(n(l)||s(l))){const{linearFilterDepth:t,compareEnabled:i,samplingMode:n,hasMipmap:s}=e;s&&o().error("Depth textures cannot have mipmaps"),t?n!==r.TextureSamplingMode.LINEAR&&n!==r.TextureSamplingMode.NEAREST&&o().error("Depth textures cannot sample mipmaps"):(n!==r.TextureSamplingMode.NEAREST&&o().error("Depth textures without filtering must use NEAREST filtering"),i&&o().error("Depth textures without filtering cannot use compare function"))}},Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})}))},"esri/views/webgl/ValidatedTextureDescriptor":function(){define(["exports","./enums","./TextureDescriptor"],(function(e,t,i){"use strict";class r extends i.TextureDescriptor{constructor(e,i){switch(super(),this.context=e,Object.assign(this,i),this.internalFormat){case t.SizedPixelFormat.R16F:case t.SizedPixelFormat.R32F:case t.SizedPixelFormat.R8_SNORM:case t.SizedPixelFormat.R8:this.pixelFormat=t.PixelFormat.RED;break;case t.SizedPixelFormat.R8I:case t.SizedPixelFormat.R8UI:case t.SizedPixelFormat.R16I:case t.SizedPixelFormat.R16UI:case t.SizedPixelFormat.R32I:case t.SizedPixelFormat.R32UI:this.pixelFormat=t.PixelFormat.RED_INTEGER}}static validate(e,t){return new r(e,t)}}e.ValidatedTextureDescriptor=r,Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})}))},"esri/views/2d/engine/webgl/effects/highlight/MultiHighlightGradient":function(){define(["exports","./HighlightGradient"],(function(e,t){"use strict";e.MultiHighlightGradient=class{constructor(){this.type="multi",this.gradients=[]}setHighlightOptions(e){for(let i=0;i<e.length;i++)this.gradients[i]||(this.gradients[i]=new t),this.gradients[i].setHighlightOptions(e[i]);for(let t=e.length+1;t<this.gradients.length;t++)this.gradients[t].destroy();this.gradients.length=e.length}destroy(){for(const e of this.gradients)e.destroy()}getReasonsWithGradients(){let e=1;const t=[];for(let i=0;i<this.gradients.length;i++){const r=this.gradients[i];t.push({activeReasons:e,activeGradient:r}),e<<=1}return t}},Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})}))},"esri/views/2d/engine/webgl/shaderGraph/techniques/featureTechniqueUtils":function(){define(["exports","../../../../../../core/unitUtils","../../definitions","../../enums","../../../../../webgl/enums"],(function(e,t,i,r,o){"use strict";const n={color:{write:[!0,!0,!0,!0],blendMode:"composite"},depth:!1,stencil:{write:!1,test:{ref:e=>e.stencilRef,compare:o.CompareFunction.EQUAL,mask:255,op:{fail:o.StencilOperation.KEEP,zFail:o.StencilOperation.KEEP,zPass:o.StencilOperation.REPLACE}}}},s={color:{write:[!0,!0,!0,!0],blendMode:"additive"},depth:!1,stencil:!1},a={...n,color:{write:[!0,!0,!0,!0],blendMode:"delete"}};function l({pixelRatio:e,state:i,displayLevel:r,requiredLevel:o},n){const s=1/2**(r-n.key.level),a=1/2**(o-n.key.level);return{displayMat3:i.displayMat3,displayViewMat3:i.displayViewMat3,displayViewScreenMat3:n.transforms.displayViewScreenMat3,viewMat3:i.viewMat3,tileMat3:n.transforms.tileMat3,displayZoomFactor:s,requiredZoomFactor:a,tileOffset:[n.x,n.y],currentScale:i.scale,currentZoom:r,metersPerSRUnit:t.getMetersPerUnitForSR(i.spatialReference),rotation:i.rotation,pixelRatio:e}}function c(e){return"highlight"===e.passOptions?.type}function u(e){return"hittest"===e.passOptions?.type}function h(e){if(!u(e))return null;const{position:t,distance:i,smallSymbolDistance:r,smallSymbolSizeThreshold:o}=e.passOptions;return{position:t,distance:i,smallSymbolDistance:r,smallSymbolSizeThreshold:o}}function d(e){if(!c(e))return null;const{activeReasons:t,highlightAll:i}=e.passOptions;return{activeReasons:t,highlightAll:i?1:0}}e.getFeaturePipelineState=function(e){return u(e)?s:c(e)&&"clear"===e.passOptions.stepType?a:n},e.getFeatureUniforms=function(e,t){const{attributeView:i,context:r}=e;return{storage:i.getUniforms(r),view:l(e,t),hittestRequest:h(e),highlight:d(e)}},e.getLocalTileOffset=function(e){const{row:t,col:r}=e.key,o=r*i.tileSize,n=t*i.tileSize;return{tileOffsetFromLocalOrigin:[o%i.maxRepresentableInt,n%i.maxRepresentableInt],maxIntsToLocalOrigin:[Math.floor(o/i.maxRepresentableInt),Math.floor(n/i.maxRepresentableInt)]}},e.getSelectionDefines=function(e){return{inside:e.selection===r.FeatureSelection.InsideEffect,outside:e.selection===r.FeatureSelection.OutsideEffect}},e.getViewUniforms=l,e.isHighlight=c,e.isHittest=u,e.resolveDynamicUniforms=function(e,t,i){const r={};for(const o in i)"function"!=typeof i[o]?r[o]=i[o]:r[o]=i[o](e,t);return r},Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})}))},"esri/views/2d/engine/webgl/enums":function(){define(["exports"],(function(e){"use strict";var t,i,r,o,n,s,a,l,c;e.WGLGeometryType=void 0,(t=e.WGLGeometryType||(e.WGLGeometryType={}))[t.FILL=0]="FILL",t[t.LINE=1]="LINE",t[t.MARKER=2]="MARKER",t[t.TEXT=3]="TEXT",t[t.LABEL=4]="LABEL",e.WGLDrawPhase=void 0,(i=e.WGLDrawPhase||(e.WGLDrawPhase={}))[i.NONE=0]="NONE",i[i.MAP=1]="MAP",i[i.LABEL=2]="LABEL",i[i.LABEL_ALPHA=4]="LABEL_ALPHA",i[i.HITTEST=8]="HITTEST",i[i.HIGHLIGHT=16]="HIGHLIGHT",i[i.CLIP=32]="CLIP",i[i.DEBUG=64]="DEBUG",i[i.NUM_DRAW_PHASES=9]="NUM_DRAW_PHASES",e.VVBinding=void 0,(r=e.VVBinding||(e.VVBinding={}))[r.SIZE=0]="SIZE",r[r.COLOR=1]="COLOR",r[r.OPACITY=2]="OPACITY",r[r.ROTATION=3]="ROTATION",e.WGLVVTarget=void 0,(o=e.WGLVVTarget||(e.WGLVVTarget={}))[o.MINMAX_TARGETS_OUTLINE=128]="MINMAX_TARGETS_OUTLINE",o[o.SCALE_TARGETS_OUTLINE=256]="SCALE_TARGETS_OUTLINE",o[o.FIELD_TARGETS_OUTLINE=512]="FIELD_TARGETS_OUTLINE",o[o.UNIT_TARGETS_OUTLINE=1024]="UNIT_TARGETS_OUTLINE",e.MosaicType=void 0,(n=e.MosaicType||(e.MosaicType={}))[n.SPRITE=0]="SPRITE",n[n.GLYPH=1]="GLYPH",e.WGLSymbologyType=void 0,(s=e.WGLSymbologyType||(e.WGLSymbologyType={}))[s.DEFAULT=0]="DEFAULT",s[s.SIMPLE=1]="SIMPLE",s[s.DOT_DENSITY=2]="DOT_DENSITY",s[s.OUTLINE_FILL=3]="OUTLINE_FILL",s[s.OUTLINE_FILL_SIMPLE=4]="OUTLINE_FILL_SIMPLE",s[s.HEATMAP=5]="HEATMAP",s[s.PIE_CHART=6]="PIE_CHART",e.FeatureSelection=void 0,(a=e.FeatureSelection||(e.FeatureSelection={}))[a.All=0]="All",a[a.Highlight=1]="Highlight",a[a.InsideEffect=2]="InsideEffect",a[a.OutsideEffect=3]="OutsideEffect",e.FeatureBatchingStrategy=void 0,(l=e.FeatureBatchingStrategy||(e.FeatureBatchingStrategy={}))[l.BATCHING=0]="BATCHING",l[l.STRICT_ORDER=1]="STRICT_ORDER",l[l.STRICT_MARKERS_AND_TEXT=2]="STRICT_MARKERS_AND_TEXT",e.FeatureSymbologyDrawOrder=void 0,(c=e.FeatureSymbologyDrawOrder||(e.FeatureSymbologyDrawOrder={}))[c.FILL=0]="FILL",c[c.LINE=1]="LINE",c[c.MARKER=2]="MARKER",c[c.TEXT=3]="TEXT",Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})}))},"esri/views/2d/support/clippingUtils":function(){define(["exports","../../../geometry/support/contains"],(function(e,t){"use strict";const i=e=>parseFloat(e)/100;function r(e,t,r){const o="string"==typeof e.left?i(e.left)*t:e.left,n="string"==typeof e.right?i(e.right)*t:e.right,s="string"==typeof e.top?i(e.top)*r:e.top,a="string"==typeof e.bottom?i(e.bottom)*r:e.bottom,l=s;return{xmin:o,xmax:Math.max(t-n,o),ymin:l,ymax:Math.max(r-a,s)}}e.clipContainsPoint=function(e,i,o,n){switch(i.type){case"rect":{const{width:t,height:n}=e,{xmin:s,xmax:a,ymin:l,ymax:c}=r(i,t,n),{x:u,y:h}=o;return u>s&&u<a&&h>l&&h<c}case"path":return 0===i.path.length||!Array.isArray(i.path[0][0])||t.ringsContainsCoords(i.path,[o.x,o.y]);case"geometry":return null==i.geometry||("polygon"===i.geometry.type?t.polygonContainsPoint(i.geometry,n):t.extentContainsPoint(i.geometry,n))}},e.createScreenExtent=r,Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})}))},"esri/views/2d/support/highlightOptionsUtils":function(){define(["exports","../../../core/Collection","../../support/HighlightOptions"],(function(e,t,i){"use strict";e.getDefaultHighlightOptions=function(e){if(!e.highlights)return null;const t=e.highlights.findIndex((e=>"default"===e.name));return-1===t?null:e.highlights.items[t]},e.setDefaultHighlightOptions=function(e,r){if(!e.highlights){if(!r)return;e.highlights=new t([new i])}const o=e.highlights.findIndex((e=>"default"===e.name));r?e.highlights.items[o].assignFrom(r):(e.highlights.removeAt(o),0===e.highlights.length&&(e.highlights=null))},Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})}))},"esri/views/2d/support/hitTestUtils":function(){define(["exports","../../../Graphic","../../../core/arrayUtils","../../../core/iteratorUtils","./clippingUtils","../../support/screenUtils"],(function(e,t,i,r,o,n){"use strict";function s(e,i,r,o,n,s){return a=>{if(a instanceof t){if(a.layer===e)s?.();else{const t=e.allLayerViews.find((e=>e.layer===a.layer));t&&n?.(t)}o(l(a))}else if("layer"in a&&"element"in a);else if("subtype-sublayer"===a.type){const t=e.allLayerViews.find((e=>e.layer===a.parent));t&&r(a,t)}else{const t=e.allLayerViews.find((e=>e.layer===a));t&&i(t)}}}function a(e,t){if(e)if(r.isIterable(e))for(const i of e)if(r.isIterable(i))for(const e of i)t(e);else t(i);else t(e)}function l(e){const t=e.getObjectId();return t?`${e.layer?.uid??e.sourceLayer?.uid??"MapView"}/${t}`:`"MapView/${e.uid}`}function c({layer:e},t){"subtype-group"===e?.type&&e.sublayers.forEach((e=>{t(e)}))}e.hitTest=async function(e,t,r){const u=n.isSupportedScreenPointEvent(t)?n.createScreenPointFromSupportedEvent(e,t):t;if(!e.ready||isNaN(u.x)||isNaN(u.y))return{screenPoint:u,results:[]};let h=new Set;const d=new Set;let p=!1,m=null,g=null;r?.include?a(r.include,s(e,(e=>{h.add(e),c(e,(e=>d.add(e)))}),((e,t)=>{d.add(e),h.add(t)}),(e=>{m||(m=new Set),m.add(e)}),(e=>h.add(e)),(()=>p=!0))):(p=!0,h=new Set(e.allLayerViews),h.forEach((e=>{c(e,(e=>d.add(e)))}))),r?.exclude&&a(r.exclude,s(e,(e=>{h.delete(e),c(e,(e=>d.delete(e)))}),(e=>d.delete(e)),(e=>{g||(g=new Set),g.add(e)})));const _=e.toMap(u),f=e.allLayerViews.filter((t=>!t.suspended&&h.has(t)&&t.clips.every((t=>o.clipContainsPoint(e,t,u,_))))).reverse();let y=[...p?e.graphicsView.hitTest(_).map((e=>({type:"graphic",graphic:e,layer:null,mapPoint:_}))):[],...await Promise.all(f.map((e=>e.hitTest(_,u))).toArray())].filter(i.isSome).flat().filter(i.isSome);return y=y.filter((e=>"graphic"!==e.type||"subtype-group"!==e.layer?.type||d.has(e.graphic.layer))),m&&(y=y.filter((e=>!("graphic"in e)||!e.graphic||m?.has(l(e.graphic))))),g&&(y=y.filter((e=>!("graphic"in e)||!e.graphic||!g?.has(l(e.graphic))))),{screenPoint:u,results:y}},Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})}))},"esri/views/2d/support/screenshotUtils":function(){define(["exports","../../support/screenshotUtils"],(function(e,t){"use strict";const i={flipY:!0,premultipliedAlpha:!0};function r(e,i){const r=o(i||{},(n=e.stage,s=e.size,Math.min(4,t.getMaximumResolutionScale(s,Math.min(4096,n.context.parameters.maxTextureSize)))),e.size,e.padding);var n,s;const a=function(e={},t){if(!e.layers)return;const i=[];return e.layers.forEach((e=>{const r=t.find((t=>t.layer.id===e.id));r?.container&&i.push(r.container)})),i}(i,e.allLayerViews);return e.stage.takeScreenshot(r,a,e.backgroundColor,i?.rotation)}function o(e,t,i,r){e.ignorePadding&&(r={left:0,right:0,top:0,bottom:0});let o=null;null!=e.width&&null!=e.height?o=[e.width,e.height]:null==e.width&&null!=e.height?o=[e.height,e.height]:null!=e.width&&null==e.height?o=[e.width,e.width]:null==e.width&&null==e.height&&(o=null);const n=i[0]-(r.left+r.right),s=i[1]-(r.top+r.bottom);let a,l,c=e.area||{x:0,y:0,width:n,height:s};if(o){const e=n/s,t=o[0]/o[1];if(t>e){const e=c.width/t;c={x:c.x,y:Math.round(c.y+(c.height-e)/2),width:c.width,height:Math.round(e)}}else{const e=c.height*t;c={x:Math.round(c.x+(c.width-e)/2),y:c.y,width:Math.round(e),height:c.height}}}else o=[c.width,c.height];return o[0]>c.width?(a=Math.min(o[0]/c.width,t),l=o[0]/c.width/a):(a=1,l=o[0]/c.width),{cropArea:{x:Math.round((c.x+r.left)*a),y:Math.round((c.y+r.top)*a),width:Math.round(c.width*a),height:Math.round(c.height*a)},outputScale:l,resolutionScale:a}}e.createScreenshotRegion=o,e.takeRawScreenshot=async function(e,o){const n=await r(e,o);return t.encodeData(n,i)},e.takeScreenshot=async function(e,o){const n=await r(e,o),{format:s,quality:a}=t.getFormatAndQuality(o?.format,o?.quality);return t.encode(n,{format:s,quality:a},i)},Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})}))},"esri/views/support/screenshotUtils":function(){define(["exports","../../core/has","../../core/mathUtils","../../core/imageUtils"],(function(e,t,i,r){"use strict";function o(e,t){const{format:r,quality:o,rotation:n,disableDecorations:s}=e||{},a=c(e,t.padding),l=function(e,t){const i={x:0,y:0,width:t.width,height:t.height};if(e?.area){null!=e.area.x&&(i.x=Math.floor(e.area.x)),null!=e.area.y&&(i.y=Math.floor(e.area.y));const r=null!=e.area.width?Math.floor(e.area.width):null,o=null!=e.area.height?Math.floor(e.area.height):null;if(i.width=t.width-i.x,i.height=t.height-i.y,null!=r&&null!=o)i.width=Math.min(i.width,r),i.height=Math.min(i.height,o);else if(null==r&&null!=o){const e=Math.min(i.width,r);i.height=e/i.width*i.height,i.width=e}else if(null!=r&&null==o){const e=Math.min(i.height,o);i.width=e/i.height*i.width,i.height=e}}return function(e,t){const i=Math.floor(Math.max(e.x,0)),r=Math.floor(Math.max(e.y,0)),o={x:i,y:r,width:Math.floor(Math.min(e.width,t.width-i)),height:Math.floor(Math.min(e.height,t.height-r))},n=o.width/o.height,s=e.width/e.height;if(s===n)return o;if(s>n){const e=Math.floor(o.width/s),t=o.height-e;return{x:o.x,y:Math.floor(o.y+t/2),width:o.width,height:e}}const a=Math.floor(o.height*s),l=o.width-a;return{x:Math.floor(o.x+l/2),y:o.y,width:a,height:o.height}}(function(e,t){if(null==t?.width||null==t.height)return e;const i=t.width/t.height,r=e.width/e.height;if(r===i)return e;if(r<i){const t=Math.floor(e.height*i);return e.x-=(t-e.width)/2,e.width=t,e}const o=Math.floor(e.width/i);return e.y-=(o-e.height)/2,e.height=o,e}(i,e),t)}(e,{width:t.width-a.left-a.right,height:t.height-a.top-a.bottom}),{width:h,height:d}=function(e,t){if(!e)return t;const i=e.width,r=e.height;if(null!=i&&null!=r)return{width:Math.floor(i),height:Math.floor(r)};if(null==i&&null==r)return t;const o=t.width/t.height;return null==r?{width:Math.floor(i),height:Math.floor(i/o)}:{width:Math.floor(r*o),height:Math.floor(r)}}(e,l),m=u(r),g=p[m];return{format:m,quality:i.clamp(null!=o?o:g,0,100),area:l,width:h,height:d,rotation:n,disableDecorations:!!s,ignoreBackground:!!e?.ignoreBackground,ignorePadding:!!e?.ignorePadding}}function n(e,t){const i=(null==a&&(a=document.createElement("canvas")),a);t.premultipliedAlpha&&function(e){const t=e.data,i=t.length;for(let e=0;e<i;e+=4){const i=t[e+3];if(255!==i&&i>0){const r=255/i;t[e]=t[e]*r,t[e+1]=t[e+1]*r,t[e+2]=t[e+2]*r}}}(e),i.width=e.width,i.height=e.height;const r=i.getContext("2d",{willReadFrequently:!0});return r.putImageData(e,0,0),t.flipY&&function(e){e.save(),e.globalCompositeOperation="copy",e.scale(1,-1),e.translate(0,-e.canvas.height),e.drawImage(e.canvas,0,0),e.restore()}(r),{ctx:r,canvas:i}}function s(e){e.width=0,e.height=0}let a=null;function l(e,t){const i=h[t.format],r=t.quality/100;return e.toDataURL(i,r)}function c(e,t){return!t||e?.ignorePadding?m:t}function u(e){switch(e){case"png":case"jpg":case"jpeg":return e;default:return d}}const h={png:"image/png",jpg:"image/jpeg",jpeg:"image/jpeg"},d="png",p={png:100,jpg:98,jpeg:98},m={top:0,right:0,bottom:0,left:0};e.createEmptyImageData=r.createEmptyImageData,e.completeUserSettings=o,e.encode=function(e,t,i){const{ctx:r,canvas:o}=n(e,i),a=r.getImageData(0,0,e.width,e.height),c=l(o,t);return s(o),{dataUrl:c,data:a}},e.encodeData=function(e,t){const{ctx:i,canvas:r}=n(e,t),o=i.getImageData(0,0,e.width,e.height);return s(r),o},e.getFormatAndQuality=function(e,t){const r=u(e),o=p[r];return{format:r,quality:i.clamp(null!=t?t:o,0,100)}},e.getMaximumResolutionScale=function(e,t){return t/Math.max(e[0],e[1])},e.resampleHermite=function(e,t,i,r=0,o=0,n=e.width-r,s=e.height-o,a=!1){const{data:l}=e,{width:c,height:u,data:h}=t,d=n/c,p=s/u,m=Math.ceil(d/2),g=Math.ceil(p/2),_=e.width;for(let e=0;e<u;e++)for(let t=0;t<c;t++){const n=4*(t+(a?u-e-1:e)*c);let s=0,f=0,y=0,w=0,v=0,T=0;const S=(e+.5)*p;for(let n=Math.floor(e*p);n<(e+1)*p;n++){const e=Math.abs(S-(n+.5))/g,a=(t+.5)*d,c=e*e;for(let e=Math.floor(t*d);e<(t+1)*d;e++){const t=Math.abs(a-(e+.5))/m,u=Math.sqrt(c+t*t);if(u>=1)continue;let h=2*u*u*u-3*u*u+1;const d=4*(r+e+(o+n)*_);T+=h*l[d+3],f+=h,!i&&l[d+3]<255&&(h=h*l[d+3]/255),y+=h*l[d],w+=h*l[d+1],v+=h*l[d+2],s+=h}}h[n]=y/s,h[n+1]=w/s,h[n+2]=v/s,h[n+3]=T/f}return t},e.screenshotSuperSampleSettings=function(e,t,i){if(!t)return e;const{framebufferWidth:r,framebufferHeight:o,pixelRatio:n,region:s}=e,a=c(e,i),l=a.left+a.right,u=a.top+a.bottom,h=r-l,d=o-u,p=Math.min(8,Math.min((2048-l)/h,(2048-u)/d));return p<1.5?e:{...e,framebufferWidth:Math.round(h*p)+l,framebufferHeight:Math.round(d*p)+u,pixelRatio:n*p,resample:{region:{x:Math.round((s.x-a.left)*p)+a.left,y:Math.round((s.y-a.top)*p)+a.top,width:Math.round(s.width*p),height:Math.round(s.height*p)},width:r,height:o}}},e.toDataUrl=l,e.toRenderSettings=function(e,t){const i=o(e,t),r=i.area,n=i.width/r.width,s=c(i,t.padding),a=s.left+s.right,l=s.top+s.bottom,u=t.width-a,h=t.height-l,d=Math.floor(u*n+a),p=Math.floor(h*n+l),m=e?.layers??[],g=i.ignoreBackground,_=i.ignorePadding;return{framebufferWidth:d,framebufferHeight:p,region:{x:Math.floor(r.x*n)+s.left,y:Math.floor(r.y*n)+s.top,width:i.width,height:i.height},format:i.format,quality:i.quality,rotation:i.rotation,pixelRatio:n,layers:m,disableDecorations:i.disableDecorations,ignoreBackground:g,ignorePadding:_,objectAndLayerIdColor:!1}},Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})}))},"esri/core/imageUtils":function(){define(["require","exports","../request","./Error","./promiseUtils","./urlUtils","../support/base64Utils"],(function(e,t,i,r,o,n,s){"use strict";let a=null,l=!0;function c(e,t,i){return i||(a||(a=document.createElement("canvas"),a.width=1,a.height=1),i=a),i.getContext("2d").createImageData(e,t)}t.createEmptyImageData=function(e,t,i){if(!e||!t)throw new Error("Cannot construct image data without dimensions");if(l)try{return new ImageData(e,t)}catch(e){l=!1}return c(e,t,i)},t.getImageData=async function(t,a){const{arrayBuffer:l,mediaType:c}=await async function(e,t){const r=n.dataComponents(e);if(r?.isBase64)return{arrayBuffer:s.base64ToArrayBuffer(r.data),mediaType:r.mediaType};const o=await i(e,{responseType:"array-buffer",...t});return{arrayBuffer:o.data,mediaType:o.getHeader?.("Content-Type")??""}}(t,a),u="image/png"===c;if("image/gif"===c){const{isAnimatedGIF:t,parseGif:i}=await new Promise(((t,i)=>e(["./image/gif"],t,i)));if(t(l))return i(l,a)}if(u){const{isAnimatedPNG:t,parseApng:i}=await new Promise(((t,i)=>e(["./image/apng"],t,i)));if(t(l))return i(l,a)}return async function(e,t){const n=window.URL.createObjectURL(e);try{const{data:e}=await i(n,{...t,responseType:"image"});return e}catch(e){if(!o.isAbortError(e))throw new r("invalid-image",`Could not fetch requested image at ${n}`);throw e}finally{window.URL.revokeObjectURL(n)}}(new Blob([l],{type:c}),a)},t.wrapImageData=function(e,t,i,r){if(!t||!i)throw new Error("Cannot construct image data without dimensions");if(l)try{return new ImageData(e,t,i)}catch(e){l=!1}const o=c(t,i,r);return o.data.set(e,0),o},Object.defineProperty(t,Symbol.toStringTag,{value:"Module"})}))},"esri/views/2d/support/Timeline":function(){define(["exports"],(function(e){"use strict";e.Timeline=class{constructor(){this._names=new Map}begin(e){this._names.has(e)||(this._names.set(e,!1),(e=>e.includes("Brush"))(e)&&this.record("Esri.FirstDraw"),performance.mark(`Esri.${e}.Start`))}end(e){this._names.has(e)&&!this._names.get(e)&&(this._names.set(e,!0),performance.mark(`Esri.${e}.End`))}record(e){this._names.has(e)||(this._names.set(e,!0),performance.mark(`Esri.${e}`))}},Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})}))},"esri/views/support/WebGLRequirements":function(){define(["exports","../../core/Error","../webgl/capabilities"],(function(e,t,i){"use strict";e.check=function(e){const r=i.getWebGLCapabilities();return r.available?"3d"===e&&r.majorPerformanceCaveat?new t("webgl:major-performance-caveat-detected",`Your WebGL implementation (${r.unmaskedRenderer}) doesn't seem to support hardware accelerated rendering. Check your browser settings or if your GPU is in a blocklist.`):r.supportsHighPrecisionFragment?r.supportsVertexShaderSamplers?null:new t("webgl:vertex-shader-samplers-required","WebGL support for vertex shader samplers is required but not supported."):new t("webgl:high-precision-fragment-required","WebGL support for high precision fragment shaders is required but not supported."):new t("webgl:required","WebGL2 is required but not supported.",(new Error).stack)},Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})}))},"esri/views/webgl/capabilities":function(){define(["exports","./capabilities/DebugRendererInfo"],(function(e,t){"use strict";let i;class r{constructor(){this.available=!1,this.majorPerformanceCaveat=!1,this.maxTextureSize=0,this.supportsVertexShaderSamplers=!1,this.supportsHighPrecisionFragment=!1,this.supportsColorBufferFloat=!1,this.supportsColorBufferFloatBlend=!1,this.supportsColorBufferHalfFloat=!1,this.unmaskedRenderer="unloaded"}}e.getWebGLCapabilities=function(){return i??=function(){const e=new r,i=function(e){if("undefined"==typeof WebGL2RenderingContext)return null;const i=document.createElement("canvas");if(!i)return null;let r=i.getContext("webgl2",{failIfMajorPerformanceCaveat:!0});if(null==r&&(r=i.getContext("webgl2"),null!=r&&(e.majorPerformanceCaveat=!0,e.unmaskedRenderer=t.loadRendererInfo(r)?.getUnmaskedRenderer()??"unknown")),null==r)return r;e.available=!0,e.maxTextureSize=r.getParameter(r.MAX_TEXTURE_SIZE),e.supportsVertexShaderSamplers=r.getParameter(r.MAX_VERTEX_TEXTURE_IMAGE_UNITS)>0;const o=r.getShaderPrecisionFormat(r.FRAGMENT_SHADER,r.HIGH_FLOAT);return o&&(e.supportsHighPrecisionFragment=o.precision>0),r}(e);return null==i||(e.supportsColorBufferFloat=null!==i.getExtension("EXT_color_buffer_float"),e.supportsColorBufferFloatBlend=null!==i.getExtension("EXT_float_blend"),e.supportsColorBufferHalfFloat=e.supportsColorBufferFloat||null!==i.getExtension("EXT_color_buffer_half_float")),e}(),i},Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})}))},"esri/views/webgl/capabilities/DebugRendererInfo":function(){define(["exports"],(function(e){"use strict";class t{constructor(e){this.getUnmaskedRenderer=e}}e.RendererInfo=t,e.loadRendererInfo=function(e){const i=e.getExtension("WEBGL_debug_renderer_info");return i?new t((()=>e.getParameter(i.UNMASKED_RENDERER_WEBGL))):null},Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})}))},"esri/views/ui/DefaultUI":function(){define(["../../chunks/tslib.es6","../../core/has","../../core/Logger","../../core/reactiveUtils","../../core/accessorSupport/decorators/property","../../core/RandomLCG","../../core/accessorSupport/decorators/subclass","./Component","./UI","../../widgets/Attribution","../../widgets/Compass","../../widgets/NavigationToggle","../../widgets/Zoom"],(function(e,t,i,r,o,n,s,a,l,c,u,h,d){"use strict";let p=class extends l{constructor(e){super(e),this._defaultPositionLookup={attribution:"manual",compass:"top-left","navigation-toggle":"top-left",zoom:"top-left"},this.components=[],this._updateViewAwareWidgets=e=>{this.components.forEach((t=>{const i=this._find(t),r=i?.widget;(function(e){return void 0!==e?.view})(r)&&(r.view=e)}))},this._componentsWatcher=(e,t)=>{this._removeComponents(t),this._addComponents(e),this._adjustPadding(e)}}initialize(){this.addHandles([r.watch((()=>this.components),this._componentsWatcher,r.initial),r.watch((()=>this.view),this._updateViewAwareWidgets,r.initial)])}_add(e,t,i,r,o){let n=e;if("string"==typeof e&&this._defaultPositionLookup[e]){if(this._find(e))return;n=this._createComponent(e)}super._add(n,t,i,r,o)}_removeComponents(e){e.forEach((e=>{const t=this._find(e);t&&(this.remove(t),t.destroy())}))}_adjustPadding(e){if(!e.includes("attribution")&&!this._isOverridden("padding")){const{top:e}=this.padding;this.padding=e}}_addComponents(e){this.constructed&&e.forEach((e=>this.add(this._createComponent(e),this._defaultPositionLookup[e])))}_createComponent(e){const t=this._createWidget(e);return new a({id:e,node:t})}_createWidget(e){const t=this.view;switch(e){case"attribution":return new c({view:t});case"compass":return new u({view:t});case"navigation-toggle":return new h({view:t,isDefaultUI:!0});case"zoom":return new d({view:t})}}};return e.__decorate([o.property()],p.prototype,"components",void 0),p=e.__decorate([s.subclass("esri.views.ui.DefaultUI")],p),p}))},"esri/views/ui/Component":function(){define(["../../chunks/tslib.es6","../../core/Accessor","../../core/domUtils","../../core/accessorSupport/decorators/property","../../core/accessorSupport/decorators/cast","../../core/has","../../core/RandomLCG","../../core/accessorSupport/decorators/subclass"],(function(e,t,i,r,o,n,s,a){"use strict";const l="esri-component";let c=class extends t{constructor(){super(...arguments),this.widget=null}destroy(){this.node=null,this.widget?.destroy()}get id(){return this._get("id")??this.widget?.id??this.node?.id}set id(e){this._set("id",e)}set node(e){const t=this._get("node");e!==t&&(e&&e.classList.add(l),t&&t.classList.remove(l),this._set("node",e))}castNode(e){return this.widget?.destroy(),e?"string"==typeof e||function(e){return e&&"nodeType"in e}(e)?(this._set("widget",null),i.byId(e)):(function(e){return e&&"function"==typeof e.render}(e)&&!e.domNode&&(e.domNode=document.createElement("div")),this._set("widget",e),e.domNode):(this._set("widget",null),null)}};return e.__decorate([r.property()],c.prototype,"id",null),e.__decorate([r.property()],c.prototype,"node",null),e.__decorate([o.cast("node")],c.prototype,"castNode",null),e.__decorate([r.property({readOnly:!0})],c.prototype,"widget",void 0),c=e.__decorate([a.subclass("esri.views.ui.Component")],c),c}))},"esri/views/ui/UI":function(){define(["../../chunks/tslib.es6","../../intl","../../core/Accessor","../../core/arrayUtils","../../core/Evented","../../core/handleUtils","../../core/reactiveUtils","../../core/accessorSupport/decorators/property","../../core/accessorSupport/decorators/cast","../../core/has","../../core/accessorSupport/decorators/subclass","../../support/modeUtils","./Component","../../widgets/support/widgetUtils","../../intl/locale"],(function(e,t,i,r,o,n,s,a,l,c,u,h,d,p,m){"use strict";const g={left:0,top:0,bottom:0,right:0},_={bottom:30,top:15,right:15,left:15},f="esri-ui",y={ui:f,corner:`${f}-corner`,innerContainer:`${f}-inner-container`,manualContainer:`${f}-manual-container`,cornerContainer:`${f}-corner-container`,topLeft:`${f}-top-left`,topRight:`${f}-top-right`,bottomLeft:`${f}-bottom-left`,bottomRight:`${f}-bottom-right`};function w(e){return 0===e?"0":`${e}px`}function v(e){const t="object"==typeof e&&null!==e&&Object.getPrototypeOf(e);return null!==t&&t!==Object.prototype||!("component"in e||"index"in e||"position"in e)?null:e}function T(e,{top:t,bottom:i,left:r,right:o}){e.style.top=t,e.style.bottom=i,e.style.left=r,e.style.right=o}let S=class extends o.EventedAccessor{constructor(e){super(e),this._cornerNameToContainerLookup={},this._positionNameToContainerLookup={},this._components=new Array,this._componentMap=new Map,this._removeWidgetHandleKey=Symbol("componentOnRemoveSymbol"),this._locale=m.getLocale(),this.view=null,this._applyViewPadding=()=>{const e=this.container;e&&T(e,this._toPixelPosition(this._getViewPadding()))},this._applyUIPadding=()=>{const e=this._innerContainer;e&&T(e,this._toPixelPosition(this.padding))},this._initContainers()}initialize(){this.addHandles([s.watch((()=>[this.view?.padding,this.container]),this._applyViewPadding,s.initial),s.watch((()=>this.padding),this._applyUIPadding,s.initial),s.watch((()=>[this.container,this._locale]),(([e,t])=>{e&&e.setAttribute("lang",t)}),s.initial),m.onLocaleChange((e=>{this._locale=e}))])}destroy(){this.container=null;for(const e of this._components)e.destroy();this._components.length=0,this._componentMap.clear()}set container(e){const t=this._get("container");e!==t&&(e&&(e.classList.add(y.ui),h.setCalciteModeClass(e),this._attachContainers(e)),t&&(t.classList.remove(y.ui),T(t,{top:"",bottom:"",left:"",right:""}),t.textContent=""),this._set("container",e))}get height(){const e=this.view?.height??0;if(0===e)return e;const t=this._getViewPadding(),{top:i,bottom:r}=t;return Math.max(e-i-r,0)}get padding(){return this._get("padding")}set padding(e){this._overrideIfSome("padding",e)}castPadding(e){return"number"==typeof e?{bottom:e,top:e,right:e,left:e}:{..._,...e}}get width(){const e=this.view?.width??0;if(0===e)return e;const t=this._getViewPadding(),{left:i,right:r}=t;return Math.max(e-i-r,0)}add(e,t){let i,r,o;if(Array.isArray(e))return void e.forEach((e=>this.add(e,t)));const n=v(e);n&&({index:i,position:t,component:e,key:r}=n),t&&"object"==typeof t&&({index:i,key:r,position:t,internal:o}=t),!e||t&&!this._isValidPosition(t)||this._add(e,t,i??this._getNumComponentsAtPosition(t),r,o)}remove(e,t){if(!e)return;if(Array.isArray(e))return e.map((e=>this.remove(e,t)));const i=this._find(e);if(i){const e=this._componentMap.get(i);if(!e||e.key!==t)return;const r=this._components.indexOf(i),o=i.node.parentNode;return o?.removeChild(i.node),this._componentMap.delete(i),i.widget?.removeHandlesReference(this._removeWidgetHandleKey),this._components.forEach((t=>{const i=this._componentMap.get(t);i&&i.position===e.position&&i.index>e.index&&i.index--})),this._components.splice(r,1)[0]}}empty(e,t={removeInternal:!1}){if(Array.isArray(e)){for(const i of e)this.empty(i,t);return}const i=this._positionNameToContainerLookup[e??"manual"],r=Array.prototype.slice.call(i.children).map((e=>this._findByNode(e))).filter((e=>null!=e&&(!this._componentMap.get(e)?.internal||t.removeInternal)));for(const e of r)this.remove(e)}move(e,t){if(Array.isArray(e)&&e.forEach((e=>this.move(e,t))),!e)return;let i;const r=v(e)||v(t);if(r&&(i=r.index,t=r.position,e=r.component||e),t&&!this._isValidPosition(t))return;const o=this.remove(e);o&&this.add(o,{position:t,index:i})}find(e){if(!e)return null;const t=this._findById(e);return t&&(t.widget||t.node)}getComponents(e,t={includeInternal:!1}){return e?Array.isArray(e)?e.flatMap((e=>this._getComponentsAtPosition(e,t))):this._getComponentsAtPosition(e,t):this._components.filter((e=>t.includeInternal||!this._componentMap.get(e)?.internal)).map((({widget:e,node:t})=>e??t))}getPosition(e){for(const t in this._positionNameToContainerLookup)if(this._positionNameToContainerLookup[t].contains(e))return t;return null}_add(e,t,r,o,s){e instanceof d||(e=new d({node:e}));const{widget:a}=e;null!=a&&a instanceof i&&a.addHandles(n.makeHandle((()=>{queueMicrotask((()=>this.remove(e)))})),this._removeWidgetHandleKey),this._components.some((e=>this._componentMap.get(e)?.position===t&&this._componentMap.get(e)?.index===r))&&this._components.forEach((e=>{const i=this._componentMap.get(e);i&&i.position===t&&i.index>=r&&i.index++})),this._place({component:e,position:t,index:r}),this._components.push(e),this._componentMap.set(e,{key:o,position:t,internal:s,index:r})}_find(e){return e?e instanceof d?this._findByComponent(e):"string"==typeof e?this._findById(e):"domNode"in e?this._findByNode(e.domNode):this._findByNode(e):null}_getViewPadding(){return this.view?.padding??g}_attachContainers(e){e.appendChild(this._innerContainer),e.appendChild(this._manualContainer)}_initContainers(){const e=document.createElement("div");e.classList.add(y.innerContainer,y.cornerContainer);const t=document.createElement("div");t.classList.add(y.innerContainer,y.manualContainer);const i=document.createElement("div");i.classList.add(y.topLeft,y.corner),e.appendChild(i);const r=document.createElement("div");r.classList.add(y.topRight,y.corner),e.appendChild(r);const o=document.createElement("div");o.classList.add(y.bottomLeft,y.corner),e.appendChild(o);const n=document.createElement("div");n.classList.add(y.bottomRight,y.corner),e.appendChild(n),this._innerContainer=e,this._manualContainer=t;const s=p.isRTL();this._cornerNameToContainerLookup={"top-left":i,"top-right":r,"bottom-left":o,"bottom-right":n,"top-leading":s?r:i,"top-trailing":s?i:r,"bottom-leading":s?n:o,"bottom-trailing":s?o:n},this._positionNameToContainerLookup={manual:t,...this._cornerNameToContainerLookup}}_isValidPosition(e){return!!this._positionNameToContainerLookup[e]}_place(e){const t=e.position??"manual",{component:i,index:r}=e,o=this._positionNameToContainerLookup[t],n=null!=r&&r>-1;var s;if((s=i.widget)&&!s._started&&"function"==typeof s.postMixInProperties&&"function"==typeof s.buildRendering&&"function"==typeof s.postCreate&&"function"==typeof s.startup&&i.widget.startup(),!n)return void o.appendChild(i.node);const a=Array.from(o.children);if(0!==a.length){for(const e of a){const t=this._findByNode(e);if(t&&r<(this._componentMap.get(t)?.index??0))return void e.parentNode?.insertBefore(i.node,e)}o.appendChild(i.node)}else o.appendChild(i.node)}_toPixelPosition(e){return{top:w(e.top),left:w(e.left),right:w(e.right),bottom:w(e.bottom)}}_findByComponent(e){return this._components.find((t=>t===e))??null}_findById(e){return this._components.find((({id:t})=>t===e))??null}_findByNode(e){return e?this._components.find((({node:t})=>t===e)):null}_getComponentsAtPosition(e,t){const i=this._positionNameToContainerLookup[e];return Array.prototype.slice.call(i.children).map((e=>this._findByNode(e))).filter(r.isSome).filter((e=>t.includeInternal||!this._componentMap.get(e)?.internal)).map((({widget:e,node:t})=>e??t))}_getNumComponentsAtPosition(e){const t=this._positionNameToContainerLookup[e];return t?.children.length??0}};return e.__decorate([a.property()],S.prototype,"_locale",void 0),e.__decorate([a.property()],S.prototype,"container",null),e.__decorate([a.property()],S.prototype,"height",null),e.__decorate([a.property({value:_})],S.prototype,"padding",null),e.__decorate([l.cast("padding")],S.prototype,"castPadding",null),e.__decorate([a.property()],S.prototype,"view",void 0),e.__decorate([a.property()],S.prototype,"width",null),S=e.__decorate([u.subclass("esri.views.ui.UI")],S),S}))},"esri/widgets/Attribution":function(){define(["../chunks/tslib.es6","../core/reactiveUtils","../core/accessorSupport/decorators/property","../core/has","../core/Logger","../core/RandomLCG","../core/accessorSupport/decorators/subclass","./Widget","./Attribution/AttributionViewModel","./support/globalCss","./support/decorators/accessibleHandler","./support/decorators/messageBundle","./support/jsxFactory","./support/widgetUtils"],(function(e,t,i,r,o,n,s,a,l,c,u,h,d,p){"use strict";const m="esri-attribution",g={base:m,poweredBy:`${m}__powered-by`,sources:`${m}__sources`,open:`${m}--open`,sourcesOpen:`${m}__sources--open`,link:`${m}__link`};let _=class extends a{constructor(e,t){super(e,t),this._isOpen=!1,this._attributionTextOverflowed=!1,this._prevSourceNodeHeight=0,this._resizeObserver=new ResizeObserver((e=>e.forEach((({target:e})=>this._checkSourceTextOverflow(e))))),this.itemDelimiter=" | ",this.messages=null,this.viewModel=new l}initialize(){this.addHandles(t.on((()=>this.viewModel?.items),"change",(()=>this.scheduleRender())))}destroy(){this._resizeObserver?.disconnect()}get _isInteractive(){return this._isOpen||this._attributionTextOverflowed}get attributionText(){return this.viewModel.items.reduce(((e,t)=>(e.includes(t.text)||e.push(t.text),e)),[]).join(this.itemDelimiter)}get icon(){return"description"}set icon(e){this._overrideIfSome("icon",e)}get label(){return this.messages?.widgetLabel??""}set label(e){this._overrideIfSome("label",e)}get view(){return this.viewModel.view}set view(e){this.viewModel.view=e}render(){const e={[g.open]:this._isOpen};return d.tsx("div",{bind:this,class:this.classes(g.base,c.globalCss.widget,e),dir:"ltr",onclick:this._toggleState,onkeydown:this._toggleState},this._renderSourcesNode(),this._renderPoweredBy())}_renderPoweredBy(){return d.tsx("div",{class:g.poweredBy},"Powered by"," ",d.tsx("a",{class:g.link,href:"https://www.esri.com/",rel:"noreferrer",target:"_blank"},"Esri"))}_renderSourcesNode(){const e=this._isOpen,t=this._isInteractive,i=t?0:void 0,{attributionText:r}=this,o={[g.sourcesOpen]:e,[c.globalCss.interactive]:t};return d.tsx("div",{afterCreate:this._afterSourcesNodeCreate,bind:this,class:this.classes(g.sources,o),innerHTML:r,tabIndex:i})}_afterSourcesNodeCreate(e){this._prevSourceNodeHeight=e.clientWidth,this._resizeObserver.observe(e)}_checkSourceTextOverflow(e){let t=!1;const{clientHeight:i,clientWidth:r,scrollWidth:o}=e,n=o>r,s=this._attributionTextOverflowed!==n;if(this._attributionTextOverflowed=n,s&&(t=!0),this._isOpen){const e=i<this._prevSourceNodeHeight;this._prevSourceNodeHeight=i,e&&(this._isOpen=!1,t=!0)}t&&this.scheduleRender()}_toggleState(){this._isInteractive&&(this._isOpen=!this._isOpen)}};return e.__decorate([i.property()],_.prototype,"_isOpen",void 0),e.__decorate([i.property()],_.prototype,"_isInteractive",null),e.__decorate([i.property()],_.prototype,"_attributionTextOverflowed",void 0),e.__decorate([i.property()],_.prototype,"_prevSourceNodeHeight",void 0),e.__decorate([i.property({readOnly:!0,dependsOn:["viewModel.items.length","itemDelimiter"]})],_.prototype,"attributionText",null),e.__decorate([i.property()],_.prototype,"icon",null),e.__decorate([i.property()],_.prototype,"itemDelimiter",void 0),e.__decorate([i.property()],_.prototype,"label",null),e.__decorate([i.property(),h.messageBundle("esri/widgets/Attribution/t9n/Attribution")],_.prototype,"messages",void 0),e.__decorate([i.property()],_.prototype,"view",null),e.__decorate([i.property({type:l})],_.prototype,"viewModel",void 0),e.__decorate([u.accessibleHandler()],_.prototype,"_toggleState",null),_=e.__decorate([s.subclass("esri.widgets.Attribution")],_),_}))},"esri/widgets/Attribution/AttributionViewModel":function(){define(["../../chunks/tslib.es6","../../core/Accessor","../../core/asyncUtils","../../core/Collection","../../core/reactiveUtils","../../core/accessorSupport/decorators/property","../../core/has","../../core/Logger","../../core/RandomLCG","../../core/accessorSupport/decorators/subclass","../../geometry/Extent","../../geometry/SpatialReference","../../geometry/support/contains","../../geometry/support/webMercatorUtils","../../views/3d/layers/Lyr3DWasm"],(function(e,t,i,r,o,n,s,a,l,c,u,h,d,p,m){"use strict";function g(e,t){return e&&"copyright"in e&&(!t||"function"==typeof e.originOf&&"user"===e.originOf("copyright"))}function _(e,t,i){i&&t&&(e.find((e=>e.layerView===t&&e.text===i))||e.push({text:i,layerView:t}))}const f=[];let y=class extends t{constructor(e){super(e),this._clear=()=>{this._fetchedAttributionData.clear(),this._pendingAttributions.clear(),this.removeHandles("suspension"),this.notifyChange("state")},this._pendingAttributions=new Set,this._fetchedAttributionData=new Map,this.items=new r,this.view=null,this._allLayerViewsChange=e=>{this.removeHandles("suspension"),this.removeHandles("visible-geometry-changed");const t=this.view?.allLayerViews;t&&(this.addHandles(t.map((e=>o.watch((()=>[e.suspended,e.layer?.attributionVisible]),(()=>this._updateAttributionItems())))).toArray(),"suspension"),t.forEach((e=>{"esri.views.3d.layers.Tiles3DLayerView3D"===e.declaredClass&&this.addHandles(e.on("visible-geometry-changed",(()=>this._updateAttributionItems())),"visible-geometry-changed")}))),e?.removed&&e.removed.forEach((e=>{this._pendingAttributions.delete(e),this._fetchedAttributionData.delete(e)})),this._updateAttributionItems()},this.addHandles([o.on((()=>this.view?.allLayerViews),"change",(e=>this._allLayerViewsChange(e)),{onListenerAdd:()=>this._allLayerViewsChange(),onListenerRemove:this._clear}),o.when((()=>!0===this.view?.stationary),(()=>this._updateAttributionItems()))])}destroy(){this.view=null,this._fetchedAttributionData.clear(),this._pendingAttributions.clear(),this.items.removeAll()}get state(){return this.view?.ready?this._pendingAttributions.size>0?"loading":"ready":"disabled"}_updateAttributionItems(){const e=this.view,t=e?.allLayerViews;if(f.length=0,!e||!t)return void this._clear();t.forEach((t=>{if(t.suspended||!t.layer?.attributionVisible)return;const i=t.layer;if(g(i,"user"))return void _(f,t,i.copyright);if(i.hasAttributionData){if(this._fetchedAttributionData.has(t)){const r=this._fetchedAttributionData.get(t);return void(r?_(f,t,this._getDynamicAttribution(r,e,i)):g(i)&&_(f,t,i.copyright))}return void this._fetchAttributionData(t)}const r="portalItem"in i?i.portalItem?.accessInformation:void 0;_(f,t,r||i.copyright)}));const i=t.find((e=>"integrated-mesh-3dtiles"===e.layer?.type));if(this.view&&i){const e=m.getLyr3DWasm(this.view);if(e){const t=e.getAttributionText();for(let e=0;e<t.length;++e)_(f,i,t[e])}}var r,o;r=this.items,o=f,(r.length!==o.length||r.some(((e,t)=>e.text!==o[t].text)))&&(this.items.removeAll(),this.items.addMany(f)),f.length=0,this.notifyChange("state")}async _fetchAttributionData(e){if(this._pendingAttributions.has(e))return;this._pendingAttributions.add(e);const t=await i.result(e.layer.fetchAttributionData());if(this._pendingAttributions.has(e)){const i=t.ok?this._createContributionIndex(t.value,"bing-maps"===e.layer.type):null;this._pendingAttributions.delete(e),this._fetchedAttributionData.set(e,i)}this._updateAttributionItems()}_createContributionIndex(e,t){const i=e.contributors,r={};if(!i)return r;for(let e=0;e<i.length;e++){const o=i[e],n=o.coverageAreas;if(!n)return;for(const i of n){const n=i.bbox,s=i.zoomMin-(t&&i.zoomMin?1:0),a=i.zoomMax-(t&&i.zoomMax?1:0),l=new u({xmin:n[1],ymin:n[0],xmax:n[3],ymax:n[2],spatialReference:h.WGS84}),c={extent:p.geographicToWebMercator(l),attribution:o.attribution||"",score:null!=i.score?i.score:100,id:e};for(let e=s;e<=a;e++)r[e]??=[],r[e].push(c)}}return r.maxKey=Math.max.apply(null,Object.keys(r)),r}_getDynamicAttribution(e,t,i){const{extent:r,scale:o}=t;let n=i.tileInfo?.scaleToZoom(o)??0;if(n=Math.min(e.maxKey??0,Math.round(n)),!r||null==n||n<=-1)return"";const s=e[n],a=p.project(r.center.clone().normalize(),h.WebMercator),l=new Set;return s?s.filter((e=>{const t=e.id,i=!l.has(t)&&a&&e.extent&&d.extentContainsPoint(e.extent,a);return i&&l.add(t),i})).sort(((e,t)=>t.score-e.score||e.objectId-t.objectId)).map((e=>e.attribution)).join(", "):""}};return e.__decorate([n.property({readOnly:!0,type:r})],y.prototype,"items",void 0),e.__decorate([n.property({readOnly:!0})],y.prototype,"state",null),e.__decorate([n.property()],y.prototype,"view",void 0),y=e.__decorate([c.subclass("esri.widgets.Attribution.AttributionViewModel")],y),y}))},"esri/views/3d/layers/Lyr3DWasm":function(){define(["require","exports","../../../core/Error","../../../layers/ILyr3DWasmPerSceneView"],(function(e,t,i,r){"use strict";const o=e=>Object.freeze(Object.defineProperty({__proto__:null,default:e},Symbol.toStringTag,{value:"Module"}));let n,s=null;const a=new Map;t.addLayerViewToWasm=async function(t){null==s&&(null==n&&(n=new Promise(((t,i)=>e(["../../../layers/Lyr3DWasmPerSceneView"],(e=>t(o(e))),i)))),s=await n);const l=t.view;let c=a.get(l);c||(c=new s.default({view:l}),a.set(l,c));const u=!!l.stage.renderView.renderingContext.capabilities.compressedTextureS3TC,h=!!l.stage.renderView.renderingContext.capabilities.compressedTextureETC;await c.initializeWasm(u,h);const d=c.add3DTilesLayerView(t);if(d.wasmLayerId<0)throw c.getValidLayerViewCount()<1&&(a.delete(l),0===a.size&&(n=null,s=null)),d.wasmLayerId===r.wasmFailedToInit?new i("tiles3d:addLayer-failure","The 3d tiles layer web assembly module failed to download.",{}):new i("tiles3d:addLayer-failure",d.check?.errorDescription??"The 3d tiles layer description was invalid.",{});return d.wasmLayerId},t.getLyr3DWasm=function(e){return a.get(e)},t.removeLayerViewFromWasm=function(e){const t=e.view,i=a.get(t);i&&i.remove3DTilesLayerView(e)<1&&(a.delete(t),0===a.size&&(n=null,s=null))},Object.defineProperty(t,Symbol.toStringTag,{value:"Module"})}))},"esri/layers/ILyr3DWasmPerSceneView":function(){define(["exports"],(function(e){"use strict";var t,i,r,o,n,s,a,l,c,u,h,d,p,m,g;e.Lyr3DType=void 0,(t=e.Lyr3DType||(e.Lyr3DType={})).U8="U8",t.I8="I8",t.U16="U16",t.I16="I16",t.U32="U32",t.I32="I32",t.F32="F32",t.F64="F64",t.Utf8String="Utf8String",t.NotSet="NotSet",e.Lyr3DImageFormat=void 0,(i=e.Lyr3DImageFormat||(e.Lyr3DImageFormat={})).Png="Png",i.Jpeg="Jpeg",i.Dds="Dds",i.Raw="Raw",i.Dxt1="Dxt1",i.Dxt5="Dxt5",i.Bc7="Bc7",i.Basis="Basis",i.Etc1="Etc1",i.Etc2="Etc2",i.Astc="Astc",i.Pvrtc="Pvrtc",i.NotSet="NotSet",e.Lyr3DVtxAtrbSemantic=void 0,(r=e.Lyr3DVtxAtrbSemantic||(e.Lyr3DVtxAtrbSemantic={})).Position="Position",r.Normal="Normal",r.TexCoord="TexCoord",r.Color="Color",r.Tangent="Tangent",r.FeatureIndex="FeatureIndex",r.UvRegion="UvRegion",r.FeatureVariable="FeatureVariable",r.NotSet="NotSet",e.Lyr3DAlphaMode=void 0,(o=e.Lyr3DAlphaMode||(e.Lyr3DAlphaMode={})).Opaque="Opaque",o.Mask="Mask",o.Blend="Blend",e.Lyr3DTransparency=void 0,(n=e.Lyr3DTransparency||(e.Lyr3DTransparency={})).None="None",n.Mask="Mask",n.Alpha="Alpha",n.PreMultAlpha="PreMultAlpha",n.NotSet="NotSet",e.Lyr3DPrimitiveType=void 0,(s=e.Lyr3DPrimitiveType||(e.Lyr3DPrimitiveType={})).Points="Points",s.Lines="Lines",s.LineStrip="LineStrip",s.Triangles="Triangles",s.TriangleStrip="TriangleStrip",s.NotSet="NotSet",e.Lyr3DUvWrapMode=void 0,(a=e.Lyr3DUvWrapMode||(e.Lyr3DUvWrapMode={})).None="None",a.WrapXBit="WrapXBit",a.WrapYBit="WrapYBit",a.WrapXy="WrapXy",a.NotSet="NotSet",e.Lyr3DMagFilterMode=void 0,(l=e.Lyr3DMagFilterMode||(e.Lyr3DMagFilterMode={})).Linear="Linear",l.Nearest="Nearest",l.NotSet="NotSet",e.Lyr3DMinFilterMode=void 0,(c=e.Lyr3DMinFilterMode||(e.Lyr3DMinFilterMode={})).Linear="Linear",c.Nearest="Nearest",c.NearestMipmapNearest="NearestMipmapNearest",c.LinearMipmapNearest="LinearMipmapNearest",c.NearestMipmapLinear="NearestMipmapLinear",c.LinearMipmapLinear="LinearMipmapLinear",c.NotSet="NotSet",e.Lyr3DSchemaPropertySemantic=void 0,(u=e.Lyr3DSchemaPropertySemantic||(e.Lyr3DSchemaPropertySemantic={})).FeatureId="FeatureId",u.GlobalUid="GlobalUid",u.UnspecifiedDateTime="UnspecifiedDateTime",u.EcmaIso8601DateTime="EcmaIso8601DateTime",u.EcmaIso8601DateOnly="EcmaIso8601DateOnly",u.TimeOnly="TimeOnly",u.TimeStamp="TimeStamp",u.ColorRgb="ColorRgb",u.ColorRgba="ColorRgba",u.Unrecognized="Unrecognized",u.NotSet="NotSet",e.Lyr3DFeatureIndexSource=void 0,(h=e.Lyr3DFeatureIndexSource||(e.Lyr3DFeatureIndexSource={})).Texture="Texture",h.VertexAtrb="VertexAtrb",h.Implicit="Implicit",h.NotSet="NotSet",e.Lyr3DFaceCullingMode=void 0,(d=e.Lyr3DFaceCullingMode||(e.Lyr3DFaceCullingMode={})).Front="Front",d.Back="Back",d.None="None",d.NotSet="NotSet",e.Lyr3DLightingModel=void 0,(p=e.Lyr3DLightingModel||(e.Lyr3DLightingModel={})).Pbr="Pbr",p.Unlit="Unlit",e.Lyr3DPixelFormat=void 0,(m=e.Lyr3DPixelFormat||(e.Lyr3DPixelFormat={})).Rgb8="Rgb8",m.Rgba8="Rgba8",m.R8="R8",m.Bgr8="Bgr8",m.Bgra8="Bgra8",m.Rg8="Rg8",m.Ga8="Ga8",m.Etc1="Etc1",m.Etc2="Etc2",m.Dxt1="Dxt1",m.Dxt5="Dxt5",m.Bc7="Bc7",m.NotSet="NotSet",e.Lyr3DWasmWorkerOutputStatus=void 0,(g=e.Lyr3DWasmWorkerOutputStatus||(e.Lyr3DWasmWorkerOutputStatus={}))[g.Succeeded=0]="Succeeded",g[g.Failed=1]="Failed",g[g.MissingInputs=2]="MissingInputs",e.invalidLayerView=-1,e.wasmFailedToInit=-2,Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})}))},"esri/widgets/support/globalCss":function(){define(["exports"],(function(e){"use strict";e.globalCss={anchor:"esri-widget__anchor",anchorDisabled:"esri-widget__anchor--disabled",button:"esri-button",buttonDisabled:"esri-button--disabled",buttonHalf:"esri-button--half",buttonSecondary:"esri-button--secondary",buttonSmall:"esri-button--small",buttonTertiary:"esri-button--tertiary",buttonThird:"esri-button--third",disabled:"esri-disabled",empty:"esri-widget__content--empty",emptyIllustration:"esri-widget__content-illustration--empty",heading:"esri-widget__heading",hidden:"esri-hidden",input:"esri-input",interactive:"esri-interactive",loader:"esri-widget__loader",loaderAnimation:"esri-widget__loader-animation",loaderText:"esri-widget__loader-text",menu:"esri-menu",menuHeader:"esri-menu__header",menuItem:"esri-menu__list-item",menuItemActive:"esri-menu__list-item--active",menuItemFocus:"esri-menu__list-item--focus",menuList:"esri-menu__list",panel:"esri-widget--panel",panelHeightOnly:"esri-widget--panel-height-only",primaryTick:"primary-tick",primaryTickAmPm:"primary-tick__ampm",primaryTickLabel:"primary-tick__label",primaryTickLabelKeepAll:"primary-tick__label--keep-all",rotating:"esri-rotating",secondaryTick:"secondary-tick",select:"esri-select",table:"esri-widget__table",widget:"esri-widget",widgetButton:"esri-widget--button",widgetButtonActive:"esri-widget--button-active",widgetDisabled:"esri-widget--disabled"},Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})}))},"esri/widgets/Compass":function(){define(["require","../chunks/tslib.es6","../core/accessorSupport/decorators/property","../core/has","../core/Logger","../core/RandomLCG","../core/accessorSupport/decorators/subclass","./Widget","./Compass/CompassViewModel","./Compass/css","../chunks/componentsUtils","./support/globalCss","./support/widgetUtils","./support/decorators/messageBundle","./support/jsxFactory"],(function(e,t,i,r,o,n,s,a,l,c,u,h,d,p,m){"use strict";let g=class extends a{constructor(e,t){super(e,t),this.messages=null,this.viewModel=new l,this._reset=()=>{this.viewModel.reset()},this._toRotationTransform=e=>({transform:`rotateZ(${e.z}deg)`})}loadDependencies(){return u.loadCalciteComponents({button:()=>new Promise(((t,i)=>e(["../chunks/index2"],t,i))),icon:()=>new Promise(((t,i)=>e(["../chunks/index7"],t,i)))})}get goToOverride(){return this.viewModel.goToOverride}set goToOverride(e){this.viewModel.goToOverride=e}get icon(){return"rotation"===this.viewModel.state?"arrow-up":"compass-needle"}set icon(e){this._overrideIfSome("icon",e)}get label(){return this.messages?.widgetLabel??""}set label(e){this._overrideIfSome("label",e)}get view(){return this.viewModel.view}set view(e){this.viewModel.view=e}reset(){return this.viewModel.reset()}render(){const{orientation:e,state:t}=this.viewModel,{messages:i}=this;return m.tsx("div",{class:this.classes(c.css.base,h.globalCss.widget)},m.tsx("calcite-button",{class:h.globalCss.widgetButton,disabled:"disabled"===t,kind:"neutral",label:i.reset,onclick:this._reset,round:!0,scale:"s",title:i.reset},m.tsx("div",{"aria-hidden":"true",class:c.css.iconContainer,title:i.reset},m.tsx("calcite-icon",{icon:this.icon,styles:this._toRotationTransform(e)}))))}};return t.__decorate([i.property()],g.prototype,"goToOverride",null),t.__decorate([i.property()],g.prototype,"icon",null),t.__decorate([i.property()],g.prototype,"label",null),t.__decorate([i.property(),p.messageBundle("esri/widgets/Compass/t9n/Compass")],g.prototype,"messages",void 0),t.__decorate([i.property()],g.prototype,"view",null),t.__decorate([i.property({type:l})],g.prototype,"viewModel",void 0),g=t.__decorate([s.subclass("esri.widgets.Compass")],g),g}))},"esri/widgets/Compass/CompassViewModel":function(){define(["../../chunks/tslib.es6","../../core/Accessor","../../core/reactiveUtils","../../core/accessorSupport/decorators/property","../../core/has","../../core/Logger","../../core/RandomLCG","../../core/accessorSupport/decorators/subclass","../../views/2d/navigation/duration","./utils","../support/GoTo"],(function(e,t,i,r,o,n,s,a,l,c,u){"use strict";let h=class extends(u(t)){constructor(e){super(e),this.orientation={x:0,y:0,z:0},this.view=null,this._updateForCamera=this._updateForCamera.bind(this),this._updateForRotation=this._updateForRotation.bind(this),this._updateRotationWatcher=this._updateRotationWatcher.bind(this)}initialize(){this._watchForView(i.initial)}destroy(){this.view=null}get canShowNorth(){return c.canShowNorth(this.view)}get state(){return!this.view?.ready||"2d"===this.view.type&&!this.view.constraints.rotationEnabled?"disabled":this.canShowNorth?"compass":"rotation"}reset(){this.view?.ready&&("2d"===this.view?.type?this.callGoTo({target:{rotation:0},options:{animationMode:"always",duration:l.getGoToDuration()}}):this.callGoTo({target:{heading:0}}))}_updateForRotation(e){null!=e&&this._set("orientation",{z:e})}_updateForCamera(e){if(!e)return;const t=-e.heading;this._set("orientation",{x:0,y:0,z:t})}_updateRotationWatcher(e){this.removeAllHandles(),this._watchForView(),e&&this.addHandles("2d"===e.type?i.watch((()=>e?.rotation),this._updateForRotation,i.initial):i.watch((()=>e?.camera),this._updateForCamera,i.initial))}_watchForView(e){this.addHandles(i.watch((()=>this.view),this._updateRotationWatcher,e))}};return e.__decorate([r.property({readOnly:!0})],h.prototype,"canShowNorth",null),e.__decorate([r.property({readOnly:!0})],h.prototype,"orientation",void 0),e.__decorate([r.property({readOnly:!0})],h.prototype,"state",null),e.__decorate([r.property()],h.prototype,"view",void 0),h=e.__decorate([a.subclass("esri.widgets.Compass.CompassViewModel")],h),h}))},"esri/views/2d/navigation/duration":function(){define(["exports","../../../core/has","../../../core/time"],(function(e,t,i){"use strict";e.getGoToDuration=function(){const e=t("mapview-essential-goto-duration");return null==e?e:i.Milliseconds(e)},Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})}))},"esri/widgets/Compass/utils":function(){define(["exports"],(function(e){"use strict";e.canShowNorth=function(e){return e?.spatialReference?.isWebMercator||e?.spatialReference?.isGeographic||!1},Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})}))},"esri/widgets/support/GoTo":function(){define(["../../chunks/tslib.es6","../../core/maybe","../../core/accessorSupport/decorators/property","../../core/has","../../core/Logger","../../core/RandomLCG","../../core/accessorSupport/decorators/subclass","./goToUtils"],(function(e,t,i,r,o,n,s,a){"use strict";return r=>{let o=class extends r{constructor(...e){super(...e),this.goToOverride=null,this.view=null}callGoTo(e){const{view:i}=this;return t.assertIsSome(i),this.goToOverride?this.goToOverride(i,e):a.goTo(i,e.target,e.options)}};return e.__decorate([i.property()],o.prototype,"goToOverride",void 0),e.__decorate([i.property()],o.prototype,"view",void 0),o=e.__decorate([s.subclass("esri.widgets.support.GoTo")],o),o}}))},"esri/widgets/support/goToUtils":function(){define(["exports"],(function(e){"use strict";e.goTo=function(e,t,i){return e.goTo(t,i)},e.makeGoToWithoutAnimation=function(){return(e,t)=>e.goTo(t.target,{...t.options,animate:!1})},Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})}))},"esri/widgets/Compass/css":function(){define(["exports"],(function(e){"use strict";const t="esri-compass",i={base:t,iconContainer:`${t}__icon-container`};e.css=i,Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})}))},"esri/widgets/NavigationToggle":function(){define(["require","../chunks/tslib.es6","../core/deprecate","../core/Logger","../core/accessorSupport/decorators/property","../core/has","../core/RandomLCG","../core/accessorSupport/decorators/subclass","./Widget","./NavigationToggle/css","./NavigationToggle/NavigationToggleViewModel","../chunks/componentsUtils","./support/globalCss","./support/widgetUtils","./support/decorators/messageBundle","./support/jsxFactory"],(function(e,t,i,r,o,n,s,a,l,c,u,h,d,p,m,g){"use strict";let _=class extends l{constructor(e,t){super(e,t),this.messages=null,this.viewModel=new u({isDefaultViewModel:!0}),this.toggle=()=>this.viewModel.toggle(),this._panButton=null,this._rotateButton=null,this._toggle=()=>{const e="pan"===this.viewModel?.navigationMode?this._rotateButton:this._panButton;p.setFocus(e),this.toggle()},e?.isDefaultUI||i.deprecateWidget(r.getLogger(this),"Navigation Toggle","arcgis-navigation-toggle",{version:"4.32"})}normalizeCtorArgs(e={}){const{isDefaultUI:t,...i}=e;return i}loadDependencies(){return h.loadCalciteComponents({button:()=>new Promise(((t,i)=>e(["../chunks/index2"],t,i)))})}get icon(){return"move"}set icon(e){this._overrideIfSome("icon",e)}get label(){return this.messages?.widgetLabel??""}set label(e){this._overrideIfSome("label",e)}set layout(e){"horizontal"!==e&&(e="vertical"),this._set("layout",e)}get view(){return this.viewModel.view}set view(e){this.viewModel.view=e}render(){const e="disabled"===this.viewModel?.state,t="pan"===this.viewModel?.navigationMode,i=this.messages.toggle;return g.tsx("div",{class:this.classes(c.css.base,d.globalCss.widget,{[c.css.isLayoutHorizontal]:"horizontal"===this.layout})},g.tsx("calcite-button",{afterCreate:e=>{this._panButton=e},appearance:t?"outline-fill":"solid",class:d.globalCss.widgetButton,disabled:e,iconStart:"move",kind:"neutral",label:i,onclick:this._toggle,tabIndex:t?void 0:-1,title:i}),g.tsx("calcite-button",{afterCreate:e=>{this._rotateButton=e},appearance:t?"solid":"outline-fill",class:d.globalCss.widgetButton,disabled:e,iconStart:"rotate",kind:"neutral",label:i,onclick:this._toggle,tabIndex:t?-1:void 0,title:i}))}};return t.__decorate([o.property()],_.prototype,"icon",null),t.__decorate([o.property()],_.prototype,"label",null),t.__decorate([o.property({value:"vertical"})],_.prototype,"layout",null),t.__decorate([o.property(),m.messageBundle("esri/widgets/NavigationToggle/t9n/NavigationToggle")],_.prototype,"messages",void 0),t.__decorate([o.property()],_.prototype,"view",null),t.__decorate([o.property({type:u})],_.prototype,"viewModel",void 0),_=t.__decorate([a.subclass("esri.widgets.NavigationToggle")],_),_}))},"esri/widgets/NavigationToggle/css":function(){define(["exports"],(function(e){"use strict";const t="esri-navigation-toggle",i={base:t,isLayoutHorizontal:`${t}--horizontal`};e.css=i,Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})}))},"esri/widgets/NavigationToggle/NavigationToggleViewModel":function(){define(["../../chunks/tslib.es6","../../core/Accessor","../../core/deprecate","../../core/Logger","../../core/reactiveUtils","../../core/accessorSupport/decorators/property","../../core/has","../../core/RandomLCG","../../core/accessorSupport/decorators/subclass"],(function(e,t,i,r,o,n,s,a,l){"use strict";let c=class extends t{constructor(e){super(e),this._navigationMode="pan",this.view=null,e?.isDefaultViewModel||i.deprecateUnnecessaryViewModel(r.getLogger(this),"Navigation Toggle","arcgis-navigation-toggle",{version:"4.33"})}normalizeCtorArgs(e={}){const{isDefaultViewModel:t,...i}=e;return i}initialize(){this.addHandles(o.when((()=>this.view?.navigation?.actionMap),(()=>this._updateNavigationActionMap())))}destroy(){this.view=null}get state(){return this.view?.ready&&"3d"===this.view?.type?"ready":"disabled"}get navigationMode(){return this._navigationMode}set navigationMode(e){this._navigationMode=e,this._updateNavigationActionMap()}toggle(){"disabled"!==this.state&&(this.navigationMode="pan"!==this.navigationMode?"pan":"rotate")}_updateNavigationActionMap(){const e=this.view?.navigation?.actionMap;if(!e)return;const t="pan"===this._navigationMode;e.dragPrimary=t?"pan":"rotate",e.dragSecondary=t?"rotate":"pan"}};return e.__decorate([n.property({readOnly:!0})],c.prototype,"state",null),e.__decorate([n.property()],c.prototype,"_navigationMode",void 0),e.__decorate([n.property()],c.prototype,"view",void 0),c=e.__decorate([l.subclass("esri.widgets.NavigationToggle.NavigationToggleViewModel")],c),c}))},"esri/widgets/Zoom":function(){define(["require","../chunks/tslib.es6","../core/accessorSupport/decorators/property","../core/has","../core/Logger","../core/RandomLCG","../core/accessorSupport/decorators/subclass","./Widget","../chunks/componentsUtils","./support/globalCss","./support/widgetUtils","./support/decorators/messageBundle","./support/jsxFactory","./Zoom/ZoomViewModel"],(function(e,t,i,r,o,n,s,a,l,c,u,h,d,p){"use strict";const m="esri-zoom--horizontal";let g=class extends a{constructor(e,t){super(e,t),this.messages=null,this.viewModel=new p,this.zoomIn=()=>this.viewModel.zoomIn(),this.zoomOut=()=>this.viewModel.zoomOut()}loadDependencies(){return l.loadCalciteComponents({button:()=>new Promise(((t,i)=>e(["../chunks/index2"],t,i)))})}get icon(){return"magnifying-glass-plus"}set icon(e){this._overrideIfSome("icon",e)}get label(){return this.messages?.widgetLabel??""}set label(e){this._overrideIfSome("label",e)}set layout(e){"horizontal"!==e&&(e="vertical"),this._set("layout",e)}set view(e){this.viewModel.view=e}get view(){return this.viewModel.view}render(){const e={[m]:"horizontal"===this.layout},{canZoomIn:t,canZoomOut:i}=this.viewModel,{zoomIn:r,zoomOut:o}=this.messages;return d.tsx("div",{class:this.classes("esri-zoom",c.globalCss.widget,e)},d.tsx("calcite-button",{class:c.globalCss.widgetButton,disabled:!t,iconStart:"plus",kind:"neutral",label:r,onclick:this.zoomIn,title:r}),d.tsx("calcite-button",{class:c.globalCss.widgetButton,disabled:!i,iconStart:"minus",kind:"neutral",label:o,onclick:this.zoomOut,title:o}))}};return t.__decorate([i.property()],g.prototype,"icon",null),t.__decorate([i.property()],g.prototype,"label",null),t.__decorate([i.property({value:"vertical"})],g.prototype,"layout",null),t.__decorate([i.property(),h.messageBundle("esri/widgets/Zoom/t9n/Zoom")],g.prototype,"messages",void 0),t.__decorate([i.property()],g.prototype,"view",null),t.__decorate([i.property({type:p})],g.prototype,"viewModel",void 0),g=t.__decorate([s.subclass("esri.widgets.Zoom")],g),g}))},"esri/widgets/Zoom/ZoomViewModel":function(){define(["../../chunks/tslib.es6","../../core/Accessor","../../core/promiseUtils","../../core/accessorSupport/decorators/property","../../core/has","../../core/Logger","../../core/RandomLCG","../../core/accessorSupport/decorators/subclass","./ZoomConditions2D","./ZoomConditions3D"],(function(e,t,i,r,o,n,s,a,l,c){"use strict";let u=class extends t{constructor(e){super(e)}destroy(){this.view=null}get canZoomIn(){return null!=this._zoomConditions&&this._zoomConditions.canZoomIn}get canZoomOut(){return null!=this._zoomConditions&&this._zoomConditions?.canZoomOut}get state(){return this.view?.ready?"ready":"disabled"}set view(e){e?"2d"===e.type?this._zoomConditions=new l({view:e}):"3d"===e.type&&(this._zoomConditions=new c({view:e})):this._zoomConditions=null,this._set("view",e)}zoomIn(){const e=this.view;this.canZoomIn&&e&&("2d"===e.type?e.mapViewNavigation.zoomIn():i.ignoreAbortErrors(e.goTo({zoomFactor:2})))}zoomOut(){const e=this.view;this.canZoomOut&&e&&("2d"===e.type?e.mapViewNavigation.zoomOut():i.ignoreAbortErrors(e.goTo({zoomFactor:.5})))}};return e.__decorate([r.property()],u.prototype,"_zoomConditions",void 0),e.__decorate([r.property()],u.prototype,"canZoomIn",null),e.__decorate([r.property()],u.prototype,"canZoomOut",null),e.__decorate([r.property({readOnly:!0})],u.prototype,"state",null),e.__decorate([r.property()],u.prototype,"view",null),u=e.__decorate([a.subclass("esri.widgets.Zoom.ZoomViewModel")],u),u}))},"esri/widgets/Zoom/ZoomConditions2D":function(){define(["../../chunks/tslib.es6","../../core/Accessor","../../core/accessorSupport/decorators/property","../../core/has","../../core/Logger","../../core/RandomLCG","../../core/accessorSupport/decorators/subclass"],(function(e,t,i,r,o,n,s){"use strict";let a=class extends t{get canZoomIn(){const e=this.view?.ready;if(!e)return!1;const t=this.view?.constraints?.effectiveMaxScale;return 0===t||this._scale>t}get canZoomOut(){const{view:e}=this,t=e?.ready;if(!t)return!1;const i=e.constraints?.effectiveMinScale;return 0===i||this._scale<i}get _scale(){const e=this.view?.animation?.target;return(e&&"then"in e?void 0:e?.scale)??this.view?.scale??0}};return e.__decorate([i.property({readOnly:!0})],a.prototype,"canZoomIn",null),e.__decorate([i.property({readOnly:!0})],a.prototype,"canZoomOut",null),e.__decorate([i.property()],a.prototype,"view",void 0),e.__decorate([i.property()],a.prototype,"_scale",null),a=e.__decorate([s.subclass("esri.widgets.Zoom.ZoomConditions2D")],a),a}))},"esri/widgets/Zoom/ZoomConditions3D":function(){define(["../../chunks/tslib.es6","../../core/Accessor","../../core/accessorSupport/decorators/property","../../core/has","../../core/Logger","../../core/RandomLCG","../../core/accessorSupport/decorators/subclass"],(function(e,t,i,r,o,n,s){"use strict";let a=class extends t{get canZoomIn(){return!!this.view.ready}get canZoomOut(){return!!this.view.ready}};return e.__decorate([i.property({readOnly:!0})],a.prototype,"canZoomIn",null),e.__decorate([i.property({readOnly:!0})],a.prototype,"canZoomOut",null),e.__decorate([i.property()],a.prototype,"view",void 0),a=e.__decorate([s.subclass("esri.widgets.Zoom.ZoomConditions3D")],a),a}))},"esri/views/ui/2d/DefaultUI2D":function(){define(["../../../chunks/tslib.es6","../../../core/accessorSupport/decorators/property","../../../core/has","../../../core/Logger","../../../core/RandomLCG","../../../core/accessorSupport/decorators/subclass","../DefaultUI"],(function(e,t,i,r,o,n,s){"use strict";let a=class extends s{constructor(e){super(e),this.components=["attribution","zoom"]}};return e.__decorate([t.property()],a.prototype,"components",void 0),a=e.__decorate([n.subclass("esri.views.ui.2d.DefaultUI2D")],a),a}))},"esri/webmap/utils":function(){define(["exports","./Version"],(function(e,t){"use strict";const i=new t.Version(2,34);e.currentVersion=i,e.isWebMap=function(e){return null!=e&&"object"==typeof e&&"declaredClass"in e&&"esri.WebMap"===e.declaredClass},Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})}))},"esri/webmap/Version":function(){define(["exports","../core/Version"],(function(e,t){"use strict";class i extends t.Version{constructor(e,t){super(e,t,"webmap")}}e.Version=i,Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})}))},"esri/webmap/background/ColorBackground":function(){define(["../../chunks/tslib.es6","../../Color","../../core/JSONSupport","../../core/lang","../../core/accessorSupport/decorators/property","../../core/has","../../core/Logger","../../core/accessorSupport/decorators/subclass"],(function(e,t,i,r,o,n,s,a){"use strict";var l;let c=l=class extends i{constructor(e){super(e),this.color=new t([0,0,0,1])}clone(){return new l(r.clone({color:this.color}))}};return e.__decorate([o.property({type:t,json:{write:!0}})],c.prototype,"color",void 0),c=l=e.__decorate([a.subclass("esri.webmap.background.ColorBackground")],c),c}))},"*noref":1}}),define(["../chunks/tslib.es6","../core/accessorSupport/decorators/property","../core/has","../core/Logger","../core/RandomLCG","../core/accessorSupport/decorators/subclass","./View2D"],(function(e,t,i,r,o,n,s){"use strict";let a=class extends s{constructor(e){super(e),this.view2dType="map"}};return e.__decorate([t.property({readOnly:!0})],a.prototype,"view2dType",void 0),a=e.__decorate([n.subclass("esri.views.MapView")],a),a}));