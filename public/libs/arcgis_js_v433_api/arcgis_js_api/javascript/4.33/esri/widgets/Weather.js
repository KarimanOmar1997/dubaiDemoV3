// All material copyright Esri, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.33/esri/copyright.txt for details.
//>>built
define(["require","../chunks/tslib.es6","../core/deprecate","../core/Logger","../core/memoize","../core/accessorSupport/decorators/property","../core/has","../core/RandomLCG","../core/accessorSupport/decorators/subclass","../views/3d/environment/weather","./Widget","../chunks/componentsUtils","./support/globalCss","./support/Heading","./support/widgetUtils","./support/decorators/messageBundle","./support/jsxFactory","./Weather/css","./Weather/enums","./Weather/LabeledSlider","./Weather/VisibleElements","./Weather/WeatherViewModel"],(function(e,t,r,o,s,n,a,i,l,c,d,p,h,u,g,y,v,b,w,C,m,_){"use strict";const x={sunny:"brightness",cloudy:"partly-cloudy",rainy:"rain",snowy:"snow",foggy:"fog"};let k=class extends d{constructor(e){super(e),this.viewModel=new _({isDefaultViewModel:!0}),this.headingLevel=4,this.visibleElements=new m,this._renderWeatherTypeButton=e=>{const t=this.viewModel,r=this.messages[e].label,o=t.state===w.WeatherState.Disabled,s=!o&&t.current.type===e;return v.tsx("calcite-button",{appearance:s?"solid":"outline","aria-checked":s?"true":"false",disabled:o,iconStart:x[e],key:`${e}-type-button`,kind:s?"brand":"neutral",label:r,onclick:()=>{s||t.setWeatherByType(e)},scale:"l",title:r})},this._memoizedCallbacks=s.memoize((e=>({onCloudCoverChange:t=>{"cloudCover"in e&&(e.cloudCover=t)},onPrecipitationChange:t=>{"precipitation"in e&&(e.precipitation=t)},onFogStrengthChange:t=>{"fogStrength"in e&&(e.fogStrength=t)},onSnowCoverChange:e=>{this.viewModel.setSnowCoverEnabled(e.currentTarget.checked)}}))),r.deprecateWidget(o.getLogger(this),"Weather","arcgis-weather",{version:"4.33"})}render(){const e=this.viewModel.state===w.WeatherState.Disabled;return v.tsx("div",{"aria-label":this.messages.widgetLabelAccessible,class:this.classes(b.css.base,h.globalCss.widget,e&&h.globalCss.widgetDisabled),role:"region"},this._renderContent())}loadDependencies(){return p.loadCalciteComponents({button:()=>new Promise(((t,r)=>e(["../chunks/index2"],t,r))),checkbox:()=>new Promise(((t,r)=>e(["../chunks/index44"],t,r))),icon:()=>new Promise(((t,r)=>e(["../chunks/index7"],t,r))),label:()=>new Promise(((t,r)=>e(["../chunks/index5"],t,r)))})}get view(){return this.viewModel?.view}set view(e){this.viewModel&&(this.viewModel.view=e)}get icon(){return"partly-cloudy"}set icon(e){this._overrideIfSome("icon",e)}get label(){return this.messages?.widgetLabel??""}set label(e){this._overrideIfSome("label",e)}get _errorMessage(){const e=this.messages.error;switch(this.viewModel.error){case w.WeatherError.LocalScene:return e.localScene;case w.WeatherError.NoAtmosphere:return e.noAtmosphere;case w.WeatherError.UnsupportedView:return e.unsupported;default:return null}}get _warningMessage(){return this.viewModel.error===w.WeatherError.NotVisible&&null!=this.view&&"3d"===this.view?.type&&this.view.environment.atmosphereEnabled?this.messages.error.notVisible:null}_renderContent(){const{headingLevel:e,messages:t,viewModel:r,visibleElements:o}=this,s=this._warningMessage,n=r.current,a=r.state===w.WeatherState.Error;return v.tsx(v.tsxFragment,null,o.header?v.tsx(u.Heading,{level:e},t.widgetLabel):null,a?v.tsx("div",{class:b.css.error,key:"error"},this._errorMessage):null,v.tsx("div",{class:g.classes({[b.css.content]:!0,[b.css.hasError]:a}),key:"content"},v.tsx("div",{"aria-label":t.weatherType,class:b.css.selector,key:"type-selector",role:"radiogroup"},c.weatherTypesArray.map(this._renderWeatherTypeButton)),Object.values(r.weatherByType).map((e=>v.tsx("div",{class:g.classes({[b.css.options]:!0,[b.css.optionsHidden]:e.type!==n?.type}),key:"options-container"},this._renderOptions(e)))),null!=s?this._renderWarning(s):null))}_renderOptions(e){const{viewModel:t,messages:r}=this,o=t.state===w.WeatherState.Disabled,s=this._memoizedCallbacks(e);switch(e.type){case"sunny":return v.tsx(C.LabeledSlider,{disabled:o,key:"sunny-cover",label:r.sunny.cloudCover,value:e.cloudCover,onChange:s.onCloudCoverChange});case"cloudy":return v.tsx(C.LabeledSlider,{disabled:o,key:"cloudy-cover",label:r.cloudy.cloudCover,value:e.cloudCover,onChange:s.onCloudCoverChange});case"rainy":return v.tsx(v.tsxFragment,null,v.tsx(C.LabeledSlider,{disabled:o,key:"rainy-cover",label:r.rainy.cloudCover,value:e.cloudCover,onChange:s.onCloudCoverChange}),v.tsx(C.LabeledSlider,{disabled:o,key:"rainy-precipitation",label:r.rainy.precipitation,value:e.precipitation,onChange:s.onPrecipitationChange}));case"snowy":return v.tsx(v.tsxFragment,null,v.tsx(C.LabeledSlider,{disabled:o,key:"snowy-cloud-cover",label:r.snowy.cloudCover,value:e.cloudCover,onChange:s.onCloudCoverChange}),v.tsx(C.LabeledSlider,{disabled:o,key:"snowy-precipitation",label:r.snowy.precipitation,value:e.precipitation,onChange:s.onPrecipitationChange}),v.tsx("calcite-label",{key:"snow-cover",layout:"inline",scale:"s",title:r.snowy.snowCoverTooltip},v.tsx("calcite-checkbox",{checked:"enabled"===e.snowCover,disabled:o,onCalciteCheckboxChange:s.onSnowCoverChange}),r.snowy.snowCover));case"foggy":return v.tsx(C.LabeledSlider,{disabled:o,key:"foggy-cover",label:r.foggy.fogStrength,value:e.fogStrength,onChange:s.onFogStrengthChange})}}_renderWarning(e){return v.tsx("div",{class:b.css.warning,key:"warning"},v.tsx("calcite-icon",{icon:"exclamation-mark-triangle",scale:"s"}),e)}};return t.__decorate([n.property()],k.prototype,"viewModel",void 0),t.__decorate([n.property()],k.prototype,"view",null),t.__decorate([n.property()],k.prototype,"headingLevel",void 0),t.__decorate([n.property({type:m,nonNullable:!0})],k.prototype,"visibleElements",void 0),t.__decorate([n.property()],k.prototype,"icon",null),t.__decorate([n.property()],k.prototype,"label",null),t.__decorate([n.property(),y.messageBundle("esri/widgets/Weather/t9n/Weather")],k.prototype,"messages",void 0),t.__decorate([n.property()],k.prototype,"_errorMessage",null),t.__decorate([n.property()],k.prototype,"_warningMessage",null),k=t.__decorate([l.subclass("esri.widgets.Weather")],k),k}));